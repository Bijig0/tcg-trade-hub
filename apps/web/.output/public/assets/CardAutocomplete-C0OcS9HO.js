import{a as Oe,p as pe,b,s as V,c as I,n as W,i as te,d as me,t as Ke,e as Q,f as ze,g as Qe,h as ye,k as J,l as ge,m as $e,r as m,o as ie,u as Ne,j as u,q as E}from"./main-BaJar6w-.js";var Be=class extends Oe{constructor(t,e){super(),this.options=e,this.#t=t,this.#o=null,this.#a=pe(),this.bindMethods(),this.setOptions(e)}#t;#e=void 0;#s=void 0;#r=void 0;#n;#i;#a;#o;#m;#h;#f;#u;#l;#c;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),xe(this.#e,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return re(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return re(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#E(),this.#e.removeObserver(this)}setOptions(t){const e=this.options,s=this.#e;if(this.options=this.#t.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof b(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#e.setOptions(this.options),e._defaulted&&!V(this.options,e)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&ve(this.#e,s,this.options,e)&&this.#d(),this.updateResult(),r&&(this.#e!==s||b(this.options.enabled,this.#e)!==b(e.enabled,this.#e)||I(this.options.staleTime,this.#e)!==I(e.staleTime,this.#e))&&this.#y();const n=this.#g();r&&(this.#e!==s||b(this.options.enabled,this.#e)!==b(e.enabled,this.#e)||n!==this.#c)&&this.#x(n)}getOptimisticResult(t){const e=this.#t.getQueryCache().build(this.#t,t),s=this.createResult(e,t);return Ve(this,s)&&(this.#r=s,this.#i=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#r}trackResult(t,e){return new Proxy(t,{get:(s,r)=>(this.trackProp(r),e?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#e}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#t.defaultQueryOptions(t),s=this.#t.getQueryCache().build(this.#t,e);return s.fetch().then(()=>this.createResult(s,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(t){this.#w();let e=this.#e.fetch(this.options,t);return t?.throwOnError||(e=e.catch(W)),e}#y(){this.#b();const t=I(this.options.staleTime,this.#e);if(te||this.#r.isStale||!me(t))return;const s=Ke(this.#r.dataUpdatedAt,t)+1;this.#u=Q.setTimeout(()=>{this.#r.isStale||this.updateResult()},s)}#g(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#x(t){this.#E(),this.#c=t,!(te||b(this.options.enabled,this.#e)===!1||!me(this.#c)||this.#c===0)&&(this.#l=Q.setInterval(()=>{(this.options.refetchIntervalInBackground||ze.isFocused())&&this.#d()},this.#c))}#v(){this.#y(),this.#x(this.#g())}#b(){this.#u&&(Q.clearTimeout(this.#u),this.#u=void 0)}#E(){this.#l&&(Q.clearInterval(this.#l),this.#l=void 0)}createResult(t,e){const s=this.#e,r=this.options,n=this.#r,a=this.#n,i=this.#i,c=t!==s?t.state:this.#s,{state:l}=t;let d={...l},f=!1,h;if(e._optimisticResults){const x=this.hasListeners(),P=!x&&xe(t,e),L=x&&ve(t,s,e,r);(P||L)&&(d={...d,...Qe(l.data,t.options)}),e._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:g,errorUpdatedAt:p,status:v}=d;h=d.data;let q=!1;if(e.placeholderData!==void 0&&h===void 0&&v==="pending"){let x;n?.isPlaceholderData&&e.placeholderData===i?.placeholderData?(x=n.data,q=!0):x=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,x!==void 0&&(v="success",h=ye(n?.data,x,e),f=!0)}if(e.select&&h!==void 0&&!q)if(n&&h===a?.data&&e.select===this.#m)h=this.#h;else try{this.#m=e.select,h=e.select(h),h=ye(n?.data,h,e),this.#h=h,this.#o=null}catch(x){this.#o=x}this.#o&&(g=this.#o,h=this.#h,p=Date.now(),v="error");const N=d.fetchStatus==="fetching",Z=v==="pending",ee=v==="error",de=Z&&N,he=h!==void 0,w={status:v,fetchStatus:d.fetchStatus,isPending:Z,isSuccess:v==="success",isError:ee,isInitialLoading:de,isLoading:de,data:h,dataUpdatedAt:d.dataUpdatedAt,error:g,errorUpdatedAt:p,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:N,isRefetching:N&&!Z,isLoadingError:ee&&!he,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:ee&&he,isStale:ae(t,e),refetch:this.refetch,promise:this.#a,isEnabled:b(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const x=w.data!==void 0,P=w.status==="error"&&!x,L=z=>{P?z.reject(w.error):x&&z.resolve(w.data)},fe=()=>{const z=this.#a=w.promise=pe();L(z)},K=this.#a;switch(K.status){case"pending":t.queryHash===s.queryHash&&L(K);break;case"fulfilled":(P||w.data!==K.value)&&fe();break;case"rejected":(!P||w.error!==K.reason)&&fe();break}}return w}updateResult(){const t=this.#r,e=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#i=this.options,this.#n.data!==void 0&&(this.#f=this.#e),V(e,t))return;this.#r=e;const s=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,n=typeof r=="function"?r():r;if(n==="all"||!n&&!this.#p.size)return!0;const a=new Set(n??this.#p);return this.options.throwOnError&&a.add("error"),Object.keys(this.#r).some(i=>{const o=i;return this.#r[o]!==t[o]&&a.has(o)})};this.#R({listeners:s()})}#w(){const t=this.#t.getQueryCache().build(this.#t,this.options);if(t===this.#e)return;const e=this.#e;this.#e=t,this.#s=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#R(t){J.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function Ge(t,e){return b(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function xe(t,e){return Ge(t,e)||t.state.data!==void 0&&re(t,e,e.refetchOnMount)}function re(t,e,s){if(b(e.enabled,t)!==!1&&I(e.staleTime,t)!=="static"){const r=typeof s=="function"?s(t):s;return r==="always"||r!==!1&&ae(t,e)}return!1}function ve(t,e,s,r){return(t!==e||b(r.enabled,t)===!1)&&(!s.suspense||t.state.status!=="error")&&ae(t,s)}function ae(t,e){return b(e.enabled,t)!==!1&&t.isStaleByTime(I(e.staleTime,t))}function Ve(t,e){return!V(t.getCurrentResult(),e)}var We=class extends Oe{#t;#e=void 0;#s;#r;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),V(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),e?.mutationKey&&this.options.mutationKey&&ge(e.mutationKey)!==ge(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(t){this.#n(),this.#i(t)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(t,e){return this.#r=e,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(t)}#n(){const t=this.#s?.state??$e();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#i(t){J.batch(()=>{if(this.#r&&this.hasListeners()){const e=this.#e.variables,s=this.#e.context,r={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#r.onSuccess?.(t.data,e,s,r)}catch(n){Promise.reject(n)}try{this.#r.onSettled?.(t.data,null,e,s,r)}catch(n){Promise.reject(n)}}else if(t?.type==="error"){try{this.#r.onError?.(t.error,e,s,r)}catch(n){Promise.reject(n)}try{this.#r.onSettled?.(void 0,t.error,e,s,r)}catch(n){Promise.reject(n)}}}this.listeners.forEach(e=>{e(this.#e)})})}},Ce=m.createContext(!1),Ye=()=>m.useContext(Ce);Ce.Provider;function Je(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var He=m.createContext(Je()),Xe=()=>m.useContext(He),Ze=(t,e,s)=>{const r=s?.state.error&&typeof t.throwOnError=="function"?ie(t.throwOnError,[s.state.error,s]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||r)&&(e.isReset()||(t.retryOnMount=!1))},et=t=>{m.useEffect(()=>{t.clearReset()},[t])},tt=({result:t,errorResetBoundary:e,throwOnError:s,query:r,suspense:n})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(n&&t.data===void 0||ie(s,[t.error,r])),rt=t=>{if(t.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},st=(t,e)=>t.isLoading&&t.isFetching&&!e,nt=(t,e)=>t?.suspense&&e.isPending,be=(t,e,s)=>e.fetchOptimistic(t).catch(()=>{s.clearReset()});function it(t,e,s){const r=Ye(),n=Xe(),a=Ne(),i=a.defaultQueryOptions(t);a.getDefaultOptions().queries?._experimental_beforeQuery?.(i);const o=a.getQueryCache().get(i.queryHash);i._optimisticResults=r?"isRestoring":"optimistic",rt(i),Ze(i,n,o),et(n);const c=!a.getQueryCache().get(i.queryHash),[l]=m.useState(()=>new e(a,i)),d=l.getOptimisticResult(i),f=!r&&t.subscribed!==!1;if(m.useSyncExternalStore(m.useCallback(h=>{const g=f?l.subscribe(J.batchCalls(h)):W;return l.updateResult(),g},[l,f]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),m.useEffect(()=>{l.setOptions(i)},[i,l]),nt(i,d))throw be(i,l,n);if(tt({result:d,errorResetBoundary:n,throwOnError:i.throwOnError,query:o,suspense:i.suspense}))throw d.error;return a.getDefaultOptions().queries?._experimental_afterQuery?.(i,d),i.experimental_prefetchInRender&&!te&&st(d,r)&&(c?be(i,l,n):o?.promise)?.catch(W).finally(()=>{l.updateResult()}),i.notifyOnChangeProps?d:l.trackResult(d)}function at(t,e){return it(t,Be)}function pr(t,e){const s=Ne(),[r]=m.useState(()=>new We(s,t));m.useEffect(()=>{r.setOptions(t)},[r,t]);const n=m.useSyncExternalStore(m.useCallback(i=>r.subscribe(J.batchCalls(i)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),a=m.useCallback((i,o)=>{r.mutate(i,o).catch(W)},[r]);if(n.error&&ie(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:a,mutateAsync:n.mutate}}const mr=({position:t,email:e,onReset:s})=>u.jsxs("div",{className:"mx-auto max-w-md text-center py-12 px-4",children:[u.jsx("div",{className:"mb-6 text-6xl",children:"ðŸŽ‰"}),u.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"You're in!"}),u.jsxs("p",{className:"text-muted-foreground mb-2",children:["We've registered ",u.jsx("span",{className:"font-medium text-foreground",children:e})," for early access."]}),u.jsxs("div",{className:"my-6 rounded-xl bg-primary/10 p-6",children:[u.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Your position in your area"}),u.jsxs("p",{className:"text-4xl font-bold text-primary",children:["#",t]})]}),u.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"We'll email you when TCG Trade Hub launches in your area. Your card listing will be ready to go on day one."}),u.jsx("button",{type:"button",onClick:s,className:"text-sm text-primary hover:underline",children:"Register another email"})]}),yr=({children:t,className:e})=>u.jsxs("div",{className:`mx-auto flex w-full max-w-[420px] flex-col overflow-hidden rounded-[2.5rem] border-2 border-border bg-background shadow-2xl ${e??"h-[85vh] max-h-[800px]"}`,children:[u.jsxs("div",{className:"flex items-center justify-between px-8 pb-1 pt-3 text-xs text-muted-foreground",children:[u.jsx("span",{children:"9:41"}),u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3a4.237 4.237 0 00-6 0zm-4-4l2 2a7.074 7.074 0 0110 0l2-2C15.14 9.14 8.87 9.14 5 13z"})}),u.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:u.jsx("path",{d:"M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4z"})})]})]}),u.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:t})]}),ot=[{name:"Charizard ex",set:"151",price:"$185"}],ct=[{name:"Umbreon ex",set:"Obsidian Flames",price:"$95"},{name:"Mew ex",set:"151",price:"$35"}],Ee=({card:t})=>u.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-background/60 px-3 py-2",children:[u.jsx("div",{className:"h-8 w-6 rounded bg-primary/20 text-[8px] flex items-center justify-center text-primary font-bold",children:"TCG"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-xs font-medium text-foreground truncate",children:t.name}),u.jsxs("p",{className:"text-[10px] text-muted-foreground",children:[t.set," Â· ",t.price]})]})]}),gr=({onCounterOffer:t})=>u.jsxs("div",{className:"rounded-xl border border-border bg-card overflow-hidden",children:[u.jsx("div",{className:"bg-primary/10 px-4 py-2.5",children:u.jsx("p",{className:"text-xs font-semibold text-primary",children:"Trade Offer"})}),u.jsxs("div",{className:"space-y-3 p-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"mb-1.5 text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Offering"}),u.jsx("div",{className:"space-y-1.5",children:ot.map(e=>u.jsx(Ee,{card:e},e.name))})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"h-px flex-1 bg-border"}),u.jsx("span",{className:"text-xs text-muted-foreground",children:"â†“"}),u.jsx("div",{className:"h-px flex-1 bg-border"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"mb-1.5 text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Requesting"}),u.jsx("div",{className:"space-y-1.5",children:ct.map(e=>u.jsx(Ee,{card:e},e.name))})]}),u.jsxs("div",{className:"flex items-center gap-2 rounded-lg bg-success/10 px-3 py-2",children:[u.jsx("span",{className:"text-sm",children:"ðŸ’°"}),u.jsx("p",{className:"text-xs font-medium text-success",children:"+ $50 cash"})]}),u.jsx("button",{type:"button",onClick:t,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90",children:"Make Your Counter-Offer"})]})]}),xr=()=>u.jsxs("div",{className:"rounded-xl border border-border bg-card overflow-hidden",children:[u.jsx("div",{className:"bg-success/10 px-4 py-2.5",children:u.jsx("p",{className:"text-xs font-semibold text-success",children:"Meetup Proposal"})}),u.jsxs("div",{className:"space-y-3 p-4",children:[u.jsxs("div",{className:"flex items-center gap-2.5",children:[u.jsx("span",{className:"text-lg",children:"ðŸ“"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-foreground",children:"Cool Stuff Games"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"1234 Main St, Orlando, FL"})]})]}),u.jsxs("div",{className:"flex items-center gap-2.5",children:[u.jsx("span",{className:"text-lg",children:"ðŸ“…"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-foreground",children:"Saturday, 2:00 PM"}),u.jsx("p",{className:"text-xs text-muted-foreground",children:"Mar 8, 2025"})]})]}),u.jsxs("div",{className:"flex gap-2 pt-1",children:[u.jsx("button",{type:"button",disabled:!0,className:"flex-1 rounded-lg border border-success/30 bg-success/10 py-2 text-xs font-medium text-success/50 cursor-not-allowed",children:"Accept"}),u.jsx("button",{type:"button",disabled:!0,className:"flex-1 rounded-lg border border-border bg-secondary py-2 text-xs font-medium text-muted-foreground cursor-not-allowed",children:"Suggest New Time"})]})]})]});function ut(t){return t[0]??{}}function k(t){return Array.isArray(t)?t:t==null?[]:[t]}const we="orpc",lt="@orpc/shared",dt="1.13.5";class ht extends Error{constructor(...e){super(...e),this.name="AbortError"}}function ft(t){let e;return()=>{if(e)return e.result;const s=t();return e={result:s},s}}function pt(t){let e=Promise.resolve();return(...s)=>e=e.catch(()=>{}).then(()=>t(...s))}const mt=2,yt=`__${lt}@${dt}/otel/config__`;function H(){return globalThis[yt]}function oe(t,e={},s){return H()?.tracer?.startSpan(t,e,s)}function S(t,e,s={}){if(!t)return;const r=gt(e);t.recordException(r),(!s.signal?.aborted||s.signal.reason!==e)&&t.setStatus({code:mt,message:r.message})}function gt(t){if(t instanceof Error){const e={message:t.message,name:t.name,stack:t.stack};return"code"in t&&(typeof t.code=="string"||typeof t.code=="number")&&(e.code=t.code),e}return{message:String(t)}}async function U({name:t,context:e,...s},r){const n=H()?.tracer;if(!n)return r();const a=async i=>{try{return await r(i)}catch(o){throw S(i,o,s),o}finally{i.end()}};return e?n.startActiveSpan(t,s,e,a):n.startActiveSpan(t,s,a)}async function T(t,e){const s=H();if(!t||!s)return e();const r=s.trace.setSpan(s.context.active(),t);return s.context.with(r,e)}function R(t){return!t||typeof t!="object"?!1:"next"in t&&typeof t.next=="function"&&Symbol.asyncIterator in t&&typeof t[Symbol.asyncIterator]=="function"}const xt=Symbol.for("asyncDispose"),vt=Symbol.asyncDispose??xt;class ce{#t=!1;#e=!1;#s;#r;constructor(e,s){this.#s=s,this.#r=pt(async()=>{if(this.#t)return{done:!0,value:void 0};try{const r=await e();return r.done&&(this.#t=!0),r}catch(r){throw this.#t=!0,r}finally{this.#t&&!this.#e&&(this.#e=!0,await this.#s("next"))}})}next(){return this.#r()}async return(e){return this.#t=!0,this.#e||(this.#e=!0,await this.#s("return")),{done:!0,value:e}}async throw(e){throw this.#t=!0,this.#e||(this.#e=!0,await this.#s("throw")),e}async[vt](){this.#t=!0,this.#e||(this.#e=!0,await this.#s("dispose"))}[Symbol.asyncIterator](){return this}}function Re({name:t,...e},s){let r;return new ce(async()=>{r??=oe(t);try{const n=await T(r,()=>s.next());return r?.addEvent(n.done?"completed":"yielded"),n}catch(n){throw S(r,n,e),n}},async n=>{try{n!=="next"&&await T(r,()=>s.return?.())}catch(a){throw S(r,a,e),a}finally{r?.end()}})}function se(t,e,s){const r=(n,a)=>{const i=t[a];return i?i({...n,next:(o=n)=>r(o,a+1)}):s(n)};return r(e,0)}function G(t){if(t)return JSON.parse(t)}function j(t){return JSON.stringify(t)}function bt(t){return O(t)?Object.getPrototypeOf(t)?.constructor:null}function _e(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||!e||!e.constructor}function O(t){return!!t&&(typeof t=="object"||typeof t=="function")}function Et(t,e){let s=t;for(const r of e){if(!O(s))return;s=s[r]}return s}function $(t,...e){return typeof t=="function"?t(...e):t}function Te(t){return new Proxy(t,{get(e,s,r){const n=Reflect.get(e,s,r);return s!=="then"||typeof n!="function"?n:new Proxy(n,{apply(a,i,o){if(o.length!==2||o.some(l=>!Rt(l)))return Reflect.apply(a,i,o);let c=!0;o[0].call(i,Te(new Proxy(e,{get:(l,d,f)=>{if(c&&d==="then"){c=!1;return}return Reflect.get(l,d,f)}})))}})}})}const wt=/^\s*function\s*\(\)\s*\{\s*\[native code\]\s*\}\s*$/;function Rt(t){return typeof t=="function"&&wt.test(t.toString())}function St(t){try{return decodeURIComponent(t)}catch{return t}}const Ot="@orpc/client",Nt="1.13.5",ue={BAD_REQUEST:{status:400,message:"Bad Request"},UNAUTHORIZED:{status:401,message:"Unauthorized"},FORBIDDEN:{status:403,message:"Forbidden"},NOT_FOUND:{status:404,message:"Not Found"},METHOD_NOT_SUPPORTED:{status:405,message:"Method Not Supported"},NOT_ACCEPTABLE:{status:406,message:"Not Acceptable"},TIMEOUT:{status:408,message:"Request Timeout"},CONFLICT:{status:409,message:"Conflict"},PRECONDITION_FAILED:{status:412,message:"Precondition Failed"},PAYLOAD_TOO_LARGE:{status:413,message:"Payload Too Large"},UNSUPPORTED_MEDIA_TYPE:{status:415,message:"Unsupported Media Type"},UNPROCESSABLE_CONTENT:{status:422,message:"Unprocessable Content"},TOO_MANY_REQUESTS:{status:429,message:"Too Many Requests"},CLIENT_CLOSED_REQUEST:{status:499,message:"Client Closed Request"},INTERNAL_SERVER_ERROR:{status:500,message:"Internal Server Error"},NOT_IMPLEMENTED:{status:501,message:"Not Implemented"},BAD_GATEWAY:{status:502,message:"Bad Gateway"},SERVICE_UNAVAILABLE:{status:503,message:"Service Unavailable"},GATEWAY_TIMEOUT:{status:504,message:"Gateway Timeout"}};function Ct(t,e){return e??ue[t]?.status??500}function _t(t,e){return e||ue[t]?.message||t}const je=Symbol.for(`__${Ot}@${Nt}/error/ORPC_ERROR_CONSTRUCTORS__`);globalThis[je]??=new WeakSet;const ne=globalThis[je];class F extends Error{defined;code;status;data;constructor(e,...s){const r=ut(s);if(r.status!==void 0&&!le(r.status))throw new Error("[ORPCError] Invalid error status code.");const n=_t(e,r.message);super(n,r),this.code=e,this.status=Ct(e,r.status),this.defined=r.defined??!1,this.data=r.data}toJSON(){return{defined:this.defined,code:this.code,status:this.status,message:this.message,data:this.data}}static[Symbol.hasInstance](e){if(ne.has(this)){const s=bt(e);if(s&&ne.has(s))return!0}return super[Symbol.hasInstance](e)}}ne.add(F);function Tt(t){return t instanceof F?t:new F("INTERNAL_SERVER_ERROR",{message:"Internal server error",cause:t})}function le(t){return t<200||t>=400}function Pe(t){if(!_e(t))return!1;const e=["defined","code","status","message","data"];return Object.keys(t).some(s=>!e.includes(s))?!1:"defined"in t&&typeof t.defined=="boolean"&&"code"in t&&typeof t.code=="string"&&"status"in t&&typeof t.status=="number"&&le(t.status)&&"message"in t&&typeof t.message=="string"}function Ae(t,e={}){return new F(t.code,{...e,...t})}class X extends TypeError{}class jt extends TypeError{}class _ extends Error{data;constructor(e){super(e?.message??"An error event was received",e),this.data=e?.data}}function Pt(t){const e=t.replace(/\n+$/,"").split(/\n/),s={data:void 0,event:void 0,id:void 0,retry:void 0,comments:[]};for(const r of e){const n=r.indexOf(":"),a=n===-1?r:r.slice(0,n),i=n===-1?"":r.slice(n+1).replace(/^\s/,"");if(n===0)s.comments.push(i);else if(a==="data")s.data??="",s.data+=`${i}
`;else if(a==="event")s.event=i;else if(a==="id")s.id=i;else if(a==="retry"){const o=Number.parseInt(i);Number.isInteger(o)&&o>=0&&o.toString()===i&&(s.retry=o)}}return s.data=s.data?.replace(/\n$/,""),s}class At{constructor(e={}){this.options=e}incomplete="";feed(e){this.incomplete+=e;const s=this.incomplete.lastIndexOf(`

`);if(s===-1)return;const r=this.incomplete.slice(0,s).split(/\n\n/);this.incomplete=this.incomplete.slice(s+2);for(const n of r){const a=Pt(`${n}

`);this.options.onEvent&&this.options.onEvent(a)}}end(){if(this.incomplete)throw new jt("Event Iterator ended before complete")}}class Mt extends TransformStream{constructor(){let e;super({start(s){e=new At({onEvent:r=>{s.enqueue(r)}})},transform(s){e.feed(s)},flush(){e.end()}})}}function Me(t){if(t.includes(`
`))throw new X("Event's id must not contain a newline character")}function Ut(t){if(t.includes(`
`))throw new X("Event's event must not contain a newline character")}function Ue(t){if(!Number.isInteger(t)||t<0)throw new X("Event's retry must be a integer and >= 0")}function Ie(t){if(t.includes(`
`))throw new X("Event's comment must not contain a newline character")}function It(t){const e=t?.split(/\n/)??[];let s="";for(const r of e)s+=`data: ${r}
`;return s}function Dt(t){let e="";for(const s of t??[])Ie(s),e+=`: ${s}
`;return e}function B(t){let e="";return e+=Dt(t.comments),t.event!==void 0&&(Ut(t.event),e+=`event: ${t.event}
`),t.retry!==void 0&&(Ue(t.retry),e+=`retry: ${t.retry}
`),t.id!==void 0&&(Me(t.id),e+=`id: ${t.id}
`),e+=It(t.data),e+=`
`,e}const De=Symbol("ORPC_EVENT_SOURCE_META");function D(t,e){if(e.id===void 0&&e.retry===void 0&&!e.comments?.length)return t;if(e.id!==void 0&&Me(e.id),e.retry!==void 0&&Ue(e.retry),e.comments!==void 0)for(const s of e.comments)Ie(s);return new Proxy(t,{get(s,r,n){return r===De?e:Reflect.get(s,r,n)}})}function Y(t){return O(t)?Reflect.get(t,De):void 0}function kt(t){const e=t.replace(/"/g,'\\"'),s=encodeURIComponent(t).replace(/['()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`).replace(/%(7C|60|5E)/g,(r,n)=>String.fromCharCode(Number.parseInt(n,16)));return`inline; filename="${e}"; filename*=utf-8''${s}`}function Ft(t){const e=t.match(/filename\*=(UTF-8'')?([^;]*)/i);if(e&&typeof e[2]=="string")return St(e[2]);const s=t.match(/filename="((?:\\"|[^"])*)"/i);if(s&&typeof s[1]=="string")return s[1].replace(/\\"/g,'"')}function qt(t,e){const s={...t};for(const r in e)Array.isArray(e[r])?s[r]=[...k(s[r]),...e[r]]:e[r]!==void 0&&(Array.isArray(s[r])?s[r]=[...s[r],e[r]]:s[r]!==void 0?s[r]=[s[r],e[r]]:s[r]=e[r]);return s}function Se(t,e){const s=async r=>{let n=await e.error(r);if(n!==r){const a=Y(r);a&&O(n)&&(n=D(n,a))}return n};return new ce(async()=>{const{done:r,value:n}=await(async()=>{try{return await t.next()}catch(i){throw await s(i)}})();let a=await e.value(n,r);if(a!==n){const i=Y(n);i&&O(a)&&(a=D(a,i))}return{done:r,value:a}},async()=>{try{await t.return?.()}catch(r){throw await s(r)}})}function Lt(t){return{...t,context:t.context??{}}}function ke(t,e={}){const s=e.path??[],r=async(...[a,i={}])=>await t.call(s,a,Lt(i)),n=new Proxy(r,{get(a,i){return typeof i!="string"?Reflect.get(a,i):ke(t,{...e,path:[...s,i]})}});return Te(n)}function Kt(t,e={}){const r=t?.pipeThrough(new TextDecoderStream).pipeThrough(new Mt)?.getReader();let n,a=!1;return new ce(async()=>{n??=oe("consume_event_iterator_stream");try{for(;;){if(r===void 0)return{done:!0,value:void 0};const{done:i,value:o}=await T(n,()=>r.read());if(i){if(a)throw new ht("Stream was cancelled");return{done:!0,value:void 0}}switch(o.event){case"message":{let c=G(o.data);return O(c)&&(c=D(c,o)),n?.addEvent("message"),{done:!1,value:c}}case"error":{let c=new _({data:G(o.data)});throw c=D(c,o),n?.addEvent("error"),c}case"done":{let c=G(o.data);return O(c)&&(c=D(c,o)),n?.addEvent("done"),{done:!0,value:c}}default:n?.addEvent("maybe_keepalive")}}}catch(i){throw i instanceof _||S(n,i,e),i}},async i=>{try{i!=="next"&&(a=!0,n?.addEvent("cancelled")),await T(n,()=>r?.cancel())}catch(o){throw S(n,o,e),o}finally{n?.end()}})}function zt(t,e={}){const s=e.eventIteratorKeepAliveEnabled??!0,r=e.eventIteratorKeepAliveInterval??5e3,n=e.eventIteratorKeepAliveComment??"",a=e.eventIteratorInitialCommentEnabled??!0,i=e.eventIteratorInitialComment??"";let o=!1,c,l;return new ReadableStream({start(f){l=oe("stream_event_iterator"),a&&f.enqueue(B({comments:[i]}))},async pull(f){try{s&&(c=setInterval(()=>{f.enqueue(B({comments:[n]})),l?.addEvent("keepalive")},r));const h=await T(l,()=>t.next());if(clearInterval(c),o)return;const g=Y(h.value);if(!h.done||h.value!==void 0||g!==void 0){const p=h.done?"done":"message";f.enqueue(B({...g,event:p,data:j(h.value)})),l?.addEvent(p)}h.done&&(f.close(),l?.end())}catch(h){if(clearInterval(c),o)return;h instanceof _?(f.enqueue(B({...Y(h),event:"error",data:j(h.data)})),l?.addEvent("error"),f.close()):(S(l,h),f.error(h)),l?.end()}},async cancel(){try{o=!0,clearInterval(c),l?.addEvent("cancelled"),await T(l,()=>t.return?.())}catch(f){throw S(l,f),f}finally{l?.end()}}}).pipeThrough(new TextEncoderStream)}function Qt(t,e={}){return U({name:"parse_standard_body",signal:e.signal},async()=>{const s=t.headers.get("content-disposition");if(typeof s=="string"){const a=Ft(s)??"blob",i=await t.blob();return new File([i],a,{type:i.type})}const r=t.headers.get("content-type");if(!r||r.startsWith("application/json")){const a=await t.text();return G(a)}if(r.startsWith("multipart/form-data"))return await t.formData();if(r.startsWith("application/x-www-form-urlencoded")){const a=await t.text();return new URLSearchParams(a)}if(r.startsWith("text/event-stream"))return Kt(t.body,e);if(r.startsWith("text/plain"))return await t.text();const n=await t.blob();return new File([n],"blob",{type:n.type})})}function $t(t,e,s={}){const r=e.get("content-disposition");if(e.delete("content-type"),e.delete("content-disposition"),t!==void 0)return t instanceof Blob?(e.set("content-type",t.type),e.set("content-length",t.size.toString()),e.set("content-disposition",r??kt(t instanceof File?t.name:"blob")),t):t instanceof FormData||t instanceof URLSearchParams?t:R(t)?(e.set("content-type","text/event-stream"),zt(t,s)):(e.set("content-type","application/json"),j(t))}function Fe(t,e={}){return t.forEach((s,r)=>{Array.isArray(e[r])?e[r].push(s):e[r]!==void 0?e[r]=[e[r],s]:e[r]=s}),e}function Bt(t,e=new Headers){for(const[s,r]of Object.entries(t))if(Array.isArray(r))for(const n of r)e.append(s,n);else r!==void 0&&e.append(s,r);return e}function Gt(t,e={}){const s=Bt(t.headers),r=$t(t.body,s,e);return new Request(t.url,{signal:t.signal,method:t.method,headers:s,body:r})}function Vt(t,e={}){return{body:ft(()=>Qt(t,e)),status:t.status,get headers(){const s=Fe(t.headers);return Object.defineProperty(this,"headers",{value:s,writable:!0}),s},set headers(s){Object.defineProperty(this,"headers",{value:s,writable:!0})}}}class qe{plugins;constructor(e=[]){this.plugins=[...e].sort((s,r)=>(s.order??0)-(r.order??0))}init(e){for(const s of this.plugins)s.init?.(e)}}class Wt{constructor(e,s,r={}){this.codec=e,this.sender=s,new qe(r.plugins).init(r),this.interceptors=k(r.interceptors),this.clientInterceptors=k(r.clientInterceptors)}interceptors;clientInterceptors;call(e,s,r){return U({name:`${we}.${e.join("/")}`,signal:r.signal},n=>(n?.setAttribute("rpc.system",we),n?.setAttribute("rpc.method",e.join(".")),R(s)&&(s=Re({name:"consume_event_iterator_input",signal:r.signal},s)),se(this.interceptors,{...r,path:e,input:s},async({path:a,input:i,...o})=>{const c=H();let l;const d=c?.trace.getActiveSpan()??n;d&&c&&(l=c?.trace.setSpan(c.context.active(),d));const f=await U({name:"encode_request",context:l},()=>this.codec.encode(a,i,o)),h=await se(this.clientInterceptors,{...o,input:i,path:a,request:f},({input:p,path:v,request:q,...N})=>U({name:"send_request",signal:N.signal,context:l},()=>this.sender.call(q,N,v,p))),g=await U({name:"decode_response",context:l},()=>this.codec.decode(h,o,a,i));return R(g)?Re({name:"consume_event_iterator_output",signal:o.signal},g):g})))}}const y={BIGINT:0,DATE:1,NAN:2,UNDEFINED:3,URL:4,REGEXP:5,SET:6,MAP:7};class Yt{customSerializers;constructor(e={}){if(this.customSerializers=e.customJsonSerializers??[],this.customSerializers.length!==new Set(this.customSerializers.map(s=>s.type)).size)throw new Error("Custom serializer type must be unique.")}serialize(e,s=[],r=[],n=[],a=[]){for(const i of this.customSerializers)if(i.condition(e)){const o=this.serialize(i.serialize(e),s,r,n,a);return r.push([i.type,...s]),o}if(e instanceof Blob)return n.push(s),a.push(e),[e,r,n,a];if(typeof e=="bigint")return r.push([y.BIGINT,...s]),[e.toString(),r,n,a];if(e instanceof Date)return r.push([y.DATE,...s]),Number.isNaN(e.getTime())?[null,r,n,a]:[e.toISOString(),r,n,a];if(Number.isNaN(e))return r.push([y.NAN,...s]),[null,r,n,a];if(e instanceof URL)return r.push([y.URL,...s]),[e.toString(),r,n,a];if(e instanceof RegExp)return r.push([y.REGEXP,...s]),[e.toString(),r,n,a];if(e instanceof Set){const i=this.serialize(Array.from(e),s,r,n,a);return r.push([y.SET,...s]),i}if(e instanceof Map){const i=this.serialize(Array.from(e.entries()),s,r,n,a);return r.push([y.MAP,...s]),i}if(Array.isArray(e))return[e.map((o,c)=>o===void 0?(r.push([y.UNDEFINED,...s,c]),o):this.serialize(o,[...s,c],r,n,a)[0]),r,n,a];if(_e(e)){const i={};for(const o in e)o==="toJSON"&&typeof e[o]=="function"||(i[o]=this.serialize(e[o],[...s,o],r,n,a)[0]);return[i,r,n,a]}return[e,r,n,a]}deserialize(e,s,r,n){const a={data:e};r&&n&&r.forEach((i,o)=>{let c=a,l="data";i.forEach(d=>{c=c[l],l=d}),c[l]=n(o)});for(const i of s){const o=i[0];let c=a,l="data";for(let d=1;d<i.length;d++)c=c[l],l=i[d];for(const d of this.customSerializers)if(d.type===o){c[l]=d.deserialize(c[l]);break}switch(o){case y.BIGINT:c[l]=BigInt(c[l]);break;case y.DATE:c[l]=new Date(c[l]??"Invalid Date");break;case y.NAN:c[l]=Number.NaN;break;case y.UNDEFINED:c[l]=void 0;break;case y.URL:c[l]=new URL(c[l]);break;case y.REGEXP:{const[,d,f]=c[l].match(/^\/(.*)\/([a-z]*)$/);c[l]=new RegExp(d,f);break}case y.SET:c[l]=new Set(c[l]);break;case y.MAP:c[l]=new Map(c[l]);break}}return a.data}}function Jt(t){return`/${t.map(encodeURIComponent).join("/")}`}function Ht(t){return typeof t.forEach=="function"?Fe(t):t}function Xt(t){return Object.entries(ue).find(([,e])=>e.status===t)?.[0]??"MALFORMED_ORPC_ERROR_RESPONSE"}class Zt{constructor(e,s){this.serializer=e,this.baseUrl=s.url,this.maxUrlLength=s.maxUrlLength??2083,this.fallbackMethod=s.fallbackMethod??"POST",this.expectedMethod=s.method??this.fallbackMethod,this.headers=s.headers??{}}baseUrl;maxUrlLength;fallbackMethod;expectedMethod;headers;async encode(e,s,r){let n=Ht(await $(this.headers,r,e,s));r.lastEventId!==void 0&&(n=qt(n,{"last-event-id":r.lastEventId}));const a=await $(this.expectedMethod,r,e,s),i=await $(this.baseUrl,r,e,s),o=new URL(i);o.pathname=`${o.pathname.replace(/\/$/,"")}${Jt(e)}`;const c=this.serializer.serialize(s);if(a==="GET"&&!(c instanceof FormData)&&!R(c)){const l=await $(this.maxUrlLength,r,e,s),d=new URL(o);if(d.searchParams.append("data",j(c)),d.toString().length<=l)return{body:void 0,method:a,headers:n,url:d,signal:r.signal}}return{url:o,method:a==="GET"?this.fallbackMethod:a,headers:n,body:c,signal:r.signal}}async decode(e){const s=!le(e.status),r=await(async()=>{let n=!1;try{const a=await e.body();return n=!0,this.serializer.deserialize(a)}catch(a){throw n?new Error("Invalid RPC response format.",{cause:a}):new Error("Cannot parse response body, please check the response body and content-type.",{cause:a})}})();if(!s)throw Pe(r)?Ae(r):new F(Xt(e.status),{status:e.status,data:{...e,body:r}});return r}}class er{constructor(e){this.jsonSerializer=e}serialize(e){return R(e)?Se(e,{value:async s=>this.#t(s,!1),error:async s=>new _({data:this.#t(Tt(s).toJSON(),!1),cause:s})}):this.#t(e,!0)}#t(e,s){const[r,n,a,i]=this.jsonSerializer.serialize(e),o=n.length===0?void 0:n;if(!s||i.length===0)return{json:r,meta:o};const c=new FormData;return c.set("data",j({json:r,meta:o,maps:a})),i.forEach((l,d)=>{c.set(d.toString(),l)}),c}deserialize(e){return R(e)?Se(e,{value:async s=>this.#e(s),error:async s=>{if(!(s instanceof _))return s;const r=this.#e(s.data);return Pe(r)?Ae(r,{cause:s}):new _({data:r,cause:s})}}):this.#e(e)}#e(e){if(e===void 0)return;if(!(e instanceof FormData))return this.jsonSerializer.deserialize(e.json,e.meta??[]);const s=JSON.parse(e.get("data"));return this.jsonSerializer.deserialize(s.json,s.meta??[],s.maps,r=>e.get(r.toString()))}}class tr extends Wt{constructor(e,s){const r=new Yt(s),n=new er(r),a=new Zt(n,s);super(a,e,s)}}class rr extends qe{initRuntimeAdapter(e){for(const s of this.plugins)s.initRuntimeAdapter?.(e)}}class sr{fetch;toFetchRequestOptions;adapterInterceptors;constructor(e){new rr(e.plugins).initRuntimeAdapter(e),this.fetch=e.fetch??globalThis.fetch.bind(globalThis),this.toFetchRequestOptions=e,this.adapterInterceptors=k(e.adapterInterceptors)}async call(e,s,r,n){const a=Gt(e,this.toFetchRequestOptions),i=await se(this.adapterInterceptors,{...s,request:a,path:r,input:n,init:{redirect:"manual"}},({request:c,path:l,input:d,init:f,...h})=>this.fetch(c,f,h,l,d));return Vt(i,{signal:a.signal})}}class nr extends tr{constructor(e){const s=new sr(e);super(s,e)}}function C(t,e={}){return[t,{...e.input!==void 0?{input:e.input}:{},...e.type!==void 0?{type:e.type}:{},...e.fnOptions!==void 0?{fnOptions:e.fnOptions}:{}}]}function ir(t){return{key(e){return C(t,e)}}}function ar(t){return async e=>{const s=await t(e);let r;for await(const n of s){if(e.signal.aborted)throw e.signal.reason;r={chunk:n},e.client.setQueryData(e.queryKey,n)}if(!r)throw new Error(`Live query for ${j(e.queryKey)} did not yield any data. Ensure the query function returns an AsyncIterable with at least one chunk.`);return r.chunk}}function or(t,{refetchMode:e="reset",maxChunks:s=Number.POSITIVE_INFINITY}={}){return async r=>{const n=r.client.getQueryCache().find({queryKey:r.queryKey,exact:!0}),a=!!n&&n.state.data!==void 0;a&&(e==="reset"?n.setState({status:"pending",data:void 0,error:null,fetchStatus:"fetching"}):r.client.setQueryData(r.queryKey,(d=[])=>A(d,s)));let i=[];const o=await t(r),c=!a||e!=="replace";r.client.setQueryData(r.queryKey,(d=[])=>A(d,s));for await(const d of o){if(r.signal.aborted)throw r.signal.reason;i.push(d),i=A(i,s),c&&r.client.setQueryData(r.queryKey,(f=[])=>A([...f,d],s))}c||r.client.setQueryData(r.queryKey,i);const l=r.client.getQueryData(r.queryKey);return l?A(l,s):i}}function A(t,e){return t.length<=e?t:t.slice(t.length-e)}const M=Symbol("ORPC_OPERATION_CONTEXT");function cr(t,e){const s={call:t,queryKey(...[r={}]){return r={...e.experimental_defaults?.queryKey,...r},r.queryKey??C(e.path,{type:"query",input:r.input})},queryOptions(...[r={}]){r={...e.experimental_defaults?.queryOptions,...r};const n=s.queryKey(r);return{queryFn:({signal:a})=>{if(r.input===E)throw new Error("queryFn should not be called with skipToken used as input");return t(r.input,{signal:a,context:{[M]:{key:n,type:"query"},...r.context}})},...r.input===E?{enabled:!1}:{},...r,queryKey:n}},experimental_streamedKey(...[r={}]){return r={...e.experimental_defaults?.experimental_streamedKey,...r},r.queryKey??C(e.path,{type:"streamed",input:r.input,fnOptions:r.queryFnOptions})},experimental_streamedOptions(...[r={}]){r={...e.experimental_defaults?.experimental_streamedOptions,...r};const n=s.experimental_streamedKey(r);return{queryFn:or(async({signal:a})=>{if(r.input===E)throw new Error("queryFn should not be called with skipToken used as input");const i=await t(r.input,{signal:a,context:{[M]:{key:n,type:"streamed"},...r.context}});if(!R(i))throw new Error("streamedQuery requires an event iterator output");return i},r.queryFnOptions),...r.input===E?{enabled:!1}:{},...r,queryKey:n}},experimental_liveKey(...[r={}]){return r={...e.experimental_defaults?.experimental_liveKey,...r},r.queryKey??C(e.path,{type:"live",input:r.input})},experimental_liveOptions(...[r={}]){r={...e.experimental_defaults?.experimental_liveOptions,...r};const n=s.experimental_liveKey(r);return{queryFn:ar(async({signal:a})=>{if(r.input===E)throw new Error("queryFn should not be called with skipToken used as input");const i=await t(r.input,{signal:a,context:{[M]:{key:n,type:"live"},...r.context}});if(!R(i))throw new Error("liveQuery requires an event iterator output");return i}),...r.input===E?{enabled:!1}:{},...r,queryKey:n}},infiniteKey(r){return r={...e.experimental_defaults?.infiniteKey,...r},r.queryKey??C(e.path,{type:"infinite",input:r.input===E?E:r.input(r.initialPageParam)})},infiniteOptions(r){r={...e.experimental_defaults?.infiniteOptions,...r};const n=s.infiniteKey(r);return{queryFn:({pageParam:a,signal:i})=>{if(r.input===E)throw new Error("queryFn should not be called with skipToken used as input");return t(r.input(a),{signal:i,context:{[M]:{key:n,type:"infinite"},...r.context}})},...r.input===E?{enabled:!1}:{},...r,queryKey:n}},mutationKey(...[r={}]){return r={...e.experimental_defaults?.mutationKey,...r},r.mutationKey??C(e.path,{type:"mutation"})},mutationOptions(...[r={}]){r={...e.experimental_defaults?.mutationOptions,...r};const n=s.mutationKey(r);return{mutationFn:a=>t(a,{context:{[M]:{key:n,type:"mutation"},...r.context}}),...r,mutationKey:n}}};return s}function Le(t,e={}){const s=k(e.path),r=ir(s),n=cr(t,{path:s,experimental_defaults:e.experimental_defaults});return new Proxy({...r,...n},{get(i,o){const c=Reflect.get(i,o);if(typeof o!="string")return c;const l=Le(t[o],{...e,path:[...s,o],experimental_defaults:Et(e.experimental_defaults,[o])});return typeof c!="function"?l:new Proxy(c,{get(d,f){return Reflect.get(l,f)}})}})}const ur=new nr({url:typeof window<"u"?`${window.location.origin}/api/rpc`:"http://localhost:3000/api/rpc"}),lr=ke(ur),dr=Le(lr),vr=({tcg:t,onSelect:e,selectedCard:s,onClear:r})=>{const[n,a]=m.useState(""),[i,o]=m.useState(""),[c,l]=m.useState(!1),d=m.useRef(null);m.useEffect(()=>{const p=setTimeout(()=>o(n),300);return()=>clearTimeout(p)},[n]),m.useEffect(()=>{const p=v=>{d.current&&!d.current.contains(v.target)&&l(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[]);const{data:f=[],isFetching:h}=at({...dr.card.search.queryOptions({input:{query:i,tcg:t}}),enabled:i.length>=2}),g=p=>{e(p),a(""),l(!1)};return s?u.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-secondary/50 p-3",children:[u.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-16 w-12 rounded object-cover"}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-foreground truncate",children:s.name}),u.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:[s.setName," Â· ",s.rarity]})]}),u.jsx("button",{type:"button",onClick:r,className:"shrink-0 text-sm text-muted-foreground hover:text-foreground",children:"Change"})]}):u.jsxs("div",{ref:d,className:"relative",children:[u.jsx("input",{type:"text",value:n,onChange:p=>{a(p.target.value),l(!0)},onFocus:()=>n.length>=2&&l(!0),placeholder:"Search for a card...",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"}),h&&u.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:u.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),c&&f.length>0&&u.jsx("ul",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card shadow-lg max-h-64 overflow-y-auto",children:f.map(p=>u.jsx("li",{children:u.jsxs("button",{type:"button",onClick:()=>g(p),className:"flex w-full items-center gap-3 px-3 py-2 text-left hover:bg-accent transition-colors",children:[u.jsx("img",{src:p.imageUrl,alt:p.name,className:"h-12 w-9 rounded object-cover"}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:p.name}),u.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[p.setName," Â· ",p.rarity,p.marketPrice!=null&&` Â· $${p.marketPrice.toFixed(2)}`]})]})]})},p.externalId))}),c&&i.length>=2&&!h&&f.length===0&&u.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card p-4 text-center text-sm text-muted-foreground shadow-lg",children:"No cards found"})]})};export{vr as C,gr as D,yr as P,mr as S,xr as a,dr as o,pr as u};
