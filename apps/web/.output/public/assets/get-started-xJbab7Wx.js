import{S as Se,p as me,r as w,s as W,a as M,n as H,i as te,b as pe,t as ze,c as B,f as Ke,d as Be,e as xe,g as V,h as ye,k as Qe,l as p,m as ie,u as Re,j as i,o as N,L as $e}from"./main-COPpJO_p.js";var Ge=class extends Se{constructor(e,t){super(),this.options=t,this.#t=e,this.#o=null,this.#a=me(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#s=void 0;#r=void 0;#n;#i;#a;#o;#p;#h;#f;#l;#u;#c;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),ge(this.#e,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return re(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return re(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#w(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,s=this.#e;if(this.options=this.#t.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof w(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#e.setOptions(this.options),t._defaulted&&!W(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&ve(this.#e,s,this.options,t)&&this.#d(),this.updateResult(),r&&(this.#e!==s||w(this.options.enabled,this.#e)!==w(t.enabled,this.#e)||M(this.options.staleTime,this.#e)!==M(t.staleTime,this.#e))&&this.#x();const n=this.#y();r&&(this.#e!==s||w(this.options.enabled,this.#e)!==w(t.enabled,this.#e)||n!==this.#c)&&this.#g(n)}getOptimisticResult(e){const t=this.#t.getQueryCache().build(this.#t,e),s=this.createResult(t,e);return He(this,s)&&(this.#r=s,this.#i=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#r}trackResult(e,t){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),t?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#t.defaultQueryOptions(e),s=this.#t.getQueryCache().build(this.#t,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#d({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(e){this.#E();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(H)),t}#x(){this.#b();const e=M(this.options.staleTime,this.#e);if(te||this.#r.isStale||!pe(e))return;const s=ze(this.#r.dataUpdatedAt,e)+1;this.#l=B.setTimeout(()=>{this.#r.isStale||this.updateResult()},s)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#g(e){this.#w(),this.#c=e,!(te||w(this.options.enabled,this.#e)===!1||!pe(this.#c)||this.#c===0)&&(this.#u=B.setInterval(()=>{(this.options.refetchIntervalInBackground||Ke.isFocused())&&this.#d()},this.#c))}#v(){this.#x(),this.#g(this.#y())}#b(){this.#l&&(B.clearTimeout(this.#l),this.#l=void 0)}#w(){this.#u&&(B.clearInterval(this.#u),this.#u=void 0)}createResult(e,t){const s=this.#e,r=this.options,n=this.#r,o=this.#n,a=this.#i,l=e!==s?e.state:this.#s,{state:u}=e;let d={...u},h=!1,f;if(t._optimisticResults){const b=this.hasListeners(),k=!b&&ge(e,t),q=b&&ve(e,s,t,r);(k||q)&&(d={...d,...Be(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:y,errorUpdatedAt:x,status:m}=d;f=d.data;let v=!1;if(t.placeholderData!==void 0&&f===void 0&&m==="pending"){let b;n?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(b=n.data,v=!0):b=typeof t.placeholderData=="function"?t.placeholderData(this.#f?.state.data,this.#f):t.placeholderData,b!==void 0&&(m="success",f=xe(n?.data,b,t),h=!0)}if(t.select&&f!==void 0&&!v)if(n&&f===o?.data&&t.select===this.#p)f=this.#h;else try{this.#p=t.select,f=t.select(f),f=xe(n?.data,f,t),this.#h=f,this.#o=null}catch(b){this.#o=b}this.#o&&(y=this.#o,f=this.#h,x=Date.now(),m="error");const E=d.fetchStatus==="fetching",Z=m==="pending",ee=m==="error",de=Z&&E,he=f!==void 0,S={status:m,fetchStatus:d.fetchStatus,isPending:Z,isSuccess:m==="success",isError:ee,isInitialLoading:de,isLoading:de,data:f,dataUpdatedAt:d.dataUpdatedAt,error:y,errorUpdatedAt:x,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:E,isRefetching:E&&!Z,isLoadingError:ee&&!he,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:ee&&he,isStale:ae(e,t),refetch:this.refetch,promise:this.#a,isEnabled:w(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const b=S.data!==void 0,k=S.status==="error"&&!b,q=K=>{k?K.reject(S.error):b&&K.resolve(S.data)},fe=()=>{const K=this.#a=S.promise=me();q(K)},z=this.#a;switch(z.status){case"pending":e.queryHash===s.queryHash&&q(z);break;case"fulfilled":(k||S.data!==z.value)&&fe();break;case"rejected":(!k||S.error!==z.reason)&&fe();break}}return S}updateResult(){const e=this.#r,t=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#i=this.options,this.#n.data!==void 0&&(this.#f=this.#e),W(t,e))return;this.#r=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,n=typeof r=="function"?r():r;if(n==="all"||!n&&!this.#m.size)return!0;const o=new Set(n??this.#m);return this.options.throwOnError&&o.add("error"),Object.keys(this.#r).some(a=>{const c=a;return this.#r[c]!==e[c]&&o.has(c)})};this.#N({listeners:s()})}#E(){const e=this.#t.getQueryCache().build(this.#t,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#s=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#N(e){V.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function We(e,t){return w(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ge(e,t){return We(e,t)||e.state.data!==void 0&&re(e,t,t.refetchOnMount)}function re(e,t,s){if(w(t.enabled,e)!==!1&&M(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&ae(e,t)}return!1}function ve(e,t,s,r){return(e!==t||w(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&ae(e,s)}function ae(e,t){return w(t.enabled,e)!==!1&&e.isStaleByTime(M(t.staleTime,e))}function He(e,t){return!W(e.getCurrentResult(),t)}var Ye=class extends Se{#t;#e=void 0;#s;#r;constructor(e,t){super(),this.#t=e,this.setOptions(t),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#t.defaultMutationOptions(e),W(this.options,t)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&ye(t.mutationKey)!==ye(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#i(e)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(e)}#n(){const e=this.#s?.state??Qe();this.#e={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){V.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#e.variables,s=this.#e.context,r={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#r.onSuccess?.(e.data,t,s,r)}catch(n){Promise.reject(n)}try{this.#r.onSettled?.(e.data,null,t,s,r)}catch(n){Promise.reject(n)}}else if(e?.type==="error"){try{this.#r.onError?.(e.error,t,s,r)}catch(n){Promise.reject(n)}try{this.#r.onSettled?.(void 0,e.error,t,s,r)}catch(n){Promise.reject(n)}}}this.listeners.forEach(t=>{t(this.#e)})})}},Oe=p.createContext(!1),Ve=()=>p.useContext(Oe);Oe.Provider;function Je(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Xe=p.createContext(Je()),Ze=()=>p.useContext(Xe),et=(e,t,s)=>{const r=s?.state.error&&typeof e.throwOnError=="function"?ie(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(t.isReset()||(e.retryOnMount=!1))},tt=e=>{p.useEffect(()=>{e.clearReset()},[e])},rt=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:n})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(n&&e.data===void 0||ie(s,[e.error,r])),st=e=>{if(e.suspense){const s=n=>n==="static"?n:Math.max(n??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...n)=>s(r(...n)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},nt=(e,t)=>e.isLoading&&e.isFetching&&!t,it=(e,t)=>e?.suspense&&t.isPending,be=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function at(e,t,s){const r=Ve(),n=Ze(),o=Re(),a=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a);const c=o.getQueryCache().get(a.queryHash);a._optimisticResults=r?"isRestoring":"optimistic",st(a),et(a,n,c),tt(n);const l=!o.getQueryCache().get(a.queryHash),[u]=p.useState(()=>new t(o,a)),d=u.getOptimisticResult(a),h=!r&&e.subscribed!==!1;if(p.useSyncExternalStore(p.useCallback(f=>{const y=h?u.subscribe(V.batchCalls(f)):H;return u.updateResult(),y},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),p.useEffect(()=>{u.setOptions(a)},[a,u]),it(a,d))throw be(a,u,n);if(rt({result:d,errorResetBoundary:n,throwOnError:a.throwOnError,query:c,suspense:a.suspense}))throw d.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!te&&nt(d,r)&&(l?be(a,u,n):c?.promise)?.catch(H).finally(()=>{u.updateResult()}),a.notifyOnChangeProps?d:u.trackResult(d)}function ot(e,t){return at(e,Ge)}function ct(e,t){const s=Re(),[r]=p.useState(()=>new Ye(s,e));p.useEffect(()=>{r.setOptions(e)},[r,e]);const n=p.useSyncExternalStore(p.useCallback(a=>r.subscribe(V.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=p.useCallback((a,c)=>{r.mutate(a,c).catch(H)},[r]);if(n.error&&ie(r.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:o,mutateAsync:n.mutate}}const lt=({position:e,email:t,onReset:s})=>i.jsxs("div",{className:"mx-auto max-w-md text-center py-12 px-4",children:[i.jsx("div",{className:"mb-6 text-6xl",children:"ðŸŽ‰"}),i.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"You're in!"}),i.jsxs("p",{className:"text-muted-foreground mb-2",children:["We've registered ",i.jsx("span",{className:"font-medium text-foreground",children:t})," for early access."]}),i.jsxs("div",{className:"my-6 rounded-xl bg-primary/10 p-6",children:[i.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Your position in your area"}),i.jsxs("p",{className:"text-4xl font-bold text-primary",children:["#",e]})]}),i.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"We'll email you when TCG Trade Hub launches in your area. Your card listing will be ready to go on day one."}),i.jsx("button",{type:"button",onClick:s,className:"text-sm text-primary hover:underline",children:"Register another email"})]}),ut=({children:e,className:t})=>i.jsxs("div",{className:`mx-auto flex w-full max-w-[420px] flex-col overflow-hidden rounded-[2.5rem] border-2 border-border bg-background shadow-2xl ${t??"h-[85vh] max-h-[800px]"}`,children:[i.jsxs("div",{className:"flex items-center justify-between px-8 pb-1 pt-3 text-xs text-muted-foreground",children:[i.jsx("span",{children:"9:41"}),i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3a4.237 4.237 0 00-6 0zm-4-4l2 2a7.074 7.074 0 0110 0l2-2C15.14 9.14 8.87 9.14 5 13z"})}),i.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4z"})})]})]}),i.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:e})]}),dt=({name:e})=>i.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[i.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-primary text-sm font-bold text-primary-foreground",children:e==="TCG Trade Hub"?"TH":e.charAt(0).toUpperCase()}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-semibold text-foreground",children:e}),i.jsx("p",{className:"text-xs text-success",children:"Online"})]})]}),ht=({text:e,sender:t})=>{const s=t==="own";return i.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:i.jsx("div",{className:`max-w-[80%] rounded-2xl px-4 py-2.5 text-sm ${s?"rounded-br-md bg-primary text-primary-foreground":"rounded-bl-md bg-secondary text-foreground"}`,children:e})})},ft=({text:e})=>i.jsx("div",{className:"flex justify-center px-4",children:i.jsx("p",{className:"rounded-full bg-secondary/60 px-4 py-1.5 text-center text-xs text-muted-foreground",children:e})}),mt=({onBuildList:e})=>i.jsxs("div",{className:"rounded-xl border border-border bg-card overflow-hidden",children:[i.jsxs("div",{className:"bg-primary/10 px-4 py-2.5 flex items-center gap-2",children:[i.jsx("span",{className:"text-sm",children:"ðŸŽ¯"}),i.jsx("p",{className:"text-xs font-semibold text-primary",children:"Reserve Your Spot"})]}),i.jsxs("div",{className:"space-y-4 p-4",children:[i.jsx("p",{className:"text-xs text-muted-foreground",children:"Be first to trade when we launch in your area."}),i.jsxs("ul",{className:"space-y-2",children:[i.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[i.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),i.jsx("span",{children:"Pick the cards you want"})]}),i.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[i.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),i.jsx("span",{children:"Get matched with local traders who have them"})]}),i.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[i.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),i.jsx("span",{children:"First access at launch"})]})]}),i.jsx("button",{type:"button",onClick:e,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90",children:"Build Your List"})]})]});function pt(e){return e[0]??{}}function F(e){return Array.isArray(e)?e:e==null?[]:[e]}const we="orpc",xt="@orpc/shared",yt="1.13.5";class gt extends Error{constructor(...t){super(...t),this.name="AbortError"}}function vt(e){let t;return()=>{if(t)return t.result;const s=e();return t={result:s},s}}function bt(e){let t=Promise.resolve();return(...s)=>t=t.catch(()=>{}).then(()=>e(...s))}const wt=2,Et=`__${xt}@${yt}/otel/config__`;function J(){return globalThis[Et]}function oe(e,t={},s){return J()?.tracer?.startSpan(e,t,s)}function O(e,t,s={}){if(!e)return;const r=Nt(t);e.recordException(r),(!s.signal?.aborted||s.signal.reason!==t)&&e.setStatus({code:wt,message:r.message})}function Nt(e){if(e instanceof Error){const t={message:e.message,name:e.name,stack:e.stack};return"code"in e&&(typeof e.code=="string"||typeof e.code=="number")&&(t.code=e.code),t}return{message:String(e)}}async function D({name:e,context:t,...s},r){const n=J()?.tracer;if(!n)return r();const o=async a=>{try{return await r(a)}catch(c){throw O(a,c,s),c}finally{a.end()}};return t?n.startActiveSpan(e,s,t,o):n.startActiveSpan(e,s,o)}async function T(e,t){const s=J();if(!e||!s)return t();const r=s.trace.setSpan(s.context.active(),e);return s.context.with(r,t)}function R(e){return!e||typeof e!="object"?!1:"next"in e&&typeof e.next=="function"&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}const St=Symbol.for("asyncDispose"),Rt=Symbol.asyncDispose??St;class ce{#t=!1;#e=!1;#s;#r;constructor(t,s){this.#s=s,this.#r=bt(async()=>{if(this.#t)return{done:!0,value:void 0};try{const r=await t();return r.done&&(this.#t=!0),r}catch(r){throw this.#t=!0,r}finally{this.#t&&!this.#e&&(this.#e=!0,await this.#s("next"))}})}next(){return this.#r()}async return(t){return this.#t=!0,this.#e||(this.#e=!0,await this.#s("return")),{done:!0,value:t}}async throw(t){throw this.#t=!0,this.#e||(this.#e=!0,await this.#s("throw")),t}async[Rt](){this.#t=!0,this.#e||(this.#e=!0,await this.#s("dispose"))}[Symbol.asyncIterator](){return this}}function Ee({name:e,...t},s){let r;return new ce(async()=>{r??=oe(e);try{const n=await T(r,()=>s.next());return r?.addEvent(n.done?"completed":"yielded"),n}catch(n){throw O(r,n,t),n}},async n=>{try{n!=="next"&&await T(r,()=>s.return?.())}catch(o){throw O(r,o,t),o}finally{r?.end()}})}function se(e,t,s){const r=(n,o)=>{const a=e[o];return a?a({...n,next:(c=n)=>r(c,o+1)}):s(n)};return r(t,0)}function G(e){if(e)return JSON.parse(e)}function P(e){return JSON.stringify(e)}function Ot(e){return C(e)?Object.getPrototypeOf(e)?.constructor:null}function Ce(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||!t||!t.constructor}function C(e){return!!e&&(typeof e=="object"||typeof e=="function")}function Ct(e,t){let s=e;for(const r of t){if(!C(s))return;s=s[r]}return s}function Q(e,...t){return typeof e=="function"?e(...t):e}function je(e){return new Proxy(e,{get(t,s,r){const n=Reflect.get(t,s,r);return s!=="then"||typeof n!="function"?n:new Proxy(n,{apply(o,a,c){if(c.length!==2||c.some(u=>!_t(u)))return Reflect.apply(o,a,c);let l=!0;c[0].call(a,je(new Proxy(t,{get:(u,d,h)=>{if(l&&d==="then"){l=!1;return}return Reflect.get(u,d,h)}})))}})}})}const jt=/^\s*function\s*\(\)\s*\{\s*\[native code\]\s*\}\s*$/;function _t(e){return typeof e=="function"&&jt.test(e.toString())}function Tt(e){try{return decodeURIComponent(e)}catch{return e}}const Pt="@orpc/client",kt="1.13.5",le={BAD_REQUEST:{status:400,message:"Bad Request"},UNAUTHORIZED:{status:401,message:"Unauthorized"},FORBIDDEN:{status:403,message:"Forbidden"},NOT_FOUND:{status:404,message:"Not Found"},METHOD_NOT_SUPPORTED:{status:405,message:"Method Not Supported"},NOT_ACCEPTABLE:{status:406,message:"Not Acceptable"},TIMEOUT:{status:408,message:"Request Timeout"},CONFLICT:{status:409,message:"Conflict"},PRECONDITION_FAILED:{status:412,message:"Precondition Failed"},PAYLOAD_TOO_LARGE:{status:413,message:"Payload Too Large"},UNSUPPORTED_MEDIA_TYPE:{status:415,message:"Unsupported Media Type"},UNPROCESSABLE_CONTENT:{status:422,message:"Unprocessable Content"},TOO_MANY_REQUESTS:{status:429,message:"Too Many Requests"},CLIENT_CLOSED_REQUEST:{status:499,message:"Client Closed Request"},INTERNAL_SERVER_ERROR:{status:500,message:"Internal Server Error"},NOT_IMPLEMENTED:{status:501,message:"Not Implemented"},BAD_GATEWAY:{status:502,message:"Bad Gateway"},SERVICE_UNAVAILABLE:{status:503,message:"Service Unavailable"},GATEWAY_TIMEOUT:{status:504,message:"Gateway Timeout"}};function At(e,t){return t??le[e]?.status??500}function It(e,t){return t||le[e]?.message||e}const _e=Symbol.for(`__${Pt}@${kt}/error/ORPC_ERROR_CONSTRUCTORS__`);globalThis[_e]??=new WeakSet;const ne=globalThis[_e];class L extends Error{defined;code;status;data;constructor(t,...s){const r=pt(s);if(r.status!==void 0&&!ue(r.status))throw new Error("[ORPCError] Invalid error status code.");const n=It(t,r.message);super(n,r),this.code=t,this.status=At(t,r.status),this.defined=r.defined??!1,this.data=r.data}toJSON(){return{defined:this.defined,code:this.code,status:this.status,message:this.message,data:this.data}}static[Symbol.hasInstance](t){if(ne.has(this)){const s=Ot(t);if(s&&ne.has(s))return!0}return super[Symbol.hasInstance](t)}}ne.add(L);function Dt(e){return e instanceof L?e:new L("INTERNAL_SERVER_ERROR",{message:"Internal server error",cause:e})}function ue(e){return e<200||e>=400}function Te(e){if(!Ce(e))return!1;const t=["defined","code","status","message","data"];return Object.keys(e).some(s=>!t.includes(s))?!1:"defined"in e&&typeof e.defined=="boolean"&&"code"in e&&typeof e.code=="string"&&"status"in e&&typeof e.status=="number"&&ue(e.status)&&"message"in e&&typeof e.message=="string"}function Pe(e,t={}){return new L(e.code,{...t,...e})}class X extends TypeError{}class Mt extends TypeError{}class _ extends Error{data;constructor(t){super(t?.message??"An error event was received",t),this.data=t?.data}}function Ut(e){const t=e.replace(/\n+$/,"").split(/\n/),s={data:void 0,event:void 0,id:void 0,retry:void 0,comments:[]};for(const r of t){const n=r.indexOf(":"),o=n===-1?r:r.slice(0,n),a=n===-1?"":r.slice(n+1).replace(/^\s/,"");if(n===0)s.comments.push(a);else if(o==="data")s.data??="",s.data+=`${a}
`;else if(o==="event")s.event=a;else if(o==="id")s.id=a;else if(o==="retry"){const c=Number.parseInt(a);Number.isInteger(c)&&c>=0&&c.toString()===a&&(s.retry=c)}}return s.data=s.data?.replace(/\n$/,""),s}class Ft{constructor(t={}){this.options=t}incomplete="";feed(t){this.incomplete+=t;const s=this.incomplete.lastIndexOf(`

`);if(s===-1)return;const r=this.incomplete.slice(0,s).split(/\n\n/);this.incomplete=this.incomplete.slice(s+2);for(const n of r){const o=Ut(`${n}

`);this.options.onEvent&&this.options.onEvent(o)}}end(){if(this.incomplete)throw new Mt("Event Iterator ended before complete")}}class Lt extends TransformStream{constructor(){let t;super({start(s){t=new Ft({onEvent:r=>{s.enqueue(r)}})},transform(s){t.feed(s)},flush(){t.end()}})}}function ke(e){if(e.includes(`
`))throw new X("Event's id must not contain a newline character")}function qt(e){if(e.includes(`
`))throw new X("Event's event must not contain a newline character")}function Ae(e){if(!Number.isInteger(e)||e<0)throw new X("Event's retry must be a integer and >= 0")}function Ie(e){if(e.includes(`
`))throw new X("Event's comment must not contain a newline character")}function zt(e){const t=e?.split(/\n/)??[];let s="";for(const r of t)s+=`data: ${r}
`;return s}function Kt(e){let t="";for(const s of e??[])Ie(s),t+=`: ${s}
`;return t}function $(e){let t="";return t+=Kt(e.comments),e.event!==void 0&&(qt(e.event),t+=`event: ${e.event}
`),e.retry!==void 0&&(Ae(e.retry),t+=`retry: ${e.retry}
`),e.id!==void 0&&(ke(e.id),t+=`id: ${e.id}
`),t+=zt(e.data),t+=`
`,t}const De=Symbol("ORPC_EVENT_SOURCE_META");function U(e,t){if(t.id===void 0&&t.retry===void 0&&!t.comments?.length)return e;if(t.id!==void 0&&ke(t.id),t.retry!==void 0&&Ae(t.retry),t.comments!==void 0)for(const s of t.comments)Ie(s);return new Proxy(e,{get(s,r,n){return r===De?t:Reflect.get(s,r,n)}})}function Y(e){return C(e)?Reflect.get(e,De):void 0}function Bt(e){const t=e.replace(/"/g,'\\"'),s=encodeURIComponent(e).replace(/['()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`).replace(/%(7C|60|5E)/g,(r,n)=>String.fromCharCode(Number.parseInt(n,16)));return`inline; filename="${t}"; filename*=utf-8''${s}`}function Qt(e){const t=e.match(/filename\*=(UTF-8'')?([^;]*)/i);if(t&&typeof t[2]=="string")return Tt(t[2]);const s=e.match(/filename="((?:\\"|[^"])*)"/i);if(s&&typeof s[1]=="string")return s[1].replace(/\\"/g,'"')}function $t(e,t){const s={...e};for(const r in t)Array.isArray(t[r])?s[r]=[...F(s[r]),...t[r]]:t[r]!==void 0&&(Array.isArray(s[r])?s[r]=[...s[r],t[r]]:s[r]!==void 0?s[r]=[s[r],t[r]]:s[r]=t[r]);return s}function Ne(e,t){const s=async r=>{let n=await t.error(r);if(n!==r){const o=Y(r);o&&C(n)&&(n=U(n,o))}return n};return new ce(async()=>{const{done:r,value:n}=await(async()=>{try{return await e.next()}catch(a){throw await s(a)}})();let o=await t.value(n,r);if(o!==n){const a=Y(n);a&&C(o)&&(o=U(o,a))}return{done:r,value:o}},async()=>{try{await e.return?.()}catch(r){throw await s(r)}})}function Gt(e){return{...e,context:e.context??{}}}function Me(e,t={}){const s=t.path??[],r=async(...[o,a={}])=>await e.call(s,o,Gt(a)),n=new Proxy(r,{get(o,a){return typeof a!="string"?Reflect.get(o,a):Me(e,{...t,path:[...s,a]})}});return je(n)}function Wt(e,t={}){const r=e?.pipeThrough(new TextDecoderStream).pipeThrough(new Lt)?.getReader();let n,o=!1;return new ce(async()=>{n??=oe("consume_event_iterator_stream");try{for(;;){if(r===void 0)return{done:!0,value:void 0};const{done:a,value:c}=await T(n,()=>r.read());if(a){if(o)throw new gt("Stream was cancelled");return{done:!0,value:void 0}}switch(c.event){case"message":{let l=G(c.data);return C(l)&&(l=U(l,c)),n?.addEvent("message"),{done:!1,value:l}}case"error":{let l=new _({data:G(c.data)});throw l=U(l,c),n?.addEvent("error"),l}case"done":{let l=G(c.data);return C(l)&&(l=U(l,c)),n?.addEvent("done"),{done:!0,value:l}}default:n?.addEvent("maybe_keepalive")}}}catch(a){throw a instanceof _||O(n,a,t),a}},async a=>{try{a!=="next"&&(o=!0,n?.addEvent("cancelled")),await T(n,()=>r?.cancel())}catch(c){throw O(n,c,t),c}finally{n?.end()}})}function Ht(e,t={}){const s=t.eventIteratorKeepAliveEnabled??!0,r=t.eventIteratorKeepAliveInterval??5e3,n=t.eventIteratorKeepAliveComment??"",o=t.eventIteratorInitialCommentEnabled??!0,a=t.eventIteratorInitialComment??"";let c=!1,l,u;return new ReadableStream({start(h){u=oe("stream_event_iterator"),o&&h.enqueue($({comments:[a]}))},async pull(h){try{s&&(l=setInterval(()=>{h.enqueue($({comments:[n]})),u?.addEvent("keepalive")},r));const f=await T(u,()=>e.next());if(clearInterval(l),c)return;const y=Y(f.value);if(!f.done||f.value!==void 0||y!==void 0){const x=f.done?"done":"message";h.enqueue($({...y,event:x,data:P(f.value)})),u?.addEvent(x)}f.done&&(h.close(),u?.end())}catch(f){if(clearInterval(l),c)return;f instanceof _?(h.enqueue($({...Y(f),event:"error",data:P(f.data)})),u?.addEvent("error"),h.close()):(O(u,f),h.error(f)),u?.end()}},async cancel(){try{c=!0,clearInterval(l),u?.addEvent("cancelled"),await T(u,()=>e.return?.())}catch(h){throw O(u,h),h}finally{u?.end()}}}).pipeThrough(new TextEncoderStream)}function Yt(e,t={}){return D({name:"parse_standard_body",signal:t.signal},async()=>{const s=e.headers.get("content-disposition");if(typeof s=="string"){const o=Qt(s)??"blob",a=await e.blob();return new File([a],o,{type:a.type})}const r=e.headers.get("content-type");if(!r||r.startsWith("application/json")){const o=await e.text();return G(o)}if(r.startsWith("multipart/form-data"))return await e.formData();if(r.startsWith("application/x-www-form-urlencoded")){const o=await e.text();return new URLSearchParams(o)}if(r.startsWith("text/event-stream"))return Wt(e.body,t);if(r.startsWith("text/plain"))return await e.text();const n=await e.blob();return new File([n],"blob",{type:n.type})})}function Vt(e,t,s={}){const r=t.get("content-disposition");if(t.delete("content-type"),t.delete("content-disposition"),e!==void 0)return e instanceof Blob?(t.set("content-type",e.type),t.set("content-length",e.size.toString()),t.set("content-disposition",r??Bt(e instanceof File?e.name:"blob")),e):e instanceof FormData||e instanceof URLSearchParams?e:R(e)?(t.set("content-type","text/event-stream"),Ht(e,s)):(t.set("content-type","application/json"),P(e))}function Ue(e,t={}){return e.forEach((s,r)=>{Array.isArray(t[r])?t[r].push(s):t[r]!==void 0?t[r]=[t[r],s]:t[r]=s}),t}function Jt(e,t=new Headers){for(const[s,r]of Object.entries(e))if(Array.isArray(r))for(const n of r)t.append(s,n);else r!==void 0&&t.append(s,r);return t}function Xt(e,t={}){const s=Jt(e.headers),r=Vt(e.body,s,t);return new Request(e.url,{signal:e.signal,method:e.method,headers:s,body:r})}function Zt(e,t={}){return{body:vt(()=>Yt(e,t)),status:e.status,get headers(){const s=Ue(e.headers);return Object.defineProperty(this,"headers",{value:s,writable:!0}),s},set headers(s){Object.defineProperty(this,"headers",{value:s,writable:!0})}}}class Fe{plugins;constructor(t=[]){this.plugins=[...t].sort((s,r)=>(s.order??0)-(r.order??0))}init(t){for(const s of this.plugins)s.init?.(t)}}class er{constructor(t,s,r={}){this.codec=t,this.sender=s,new Fe(r.plugins).init(r),this.interceptors=F(r.interceptors),this.clientInterceptors=F(r.clientInterceptors)}interceptors;clientInterceptors;call(t,s,r){return D({name:`${we}.${t.join("/")}`,signal:r.signal},n=>(n?.setAttribute("rpc.system",we),n?.setAttribute("rpc.method",t.join(".")),R(s)&&(s=Ee({name:"consume_event_iterator_input",signal:r.signal},s)),se(this.interceptors,{...r,path:t,input:s},async({path:o,input:a,...c})=>{const l=J();let u;const d=l?.trace.getActiveSpan()??n;d&&l&&(u=l?.trace.setSpan(l.context.active(),d));const h=await D({name:"encode_request",context:u},()=>this.codec.encode(o,a,c)),f=await se(this.clientInterceptors,{...c,input:a,path:o,request:h},({input:x,path:m,request:v,...E})=>D({name:"send_request",signal:E.signal,context:u},()=>this.sender.call(v,E,m,x))),y=await D({name:"decode_response",context:u},()=>this.codec.decode(f,c,o,a));return R(y)?Ee({name:"consume_event_iterator_output",signal:c.signal},y):y})))}}const g={BIGINT:0,DATE:1,NAN:2,UNDEFINED:3,URL:4,REGEXP:5,SET:6,MAP:7};class tr{customSerializers;constructor(t={}){if(this.customSerializers=t.customJsonSerializers??[],this.customSerializers.length!==new Set(this.customSerializers.map(s=>s.type)).size)throw new Error("Custom serializer type must be unique.")}serialize(t,s=[],r=[],n=[],o=[]){for(const a of this.customSerializers)if(a.condition(t)){const c=this.serialize(a.serialize(t),s,r,n,o);return r.push([a.type,...s]),c}if(t instanceof Blob)return n.push(s),o.push(t),[t,r,n,o];if(typeof t=="bigint")return r.push([g.BIGINT,...s]),[t.toString(),r,n,o];if(t instanceof Date)return r.push([g.DATE,...s]),Number.isNaN(t.getTime())?[null,r,n,o]:[t.toISOString(),r,n,o];if(Number.isNaN(t))return r.push([g.NAN,...s]),[null,r,n,o];if(t instanceof URL)return r.push([g.URL,...s]),[t.toString(),r,n,o];if(t instanceof RegExp)return r.push([g.REGEXP,...s]),[t.toString(),r,n,o];if(t instanceof Set){const a=this.serialize(Array.from(t),s,r,n,o);return r.push([g.SET,...s]),a}if(t instanceof Map){const a=this.serialize(Array.from(t.entries()),s,r,n,o);return r.push([g.MAP,...s]),a}if(Array.isArray(t))return[t.map((c,l)=>c===void 0?(r.push([g.UNDEFINED,...s,l]),c):this.serialize(c,[...s,l],r,n,o)[0]),r,n,o];if(Ce(t)){const a={};for(const c in t)c==="toJSON"&&typeof t[c]=="function"||(a[c]=this.serialize(t[c],[...s,c],r,n,o)[0]);return[a,r,n,o]}return[t,r,n,o]}deserialize(t,s,r,n){const o={data:t};r&&n&&r.forEach((a,c)=>{let l=o,u="data";a.forEach(d=>{l=l[u],u=d}),l[u]=n(c)});for(const a of s){const c=a[0];let l=o,u="data";for(let d=1;d<a.length;d++)l=l[u],u=a[d];for(const d of this.customSerializers)if(d.type===c){l[u]=d.deserialize(l[u]);break}switch(c){case g.BIGINT:l[u]=BigInt(l[u]);break;case g.DATE:l[u]=new Date(l[u]??"Invalid Date");break;case g.NAN:l[u]=Number.NaN;break;case g.UNDEFINED:l[u]=void 0;break;case g.URL:l[u]=new URL(l[u]);break;case g.REGEXP:{const[,d,h]=l[u].match(/^\/(.*)\/([a-z]*)$/);l[u]=new RegExp(d,h);break}case g.SET:l[u]=new Set(l[u]);break;case g.MAP:l[u]=new Map(l[u]);break}}return o.data}}function rr(e){return`/${e.map(encodeURIComponent).join("/")}`}function sr(e){return typeof e.forEach=="function"?Ue(e):e}function nr(e){return Object.entries(le).find(([,t])=>t.status===e)?.[0]??"MALFORMED_ORPC_ERROR_RESPONSE"}class ir{constructor(t,s){this.serializer=t,this.baseUrl=s.url,this.maxUrlLength=s.maxUrlLength??2083,this.fallbackMethod=s.fallbackMethod??"POST",this.expectedMethod=s.method??this.fallbackMethod,this.headers=s.headers??{}}baseUrl;maxUrlLength;fallbackMethod;expectedMethod;headers;async encode(t,s,r){let n=sr(await Q(this.headers,r,t,s));r.lastEventId!==void 0&&(n=$t(n,{"last-event-id":r.lastEventId}));const o=await Q(this.expectedMethod,r,t,s),a=await Q(this.baseUrl,r,t,s),c=new URL(a);c.pathname=`${c.pathname.replace(/\/$/,"")}${rr(t)}`;const l=this.serializer.serialize(s);if(o==="GET"&&!(l instanceof FormData)&&!R(l)){const u=await Q(this.maxUrlLength,r,t,s),d=new URL(c);if(d.searchParams.append("data",P(l)),d.toString().length<=u)return{body:void 0,method:o,headers:n,url:d,signal:r.signal}}return{url:c,method:o==="GET"?this.fallbackMethod:o,headers:n,body:l,signal:r.signal}}async decode(t){const s=!ue(t.status),r=await(async()=>{let n=!1;try{const o=await t.body();return n=!0,this.serializer.deserialize(o)}catch(o){throw n?new Error("Invalid RPC response format.",{cause:o}):new Error("Cannot parse response body, please check the response body and content-type.",{cause:o})}})();if(!s)throw Te(r)?Pe(r):new L(nr(t.status),{status:t.status,data:{...t,body:r}});return r}}class ar{constructor(t){this.jsonSerializer=t}serialize(t){return R(t)?Ne(t,{value:async s=>this.#t(s,!1),error:async s=>new _({data:this.#t(Dt(s).toJSON(),!1),cause:s})}):this.#t(t,!0)}#t(t,s){const[r,n,o,a]=this.jsonSerializer.serialize(t),c=n.length===0?void 0:n;if(!s||a.length===0)return{json:r,meta:c};const l=new FormData;return l.set("data",P({json:r,meta:c,maps:o})),a.forEach((u,d)=>{l.set(d.toString(),u)}),l}deserialize(t){return R(t)?Ne(t,{value:async s=>this.#e(s),error:async s=>{if(!(s instanceof _))return s;const r=this.#e(s.data);return Te(r)?Pe(r,{cause:s}):new _({data:r,cause:s})}}):this.#e(t)}#e(t){if(t===void 0)return;if(!(t instanceof FormData))return this.jsonSerializer.deserialize(t.json,t.meta??[]);const s=JSON.parse(t.get("data"));return this.jsonSerializer.deserialize(s.json,s.meta??[],s.maps,r=>t.get(r.toString()))}}class or extends er{constructor(t,s){const r=new tr(s),n=new ar(r),o=new ir(n,s);super(o,t,s)}}class cr extends Fe{initRuntimeAdapter(t){for(const s of this.plugins)s.initRuntimeAdapter?.(t)}}class lr{fetch;toFetchRequestOptions;adapterInterceptors;constructor(t){new cr(t.plugins).initRuntimeAdapter(t),this.fetch=t.fetch??globalThis.fetch.bind(globalThis),this.toFetchRequestOptions=t,this.adapterInterceptors=F(t.adapterInterceptors)}async call(t,s,r,n){const o=Xt(t,this.toFetchRequestOptions),a=await se(this.adapterInterceptors,{...s,request:o,path:r,input:n,init:{redirect:"manual"}},({request:l,path:u,input:d,init:h,...f})=>this.fetch(l,h,f,u,d));return Zt(a,{signal:o.signal})}}class ur extends or{constructor(t){const s=new lr(t);super(s,t)}}function j(e,t={}){return[e,{...t.input!==void 0?{input:t.input}:{},...t.type!==void 0?{type:t.type}:{},...t.fnOptions!==void 0?{fnOptions:t.fnOptions}:{}}]}function dr(e){return{key(t){return j(e,t)}}}function hr(e){return async t=>{const s=await e(t);let r;for await(const n of s){if(t.signal.aborted)throw t.signal.reason;r={chunk:n},t.client.setQueryData(t.queryKey,n)}if(!r)throw new Error(`Live query for ${P(t.queryKey)} did not yield any data. Ensure the query function returns an AsyncIterable with at least one chunk.`);return r.chunk}}function fr(e,{refetchMode:t="reset",maxChunks:s=Number.POSITIVE_INFINITY}={}){return async r=>{const n=r.client.getQueryCache().find({queryKey:r.queryKey,exact:!0}),o=!!n&&n.state.data!==void 0;o&&(t==="reset"?n.setState({status:"pending",data:void 0,error:null,fetchStatus:"fetching"}):r.client.setQueryData(r.queryKey,(d=[])=>A(d,s)));let a=[];const c=await e(r),l=!o||t!=="replace";r.client.setQueryData(r.queryKey,(d=[])=>A(d,s));for await(const d of c){if(r.signal.aborted)throw r.signal.reason;a.push(d),a=A(a,s),l&&r.client.setQueryData(r.queryKey,(h=[])=>A([...h,d],s))}l||r.client.setQueryData(r.queryKey,a);const u=r.client.getQueryData(r.queryKey);return u?A(u,s):a}}function A(e,t){return e.length<=t?e:e.slice(e.length-t)}const I=Symbol("ORPC_OPERATION_CONTEXT");function mr(e,t){const s={call:e,queryKey(...[r={}]){return r={...t.experimental_defaults?.queryKey,...r},r.queryKey??j(t.path,{type:"query",input:r.input})},queryOptions(...[r={}]){r={...t.experimental_defaults?.queryOptions,...r};const n=s.queryKey(r);return{queryFn:({signal:o})=>{if(r.input===N)throw new Error("queryFn should not be called with skipToken used as input");return e(r.input,{signal:o,context:{[I]:{key:n,type:"query"},...r.context}})},...r.input===N?{enabled:!1}:{},...r,queryKey:n}},experimental_streamedKey(...[r={}]){return r={...t.experimental_defaults?.experimental_streamedKey,...r},r.queryKey??j(t.path,{type:"streamed",input:r.input,fnOptions:r.queryFnOptions})},experimental_streamedOptions(...[r={}]){r={...t.experimental_defaults?.experimental_streamedOptions,...r};const n=s.experimental_streamedKey(r);return{queryFn:fr(async({signal:o})=>{if(r.input===N)throw new Error("queryFn should not be called with skipToken used as input");const a=await e(r.input,{signal:o,context:{[I]:{key:n,type:"streamed"},...r.context}});if(!R(a))throw new Error("streamedQuery requires an event iterator output");return a},r.queryFnOptions),...r.input===N?{enabled:!1}:{},...r,queryKey:n}},experimental_liveKey(...[r={}]){return r={...t.experimental_defaults?.experimental_liveKey,...r},r.queryKey??j(t.path,{type:"live",input:r.input})},experimental_liveOptions(...[r={}]){r={...t.experimental_defaults?.experimental_liveOptions,...r};const n=s.experimental_liveKey(r);return{queryFn:hr(async({signal:o})=>{if(r.input===N)throw new Error("queryFn should not be called with skipToken used as input");const a=await e(r.input,{signal:o,context:{[I]:{key:n,type:"live"},...r.context}});if(!R(a))throw new Error("liveQuery requires an event iterator output");return a}),...r.input===N?{enabled:!1}:{},...r,queryKey:n}},infiniteKey(r){return r={...t.experimental_defaults?.infiniteKey,...r},r.queryKey??j(t.path,{type:"infinite",input:r.input===N?N:r.input(r.initialPageParam)})},infiniteOptions(r){r={...t.experimental_defaults?.infiniteOptions,...r};const n=s.infiniteKey(r);return{queryFn:({pageParam:o,signal:a})=>{if(r.input===N)throw new Error("queryFn should not be called with skipToken used as input");return e(r.input(o),{signal:a,context:{[I]:{key:n,type:"infinite"},...r.context}})},...r.input===N?{enabled:!1}:{},...r,queryKey:n}},mutationKey(...[r={}]){return r={...t.experimental_defaults?.mutationKey,...r},r.mutationKey??j(t.path,{type:"mutation"})},mutationOptions(...[r={}]){r={...t.experimental_defaults?.mutationOptions,...r};const n=s.mutationKey(r);return{mutationFn:o=>e(o,{context:{[I]:{key:n,type:"mutation"},...r.context}}),...r,mutationKey:n}}};return s}function Le(e,t={}){const s=F(t.path),r=dr(s),n=mr(e,{path:s,experimental_defaults:t.experimental_defaults});return new Proxy({...r,...n},{get(a,c){const l=Reflect.get(a,c);if(typeof c!="string")return l;const u=Le(e[c],{...t,path:[...s,c],experimental_defaults:Ct(t.experimental_defaults,[c])});return typeof l!="function"?u:new Proxy(l,{get(d,h){return Reflect.get(u,h)}})}})}const pr=new ur({url:typeof window<"u"?`${window.location.origin}/api/rpc`:"http://localhost:3000/api/rpc"}),xr=Me(pr),qe=Le(xr),yr=({tcg:e,onSelect:t,selectedCard:s,onClear:r})=>{const[n,o]=p.useState(""),[a,c]=p.useState(""),[l,u]=p.useState(!1),d=p.useRef(null);p.useEffect(()=>{const x=setTimeout(()=>c(n),300);return()=>clearTimeout(x)},[n]),p.useEffect(()=>{const x=m=>{d.current&&!d.current.contains(m.target)&&u(!1)};return document.addEventListener("mousedown",x),()=>document.removeEventListener("mousedown",x)},[]);const{data:h=[],isFetching:f}=ot({...qe.card.search.queryOptions({input:{query:a,tcg:e}}),enabled:a.length>=2}),y=x=>{t(x),o(""),u(!1)};return s?i.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-secondary/50 p-3",children:[i.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-16 w-12 rounded object-cover"}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-foreground truncate",children:s.name}),i.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:[s.setName," Â· ",s.rarity]})]}),i.jsx("button",{type:"button",onClick:r,className:"shrink-0 text-sm text-muted-foreground hover:text-foreground",children:"Change"})]}):i.jsxs("div",{ref:d,className:"relative",children:[i.jsx("input",{type:"text",value:n,onChange:x=>{o(x.target.value),u(!0)},onFocus:()=>n.length>=2&&u(!0),placeholder:"Search for a card...",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"}),f&&i.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:i.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),l&&h.length>0&&i.jsx("ul",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card shadow-lg max-h-64 overflow-y-auto",children:h.map(x=>i.jsx("li",{children:i.jsxs("button",{type:"button",onClick:()=>y(x),className:"flex w-full items-center gap-3 px-3 py-2 text-left hover:bg-accent transition-colors",children:[i.jsx("img",{src:x.imageUrl,alt:x.name,className:"h-12 w-9 rounded object-cover"}),i.jsxs("div",{className:"min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:x.name}),i.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[x.setName," Â· ",x.rarity,x.marketPrice!=null&&` Â· $${x.marketPrice.toFixed(2)}`]})]})]})},x.externalId))}),l&&a.length>=2&&!f&&h.length===0&&i.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card p-4 text-center text-sm text-muted-foreground shadow-lg",children:"No cards found"})]})},gr=({card:e,onRemove:t})=>i.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-border bg-secondary/50 px-3 py-2",children:[i.jsx("img",{src:e.imageUrl,alt:e.name,className:"h-10 w-7 rounded object-cover"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-xs font-medium text-foreground truncate",children:e.name}),i.jsxs("p",{className:"text-[10px] text-muted-foreground truncate",children:[e.setName,e.marketPrice!=null&&` Â· $${e.marketPrice.toFixed(2)}`]})]}),i.jsx("button",{type:"button",onClick:()=>t(e.externalId),className:"shrink-0 text-muted-foreground hover:text-foreground transition-colors","aria-label":`Remove ${e.name}`,children:i.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),vr=[{value:"pokemon",label:"Pokemon"},{value:"mtg",label:"MTG"},{value:"yugioh",label:"Yu-Gi-Oh!"}],br=[{value:"wtt",label:"Trade"},{value:"wtb",label:"Buy"},{value:"wts",label:"Sell"}],wr=({selectedCards:e,tcg:t,listingType:s,onTcgChange:r,onListingTypeChange:n,onAddCard:o,onRemoveCard:a,onSubmit:c,onBack:l})=>{const[u,d]=p.useState("");return i.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[i.jsx("button",{type:"button",onClick:l,className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"Go back",children:i.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),i.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"Build Your Offer"})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:"TCG"}),i.jsx("div",{className:"flex gap-2",children:vr.map(h=>i.jsx("button",{type:"button",onClick:()=>r(h.value),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition-colors ${t===h.value?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent"}`,children:h.label},h.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:"I want to..."}),i.jsx("div",{className:"flex gap-2",children:br.map(h=>i.jsx("button",{type:"button",onClick:()=>n(h.value),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition-colors ${s===h.value?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent"}`,children:h.label},h.value))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:"Search cards to add"}),i.jsx(yr,{tcg:t,onSelect:o,selectedCard:null,onClear:()=>{}})]}),e.length>0&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:["Your cards (",e.length,")"]}),i.jsx("div",{className:"space-y-2",children:e.map(h=>i.jsx(gr,{card:h,onRemove:a},h.externalId))})]}),(s==="wts"||s==="wtb")&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-xs font-medium text-muted-foreground mb-2",children:[s==="wts"?"Asking Price":"Budget"," ",i.jsx("span",{className:"text-muted-foreground/60",children:"(optional)"})]}),i.jsxs("div",{className:"relative",children:[i.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:"$"}),i.jsx("input",{type:"number",step:"0.01",min:"0",value:u,onChange:h=>d(h.target.value),placeholder:"0.00",className:"w-full rounded-lg border border-input bg-background pl-7 pr-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]})]})]}),i.jsx("div",{className:"border-t border-border bg-card p-4",children:i.jsx("button",{type:"button",onClick:c,disabled:e.length===0,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Offer"})})]})},Er=({selectedCards:e,listingType:t,onSuccess:s,onBack:r})=>{const[n,o]=p.useState(""),[a,c]=p.useState(""),[l,u]=p.useState(""),[d,h]=p.useState(""),f=e[0],y=ct(qe.preRegistration.create.mutationOptions()),x=m=>{m.preventDefault(),f&&y.mutate({email:n,display_name:a||null,tcg:f.tcg,card_name:f.name,card_set:f.setName??null,card_external_id:f.externalId??null,card_image_url:f.imageUrl??null,listing_type:t,asking_price:null,city:l||null,zip_code:d||null},{onSuccess:v=>{s(v.position,n)}})};return i.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[i.jsx("button",{type:"button",onClick:r,className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"Go back",children:i.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:i.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),i.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"Complete Registration"})]}),i.jsxs("form",{onSubmit:x,className:"flex-1 overflow-y-auto p-4 space-y-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your email to save your offer and get notified when TCG Trade Hub launches."}),f&&i.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-secondary/50 p-3",children:[i.jsx("img",{src:f.imageUrl,alt:f.name,className:"h-14 w-10 rounded object-cover"}),i.jsxs("div",{className:"min-w-0 flex-1",children:[i.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:f.name}),i.jsx("p",{className:"text-xs text-muted-foreground truncate",children:f.setName}),e.length>1&&i.jsxs("p",{className:"text-xs text-primary",children:["+",e.length-1," more"]})]})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"demo-email",className:"block text-xs font-medium text-foreground mb-1.5",children:["Email ",i.jsx("span",{className:"text-destructive",children:"*"})]}),i.jsx("input",{id:"demo-email",type:"email",required:!0,value:n,onChange:m=>o(m.target.value),placeholder:"you@example.com",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"demo-name",className:"block text-xs font-medium text-foreground mb-1.5",children:["Display Name ",i.jsx("span",{className:"text-muted-foreground text-xs",children:"(optional)"})]}),i.jsx("input",{id:"demo-name",type:"text",value:a,onChange:m=>c(m.target.value),placeholder:"TraderJoe",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"demo-city",className:"block text-xs font-medium text-foreground mb-1.5",children:"City"}),i.jsx("input",{id:"demo-city",type:"text",value:l,onChange:m=>u(m.target.value),placeholder:"San Francisco",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"demo-zip",className:"block text-xs font-medium text-foreground mb-1.5",children:"Zip Code"}),i.jsx("input",{id:"demo-zip",type:"text",value:d,onChange:m=>h(m.target.value),placeholder:"94102",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]})]}),y.isError&&i.jsx("div",{className:"rounded-lg bg-destructive/10 p-3 text-xs text-destructive",children:y.error.message||"Something went wrong. Please try again."}),i.jsx("button",{type:"submit",disabled:y.isPending||!n,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:y.isPending?"Registering...":"Get Early Access"}),i.jsx("p",{className:"text-center text-[10px] text-muted-foreground",children:"No spam, ever. We'll only email when we launch in your area."})]})]})},Nr=[{id:"1",type:"system",sender:"system",text:"Welcome to TCG Trade Hub"},{id:"2",type:"text",sender:"other",text:"Hey! We're building the easiest way to trade cards locally â€” no shipping, no scams."},{id:"3",type:"text",sender:"other",text:"What cards are you hunting for? Tell us and we'll match you with local traders when we launch."},{id:"4",type:"reservation_card",sender:"other"},{id:"5",type:"system",sender:"system",text:"Tap above to build your list"}],Sr=["chat","trade-editor","email","success"],Rr=()=>{const[e,t]=p.useState("chat"),[s,r]=p.useState([]),[n,o]=p.useState("pokemon"),[a,c]=p.useState("wtt"),[l,u]=p.useState(null),d=Sr.indexOf(e),h=m=>{r(v=>v.some(E=>E.externalId===m.externalId)?v:[...v,m])},f=m=>{r(v=>v.filter(E=>E.externalId!==m))},y=m=>{o(m),r([])},x=p.useCallback(()=>{t("chat"),r([]),o("pokemon"),c("wtt"),setTimeout(()=>{u(null)},500)},[]);return i.jsx(ut,{children:i.jsxs("div",{className:"flex flex-1 transition-transform duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)]",style:{transform:`translateX(-${d*100}%)`},children:[i.jsxs("div",{className:"min-w-full flex flex-col overflow-hidden","aria-hidden":e!=="chat",inert:e!=="chat"||void 0,children:[i.jsx(dt,{name:"TCG Trade Hub"}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:Nr.map(m=>m.type==="system"?i.jsx(ft,{text:m.text},m.id):m.type==="text"?i.jsx(ht,{text:m.text,sender:"other"},m.id):m.type==="reservation_card"?i.jsx(mt,{onBuildList:()=>t("trade-editor")},m.id):null)})]}),i.jsx("div",{className:"min-w-full flex flex-col overflow-hidden","aria-hidden":e!=="trade-editor",inert:e!=="trade-editor"||void 0,children:i.jsx(wr,{selectedCards:s,tcg:n,listingType:a,onTcgChange:y,onListingTypeChange:c,onAddCard:h,onRemoveCard:f,onSubmit:()=>t("email"),onBack:()=>t("chat")})}),i.jsx("div",{className:"min-w-full flex flex-col overflow-hidden","aria-hidden":e!=="email",inert:e!=="email"||void 0,children:i.jsx(Er,{selectedCards:s,listingType:a,onSuccess:(m,v)=>{u({position:m,email:v}),t("success")},onBack:()=>t("trade-editor")})}),i.jsx("div",{className:"min-w-full flex flex-col overflow-hidden","aria-hidden":e!=="success",inert:e!=="success"||void 0,children:l?i.jsx("div",{className:"flex flex-1 items-center overflow-y-auto",children:i.jsx(lt,{position:l.position,email:l.email,onReset:x})}):i.jsx("div",{})})]})})};function jr(){return i.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center px-4 py-8",children:[i.jsxs("div",{className:"mb-6 text-center",children:[i.jsx($e,{to:"/",className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"â† Back to home"}),i.jsx("h1",{className:"mt-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl",children:"See how trading works"}),i.jsx("p",{className:"mt-2 text-muted-foreground",children:"Chat with a collector, build a counter-offer, and sign up for early access."})]}),i.jsx(Rr,{})]})}export{jr as component};
