import{S as Ce,p as me,r as j,s as J,a as L,n as X,i as se,b as pe,t as Be,c as W,f as Qe,d as Ge,e as xe,g as ee,h as ye,k as We,l as x,m as oe,u as Oe,j as n,o as S,L as He}from"./main-umjJ5X8Z.js";var Ve=class extends Ce{constructor(e,t){super(),this.options=t,this.#t=e,this.#o=null,this.#a=me(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#s=void 0;#r=void 0;#n;#i;#a;#o;#p;#h;#f;#l;#u;#c;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),ge(this.#e,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ne(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ne(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#w(),this.#e.removeObserver(this)}setOptions(e){const t=this.options,s=this.#e;if(this.options=this.#t.defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof j(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#N(),this.#e.setOptions(this.options),t._defaulted&&!J(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const r=this.hasListeners();r&&ve(this.#e,s,this.options,t)&&this.#d(),this.updateResult(),r&&(this.#e!==s||j(this.options.enabled,this.#e)!==j(t.enabled,this.#e)||L(this.options.staleTime,this.#e)!==L(t.staleTime,this.#e))&&this.#x();const i=this.#y();r&&(this.#e!==s||j(this.options.enabled,this.#e)!==j(t.enabled,this.#e)||i!==this.#c)&&this.#g(i)}getOptimisticResult(e){const t=this.#t.getQueryCache().build(this.#t,e),s=this.createResult(t,e);return Je(this,s)&&(this.#r=s,this.#i=this.options,this.#n=this.#e.state),s}getCurrentResult(){return this.#r}trackResult(e,t){return new Proxy(e,{get:(s,r)=>(this.trackProp(r),t?.(r),r==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(s,r))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#e}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const t=this.#t.defaultQueryOptions(e),s=this.#t.getQueryCache().build(this.#t,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#d({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(e){this.#N();let t=this.#e.fetch(this.options,e);return e?.throwOnError||(t=t.catch(X)),t}#x(){this.#b();const e=L(this.options.staleTime,this.#e);if(se||this.#r.isStale||!pe(e))return;const s=Be(this.#r.dataUpdatedAt,e)+1;this.#l=W.setTimeout(()=>{this.#r.isStale||this.updateResult()},s)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#g(e){this.#w(),this.#c=e,!(se||j(this.options.enabled,this.#e)===!1||!pe(this.#c)||this.#c===0)&&(this.#u=W.setInterval(()=>{(this.options.refetchIntervalInBackground||Qe.isFocused())&&this.#d()},this.#c))}#v(){this.#x(),this.#g(this.#y())}#b(){this.#l&&(W.clearTimeout(this.#l),this.#l=void 0)}#w(){this.#u&&(W.clearInterval(this.#u),this.#u=void 0)}createResult(e,t){const s=this.#e,r=this.options,i=this.#r,o=this.#n,a=this.#i,l=e!==s?e.state:this.#s,{state:u}=e;let d={...u},f=!1,h;if(t._optimisticResults){const E=this.hasListeners(),I=!E&&ge(e,t),B=E&&ve(e,s,t,r);(I||B)&&(d={...d,...Ge(u.data,e.options)}),t._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:y,status:m}=d;h=d.data;let w=!1;if(t.placeholderData!==void 0&&h===void 0&&m==="pending"){let E;i?.isPlaceholderData&&t.placeholderData===a?.placeholderData?(E=i.data,w=!0):E=typeof t.placeholderData=="function"?t.placeholderData(this.#f?.state.data,this.#f):t.placeholderData,E!==void 0&&(m="success",h=xe(i?.data,E,t),f=!0)}if(t.select&&h!==void 0&&!w)if(i&&h===o?.data&&t.select===this.#p)h=this.#h;else try{this.#p=t.select,h=t.select(h),h=xe(i?.data,h,t),this.#h=h,this.#o=null}catch(E){this.#o=E}this.#o&&(p=this.#o,h=this.#h,y=Date.now(),m="error");const v=d.fetchStatus==="fetching",R=m==="pending",g=m==="error",N=R&&v,$=h!==void 0,C={status:m,fetchStatus:d.fetchStatus,isPending:R,isSuccess:m==="success",isError:g,isInitialLoading:N,isLoading:N,data:h,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:y,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:v,isRefetching:v&&!R,isLoadingError:g&&!$,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:g&&$,isStale:ce(e,t),refetch:this.refetch,promise:this.#a,isEnabled:j(t.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const E=C.data!==void 0,I=C.status==="error"&&!E,B=G=>{I?G.reject(C.error):E&&G.resolve(C.data)},fe=()=>{const G=this.#a=C.promise=me();B(G)},Q=this.#a;switch(Q.status){case"pending":e.queryHash===s.queryHash&&B(Q);break;case"fulfilled":(I||C.data!==Q.value)&&fe();break;case"rejected":(!I||C.error!==Q.reason)&&fe();break}}return C}updateResult(){const e=this.#r,t=this.createResult(this.#e,this.options);if(this.#n=this.#e.state,this.#i=this.options,this.#n.data!==void 0&&(this.#f=this.#e),J(t,e))return;this.#r=t;const s=()=>{if(!e)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!this.#m.size)return!0;const o=new Set(i??this.#m);return this.options.throwOnError&&o.add("error"),Object.keys(this.#r).some(a=>{const c=a;return this.#r[c]!==e[c]&&o.has(c)})};this.#E({listeners:s()})}#N(){const e=this.#t.getQueryCache().build(this.#t,this.options);if(e===this.#e)return;const t=this.#e;this.#e=e,this.#s=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#E(e){ee.batch(()=>{e.listeners&&this.listeners.forEach(t=>{t(this.#r)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function Ye(e,t){return j(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ge(e,t){return Ye(e,t)||e.state.data!==void 0&&ne(e,t,t.refetchOnMount)}function ne(e,t,s){if(j(t.enabled,e)!==!1&&L(t.staleTime,e)!=="static"){const r=typeof s=="function"?s(e):s;return r==="always"||r!==!1&&ce(e,t)}return!1}function ve(e,t,s,r){return(e!==t||j(r.enabled,e)===!1)&&(!s.suspense||e.state.status!=="error")&&ce(e,s)}function ce(e,t){return j(t.enabled,e)!==!1&&e.isStaleByTime(L(t.staleTime,e))}function Je(e,t){return!J(e.getCurrentResult(),t)}var Xe=class extends Ce{#t;#e=void 0;#s;#r;constructor(e,t){super(),this.#t=e,this.setOptions(t),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#t.defaultMutationOptions(e),J(this.options,t)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&ye(t.mutationKey)!==ye(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#n(),this.#i(e)}getCurrentResult(){return this.#e}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#n(),this.#i()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#t.getMutationCache().build(this.#t,this.options),this.#s.addObserver(this),this.#s.execute(e)}#n(){const e=this.#s?.state??We();this.#e={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){ee.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#e.variables,s=this.#e.context,r={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#r.onSuccess?.(e.data,t,s,r)}catch(i){Promise.reject(i)}try{this.#r.onSettled?.(e.data,null,t,s,r)}catch(i){Promise.reject(i)}}else if(e?.type==="error"){try{this.#r.onError?.(e.error,t,s,r)}catch(i){Promise.reject(i)}try{this.#r.onSettled?.(void 0,e.error,t,s,r)}catch(i){Promise.reject(i)}}}this.listeners.forEach(t=>{t(this.#e)})})}},_e=x.createContext(!1),Ze=()=>x.useContext(_e);_e.Provider;function et(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var tt=x.createContext(et()),rt=()=>x.useContext(tt),st=(e,t,s)=>{const r=s?.state.error&&typeof e.throwOnError=="function"?oe(e.throwOnError,[s.state.error,s]):e.throwOnError;(e.suspense||e.experimental_prefetchInRender||r)&&(t.isReset()||(e.retryOnMount=!1))},nt=e=>{x.useEffect(()=>{e.clearReset()},[e])},it=({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||oe(s,[e.error,r])),at=e=>{if(e.suspense){const s=i=>i==="static"?i:Math.max(i??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...i)=>s(r(...i)):s(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},ot=(e,t)=>e.isLoading&&e.isFetching&&!t,ct=(e,t)=>e?.suspense&&t.isPending,be=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function lt(e,t,s){const r=Ze(),i=rt(),o=Oe(),a=o.defaultQueryOptions(e);o.getDefaultOptions().queries?._experimental_beforeQuery?.(a);const c=o.getQueryCache().get(a.queryHash);a._optimisticResults=r?"isRestoring":"optimistic",at(a),st(a,i,c),nt(i);const l=!o.getQueryCache().get(a.queryHash),[u]=x.useState(()=>new t(o,a)),d=u.getOptimisticResult(a),f=!r&&e.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(h=>{const p=f?u.subscribe(ee.batchCalls(h)):X;return u.updateResult(),p},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),x.useEffect(()=>{u.setOptions(a)},[a,u]),ct(a,d))throw be(a,u,i);if(it({result:d,errorResetBoundary:i,throwOnError:a.throwOnError,query:c,suspense:a.suspense}))throw d.error;return o.getDefaultOptions().queries?._experimental_afterQuery?.(a,d),a.experimental_prefetchInRender&&!se&&ot(d,r)&&(l?be(a,u,i):c?.promise)?.catch(X).finally(()=>{u.updateResult()}),a.notifyOnChangeProps?d:u.trackResult(d)}function ut(e,t){return lt(e,Ve)}function dt(e,t){const s=Oe(),[r]=x.useState(()=>new Xe(s,e));x.useEffect(()=>{r.setOptions(e)},[r,e]);const i=x.useSyncExternalStore(x.useCallback(a=>r.subscribe(ee.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),o=x.useCallback((a,c)=>{r.mutate(a,c).catch(X)},[r]);if(i.error&&oe(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:o,mutateAsync:i.mutate}}const ht=({position:e,email:t,onReset:s})=>n.jsxs("div",{className:"mx-auto max-w-md text-center py-12 px-4",children:[n.jsx("div",{className:"mb-6 text-6xl",children:"ðŸŽ‰"}),n.jsx("h2",{className:"text-2xl font-bold text-foreground mb-3",children:"You're in!"}),n.jsxs("p",{className:"text-muted-foreground mb-2",children:["We've registered ",n.jsx("span",{className:"font-medium text-foreground",children:t})," for early access."]}),n.jsxs("div",{className:"my-6 rounded-xl bg-primary/10 p-6",children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Your position in your area"}),n.jsxs("p",{className:"text-4xl font-bold text-primary",children:["#",e]})]}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"We'll email you when TCG Trade Hub launches in your area. Your card listing will be ready to go on day one."}),n.jsx("button",{type:"button",onClick:s,className:"text-sm text-primary hover:underline",children:"Register another email"})]}),ft=({children:e,className:t})=>n.jsxs("div",{className:`mx-auto flex w-full max-w-[420px] flex-col overflow-hidden rounded-[2.5rem] border-2 border-border bg-background shadow-2xl ${t??"h-[85vh] max-h-[800px]"}`,children:[n.jsxs("div",{className:"flex items-center justify-between px-8 pb-1 pt-3 text-xs text-muted-foreground",children:[n.jsx("span",{children:"9:41"}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:n.jsx("path",{d:"M1 9l2 2c4.97-4.97 13.03-4.97 18 0l2-2C16.93 2.93 7.08 2.93 1 9zm8 8l3 3 3-3a4.237 4.237 0 00-6 0zm-4-4l2 2a7.074 7.074 0 0110 0l2-2C15.14 9.14 8.87 9.14 5 13z"})}),n.jsx("svg",{className:"h-3.5 w-3.5",viewBox:"0 0 24 24",fill:"currentColor",children:n.jsx("path",{d:"M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4z"})})]})]}),n.jsx("div",{className:"flex flex-1 flex-col overflow-hidden",children:e})]}),mt=({name:e})=>n.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[n.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-primary text-sm font-bold text-primary-foreground",children:e==="TCG Trade Hub"?"TH":e.charAt(0).toUpperCase()}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-semibold text-foreground",children:e}),n.jsx("p",{className:"text-xs text-success",children:"Online"})]})]}),pt=({text:e,sender:t})=>{const s=t==="own";return n.jsx("div",{className:`flex ${s?"justify-end":"justify-start"}`,children:n.jsx("div",{className:`max-w-[80%] rounded-2xl px-4 py-2.5 text-sm ${s?"rounded-br-md bg-primary text-primary-foreground":"rounded-bl-md bg-secondary text-foreground"}`,children:e})})},xt=({text:e})=>n.jsx("div",{className:"flex justify-center px-4",children:n.jsx("p",{className:"rounded-full bg-secondary/60 px-4 py-1.5 text-center text-xs text-muted-foreground",children:e})}),yt=({onBuildList:e})=>n.jsxs("div",{className:"rounded-xl border border-border bg-card overflow-hidden",children:[n.jsxs("div",{className:"bg-primary/10 px-4 py-2.5 flex items-center gap-2",children:[n.jsx("span",{className:"text-sm",children:"ðŸŽ¯"}),n.jsx("p",{className:"text-xs font-semibold text-primary",children:"Reserve Your Spot"})]}),n.jsxs("div",{className:"space-y-4 p-4",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Be first to trade when we launch in your area."}),n.jsxs("ul",{className:"space-y-2",children:[n.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[n.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),n.jsx("span",{children:"Pick the cards you want"})]}),n.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[n.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),n.jsx("span",{children:"Get matched with local traders who have them"})]}),n.jsxs("li",{className:"flex items-start gap-2 text-xs text-foreground",children:[n.jsx("span",{className:"text-success mt-0.5",children:"âœ“"}),n.jsx("span",{children:"First access at launch"})]})]}),n.jsx("button",{type:"button",onClick:e,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90",children:"Build Your List"})]})]});function gt(e){return e[0]??{}}function K(e){return Array.isArray(e)?e:e==null?[]:[e]}const we="orpc",vt="@orpc/shared",bt="1.13.5";class wt extends Error{constructor(...t){super(...t),this.name="AbortError"}}function Nt(e){let t;return()=>{if(t)return t.result;const s=e();return t={result:s},s}}function Et(e){let t=Promise.resolve();return(...s)=>t=t.catch(()=>{}).then(()=>e(...s))}const jt=2,St=`__${vt}@${bt}/otel/config__`;function te(){return globalThis[St]}function le(e,t={},s){return te()?.tracer?.startSpan(e,t,s)}function _(e,t,s={}){if(!e)return;const r=Rt(t);e.recordException(r),(!s.signal?.aborted||s.signal.reason!==t)&&e.setStatus({code:jt,message:r.message})}function Rt(e){if(e instanceof Error){const t={message:e.message,name:e.name,stack:e.stack};return"code"in e&&(typeof e.code=="string"||typeof e.code=="number")&&(t.code=e.code),t}return{message:String(e)}}async function F({name:e,context:t,...s},r){const i=te()?.tracer;if(!i)return r();const o=async a=>{try{return await r(a)}catch(c){throw _(a,c,s),c}finally{a.end()}};return t?i.startActiveSpan(e,s,t,o):i.startActiveSpan(e,s,o)}async function A(e,t){const s=te();if(!e||!s)return t();const r=s.trace.setSpan(s.context.active(),e);return s.context.with(r,t)}function O(e){return!e||typeof e!="object"?!1:"next"in e&&typeof e.next=="function"&&Symbol.asyncIterator in e&&typeof e[Symbol.asyncIterator]=="function"}const Ct=Symbol.for("asyncDispose"),Ot=Symbol.asyncDispose??Ct;class ue{#t=!1;#e=!1;#s;#r;constructor(t,s){this.#s=s,this.#r=Et(async()=>{if(this.#t)return{done:!0,value:void 0};try{const r=await t();return r.done&&(this.#t=!0),r}catch(r){throw this.#t=!0,r}finally{this.#t&&!this.#e&&(this.#e=!0,await this.#s("next"))}})}next(){return this.#r()}async return(t){return this.#t=!0,this.#e||(this.#e=!0,await this.#s("return")),{done:!0,value:t}}async throw(t){throw this.#t=!0,this.#e||(this.#e=!0,await this.#s("throw")),t}async[Ot](){this.#t=!0,this.#e||(this.#e=!0,await this.#s("dispose"))}[Symbol.asyncIterator](){return this}}function Ne({name:e,...t},s){let r;return new ue(async()=>{r??=le(e);try{const i=await A(r,()=>s.next());return r?.addEvent(i.done?"completed":"yielded"),i}catch(i){throw _(r,i,t),i}},async i=>{try{i!=="next"&&await A(r,()=>s.return?.())}catch(o){throw _(r,o,t),o}finally{r?.end()}})}function ie(e,t,s){const r=(i,o)=>{const a=e[o];return a?a({...i,next:(c=i)=>r(c,o+1)}):s(i)};return r(t,0)}function Y(e){if(e)return JSON.parse(e)}function M(e){return JSON.stringify(e)}function _t(e){return T(e)?Object.getPrototypeOf(e)?.constructor:null}function Te(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||!t||!t.constructor}function T(e){return!!e&&(typeof e=="object"||typeof e=="function")}function Tt(e,t){let s=e;for(const r of t){if(!T(s))return;s=s[r]}return s}function H(e,...t){return typeof e=="function"?e(...t):e}function ke(e){return new Proxy(e,{get(t,s,r){const i=Reflect.get(t,s,r);return s!=="then"||typeof i!="function"?i:new Proxy(i,{apply(o,a,c){if(c.length!==2||c.some(u=>!Pt(u)))return Reflect.apply(o,a,c);let l=!0;c[0].call(a,ke(new Proxy(t,{get:(u,d,f)=>{if(l&&d==="then"){l=!1;return}return Reflect.get(u,d,f)}})))}})}})}const kt=/^\s*function\s*\(\)\s*\{\s*\[native code\]\s*\}\s*$/;function Pt(e){return typeof e=="function"&&kt.test(e.toString())}function At(e){try{return decodeURIComponent(e)}catch{return e}}const Mt="@orpc/client",It="1.13.5",de={BAD_REQUEST:{status:400,message:"Bad Request"},UNAUTHORIZED:{status:401,message:"Unauthorized"},FORBIDDEN:{status:403,message:"Forbidden"},NOT_FOUND:{status:404,message:"Not Found"},METHOD_NOT_SUPPORTED:{status:405,message:"Method Not Supported"},NOT_ACCEPTABLE:{status:406,message:"Not Acceptable"},TIMEOUT:{status:408,message:"Request Timeout"},CONFLICT:{status:409,message:"Conflict"},PRECONDITION_FAILED:{status:412,message:"Precondition Failed"},PAYLOAD_TOO_LARGE:{status:413,message:"Payload Too Large"},UNSUPPORTED_MEDIA_TYPE:{status:415,message:"Unsupported Media Type"},UNPROCESSABLE_CONTENT:{status:422,message:"Unprocessable Content"},TOO_MANY_REQUESTS:{status:429,message:"Too Many Requests"},CLIENT_CLOSED_REQUEST:{status:499,message:"Client Closed Request"},INTERNAL_SERVER_ERROR:{status:500,message:"Internal Server Error"},NOT_IMPLEMENTED:{status:501,message:"Not Implemented"},BAD_GATEWAY:{status:502,message:"Bad Gateway"},SERVICE_UNAVAILABLE:{status:503,message:"Service Unavailable"},GATEWAY_TIMEOUT:{status:504,message:"Gateway Timeout"}};function Ut(e,t){return t??de[e]?.status??500}function Dt(e,t){return t||de[e]?.message||e}const Pe=Symbol.for(`__${Mt}@${It}/error/ORPC_ERROR_CONSTRUCTORS__`);globalThis[Pe]??=new WeakSet;const ae=globalThis[Pe];class z extends Error{defined;code;status;data;constructor(t,...s){const r=gt(s);if(r.status!==void 0&&!he(r.status))throw new Error("[ORPCError] Invalid error status code.");const i=Dt(t,r.message);super(i,r),this.code=t,this.status=Ut(t,r.status),this.defined=r.defined??!1,this.data=r.data}toJSON(){return{defined:this.defined,code:this.code,status:this.status,message:this.message,data:this.data}}static[Symbol.hasInstance](t){if(ae.has(this)){const s=_t(t);if(s&&ae.has(s))return!0}return super[Symbol.hasInstance](t)}}ae.add(z);function Ft(e){return e instanceof z?e:new z("INTERNAL_SERVER_ERROR",{message:"Internal server error",cause:e})}function he(e){return e<200||e>=400}function Ae(e){if(!Te(e))return!1;const t=["defined","code","status","message","data"];return Object.keys(e).some(s=>!t.includes(s))?!1:"defined"in e&&typeof e.defined=="boolean"&&"code"in e&&typeof e.code=="string"&&"status"in e&&typeof e.status=="number"&&he(e.status)&&"message"in e&&typeof e.message=="string"}function Me(e,t={}){return new z(e.code,{...t,...e})}class re extends TypeError{}class Lt extends TypeError{}class P extends Error{data;constructor(t){super(t?.message??"An error event was received",t),this.data=t?.data}}function qt(e){const t=e.replace(/\n+$/,"").split(/\n/),s={data:void 0,event:void 0,id:void 0,retry:void 0,comments:[]};for(const r of t){const i=r.indexOf(":"),o=i===-1?r:r.slice(0,i),a=i===-1?"":r.slice(i+1).replace(/^\s/,"");if(i===0)s.comments.push(a);else if(o==="data")s.data??="",s.data+=`${a}
`;else if(o==="event")s.event=a;else if(o==="id")s.id=a;else if(o==="retry"){const c=Number.parseInt(a);Number.isInteger(c)&&c>=0&&c.toString()===a&&(s.retry=c)}}return s.data=s.data?.replace(/\n$/,""),s}class Kt{constructor(t={}){this.options=t}incomplete="";feed(t){this.incomplete+=t;const s=this.incomplete.lastIndexOf(`

`);if(s===-1)return;const r=this.incomplete.slice(0,s).split(/\n\n/);this.incomplete=this.incomplete.slice(s+2);for(const i of r){const o=qt(`${i}

`);this.options.onEvent&&this.options.onEvent(o)}}end(){if(this.incomplete)throw new Lt("Event Iterator ended before complete")}}class zt extends TransformStream{constructor(){let t;super({start(s){t=new Kt({onEvent:r=>{s.enqueue(r)}})},transform(s){t.feed(s)},flush(){t.end()}})}}function Ie(e){if(e.includes(`
`))throw new re("Event's id must not contain a newline character")}function $t(e){if(e.includes(`
`))throw new re("Event's event must not contain a newline character")}function Ue(e){if(!Number.isInteger(e)||e<0)throw new re("Event's retry must be a integer and >= 0")}function De(e){if(e.includes(`
`))throw new re("Event's comment must not contain a newline character")}function Bt(e){const t=e?.split(/\n/)??[];let s="";for(const r of t)s+=`data: ${r}
`;return s}function Qt(e){let t="";for(const s of e??[])De(s),t+=`: ${s}
`;return t}function V(e){let t="";return t+=Qt(e.comments),e.event!==void 0&&($t(e.event),t+=`event: ${e.event}
`),e.retry!==void 0&&(Ue(e.retry),t+=`retry: ${e.retry}
`),e.id!==void 0&&(Ie(e.id),t+=`id: ${e.id}
`),t+=Bt(e.data),t+=`
`,t}const Fe=Symbol("ORPC_EVENT_SOURCE_META");function q(e,t){if(t.id===void 0&&t.retry===void 0&&!t.comments?.length)return e;if(t.id!==void 0&&Ie(t.id),t.retry!==void 0&&Ue(t.retry),t.comments!==void 0)for(const s of t.comments)De(s);return new Proxy(e,{get(s,r,i){return r===Fe?t:Reflect.get(s,r,i)}})}function Z(e){return T(e)?Reflect.get(e,Fe):void 0}function Gt(e){const t=e.replace(/"/g,'\\"'),s=encodeURIComponent(e).replace(/['()*]/g,r=>`%${r.charCodeAt(0).toString(16).toUpperCase()}`).replace(/%(7C|60|5E)/g,(r,i)=>String.fromCharCode(Number.parseInt(i,16)));return`inline; filename="${t}"; filename*=utf-8''${s}`}function Wt(e){const t=e.match(/filename\*=(UTF-8'')?([^;]*)/i);if(t&&typeof t[2]=="string")return At(t[2]);const s=e.match(/filename="((?:\\"|[^"])*)"/i);if(s&&typeof s[1]=="string")return s[1].replace(/\\"/g,'"')}function Ht(e,t){const s={...e};for(const r in t)Array.isArray(t[r])?s[r]=[...K(s[r]),...t[r]]:t[r]!==void 0&&(Array.isArray(s[r])?s[r]=[...s[r],t[r]]:s[r]!==void 0?s[r]=[s[r],t[r]]:s[r]=t[r]);return s}function Ee(e,t){const s=async r=>{let i=await t.error(r);if(i!==r){const o=Z(r);o&&T(i)&&(i=q(i,o))}return i};return new ue(async()=>{const{done:r,value:i}=await(async()=>{try{return await e.next()}catch(a){throw await s(a)}})();let o=await t.value(i,r);if(o!==i){const a=Z(i);a&&T(o)&&(o=q(o,a))}return{done:r,value:o}},async()=>{try{await e.return?.()}catch(r){throw await s(r)}})}function Vt(e){return{...e,context:e.context??{}}}function Le(e,t={}){const s=t.path??[],r=async(...[o,a={}])=>await e.call(s,o,Vt(a)),i=new Proxy(r,{get(o,a){return typeof a!="string"?Reflect.get(o,a):Le(e,{...t,path:[...s,a]})}});return ke(i)}function Yt(e,t={}){const r=e?.pipeThrough(new TextDecoderStream).pipeThrough(new zt)?.getReader();let i,o=!1;return new ue(async()=>{i??=le("consume_event_iterator_stream");try{for(;;){if(r===void 0)return{done:!0,value:void 0};const{done:a,value:c}=await A(i,()=>r.read());if(a){if(o)throw new wt("Stream was cancelled");return{done:!0,value:void 0}}switch(c.event){case"message":{let l=Y(c.data);return T(l)&&(l=q(l,c)),i?.addEvent("message"),{done:!1,value:l}}case"error":{let l=new P({data:Y(c.data)});throw l=q(l,c),i?.addEvent("error"),l}case"done":{let l=Y(c.data);return T(l)&&(l=q(l,c)),i?.addEvent("done"),{done:!0,value:l}}default:i?.addEvent("maybe_keepalive")}}}catch(a){throw a instanceof P||_(i,a,t),a}},async a=>{try{a!=="next"&&(o=!0,i?.addEvent("cancelled")),await A(i,()=>r?.cancel())}catch(c){throw _(i,c,t),c}finally{i?.end()}})}function Jt(e,t={}){const s=t.eventIteratorKeepAliveEnabled??!0,r=t.eventIteratorKeepAliveInterval??5e3,i=t.eventIteratorKeepAliveComment??"",o=t.eventIteratorInitialCommentEnabled??!0,a=t.eventIteratorInitialComment??"";let c=!1,l,u;return new ReadableStream({start(f){u=le("stream_event_iterator"),o&&f.enqueue(V({comments:[a]}))},async pull(f){try{s&&(l=setInterval(()=>{f.enqueue(V({comments:[i]})),u?.addEvent("keepalive")},r));const h=await A(u,()=>e.next());if(clearInterval(l),c)return;const p=Z(h.value);if(!h.done||h.value!==void 0||p!==void 0){const y=h.done?"done":"message";f.enqueue(V({...p,event:y,data:M(h.value)})),u?.addEvent(y)}h.done&&(f.close(),u?.end())}catch(h){if(clearInterval(l),c)return;h instanceof P?(f.enqueue(V({...Z(h),event:"error",data:M(h.data)})),u?.addEvent("error"),f.close()):(_(u,h),f.error(h)),u?.end()}},async cancel(){try{c=!0,clearInterval(l),u?.addEvent("cancelled"),await A(u,()=>e.return?.())}catch(f){throw _(u,f),f}finally{u?.end()}}}).pipeThrough(new TextEncoderStream)}function Xt(e,t={}){return F({name:"parse_standard_body",signal:t.signal},async()=>{const s=e.headers.get("content-disposition");if(typeof s=="string"){const o=Wt(s)??"blob",a=await e.blob();return new File([a],o,{type:a.type})}const r=e.headers.get("content-type");if(!r||r.startsWith("application/json")){const o=await e.text();return Y(o)}if(r.startsWith("multipart/form-data"))return await e.formData();if(r.startsWith("application/x-www-form-urlencoded")){const o=await e.text();return new URLSearchParams(o)}if(r.startsWith("text/event-stream"))return Yt(e.body,t);if(r.startsWith("text/plain"))return await e.text();const i=await e.blob();return new File([i],"blob",{type:i.type})})}function Zt(e,t,s={}){const r=t.get("content-disposition");if(t.delete("content-type"),t.delete("content-disposition"),e!==void 0)return e instanceof Blob?(t.set("content-type",e.type),t.set("content-length",e.size.toString()),t.set("content-disposition",r??Gt(e instanceof File?e.name:"blob")),e):e instanceof FormData||e instanceof URLSearchParams?e:O(e)?(t.set("content-type","text/event-stream"),Jt(e,s)):(t.set("content-type","application/json"),M(e))}function qe(e,t={}){return e.forEach((s,r)=>{Array.isArray(t[r])?t[r].push(s):t[r]!==void 0?t[r]=[t[r],s]:t[r]=s}),t}function er(e,t=new Headers){for(const[s,r]of Object.entries(e))if(Array.isArray(r))for(const i of r)t.append(s,i);else r!==void 0&&t.append(s,r);return t}function tr(e,t={}){const s=er(e.headers),r=Zt(e.body,s,t);return new Request(e.url,{signal:e.signal,method:e.method,headers:s,body:r})}function rr(e,t={}){return{body:Nt(()=>Xt(e,t)),status:e.status,get headers(){const s=qe(e.headers);return Object.defineProperty(this,"headers",{value:s,writable:!0}),s},set headers(s){Object.defineProperty(this,"headers",{value:s,writable:!0})}}}class Ke{plugins;constructor(t=[]){this.plugins=[...t].sort((s,r)=>(s.order??0)-(r.order??0))}init(t){for(const s of this.plugins)s.init?.(t)}}class sr{constructor(t,s,r={}){this.codec=t,this.sender=s,new Ke(r.plugins).init(r),this.interceptors=K(r.interceptors),this.clientInterceptors=K(r.clientInterceptors)}interceptors;clientInterceptors;call(t,s,r){return F({name:`${we}.${t.join("/")}`,signal:r.signal},i=>(i?.setAttribute("rpc.system",we),i?.setAttribute("rpc.method",t.join(".")),O(s)&&(s=Ne({name:"consume_event_iterator_input",signal:r.signal},s)),ie(this.interceptors,{...r,path:t,input:s},async({path:o,input:a,...c})=>{const l=te();let u;const d=l?.trace.getActiveSpan()??i;d&&l&&(u=l?.trace.setSpan(l.context.active(),d));const f=await F({name:"encode_request",context:u},()=>this.codec.encode(o,a,c)),h=await ie(this.clientInterceptors,{...c,input:a,path:o,request:f},({input:y,path:m,request:w,...v})=>F({name:"send_request",signal:v.signal,context:u},()=>this.sender.call(w,v,m,y))),p=await F({name:"decode_response",context:u},()=>this.codec.decode(h,c,o,a));return O(p)?Ne({name:"consume_event_iterator_output",signal:c.signal},p):p})))}}const b={BIGINT:0,DATE:1,NAN:2,UNDEFINED:3,URL:4,REGEXP:5,SET:6,MAP:7};class nr{customSerializers;constructor(t={}){if(this.customSerializers=t.customJsonSerializers??[],this.customSerializers.length!==new Set(this.customSerializers.map(s=>s.type)).size)throw new Error("Custom serializer type must be unique.")}serialize(t,s=[],r=[],i=[],o=[]){for(const a of this.customSerializers)if(a.condition(t)){const c=this.serialize(a.serialize(t),s,r,i,o);return r.push([a.type,...s]),c}if(t instanceof Blob)return i.push(s),o.push(t),[t,r,i,o];if(typeof t=="bigint")return r.push([b.BIGINT,...s]),[t.toString(),r,i,o];if(t instanceof Date)return r.push([b.DATE,...s]),Number.isNaN(t.getTime())?[null,r,i,o]:[t.toISOString(),r,i,o];if(Number.isNaN(t))return r.push([b.NAN,...s]),[null,r,i,o];if(t instanceof URL)return r.push([b.URL,...s]),[t.toString(),r,i,o];if(t instanceof RegExp)return r.push([b.REGEXP,...s]),[t.toString(),r,i,o];if(t instanceof Set){const a=this.serialize(Array.from(t),s,r,i,o);return r.push([b.SET,...s]),a}if(t instanceof Map){const a=this.serialize(Array.from(t.entries()),s,r,i,o);return r.push([b.MAP,...s]),a}if(Array.isArray(t))return[t.map((c,l)=>c===void 0?(r.push([b.UNDEFINED,...s,l]),c):this.serialize(c,[...s,l],r,i,o)[0]),r,i,o];if(Te(t)){const a={};for(const c in t)c==="toJSON"&&typeof t[c]=="function"||(a[c]=this.serialize(t[c],[...s,c],r,i,o)[0]);return[a,r,i,o]}return[t,r,i,o]}deserialize(t,s,r,i){const o={data:t};r&&i&&r.forEach((a,c)=>{let l=o,u="data";a.forEach(d=>{l=l[u],u=d}),l[u]=i(c)});for(const a of s){const c=a[0];let l=o,u="data";for(let d=1;d<a.length;d++)l=l[u],u=a[d];for(const d of this.customSerializers)if(d.type===c){l[u]=d.deserialize(l[u]);break}switch(c){case b.BIGINT:l[u]=BigInt(l[u]);break;case b.DATE:l[u]=new Date(l[u]??"Invalid Date");break;case b.NAN:l[u]=Number.NaN;break;case b.UNDEFINED:l[u]=void 0;break;case b.URL:l[u]=new URL(l[u]);break;case b.REGEXP:{const[,d,f]=l[u].match(/^\/(.*)\/([a-z]*)$/);l[u]=new RegExp(d,f);break}case b.SET:l[u]=new Set(l[u]);break;case b.MAP:l[u]=new Map(l[u]);break}}return o.data}}function ir(e){return`/${e.map(encodeURIComponent).join("/")}`}function ar(e){return typeof e.forEach=="function"?qe(e):e}function or(e){return Object.entries(de).find(([,t])=>t.status===e)?.[0]??"MALFORMED_ORPC_ERROR_RESPONSE"}class cr{constructor(t,s){this.serializer=t,this.baseUrl=s.url,this.maxUrlLength=s.maxUrlLength??2083,this.fallbackMethod=s.fallbackMethod??"POST",this.expectedMethod=s.method??this.fallbackMethod,this.headers=s.headers??{}}baseUrl;maxUrlLength;fallbackMethod;expectedMethod;headers;async encode(t,s,r){let i=ar(await H(this.headers,r,t,s));r.lastEventId!==void 0&&(i=Ht(i,{"last-event-id":r.lastEventId}));const o=await H(this.expectedMethod,r,t,s),a=await H(this.baseUrl,r,t,s),c=new URL(a);c.pathname=`${c.pathname.replace(/\/$/,"")}${ir(t)}`;const l=this.serializer.serialize(s);if(o==="GET"&&!(l instanceof FormData)&&!O(l)){const u=await H(this.maxUrlLength,r,t,s),d=new URL(c);if(d.searchParams.append("data",M(l)),d.toString().length<=u)return{body:void 0,method:o,headers:i,url:d,signal:r.signal}}return{url:c,method:o==="GET"?this.fallbackMethod:o,headers:i,body:l,signal:r.signal}}async decode(t){const s=!he(t.status),r=await(async()=>{let i=!1;try{const o=await t.body();return i=!0,this.serializer.deserialize(o)}catch(o){throw i?new Error("Invalid RPC response format.",{cause:o}):new Error("Cannot parse response body, please check the response body and content-type.",{cause:o})}})();if(!s)throw Ae(r)?Me(r):new z(or(t.status),{status:t.status,data:{...t,body:r}});return r}}class lr{constructor(t){this.jsonSerializer=t}serialize(t){return O(t)?Ee(t,{value:async s=>this.#t(s,!1),error:async s=>new P({data:this.#t(Ft(s).toJSON(),!1),cause:s})}):this.#t(t,!0)}#t(t,s){const[r,i,o,a]=this.jsonSerializer.serialize(t),c=i.length===0?void 0:i;if(!s||a.length===0)return{json:r,meta:c};const l=new FormData;return l.set("data",M({json:r,meta:c,maps:o})),a.forEach((u,d)=>{l.set(d.toString(),u)}),l}deserialize(t){return O(t)?Ee(t,{value:async s=>this.#e(s),error:async s=>{if(!(s instanceof P))return s;const r=this.#e(s.data);return Ae(r)?Me(r,{cause:s}):new P({data:r,cause:s})}}):this.#e(t)}#e(t){if(t===void 0)return;if(!(t instanceof FormData))return this.jsonSerializer.deserialize(t.json,t.meta??[]);const s=JSON.parse(t.get("data"));return this.jsonSerializer.deserialize(s.json,s.meta??[],s.maps,r=>t.get(r.toString()))}}class ur extends sr{constructor(t,s){const r=new nr(s),i=new lr(r),o=new cr(i,s);super(o,t,s)}}class dr extends Ke{initRuntimeAdapter(t){for(const s of this.plugins)s.initRuntimeAdapter?.(t)}}class hr{fetch;toFetchRequestOptions;adapterInterceptors;constructor(t){new dr(t.plugins).initRuntimeAdapter(t),this.fetch=t.fetch??globalThis.fetch.bind(globalThis),this.toFetchRequestOptions=t,this.adapterInterceptors=K(t.adapterInterceptors)}async call(t,s,r,i){const o=tr(t,this.toFetchRequestOptions),a=await ie(this.adapterInterceptors,{...s,request:o,path:r,input:i,init:{redirect:"manual"}},({request:l,path:u,input:d,init:f,...h})=>this.fetch(l,f,h,u,d));return rr(a,{signal:o.signal})}}class fr extends ur{constructor(t){const s=new hr(t);super(s,t)}}function k(e,t={}){return[e,{...t.input!==void 0?{input:t.input}:{},...t.type!==void 0?{type:t.type}:{},...t.fnOptions!==void 0?{fnOptions:t.fnOptions}:{}}]}function mr(e){return{key(t){return k(e,t)}}}function pr(e){return async t=>{const s=await e(t);let r;for await(const i of s){if(t.signal.aborted)throw t.signal.reason;r={chunk:i},t.client.setQueryData(t.queryKey,i)}if(!r)throw new Error(`Live query for ${M(t.queryKey)} did not yield any data. Ensure the query function returns an AsyncIterable with at least one chunk.`);return r.chunk}}function xr(e,{refetchMode:t="reset",maxChunks:s=Number.POSITIVE_INFINITY}={}){return async r=>{const i=r.client.getQueryCache().find({queryKey:r.queryKey,exact:!0}),o=!!i&&i.state.data!==void 0;o&&(t==="reset"?i.setState({status:"pending",data:void 0,error:null,fetchStatus:"fetching"}):r.client.setQueryData(r.queryKey,(d=[])=>U(d,s)));let a=[];const c=await e(r),l=!o||t!=="replace";r.client.setQueryData(r.queryKey,(d=[])=>U(d,s));for await(const d of c){if(r.signal.aborted)throw r.signal.reason;a.push(d),a=U(a,s),l&&r.client.setQueryData(r.queryKey,(f=[])=>U([...f,d],s))}l||r.client.setQueryData(r.queryKey,a);const u=r.client.getQueryData(r.queryKey);return u?U(u,s):a}}function U(e,t){return e.length<=t?e:e.slice(e.length-t)}const D=Symbol("ORPC_OPERATION_CONTEXT");function yr(e,t){const s={call:e,queryKey(...[r={}]){return r={...t.experimental_defaults?.queryKey,...r},r.queryKey??k(t.path,{type:"query",input:r.input})},queryOptions(...[r={}]){r={...t.experimental_defaults?.queryOptions,...r};const i=s.queryKey(r);return{queryFn:({signal:o})=>{if(r.input===S)throw new Error("queryFn should not be called with skipToken used as input");return e(r.input,{signal:o,context:{[D]:{key:i,type:"query"},...r.context}})},...r.input===S?{enabled:!1}:{},...r,queryKey:i}},experimental_streamedKey(...[r={}]){return r={...t.experimental_defaults?.experimental_streamedKey,...r},r.queryKey??k(t.path,{type:"streamed",input:r.input,fnOptions:r.queryFnOptions})},experimental_streamedOptions(...[r={}]){r={...t.experimental_defaults?.experimental_streamedOptions,...r};const i=s.experimental_streamedKey(r);return{queryFn:xr(async({signal:o})=>{if(r.input===S)throw new Error("queryFn should not be called with skipToken used as input");const a=await e(r.input,{signal:o,context:{[D]:{key:i,type:"streamed"},...r.context}});if(!O(a))throw new Error("streamedQuery requires an event iterator output");return a},r.queryFnOptions),...r.input===S?{enabled:!1}:{},...r,queryKey:i}},experimental_liveKey(...[r={}]){return r={...t.experimental_defaults?.experimental_liveKey,...r},r.queryKey??k(t.path,{type:"live",input:r.input})},experimental_liveOptions(...[r={}]){r={...t.experimental_defaults?.experimental_liveOptions,...r};const i=s.experimental_liveKey(r);return{queryFn:pr(async({signal:o})=>{if(r.input===S)throw new Error("queryFn should not be called with skipToken used as input");const a=await e(r.input,{signal:o,context:{[D]:{key:i,type:"live"},...r.context}});if(!O(a))throw new Error("liveQuery requires an event iterator output");return a}),...r.input===S?{enabled:!1}:{},...r,queryKey:i}},infiniteKey(r){return r={...t.experimental_defaults?.infiniteKey,...r},r.queryKey??k(t.path,{type:"infinite",input:r.input===S?S:r.input(r.initialPageParam)})},infiniteOptions(r){r={...t.experimental_defaults?.infiniteOptions,...r};const i=s.infiniteKey(r);return{queryFn:({pageParam:o,signal:a})=>{if(r.input===S)throw new Error("queryFn should not be called with skipToken used as input");return e(r.input(o),{signal:a,context:{[D]:{key:i,type:"infinite"},...r.context}})},...r.input===S?{enabled:!1}:{},...r,queryKey:i}},mutationKey(...[r={}]){return r={...t.experimental_defaults?.mutationKey,...r},r.mutationKey??k(t.path,{type:"mutation"})},mutationOptions(...[r={}]){r={...t.experimental_defaults?.mutationOptions,...r};const i=s.mutationKey(r);return{mutationFn:o=>e(o,{context:{[D]:{key:i,type:"mutation"},...r.context}}),...r,mutationKey:i}}};return s}function ze(e,t={}){const s=K(t.path),r=mr(s),i=yr(e,{path:s,experimental_defaults:t.experimental_defaults});return new Proxy({...r,...i},{get(a,c){const l=Reflect.get(a,c);if(typeof c!="string")return l;const u=ze(e[c],{...t,path:[...s,c],experimental_defaults:Tt(t.experimental_defaults,[c])});return typeof l!="function"?u:new Proxy(l,{get(d,f){return Reflect.get(u,f)}})}})}const gr=new fr({url:typeof window<"u"?`${window.location.origin}/api/rpc`:"http://localhost:3000/api/rpc"}),vr=Le(gr),$e=ze(vr),br=({tcg:e,onSelect:t,selectedCard:s,onClear:r,onAddCustomText:i})=>{const[o,a]=x.useState(""),[c,l]=x.useState(""),[u,d]=x.useState(!1),f=x.useRef(null);x.useEffect(()=>{const m=setTimeout(()=>l(o),300);return()=>clearTimeout(m)},[o]),x.useEffect(()=>{const m=w=>{f.current&&!f.current.contains(w.target)&&d(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const{data:h=[],isFetching:p}=ut({...$e.card.search.queryOptions({input:{query:c,tcg:e}}),enabled:c.length>=2}),y=m=>{t(m),a(""),d(!1)};return s?n.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-secondary/50 p-3",children:[s.imageUrl?n.jsx("img",{src:s.imageUrl,alt:s.name,className:"h-16 w-12 rounded object-cover"}):n.jsx("div",{className:"h-16 w-12 rounded bg-muted flex items-center justify-center",children:n.jsx("span",{className:"text-[10px] text-muted-foreground",children:"No img"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-foreground truncate",children:s.name}),n.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:[s.setName,s.rarity&&s.rarity!=="Unknown"&&` Â· ${s.rarity}`]})]}),n.jsx("button",{type:"button",onClick:r,className:"shrink-0 text-sm text-muted-foreground hover:text-foreground",children:"Change"})]}):n.jsxs("div",{ref:f,className:"relative",children:[n.jsx("input",{type:"text",value:o,onChange:m=>{a(m.target.value),d(!0)},onFocus:()=>o.length>=2&&d(!0),placeholder:"Search for a card...",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"}),p&&n.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:n.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary border-t-transparent"})}),u&&h.length>0&&n.jsx("ul",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card shadow-lg max-h-64 overflow-y-auto",children:h.map(m=>n.jsx("li",{children:n.jsxs("button",{type:"button",onClick:()=>y(m),className:"flex w-full items-center gap-3 px-3 py-2 text-left hover:bg-accent transition-colors",children:[m.imageUrl?n.jsx("img",{src:m.imageUrl,alt:m.name,className:"h-12 w-9 rounded object-cover"}):n.jsx("div",{className:"h-12 w-9 rounded bg-muted flex items-center justify-center",children:n.jsx("span",{className:"text-[8px] text-muted-foreground",children:"No img"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:m.name}),n.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:[m.setName,m.rarity&&m.rarity!=="Unknown"&&` Â· ${m.rarity}`,m.marketPrice!=null&&` Â· $${m.marketPrice.toFixed(2)}`]})]})]})},m.externalId))}),u&&c.length>=2&&!p&&h.length===0&&n.jsx("div",{className:"absolute z-10 mt-1 w-full rounded-lg border border-border bg-card shadow-lg",children:i?n.jsxs("button",{type:"button",onClick:()=>{i(o),a(""),d(!1)},className:"flex w-full items-center gap-2 px-4 py-3 text-left text-sm hover:bg-accent transition-colors",children:[n.jsx("svg",{className:"h-4 w-4 shrink-0 text-primary",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("path",{d:"M12 5v14M5 12h14"})}),n.jsxs("span",{className:"text-foreground",children:["Add â€˜",n.jsx("span",{className:"font-medium",children:o}),"â€™ as custom item"]})]}):n.jsx("p",{className:"p-4 text-center text-sm text-muted-foreground",children:"No cards found"})})]})},wr=({card:e,onRemove:t})=>n.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5",children:[n.jsx("img",{src:e.imageUrl,alt:e.name,className:"h-12 w-9 shrink-0 rounded object-cover shadow-sm"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("p",{className:"text-xs font-semibold text-foreground truncate leading-tight",children:e.name}),e.rarity&&n.jsx("span",{className:"mt-1 inline-block rounded bg-secondary px-1.5 py-0.5 text-[10px] font-medium text-muted-foreground leading-tight",children:e.rarity})]}),n.jsx("span",{className:"shrink-0 text-xs font-semibold text-foreground tabular-nums",children:e.marketPrice!=null?`$${e.marketPrice.toFixed(2)}`:"--"}),n.jsx("button",{type:"button",onClick:()=>t(e.externalId),className:"shrink-0 rounded-full p-0.5 text-destructive/70 hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":`Remove ${e.name}`,children:n.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:n.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),je=e=>e.type==="card"?e.card.externalId:e.id,Nr=e=>e.flatMap(t=>t.type==="card"?[t.card]:[]),Er=[{value:"wtt",label:"Trade"},{value:"wtb",label:"Buy"},{value:"wts",label:"Sell"}],Se=({label:e,items:t,onItemsChange:s,enableCash:r=!1,borderColor:i,dotColor:o})=>{const[a,c]=x.useState(!1),[l,u]=x.useState(""),d=g=>{t.some(N=>N.type==="card"&&N.card.externalId===g.externalId)||s([...t,{type:"card",card:g}])},f=g=>{s([...t,{type:"custom",id:crypto.randomUUID(),text:g}])},h=g=>{s(t.filter(N=>je(N)!==g))},p=()=>{s([]),c(!1),u("")},y=t.reduce((g,N)=>g+(N.type==="card"?N.card.marketPrice??0:0),0),m=a&&parseFloat(l)||0,w=t.filter(g=>g.type==="card").length,v=t.filter(g=>g.type==="custom").length,R=[w>0?`${w} ${w===1?"card":"cards"}`:null,v>0?`${v} custom`:null].filter(Boolean).join(" + ");return n.jsxs("div",{className:`rounded-xl border-2 ${i} bg-card overflow-hidden`,children:[n.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${o}`}),n.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-foreground",children:e})]}),t.length>0&&n.jsx("button",{type:"button",onClick:p,className:"text-[11px] font-medium text-destructive hover:text-destructive/80 transition-colors",children:"Clear"})]}),n.jsx("div",{className:"border-t border-border/50"}),t.length>0&&n.jsxs("div",{children:[t.map((g,N)=>n.jsxs("div",{children:[g.type==="card"?n.jsx(wr,{card:g.card,onRemove:$=>h($)}):n.jsxs("div",{className:"flex items-center gap-3 px-3 py-2.5",children:[n.jsx("div",{className:"flex h-12 w-9 shrink-0 items-center justify-center rounded bg-secondary",children:n.jsxs("svg",{className:"h-5 w-5 text-muted-foreground",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[n.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"}),n.jsx("path",{d:"M14 2v6h6M16 13H8M16 17H8M10 9H8"})]})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("p",{className:"text-xs font-semibold text-foreground truncate leading-tight",children:g.text}),n.jsx("span",{className:"mt-1 inline-block rounded bg-violet-500/15 px-1.5 py-0.5 text-[10px] font-medium text-violet-400 leading-tight",children:"Custom item"})]}),n.jsx("span",{className:"shrink-0 text-xs font-semibold text-muted-foreground tabular-nums",children:"--"}),n.jsx("button",{type:"button",onClick:()=>h(g.id),className:"shrink-0 rounded-full p-0.5 text-destructive/70 hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":`Remove ${g.text}`,children:n.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",children:n.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]}),N<t.length-1&&n.jsx("div",{className:"mx-3 border-t border-border/40"})]},je(g))),n.jsx("div",{className:"mx-3 border-t border-border/40"})]}),n.jsx("div",{className:"px-3 py-2",children:n.jsx(br,{tcg:"pokemon",onSelect:d,selectedCard:null,onClear:()=>{},onAddCustomText:f})}),r&&!a&&n.jsx("div",{className:"px-3 pb-3 pt-1",children:n.jsxs("button",{type:"button",onClick:()=>c(!0),className:"flex w-full items-center justify-center gap-2 rounded-lg border-2 border-dashed border-border py-2.5 text-xs font-medium text-muted-foreground hover:border-primary/50 hover:text-primary transition-colors",children:[n.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("path",{d:"M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"})}),"Add Cash"]})}),r&&a&&n.jsx("div",{className:"px-3 pb-3 pt-1",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:"$"}),n.jsx("input",{type:"number",step:"0.01",min:"0",value:l,onChange:g=>u(g.target.value),placeholder:"0.00",className:"w-full rounded-lg border border-input bg-background pl-7 pr-4 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),n.jsx("button",{type:"button",onClick:()=>{c(!1),u("")},className:"shrink-0 rounded-lg p-2 text-muted-foreground hover:text-destructive hover:bg-destructive/10 transition-colors","aria-label":"Remove cash",children:n.jsx("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("path",{d:"M18 6L6 18M6 6l12 12"})})})]})}),n.jsx("div",{className:"border-t border-border/50 bg-secondary/30 px-4 py-3",children:n.jsxs("div",{className:"flex items-baseline justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[11px] font-bold uppercase tracking-wider text-muted-foreground",children:"Total Value"}),n.jsxs("p",{className:"text-[10px] text-muted-foreground/70",children:[R||"0 items",a&&l?" + cash":""]})]}),n.jsxs("span",{className:"text-base font-bold text-primary tabular-nums",children:["$",(y+m).toFixed(2)]})]})})]})},Re=({label:e,borderColor:t,dotColor:s})=>n.jsxs("div",{className:`rounded-xl border-2 ${t} bg-card overflow-hidden`,children:[n.jsx("div",{className:"flex items-center justify-between px-4 py-3",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${s}`}),n.jsx("span",{className:"text-xs font-bold uppercase tracking-wider text-foreground",children:e})]})}),n.jsx("div",{className:"border-t border-border/50"}),n.jsxs("div",{className:"flex flex-col items-center gap-2 px-4 py-6",children:[n.jsx("svg",{className:"h-10 w-10 text-muted-foreground/40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",children:n.jsx("path",{d:"M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"})}),n.jsx("span",{className:"text-[11px] font-semibold uppercase tracking-wider text-muted-foreground",children:"Cash"})]})]}),jr=({listingType:e,myOfferItems:t,theirOfferItems:s,onMyOfferItemsChange:r,onTheirOfferItemsChange:i,onListingTypeChange:o,onSubmit:a,onBack:c})=>{const l=e==="wtt"&&t.length===0&&s.length===0||e==="wts"&&t.length===0||e==="wtb"&&s.length===0;return n.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden min-h-0",children:[n.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[n.jsx("button",{type:"button",onClick:c,className:"text-primary hover:text-primary/80 transition-colors","aria-label":"Go back",children:n.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("path",{d:"M15 19l-7-7 7-7"})})}),n.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"Trade Details"})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-[11px] font-semibold uppercase tracking-wider text-muted-foreground mb-2",children:"I want to..."}),n.jsx("div",{className:"flex gap-2",children:Er.map(u=>n.jsx("button",{type:"button",onClick:()=>o(u.value),className:`flex-1 rounded-lg border px-3 py-2 text-xs font-medium transition-colors ${e===u.value?"border-primary bg-primary text-primary-foreground":"border-border bg-background text-foreground hover:bg-accent"}`,children:u.label},u.value))})]}),e==="wtb"?n.jsx(Re,{label:"My Offer",borderColor:"border-primary",dotColor:"bg-primary"}):n.jsx(Se,{label:"My Offer",items:t,onItemsChange:r,enableCash:!0,borderColor:"border-primary",dotColor:"bg-primary"}),e==="wts"?n.jsx(Re,{label:"Their Offer",borderColor:"border-violet-400",dotColor:"bg-violet-400"}):n.jsx(Se,{label:"Their Offer",items:s,onItemsChange:i,borderColor:"border-violet-400",dotColor:"bg-violet-400"})]}),n.jsx("div",{className:"border-t border-border bg-card p-4",children:n.jsx("button",{type:"button",onClick:a,disabled:l,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:"Send Offer"})})]})},Sr=({selectedCards:e,listingType:t,onSuccess:s,onBack:r})=>{const[i,o]=x.useState(""),[a,c]=x.useState(""),[l,u]=x.useState(""),[d,f]=x.useState({}),h=v=>f(R=>({...R,[v]:!0})),p=i.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i)?null:"Please enter a valid email":"Email is required",y=e[0],m=dt($e.preRegistration.create.mutationOptions()),w=v=>{v.preventDefault(),f({email:!0}),!(p||!y)&&m.mutate({email:i,display_name:a||null,tcg:y.tcg??"pokemon",card_name:y.name,card_set:y.setName??null,card_external_id:y.externalId??null,card_image_url:y.imageUrl??null,listing_type:t,city:l||null},{onSuccess:R=>{s(R.position,i)}})};return n.jsxs("div",{className:"flex flex-1 flex-col overflow-hidden",children:[n.jsxs("div",{className:"flex items-center gap-3 border-b border-border bg-card px-4 py-3",children:[n.jsx("button",{type:"button",onClick:r,className:"text-muted-foreground hover:text-foreground transition-colors","aria-label":"Go back",children:n.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:n.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),n.jsx("h2",{className:"text-sm font-semibold text-foreground",children:"Complete Registration"})]}),n.jsxs("form",{noValidate:!0,onSubmit:w,className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your email to save your offer and get notified when TCG Trade Hub launches."}),y&&n.jsxs("div",{className:"flex items-center gap-3 rounded-lg border border-border bg-secondary/50 p-3",children:[n.jsx("img",{src:y.imageUrl,alt:y.name,className:"h-14 w-10 rounded object-cover"}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:y.name}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:y.setName}),e.length>1&&n.jsxs("p",{className:"text-xs text-primary",children:["+",e.length-1," more"]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"demo-email",className:"block text-xs font-medium text-foreground mb-1.5",children:["Email ",n.jsx("span",{className:"text-destructive",children:"*"})]}),n.jsx("input",{id:"demo-email",type:"email",required:!0,value:i,onChange:v=>o(v.target.value),onBlur:()=>h("email"),placeholder:"you@example.com","aria-invalid":d.email&&!!p,"aria-describedby":d.email&&p?"demo-email-error":void 0,className:`w-full rounded-lg border bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 ${d.email&&p?"border-destructive ring-2 ring-destructive/30 focus:ring-destructive":"border-input focus:ring-ring"}`}),d.email&&p&&n.jsx("p",{id:"demo-email-error",role:"alert",className:"mt-1 text-xs text-destructive",children:p})]}),n.jsxs("div",{children:[n.jsxs("label",{htmlFor:"demo-name",className:"block text-xs font-medium text-foreground mb-1.5",children:["Display Name ",n.jsx("span",{className:"text-muted-foreground text-xs",children:"(optional)"})]}),n.jsx("input",{id:"demo-name",type:"text",value:a,onChange:v=>c(v.target.value),placeholder:"TraderJoe",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),n.jsxs("div",{children:[n.jsx("label",{htmlFor:"demo-city",className:"block text-xs font-medium text-foreground mb-1.5",children:"City"}),n.jsx("input",{id:"demo-city",type:"text",value:l,onChange:v=>u(v.target.value),placeholder:"San Francisco",className:"w-full rounded-lg border border-input bg-background px-4 py-2.5 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),m.isError&&n.jsx("div",{className:"rounded-lg bg-destructive/10 p-3 text-xs text-destructive",children:m.error.message||"Something went wrong. Please try again."}),n.jsx("button",{type:"submit",disabled:m.isPending,className:"w-full rounded-xl bg-primary py-3 text-sm font-semibold text-primary-foreground transition-opacity hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",children:m.isPending?"Registering...":"Get Early Access"}),n.jsx("p",{className:"text-center text-[10px] text-muted-foreground",children:"No spam, ever. We'll only email when we launch in your area."})]})]})},Rr=[{id:"1",type:"system",sender:"system",text:"Welcome to TCG Trade Hub"},{id:"2",type:"text",sender:"other",text:"Hey! We're building the easiest way to trade cards locally."},{id:"3",type:"text",sender:"other",text:"What cards are you hunting for? Tell us and we'll match you with local traders when we launch."},{id:"4",type:"reservation_card",sender:"other"},{id:"5",type:"system",sender:"system",text:"Tap above to build your list"}],Cr=["chat","trade-editor","email","success"],Or=()=>{const[e,t]=x.useState("chat"),[s,r]=x.useState([]),[i,o]=x.useState([]),[a,c]=x.useState("wtt"),[l,u]=x.useState(null),d=Cr.indexOf(e),f=x.useCallback(()=>{t("chat"),r([]),o([]),c("wtt"),setTimeout(()=>{u(null)},500)},[]),h=Nr(a==="wtb"?i:s);return n.jsx(ft,{children:n.jsxs("div",{className:"flex flex-1 min-h-0 transition-transform duration-500 ease-[cubic-bezier(0.34,1.56,0.64,1)]",style:{transform:`translateX(-${d*100}%)`},children:[n.jsxs("div",{className:"w-full shrink-0 flex flex-col overflow-hidden",children:[n.jsx(mt,{name:"TCG Trade Hub"}),n.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:Rr.map(p=>p.type==="system"?n.jsx(xt,{text:p.text},p.id):p.type==="text"?n.jsx(pt,{text:p.text,sender:"other"},p.id):p.type==="reservation_card"?n.jsx(yt,{onBuildList:()=>t("trade-editor")},p.id):null)})]}),n.jsx("div",{className:"w-full shrink-0 flex flex-col overflow-hidden min-h-0",children:n.jsx(jr,{listingType:a,myOfferItems:s,theirOfferItems:i,onMyOfferItemsChange:r,onTheirOfferItemsChange:o,onListingTypeChange:c,onSubmit:()=>t("email"),onBack:()=>t("chat")})}),n.jsx("div",{className:"w-full shrink-0 flex flex-col overflow-hidden",children:n.jsx(Sr,{selectedCards:h,listingType:a,onSuccess:(p,y)=>{u({position:p,email:y}),t("success")},onBack:()=>t("trade-editor")})}),n.jsx("div",{className:"w-full shrink-0 flex flex-col overflow-hidden",children:l?n.jsx("div",{className:"flex flex-1 items-center overflow-y-auto",children:n.jsx(ht,{position:l.position,email:l.email,onReset:f})}):n.jsx("div",{})})]})})};function kr(){return n.jsxs("div",{className:"flex min-h-screen flex-col items-center justify-center px-4 py-8",children:[n.jsxs("div",{className:"mb-6 text-center",children:[n.jsx(He,{to:"/",className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:"â† Back to home"}),n.jsx("h1",{className:"mt-4 text-3xl font-bold tracking-tight text-foreground sm:text-4xl",children:"See how trading works"}),n.jsx("p",{className:"mt-2 text-muted-foreground",children:"Chat with a collector, build a counter-offer, and sign up for early access."})]}),n.jsx(Or,{})]})}export{kr as component};
