{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var CONDITION_RANK = {\n    nm: 5,\n    lp: 4,\n    mp: 3,\n    hp: 2,\n    dmg: 1\n  };\n\n  /**\n   * Finds cards from a user's collection that satisfy the other party's trade wants.\n   * Used by MatchConfirmSheet to auto-select cards for a quick match.\n   *\n   * @param theirTradeWants - What the other person is looking for\n   * @param myCollection - Current user's tradeable collection items\n   * @returns Collection items that satisfy at least one trade want\n   */\n  var findMatchingCollectionCards = (theirTradeWants, myCollection) => {\n    if (theirTradeWants.length === 0 || myCollection.length === 0) return [];\n    var matchedIds = new Set();\n    var matched = [];\n    for (var want of theirTradeWants) {\n      for (var item of myCollection) {\n        if (matchedIds.has(item.id)) continue;\n        var isMatch = false;\n        switch (want.type) {\n          case 'specific_card':\n            isMatch = item.external_id === want.card_external_id;\n            break;\n          case 'sealed':\n            if (!item.is_sealed) break;\n            if (want.product_type == null) {\n              isMatch = true;\n            } else {\n              isMatch = item.product_type === want.product_type;\n            }\n            break;\n          case 'slab':\n            if (item.grading_company == null) break;\n            if (want.grading_company != null && item.grading_company !== want.grading_company) break;\n            if (want.min_grade != null) {\n              var score = parseFloat(item.grading_score ?? '0');\n              isMatch = score >= want.min_grade;\n            } else {\n              isMatch = true;\n            }\n            break;\n          case 'raw_cards':\n            if (item.is_sealed || item.grading_company != null) break;\n            if (want.min_condition == null) {\n              isMatch = true;\n            } else {\n              var itemRank = CONDITION_RANK[item.condition] ?? 0;\n              var minRank = CONDITION_RANK[want.min_condition] ?? 0;\n              isMatch = itemRank >= minRank;\n            }\n            break;\n          case 'open_to_offers':\n            isMatch = true;\n            break;\n          case 'cash':\n          case 'custom':\n            // Not matchable against collection items\n            break;\n        }\n        if (isMatch) {\n          matchedIds.add(item.id);\n          matched.push(item);\n        }\n      }\n    }\n    return matched;\n  };\n  var _default = findMatchingCollectionCards;\n});","lineCount":86,"map":[[7,2,90,0,"Object"],[7,8,90,0],[7,9,90,0,"defineProperty"],[7,23,90,0],[7,24,90,0,"exports"],[7,31,90,0],[8,4,90,0,"enumerable"],[8,14,90,0],[9,4,90,0,"get"],[9,7,90,0],[9,18,90,0,"get"],[9,19,90,0],[10,6,90,0],[10,13,90,0,"_default"],[10,21,90,0],[11,4,90,0],[12,2,90,0],[13,2,3,0],[13,6,3,6,"CONDITION_RANK"],[13,20,3,44],[13,23,3,47],[14,4,4,2,"nm"],[14,6,4,4],[14,8,4,6],[14,9,4,7],[15,4,5,2,"lp"],[15,6,5,4],[15,8,5,6],[15,9,5,7],[16,4,6,2,"mp"],[16,6,6,4],[16,8,6,6],[16,9,6,7],[17,4,7,2,"hp"],[17,6,7,4],[17,8,7,6],[17,9,7,7],[18,4,8,2,"dmg"],[18,7,8,5],[18,9,8,7],[19,2,9,0],[19,3,9,1],[21,2,11,0],[22,0,12,0],[23,0,13,0],[24,0,14,0],[25,0,15,0],[26,0,16,0],[27,0,17,0],[28,0,18,0],[29,2,19,0],[29,6,19,6,"findMatchingCollectionCards"],[29,33,19,33],[29,36,19,36,"findMatchingCollectionCards"],[29,37,20,2,"theirTradeWants"],[29,52,20,30],[29,54,21,2,"myCollection"],[29,66,21,35],[29,71,22,26],[30,4,23,2],[30,8,23,6,"theirTradeWants"],[30,23,23,21],[30,24,23,22,"length"],[30,30,23,28],[30,35,23,33],[30,36,23,34],[30,40,23,38,"myCollection"],[30,52,23,50],[30,53,23,51,"length"],[30,59,23,57],[30,64,23,62],[30,65,23,63],[30,67,23,65],[30,74,23,72],[30,76,23,74],[31,4,25,2],[31,8,25,8,"matchedIds"],[31,18,25,18],[31,21,25,21],[31,25,25,25,"Set"],[31,28,25,28],[31,29,25,37],[31,30,25,38],[32,4,26,2],[32,8,26,8,"matched"],[32,15,26,36],[32,18,26,39],[32,20,26,41],[33,4,28,2],[33,9,28,7],[33,13,28,13,"want"],[33,17,28,17],[33,21,28,21,"theirTradeWants"],[33,36,28,36],[33,38,28,38],[34,6,29,4],[34,11,29,9],[34,15,29,15,"item"],[34,19,29,19],[34,23,29,23,"myCollection"],[34,35,29,35],[34,37,29,37],[35,8,30,6],[35,12,30,10,"matchedIds"],[35,22,30,20],[35,23,30,21,"has"],[35,26,30,24],[35,27,30,25,"item"],[35,31,30,29],[35,32,30,30,"id"],[35,34,30,32],[35,35,30,33],[35,37,30,35],[36,8,32,6],[36,12,32,10,"isMatch"],[36,19,32,17],[36,22,32,20],[36,27,32,25],[37,8,34,6],[37,16,34,14,"want"],[37,20,34,18],[37,21,34,19,"type"],[37,25,34,23],[38,10,35,8],[38,15,35,13],[38,30,35,28],[39,12,36,10,"isMatch"],[39,19,36,17],[39,22,36,20,"item"],[39,26,36,24],[39,27,36,25,"external_id"],[39,38,36,36],[39,43,36,41,"want"],[39,47,36,45],[39,48,36,46,"card_external_id"],[39,64,36,62],[40,12,37,10],[41,10,39,8],[41,15,39,13],[41,23,39,21],[42,12,40,10],[42,16,40,14],[42,17,40,15,"item"],[42,21,40,19],[42,22,40,20,"is_sealed"],[42,31,40,29],[42,33,40,31],[43,12,41,10],[43,16,41,14,"want"],[43,20,41,18],[43,21,41,19,"product_type"],[43,33,41,31],[43,37,41,35],[43,41,41,39],[43,43,41,41],[44,14,42,12,"isMatch"],[44,21,42,19],[44,24,42,22],[44,28,42,26],[45,12,43,10],[45,13,43,11],[45,19,43,17],[46,14,44,12,"isMatch"],[46,21,44,19],[46,24,44,22,"item"],[46,28,44,26],[46,29,44,27,"product_type"],[46,41,44,39],[46,46,44,44,"want"],[46,50,44,48],[46,51,44,49,"product_type"],[46,63,44,61],[47,12,45,10],[48,12,46,10],[49,10,48,8],[49,15,48,13],[49,21,48,19],[50,12,49,10],[50,16,49,14,"item"],[50,20,49,18],[50,21,49,19,"grading_company"],[50,36,49,34],[50,40,49,38],[50,44,49,42],[50,46,49,44],[51,12,50,10],[51,16,50,14,"want"],[51,20,50,18],[51,21,50,19,"grading_company"],[51,36,50,34],[51,40,50,38],[51,44,50,42],[51,48,50,46,"item"],[51,52,50,50],[51,53,50,51,"grading_company"],[51,68,50,66],[51,73,50,71,"want"],[51,77,50,75],[51,78,50,76,"grading_company"],[51,93,50,91],[51,95,50,93],[52,12,51,10],[52,16,51,14,"want"],[52,20,51,18],[52,21,51,19,"min_grade"],[52,30,51,28],[52,34,51,32],[52,38,51,36],[52,40,51,38],[53,14,52,12],[53,18,52,18,"score"],[53,23,52,23],[53,26,52,26,"parseFloat"],[53,36,52,36],[53,37,52,37,"item"],[53,41,52,41],[53,42,52,42,"grading_score"],[53,55,52,55],[53,59,52,59],[53,62,52,62],[53,63,52,63],[54,14,53,12,"isMatch"],[54,21,53,19],[54,24,53,22,"score"],[54,29,53,27],[54,33,53,31,"want"],[54,37,53,35],[54,38,53,36,"min_grade"],[54,47,53,45],[55,12,54,10],[55,13,54,11],[55,19,54,17],[56,14,55,12,"isMatch"],[56,21,55,19],[56,24,55,22],[56,28,55,26],[57,12,56,10],[58,12,57,10],[59,10,59,8],[59,15,59,13],[59,26,59,24],[60,12,60,10],[60,16,60,14,"item"],[60,20,60,18],[60,21,60,19,"is_sealed"],[60,30,60,28],[60,34,60,32,"item"],[60,38,60,36],[60,39,60,37,"grading_company"],[60,54,60,52],[60,58,60,56],[60,62,60,60],[60,64,60,62],[61,12,61,10],[61,16,61,14,"want"],[61,20,61,18],[61,21,61,19,"min_condition"],[61,34,61,32],[61,38,61,36],[61,42,61,40],[61,44,61,42],[62,14,62,12,"isMatch"],[62,21,62,19],[62,24,62,22],[62,28,62,26],[63,12,63,10],[63,13,63,11],[63,19,63,17],[64,14,64,12],[64,18,64,18,"itemRank"],[64,26,64,26],[64,29,64,29,"CONDITION_RANK"],[64,43,64,43],[64,44,64,44,"item"],[64,48,64,48],[64,49,64,49,"condition"],[64,58,64,58],[64,59,64,59],[64,63,64,63],[64,64,64,64],[65,14,65,12],[65,18,65,18,"minRank"],[65,25,65,25],[65,28,65,28,"CONDITION_RANK"],[65,42,65,42],[65,43,65,43,"want"],[65,47,65,47],[65,48,65,48,"min_condition"],[65,61,65,61],[65,62,65,62],[65,66,65,66],[65,67,65,67],[66,14,66,12,"isMatch"],[66,21,66,19],[66,24,66,22,"itemRank"],[66,32,66,30],[66,36,66,34,"minRank"],[66,43,66,41],[67,12,67,10],[68,12,68,10],[69,10,70,8],[69,15,70,13],[69,31,70,29],[70,12,71,10,"isMatch"],[70,19,71,17],[70,22,71,20],[70,26,71,24],[71,12,72,10],[72,10,74,8],[72,15,74,13],[72,21,74,19],[73,10,75,8],[73,15,75,13],[73,23,75,21],[74,12,76,10],[75,12,77,10],[76,8,78,6],[77,8,80,6],[77,12,80,10,"isMatch"],[77,19,80,17],[77,21,80,19],[78,10,81,8,"matchedIds"],[78,20,81,18],[78,21,81,19,"add"],[78,24,81,22],[78,25,81,23,"item"],[78,29,81,27],[78,30,81,28,"id"],[78,32,81,30],[78,33,81,31],[79,10,82,8,"matched"],[79,17,82,15],[79,18,82,16,"push"],[79,22,82,20],[79,23,82,21,"item"],[79,27,82,25],[79,28,82,26],[80,8,83,6],[81,6,84,4],[82,4,85,2],[83,4,87,2],[83,11,87,9,"matched"],[83,18,87,16],[84,2,88,0],[84,3,88,1],[85,2,90,0],[85,6,90,0,"_default"],[85,14,90,0],[85,17,90,15,"findMatchingCollectionCards"],[85,44,90,42],[86,0,90,43],[86,3]],"functionMap":{"names":["<global>","findMatchingCollectionCards"],"mappings":"AAA;oCCkB;CDqE"},"hasCjsExports":false},"type":"js/module"}]}