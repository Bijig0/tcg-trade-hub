{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/services/cardData","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":54,"index":166}}],"key":"aDLIuqe8ZoUac1cvYkmTdLzn7po=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":167},"end":{"line":4,"column":49,"index":216}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _servicesCardData = require(_dependencyMap[3], \"@/services/cardData\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Batch-refreshes market_price for all collection items by\n   * fetching current prices from the card data service adapter.\n   */\n  var useRefreshPrices = () => {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (items) {\n          var nonSealed = items.filter(item => !item.is_sealed);\n          var updated = 0;\n          for (var item of nonSealed) {\n            var detail = yield _servicesCardData.cardDataService.getCardDetail(item.external_id);\n            if (detail?.marketPrice != null && detail.marketPrice !== item.market_price) {\n              var _yield$supabase$from$ = yield _libSupabase.supabase.from('collection_items').update({\n                  market_price: detail.marketPrice\n                }).eq('id', item.id),\n                error = _yield$supabase$from$.error;\n              if (!error) updated++;\n            }\n          }\n          return {\n            updated,\n            total: nonSealed.length\n          };\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.collectionKeys.all\n        });\n      }\n    });\n  };\n  _s(useRefreshPrices, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useRefreshPrices;\n});","lineCount":67,"map":[[13,2,39,0,"Object"],[13,8,39,0],[13,9,39,0,"defineProperty"],[13,23,39,0],[13,24,39,0,"exports"],[13,31,39,0],[14,4,39,0,"enumerable"],[14,14,39,0],[15,4,39,0,"get"],[15,7,39,0],[15,18,39,0,"get"],[15,19,39,0],[16,6,39,0],[16,13,39,0,"_default"],[16,21,39,0],[17,4,39,0],[18,2,39,0],[19,2,39,32],[19,6,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,39,32],[19,45,39,32,"require"],[19,52,39,32],[19,53,39,32,"_dependencyMap"],[19,67,39,32],[20,2,39,32],[20,6,39,32,"_asyncToGenerator"],[20,23,39,32],[20,26,39,32,"_interopDefault"],[20,41,39,32],[20,42,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,39,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_servicesCardData"],[23,23,3,0],[23,26,3,0,"require"],[23,33,3,0],[23,34,3,0,"_dependencyMap"],[23,48,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,7,0],[26,0,8,0],[27,0,9,0],[28,0,10,0],[29,2,11,0],[29,6,11,6,"useRefreshPrices"],[29,22,11,22],[29,25,11,25,"useRefreshPrices"],[29,26,11,25],[29,31,11,31],[30,4,11,31,"_s"],[30,6,11,31],[31,4,12,2],[31,8,12,8,"queryClient"],[31,19,12,19],[31,22,12,22],[31,26,12,22,"useQueryClient"],[31,45,12,36],[31,46,12,36,"useQueryClient"],[31,60,12,36],[31,62,12,37],[31,63,12,38],[32,4,14,2],[32,11,14,9],[32,15,14,9,"useMutation"],[32,34,14,20],[32,35,14,20,"useMutation"],[32,46,14,20],[32,48,14,21],[33,6,15,4,"mutationFn"],[33,16,15,14],[34,8,15,14],[34,12,15,14,"_ref"],[34,16,15,14],[34,23,15,14,"_asyncToGenerator"],[34,40,15,14],[34,41,15,14,"default"],[34,48,15,14],[34,50,15,16],[34,61,15,23,"items"],[34,66,15,49],[34,68,15,54],[35,10,16,6],[35,14,16,12,"nonSealed"],[35,23,16,21],[35,26,16,24,"items"],[35,31,16,29],[35,32,16,30,"filter"],[35,38,16,36],[35,39,16,38,"item"],[35,43,16,42],[35,47,16,47],[35,48,16,48,"item"],[35,52,16,52],[35,53,16,53,"is_sealed"],[35,62,16,62],[35,63,16,63],[36,10,17,6],[36,14,17,10,"updated"],[36,21,17,17],[36,24,17,20],[36,25,17,21],[37,10,19,6],[37,15,19,11],[37,19,19,17,"item"],[37,23,19,21],[37,27,19,25,"nonSealed"],[37,36,19,34],[37,38,19,36],[38,12,20,8],[38,16,20,14,"detail"],[38,22,20,20],[38,31,20,29,"cardDataService"],[38,48,20,44],[38,49,20,44,"cardDataService"],[38,64,20,44],[38,65,20,45,"getCardDetail"],[38,78,20,58],[38,79,20,59,"item"],[38,83,20,63],[38,84,20,64,"external_id"],[38,95,20,75],[38,96,20,76],[39,12,21,8],[39,16,21,12,"detail"],[39,22,21,18],[39,24,21,20,"marketPrice"],[39,35,21,31],[39,39,21,35],[39,43,21,39],[39,47,21,43,"detail"],[39,53,21,49],[39,54,21,50,"marketPrice"],[39,65,21,61],[39,70,21,66,"item"],[39,74,21,70],[39,75,21,71,"market_price"],[39,87,21,83],[39,89,21,85],[40,14,22,10],[40,18,22,10,"_yield$supabase$from$"],[40,39,22,10],[40,48,22,34,"supabase"],[40,60,22,42],[40,61,22,42,"supabase"],[40,69,22,42],[40,70,23,13,"from"],[40,74,23,17],[40,75,23,18],[40,93,23,36],[40,94,23,37],[40,95,24,13,"update"],[40,101,24,19],[40,102,24,20],[41,18,24,22,"market_price"],[41,30,24,34],[41,32,24,36,"detail"],[41,38,24,42],[41,39,24,43,"marketPrice"],[42,16,24,55],[42,17,24,56],[42,18,24,57],[42,19,25,13,"eq"],[42,21,25,15],[42,22,25,16],[42,26,25,20],[42,28,25,22,"item"],[42,32,25,26],[42,33,25,27,"id"],[42,35,25,29],[42,36,25,30],[43,16,22,18,"error"],[43,21,22,23],[43,24,22,23,"_yield$supabase$from$"],[43,45,22,23],[43,46,22,18,"error"],[43,51,22,23],[44,14,27,10],[44,18,27,14],[44,19,27,15,"error"],[44,24,27,20],[44,26,27,22,"updated"],[44,33,27,29],[44,35,27,31],[45,12,28,8],[46,10,29,6],[47,10,31,6],[47,17,31,13],[48,12,31,15,"updated"],[48,19,31,22],[49,12,31,24,"total"],[49,17,31,29],[49,19,31,31,"nonSealed"],[49,28,31,40],[49,29,31,41,"length"],[50,10,31,48],[50,11,31,49],[51,8,32,4],[51,9,32,5],[52,8,32,5],[52,24,15,4,"mutationFn"],[52,34,15,14,"mutationFn"],[52,35,15,14,"_x"],[52,37,15,14],[53,10,15,14],[53,17,15,14,"_ref"],[53,21,15,14],[53,22,15,14,"apply"],[53,27,15,14],[53,34,15,14,"arguments"],[53,43,15,14],[54,8,15,14],[55,6,15,14],[55,9,32,5],[56,6,33,4,"onSuccess"],[56,15,33,13],[56,17,33,15,"onSuccess"],[56,18,33,15],[56,23,33,21],[57,8,34,6,"queryClient"],[57,19,34,17],[57,20,34,18,"invalidateQueries"],[57,37,34,35],[57,38,34,36],[58,10,34,38,"queryKey"],[58,18,34,46],[58,20,34,48,"collectionKeys"],[58,30,34,62],[58,31,34,62,"collectionKeys"],[58,45,34,62],[58,46,34,63,"all"],[59,8,34,67],[59,9,34,68],[59,10,34,69],[60,6,35,4],[61,4,36,2],[61,5,36,3],[61,6,36,4],[62,2,37,0],[62,3,37,1],[63,2,37,2,"_s"],[63,4,37,2],[63,5,11,6,"useRefreshPrices"],[63,21,11,22],[64,4,11,22],[64,12,12,22,"useQueryClient"],[64,31,12,36],[64,32,12,36,"useQueryClient"],[64,46,12,36],[64,48,14,9,"useMutation"],[64,67,14,20],[64,68,14,20,"useMutation"],[64,79,14,20],[65,2,14,20],[66,2,39,0],[66,6,39,0,"_default"],[66,14,39,0],[66,17,39,15,"useRefreshPrices"],[66,33,39,31],[67,0,39,32],[67,3]],"functionMap":{"names":["<global>","useRefreshPrices","useMutation$argument_0.mutationFn","items.filter$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCU;gBCI;qCCC,yBD;KDgB;eGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}