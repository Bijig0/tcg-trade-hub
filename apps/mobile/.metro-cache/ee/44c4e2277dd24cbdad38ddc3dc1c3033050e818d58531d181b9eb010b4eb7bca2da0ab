{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":43,"index":136}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"fetchListingDetail\", {\n    enumerable: true,\n    get: function () {\n      return fetchListingDetail;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Fetches a single listing by ID with its items, owner information, and pending offer count.\n   *\n   * Joins the `users` table to include owner display_name, avatar_url,\n   * rating_score, and total_trades alongside all listing fields.\n   * Also fetches listing_items and counts pending offers.\n   */\n  var fetchListingDetail = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator.default)(function* (listingId) {\n      // Fetch listing with owner\n      var _yield$supabase$from$ = yield _libSupabase.supabase.from('listings').select(`\n      *,\n      owner:users!user_id (\n        display_name,\n        avatar_url,\n        rating_score,\n        total_trades\n      )\n    `).eq('id', listingId).single(),\n        data = _yield$supabase$from$.data,\n        error = _yield$supabase$from$.error;\n      if (error) throw error;\n\n      // Fetch listing items\n      var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listing_items').select('*').eq('listing_id', listingId).order('created_at', {\n          ascending: true\n        }),\n        items = _yield$supabase$from$2.data,\n        itemsError = _yield$supabase$from$2.error;\n      if (itemsError) throw itemsError;\n\n      // Count pending offers\n      var _yield$supabase$from$3 = yield _libSupabase.supabase.from('offers').select('id', {\n          count: 'exact',\n          head: true\n        }).eq('listing_id', listingId).eq('status', 'pending'),\n        count = _yield$supabase$from$3.count,\n        countError = _yield$supabase$from$3.error;\n      if (countError) throw countError;\n\n      // Supabase returns the joined user as an object under the alias `owner`\n      var listing = data;\n\n      // distance_km is not available from a direct query; default to 0\n      // The feed edge function normally provides this value\n      if (listing.distance_km === undefined) {\n        listing.distance_km = 0;\n      }\n      listing.items = items != null ? items : [];\n      listing.offer_count = count != null ? count : 0;\n      return listing;\n    });\n    return function fetchListingDetail(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Hook that fetches a single listing by ID with its items and owner information.\n   */\n  var useListingDetail = function useListingDetail(listingId) {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.feedKeys.detail(listingId),\n      queryFn: function queryFn() {\n        return fetchListingDetail(listingId);\n      },\n      enabled: !!listingId\n    });\n  };\n  _s(useListingDetail, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = useListingDetail;\n});","lineCount":104,"map":[[13,2,78,0,"Object"],[13,8,78,0],[13,9,78,0,"defineProperty"],[13,23,78,0],[13,24,78,0,"exports"],[13,31,78,0],[14,4,78,0,"enumerable"],[14,14,78,0],[15,4,78,0,"get"],[15,7,78,0],[15,18,78,0,"get"],[15,19,78,0],[16,6,78,0],[16,13,78,0,"_default"],[16,21,78,0],[17,4,78,0],[18,2,78,0],[19,2,14,0,"Object"],[19,8,14,0],[19,9,14,0,"defineProperty"],[19,23,14,0],[19,24,14,0,"exports"],[19,31,14,0],[20,4,14,0,"enumerable"],[20,14,14,0],[21,4,14,0,"get"],[21,7,14,0],[21,18,14,0,"get"],[21,19,14,0],[22,6,14,0],[22,13,14,0,"fetchListingDetail"],[22,31,14,0],[23,4,14,0],[24,2,14,0],[25,2,65,2],[25,6,65,2,"_babelRuntimeHelpersAsyncToGenerator"],[25,42,65,2],[25,45,65,2,"require"],[25,52,65,2],[25,53,65,2,"_dependencyMap"],[25,67,65,2],[26,2,65,2],[26,6,65,2,"_asyncToGenerator"],[26,23,65,2],[26,26,65,2,"_interopDefault"],[26,41,65,2],[26,42,65,2,"_babelRuntimeHelpersAsyncToGenerator"],[26,78,65,2],[27,2,1,0],[27,6,1,0,"_tanstackReactQuery"],[27,25,1,0],[27,28,1,0,"require"],[27,35,1,0],[27,36,1,0,"_dependencyMap"],[27,50,1,0],[28,2,2,0],[28,6,2,0,"_libSupabase"],[28,18,2,0],[28,21,2,0,"require"],[28,28,2,0],[28,29,2,0,"_dependencyMap"],[28,43,2,0],[29,2,3,0],[29,6,3,0,"_queryKeys"],[29,16,3,0],[29,19,3,0,"require"],[29,26,3,0],[29,27,3,0,"_dependencyMap"],[29,41,3,0],[30,2,7,0],[31,0,8,0],[32,0,9,0],[33,0,10,0],[34,0,11,0],[35,0,12,0],[36,0,13,0],[37,2,14,7],[37,6,14,13,"fetchListingDetail"],[37,24,14,31],[38,4,14,31],[38,8,14,31,"_ref"],[38,12,14,31],[38,19,14,31,"_asyncToGenerator"],[38,36,14,31],[38,37,14,31,"default"],[38,44,14,31],[38,46,14,34],[38,57,14,41,"listingId"],[38,66,14,58],[38,68,14,93],[39,6,15,2],[40,6,16,2],[40,10,16,2,"_yield$supabase$from$"],[40,31,16,2],[40,40,16,32,"supabase"],[40,52,16,40],[40,53,16,40,"supabase"],[40,61,16,40],[40,62,17,5,"from"],[40,66,17,9],[40,67,17,10],[40,77,17,20],[40,78,17,21],[40,79,18,5,"select"],[40,85,18,11],[40,86,19,6],[41,0,20,0],[42,0,21,0],[43,0,22,0],[44,0,23,0],[45,0,24,0],[46,0,25,0],[47,0,26,0],[48,0,27,0],[48,5,28,4],[48,6,28,5],[48,7,29,5,"eq"],[48,9,29,7],[48,10,29,8],[48,14,29,12],[48,16,29,14,"listingId"],[48,25,29,23],[48,26,29,24],[48,27,30,5,"single"],[48,33,30,11],[48,34,30,12],[48,35,30,13],[49,8,16,10,"data"],[49,12,16,14],[49,15,16,14,"_yield$supabase$from$"],[49,36,16,14],[49,37,16,10,"data"],[49,41,16,14],[50,8,16,16,"error"],[50,13,16,21],[50,16,16,21,"_yield$supabase$from$"],[50,37,16,21],[50,38,16,16,"error"],[50,43,16,21],[51,6,32,2],[51,10,32,6,"error"],[51,15,32,11],[51,17,32,13],[51,23,32,19,"error"],[51,28,32,24],[53,6,34,2],[54,6,35,2],[54,10,35,2,"_yield$supabase$from$2"],[54,32,35,2],[54,41,35,51,"supabase"],[54,53,35,59],[54,54,35,59,"supabase"],[54,62,35,59],[54,63,36,5,"from"],[54,67,36,9],[54,68,36,10],[54,83,36,25],[54,84,36,26],[54,85,37,5,"select"],[54,91,37,11],[54,92,37,12],[54,95,37,15],[54,96,37,16],[54,97,38,5,"eq"],[54,99,38,7],[54,100,38,8],[54,112,38,20],[54,114,38,22,"listingId"],[54,123,38,31],[54,124,38,32],[54,125,39,5,"order"],[54,130,39,10],[54,131,39,11],[54,143,39,23],[54,145,39,25],[55,10,39,27,"ascending"],[55,19,39,36],[55,21,39,38],[56,8,39,43],[56,9,39,44],[56,10,39,45],[57,8,35,16,"items"],[57,13,35,21],[57,16,35,21,"_yield$supabase$from$2"],[57,38,35,21],[57,39,35,10,"data"],[57,43,35,14],[58,8,35,30,"itemsError"],[58,18,35,40],[58,21,35,40,"_yield$supabase$from$2"],[58,43,35,40],[58,44,35,23,"error"],[58,49,35,28],[59,6,41,2],[59,10,41,6,"itemsError"],[59,20,41,16],[59,22,41,18],[59,28,41,24,"itemsError"],[59,38,41,34],[61,6,43,2],[62,6,44,2],[62,10,44,2,"_yield$supabase$from$3"],[62,32,44,2],[62,41,44,45,"supabase"],[62,53,44,53],[62,54,44,53,"supabase"],[62,62,44,53],[62,63,45,5,"from"],[62,67,45,9],[62,68,45,10],[62,76,45,18],[62,77,45,19],[62,78,46,5,"select"],[62,84,46,11],[62,85,46,12],[62,89,46,16],[62,91,46,18],[63,10,46,20,"count"],[63,15,46,25],[63,17,46,27],[63,24,46,34],[64,10,46,36,"head"],[64,14,46,40],[64,16,46,42],[65,8,46,47],[65,9,46,48],[65,10,46,49],[65,11,47,5,"eq"],[65,13,47,7],[65,14,47,8],[65,26,47,20],[65,28,47,22,"listingId"],[65,37,47,31],[65,38,47,32],[65,39,48,5,"eq"],[65,41,48,7],[65,42,48,8],[65,50,48,16],[65,52,48,18],[65,61,48,27],[65,62,48,28],[66,8,44,10,"count"],[66,13,44,15],[66,16,44,15,"_yield$supabase$from$3"],[66,38,44,15],[66,39,44,10,"count"],[66,44,44,15],[67,8,44,24,"countError"],[67,18,44,34],[67,21,44,34,"_yield$supabase$from$3"],[67,43,44,34],[67,44,44,17,"error"],[67,49,44,22],[68,6,50,2],[68,10,50,6,"countError"],[68,20,50,16],[68,22,50,18],[68,28,50,24,"countError"],[68,38,50,34],[70,6,52,2],[71,6,53,2],[71,10,53,8,"listing"],[71,17,53,15],[71,20,53,18,"data"],[71,24,53,56],[73,6,55,2],[74,6,56,2],[75,6,57,2],[75,10,57,6,"listing"],[75,17,57,13],[75,18,57,14,"distance_km"],[75,29,57,25],[75,34,57,30,"undefined"],[75,43,57,39],[75,45,57,41],[76,8,58,5,"listing"],[76,15,58,12],[76,16,58,41,"distance_km"],[76,27,58,52],[76,30,58,55],[76,31,58,56],[77,6,59,2],[78,6,61,3,"listing"],[78,13,61,10],[78,14,61,39,"items"],[78,19,61,44],[78,22,61,48,"items"],[78,27,61,53],[78,38,61,48,"items"],[78,43,61,53],[78,46,61,57],[78,48,61,80],[79,6,62,3,"listing"],[79,13,62,10],[79,14,62,39,"offer_count"],[79,25,62,50],[79,28,62,53,"count"],[79,33,62,58],[79,44,62,53,"count"],[79,49,62,58],[79,52,62,62],[79,53,62,63],[80,6,64,2],[80,13,64,9,"listing"],[80,20,64,16],[81,4,65,0],[81,5,65,1],[82,4,65,1],[82,20,14,13,"fetchListingDetail"],[82,38,14,31,"fetchListingDetail"],[82,39,14,31,"_x"],[82,41,14,31],[83,6,14,31],[83,13,14,31,"_ref"],[83,17,14,31],[83,18,14,31,"apply"],[83,23,14,31],[83,30,14,31,"arguments"],[83,39,14,31],[84,4,14,31],[85,2,14,31],[85,5,65,1],[87,2,67,0],[88,0,68,0],[89,0,69,0],[90,2,70,0],[90,6,70,6,"useListingDetail"],[90,22,70,22],[90,25,70,25],[90,34,70,6,"useListingDetail"],[90,50,70,22,"useListingDetail"],[90,51,70,26,"listingId"],[90,60,70,43],[90,62,70,48],[91,4,70,48,"_s"],[91,6,70,48],[92,4,71,2],[92,11,71,9],[92,15,71,9,"useQuery"],[92,34,71,17],[92,35,71,17,"useQuery"],[92,43,71,17],[92,45,71,46],[93,6,72,4,"queryKey"],[93,14,72,12],[93,16,72,14,"feedKeys"],[93,26,72,22],[93,27,72,22,"feedKeys"],[93,35,72,22],[93,36,72,23,"detail"],[93,42,72,29],[93,43,72,30,"listingId"],[93,52,72,39],[93,53,72,40],[94,6,73,4,"queryFn"],[94,13,73,11],[94,15,73,13],[94,24,73,4,"queryFn"],[94,31,73,11,"queryFn"],[94,32,73,11],[95,8,73,11],[95,15,73,19,"fetchListingDetail"],[95,33,73,37],[95,34,73,38,"listingId"],[95,43,73,47],[95,44,73,48],[96,6,73,48],[97,6,74,4,"enabled"],[97,13,74,11],[97,15,74,13],[97,16,74,14],[97,17,74,15,"listingId"],[98,4,75,2],[98,5,75,3],[98,6,75,4],[99,2,76,0],[99,3,76,1],[100,2,76,2,"_s"],[100,4,76,2],[100,5,70,6,"useListingDetail"],[100,21,70,22],[101,4,70,22],[101,12,71,9,"useQuery"],[101,31,71,17],[101,32,71,17,"useQuery"],[101,40,71,17],[102,2,71,17],[103,2,78,0],[103,6,78,0,"_default"],[103,14,78,0],[103,17,78,15,"useListingDetail"],[103,33,78,31],[104,0,78,32],[104,3]],"functionMap":{"names":["<global>","fetchListingDetail","useListingDetail","useQuery$argument_0.queryFn"],"mappings":"AAA;kCCa;CDmD;yBEK;aCG,mCD;CFG"},"hasCjsExports":false},"type":"js/module"}]}