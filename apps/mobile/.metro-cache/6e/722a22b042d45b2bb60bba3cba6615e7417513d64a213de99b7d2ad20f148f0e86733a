{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":32,"index":32}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":33},"end":{"line":2,"column":49,"index":82}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/services/cardData/cardDataService","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":83},"end":{"line":3,"column":70,"index":153}}],"key":"nywe4wRFGi03uMHWkFCW5l9Ir6I=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _servicesCardDataCardDataService = require(_dependencyMap[2], \"@/services/cardData/cardDataService\");\n  var PERIOD_DAYS = {\n    '1M': 30,\n    '3M': 90,\n    '6M': 180,\n    '12M': 365,\n    MAX: Infinity\n  };\n\n  /**\n   * Returns price history for a card, filtered by the selected time period.\n   */\n  var usePriceHistory = (externalId, period) => {\n    _s();\n    var _useQuery = (0, _tanstackReactQuery.useQuery)({\n        queryKey: ['card-detail', externalId],\n        queryFn: () => _servicesCardDataCardDataService.cardDataService.getCardDetail(externalId),\n        staleTime: 1000 * 60 * 30,\n        enabled: externalId.length > 0\n      }),\n      detail = _useQuery.data,\n      isLoading = _useQuery.isLoading;\n    var filtered = (0, _react.useMemo)(() => {\n      var history = detail?.priceHistory;\n      if (!history || history.points.length === 0) return null;\n      var days = PERIOD_DAYS[period] ?? Infinity;\n      if (days === Infinity) return history;\n      var cutoff = new Date();\n      cutoff.setDate(cutoff.getDate() - days);\n      var cutoffStr = cutoff.toISOString().split('T')[0];\n      var pts = history.points.filter(p => p.date >= cutoffStr);\n      if (pts.length < 2) return history; // fallback to full if too few points\n\n      var high = -Infinity;\n      var low = Infinity;\n      for (var p of pts) {\n        if (p.price > high) high = p.price;\n        if (p.price < low) low = p.price;\n      }\n      var first = pts[0].price;\n      var last = pts[pts.length - 1].price;\n      var changePercent = first > 0 ? Math.round((last - first) / first * 10000) / 100 : 0;\n      return {\n        points: pts,\n        high: Math.round(high * 100) / 100,\n        low: Math.round(low * 100) / 100,\n        changePercent\n      };\n    }, [detail, period]);\n    return {\n      data: filtered,\n      isLoading\n    };\n  };\n  _s(usePriceHistory, \"YMXHSA49uYO3a1yluVvMZu9yRfE=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = usePriceHistory;\n});","lineCount":74,"map":[[8,2,64,0,"Object"],[8,8,64,0],[8,9,64,0,"defineProperty"],[8,23,64,0],[8,24,64,0,"exports"],[8,31,64,0],[9,4,64,0,"enumerable"],[9,14,64,0],[10,4,64,0,"get"],[10,7,64,0],[10,18,64,0,"get"],[10,19,64,0],[11,6,64,0],[11,13,64,0,"_default"],[11,21,64,0],[12,4,64,0],[13,2,64,0],[14,2,1,0],[14,6,1,0,"_react"],[14,12,1,0],[14,15,1,0,"require"],[14,22,1,0],[14,23,1,0,"_dependencyMap"],[14,37,1,0],[15,2,2,0],[15,6,2,0,"_tanstackReactQuery"],[15,25,2,0],[15,28,2,0,"require"],[15,35,2,0],[15,36,2,0,"_dependencyMap"],[15,50,2,0],[16,2,3,0],[16,6,3,0,"_servicesCardDataCardDataService"],[16,38,3,0],[16,41,3,0,"require"],[16,48,3,0],[16,49,3,0,"_dependencyMap"],[16,63,3,0],[17,2,6,0],[17,6,6,6,"PERIOD_DAYS"],[17,17,6,41],[17,20,6,44],[18,4,7,2],[18,8,7,6],[18,10,7,8],[18,12,7,10],[19,4,8,2],[19,8,8,6],[19,10,8,8],[19,12,8,10],[20,4,9,2],[20,8,9,6],[20,10,9,8],[20,13,9,11],[21,4,10,2],[21,9,10,7],[21,11,10,9],[21,14,10,12],[22,4,11,2,"MAX"],[22,7,11,5],[22,9,11,7,"Infinity"],[23,2,12,0],[23,3,12,1],[25,2,14,0],[26,0,15,0],[27,0,16,0],[28,2,17,0],[28,6,17,6,"usePriceHistory"],[28,21,17,21],[28,24,17,24,"usePriceHistory"],[28,25,17,25,"externalId"],[28,35,17,43],[28,37,17,45,"period"],[28,43,17,59],[28,48,17,64],[29,4,17,64,"_s"],[29,6,17,64],[30,4,18,2],[30,8,18,2,"_useQuery"],[30,17,18,2],[30,20,18,38],[30,24,18,38,"useQuery"],[30,43,18,46],[30,44,18,46,"useQuery"],[30,52,18,46],[30,54,18,47],[31,8,19,4,"queryKey"],[31,16,19,12],[31,18,19,14],[31,19,19,15],[31,32,19,28],[31,34,19,30,"externalId"],[31,44,19,40],[31,45,19,50],[32,8,20,4,"queryFn"],[32,15,20,11],[32,17,20,13,"queryFn"],[32,18,20,13],[32,23,20,19,"cardDataService"],[32,55,20,34],[32,56,20,34,"cardDataService"],[32,71,20,34],[32,72,20,35,"getCardDetail"],[32,85,20,48],[32,86,20,49,"externalId"],[32,96,20,59],[32,97,20,60],[33,8,21,4,"staleTime"],[33,17,21,13],[33,19,21,15],[33,23,21,19],[33,26,21,22],[33,28,21,24],[33,31,21,27],[33,33,21,29],[34,8,22,4,"enabled"],[34,15,22,11],[34,17,22,13,"externalId"],[34,27,22,23],[34,28,22,24,"length"],[34,34,22,30],[34,37,22,33],[35,6,23,2],[35,7,23,3],[35,8,23,4],[36,6,18,16,"detail"],[36,12,18,22],[36,15,18,22,"_useQuery"],[36,24,18,22],[36,25,18,10,"data"],[36,29,18,14],[37,6,18,24,"isLoading"],[37,15,18,33],[37,18,18,33,"_useQuery"],[37,27,18,33],[37,28,18,24,"isLoading"],[37,37,18,33],[38,4,25,2],[38,8,25,8,"filtered"],[38,16,25,16],[38,19,25,19],[38,23,25,19,"useMemo"],[38,29,25,26],[38,30,25,26,"useMemo"],[38,37,25,26],[38,39,25,27],[38,45,25,54],[39,6,26,4],[39,10,26,10,"history"],[39,17,26,17],[39,20,26,20,"detail"],[39,26,26,26],[39,28,26,28,"priceHistory"],[39,40,26,40],[40,6,27,4],[40,10,27,8],[40,11,27,9,"history"],[40,18,27,16],[40,22,27,20,"history"],[40,29,27,27],[40,30,27,28,"points"],[40,36,27,34],[40,37,27,35,"length"],[40,43,27,41],[40,48,27,46],[40,49,27,47],[40,51,27,49],[40,58,27,56],[40,62,27,60],[41,6,29,4],[41,10,29,10,"days"],[41,14,29,14],[41,17,29,17,"PERIOD_DAYS"],[41,28,29,28],[41,29,29,29,"period"],[41,35,29,35],[41,36,29,36],[41,40,29,40,"Infinity"],[41,48,29,48],[42,6,30,4],[42,10,30,8,"days"],[42,14,30,12],[42,19,30,17,"Infinity"],[42,27,30,25],[42,29,30,27],[42,36,30,34,"history"],[42,43,30,41],[43,6,32,4],[43,10,32,10,"cutoff"],[43,16,32,16],[43,19,32,19],[43,23,32,23,"Date"],[43,27,32,27],[43,28,32,28],[43,29,32,29],[44,6,33,4,"cutoff"],[44,12,33,10],[44,13,33,11,"setDate"],[44,20,33,18],[44,21,33,19,"cutoff"],[44,27,33,25],[44,28,33,26,"getDate"],[44,35,33,33],[44,36,33,34],[44,37,33,35],[44,40,33,38,"days"],[44,44,33,42],[44,45,33,43],[45,6,34,4],[45,10,34,10,"cutoffStr"],[45,19,34,19],[45,22,34,22,"cutoff"],[45,28,34,28],[45,29,34,29,"toISOString"],[45,40,34,40],[45,41,34,41],[45,42,34,42],[45,43,34,43,"split"],[45,48,34,48],[45,49,34,49],[45,52,34,52],[45,53,34,53],[45,54,34,54],[45,55,34,55],[45,56,34,57],[46,6,36,4],[46,10,36,10,"pts"],[46,13,36,13],[46,16,36,16,"history"],[46,23,36,23],[46,24,36,24,"points"],[46,30,36,30],[46,31,36,31,"filter"],[46,37,36,37],[46,38,36,39,"p"],[46,39,36,40],[46,43,36,45,"p"],[46,44,36,46],[46,45,36,47,"date"],[46,49,36,51],[46,53,36,55,"cutoffStr"],[46,62,36,64],[46,63,36,65],[47,6,37,4],[47,10,37,8,"pts"],[47,13,37,11],[47,14,37,12,"length"],[47,20,37,18],[47,23,37,21],[47,24,37,22],[47,26,37,24],[47,33,37,31,"history"],[47,40,37,38],[47,41,37,39],[47,42,37,40],[49,6,39,4],[49,10,39,8,"high"],[49,14,39,12],[49,17,39,15],[49,18,39,16,"Infinity"],[49,26,39,24],[50,6,40,4],[50,10,40,8,"low"],[50,13,40,11],[50,16,40,14,"Infinity"],[50,24,40,22],[51,6,41,4],[51,11,41,9],[51,15,41,15,"p"],[51,16,41,16],[51,20,41,20,"pts"],[51,23,41,23],[51,25,41,25],[52,8,42,6],[52,12,42,10,"p"],[52,13,42,11],[52,14,42,12,"price"],[52,19,42,17],[52,22,42,20,"high"],[52,26,42,24],[52,28,42,26,"high"],[52,32,42,30],[52,35,42,33,"p"],[52,36,42,34],[52,37,42,35,"price"],[52,42,42,40],[53,8,43,6],[53,12,43,10,"p"],[53,13,43,11],[53,14,43,12,"price"],[53,19,43,17],[53,22,43,20,"low"],[53,25,43,23],[53,27,43,25,"low"],[53,30,43,28],[53,33,43,31,"p"],[53,34,43,32],[53,35,43,33,"price"],[53,40,43,38],[54,6,44,4],[55,6,46,4],[55,10,46,10,"first"],[55,15,46,15],[55,18,46,18,"pts"],[55,21,46,21],[55,22,46,22],[55,23,46,23],[55,24,46,24],[55,25,46,26,"price"],[55,30,46,31],[56,6,47,4],[56,10,47,10,"last"],[56,14,47,14],[56,17,47,17,"pts"],[56,20,47,20],[56,21,47,21,"pts"],[56,24,47,24],[56,25,47,25,"length"],[56,31,47,31],[56,34,47,34],[56,35,47,35],[56,36,47,36],[56,37,47,38,"price"],[56,42,47,43],[57,6,48,4],[57,10,48,10,"changePercent"],[57,23,48,23],[57,26,49,6,"first"],[57,31,49,11],[57,34,49,14],[57,35,49,15],[57,38,50,10,"Math"],[57,42,50,14],[57,43,50,15,"round"],[57,48,50,20],[57,49,50,22],[57,50,50,23,"last"],[57,54,50,27],[57,57,50,30,"first"],[57,62,50,35],[57,66,50,39,"first"],[57,71,50,44],[57,74,50,48],[57,79,50,53],[57,80,50,54],[57,83,50,57],[57,86,50,60],[57,89,51,10],[57,90,51,11],[58,6,53,4],[58,13,53,11],[59,8,54,6,"points"],[59,14,54,12],[59,16,54,14,"pts"],[59,19,54,17],[60,8,55,6,"high"],[60,12,55,10],[60,14,55,12,"Math"],[60,18,55,16],[60,19,55,17,"round"],[60,24,55,22],[60,25,55,23,"high"],[60,29,55,27],[60,32,55,30],[60,35,55,33],[60,36,55,34],[60,39,55,37],[60,42,55,40],[61,8,56,6,"low"],[61,11,56,9],[61,13,56,11,"Math"],[61,17,56,15],[61,18,56,16,"round"],[61,23,56,21],[61,24,56,22,"low"],[61,27,56,25],[61,30,56,28],[61,33,56,31],[61,34,56,32],[61,37,56,35],[61,40,56,38],[62,8,57,6,"changePercent"],[63,6,58,4],[63,7,58,5],[64,4,59,2],[64,5,59,3],[64,7,59,5],[64,8,59,6,"detail"],[64,14,59,12],[64,16,59,14,"period"],[64,22,59,20],[64,23,59,21],[64,24,59,22],[65,4,61,2],[65,11,61,9],[66,6,61,11,"data"],[66,10,61,15],[66,12,61,17,"filtered"],[66,20,61,25],[67,6,61,27,"isLoading"],[68,4,61,37],[68,5,61,38],[69,2,62,0],[69,3,62,1],[70,2,62,2,"_s"],[70,4,62,2],[70,5,17,6,"usePriceHistory"],[70,20,17,21],[71,4,17,21],[71,12,18,38,"useQuery"],[71,31,18,46],[71,32,18,46,"useQuery"],[71,40,18,46],[72,2,18,46],[73,2,64,0],[73,6,64,0,"_default"],[73,14,64,0],[73,17,64,15,"usePriceHistory"],[73,32,64,30],[74,0,64,31],[74,3]],"functionMap":{"names":["<global>","usePriceHistory","useQuery$argument_0.queryFn","useMemo$argument_0","history.points.filter$argument_0"],"mappings":"AAA;wBCgB;aCG,+CD;2BEK;sCCW,0BD;GFuB;CDG"},"hasCjsExports":false},"type":"js/module"}]}