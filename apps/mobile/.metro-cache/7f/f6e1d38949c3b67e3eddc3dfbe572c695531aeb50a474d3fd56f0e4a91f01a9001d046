{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"./normalizeScrydex/normalizeScrydex","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":141},"end":{"line":8,"column":45,"index":290}}],"key":"b0KpTPspXtChSl7/zv3aftK6OpQ=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"createScrydexAdapter\", {\n    enumerable: true,\n    get: function () {\n      return createScrydexAdapter;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _normalizeScrydexNormalizeScrydex = require(_dependencyMap[1], \"./normalizeScrydex/normalizeScrydex\");\n  var BASE_URL = 'https://api.scrydex.com';\n  /**\n   * Creates headers with Scrydex API key and team ID.\n   */\n  var buildHeaders = (apiKey, teamId) => ({\n    'X-Api-Key': apiKey,\n    'X-Team-ID': teamId,\n    'Content-Type': 'application/json'\n  });\n\n  /**\n   * Infers the TCG type from a Scrydex card ID by trying each TCG path.\n   * Used when the caller only has an externalId without a TCG context.\n   */\n  var inferTcgFromId = externalId => {\n    if (externalId.startsWith('op')) return 'onepiece';\n    if (externalId.includes('-') && /^[a-f0-9]{8}-/.test(externalId)) return 'mtg';\n    return 'pokemon';\n  };\n\n  /**\n   * Creates a Scrydex-backed CardDataAdapter.\n   *\n   * Requires a valid Scrydex API key and team ID.\n   * Falls back to the mock adapter if these are not configured.\n   */\n  var createScrydexAdapter = (apiKey, teamId) => {\n    var headers = buildHeaders(apiKey, teamId);\n    var searchCards = /*#__PURE__*/function () {\n      var _ref = (0, _asyncToGenerator.default)(function* (query, tcg) {\n        var tcgPath = (0, _normalizeScrydexNormalizeScrydex.getScrydexTcgPath)(tcg);\n        var url = `${BASE_URL}/${tcgPath}/v1/cards?q=name:${encodeURIComponent(query)}&page_size=20&select=id,name,number,rarity,images,expansion&include=prices`;\n        var res = yield fetch(url, {\n          headers\n        });\n        if (!res.ok) {\n          if (res.status === 404) return [];\n          throw new Error(`Scrydex search error (${res.status})`);\n        }\n        var body = yield res.json();\n        return (body.data ?? []).map(card => (0, _normalizeScrydexNormalizeScrydex.normalizeScrydexCard)(card, tcg));\n      });\n      return function searchCards(_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    var getCardDetail = /*#__PURE__*/function () {\n      var _ref2 = (0, _asyncToGenerator.default)(function* (externalId) {\n        // Try each TCG until we find the card\n        var tcgsToTry = [inferTcgFromId(externalId), 'pokemon', 'mtg', 'onepiece'];\n        var tried = new Set();\n        for (var tcg of tcgsToTry) {\n          if (tried.has(tcg)) continue;\n          tried.add(tcg);\n          var tcgPath = (0, _normalizeScrydexNormalizeScrydex.getScrydexTcgPath)(tcg);\n          var url = `${BASE_URL}/${tcgPath}/v1/cards/${encodeURIComponent(externalId)}?include=prices`;\n          var res = yield fetch(url, {\n            headers\n          });\n          if (res.ok) {\n            var body = yield res.json();\n            var card = body.data ?? body;\n            return (0, _normalizeScrydexNormalizeScrydex.normalizeScrydexCardDetail)(card, tcg);\n          }\n          if (res.status !== 404) {\n            throw new Error(`Scrydex detail error (${res.status})`);\n          }\n        }\n        return null;\n      });\n      return function getCardDetail(_x3) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    var searchSets = /*#__PURE__*/function () {\n      var _ref3 = (0, _asyncToGenerator.default)(function* (query, tcg) {\n        var tcgPath = (0, _normalizeScrydexNormalizeScrydex.getScrydexTcgPath)(tcg);\n        var url = `${BASE_URL}/${tcgPath}/v1/expansions?q=name:${encodeURIComponent(query)}`;\n        var res = yield fetch(url, {\n          headers\n        });\n        if (!res.ok) {\n          if (res.status === 404) return [];\n          throw new Error(`Scrydex sets error (${res.status})`);\n        }\n        var body = yield res.json();\n        return (body.data ?? []).map(exp => ({\n          id: exp.id,\n          name: exp.name,\n          code: exp.code,\n          releaseDate: exp.release_date,\n          totalCards: exp.total_cards,\n          logoUrl: exp.logo_url ?? null\n        }));\n      });\n      return function searchSets(_x4, _x5) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n    return {\n      searchCards,\n      getCardDetail,\n      searchSets\n    };\n  };\n});","lineCount":126,"map":[[12,2,55,0,"Object"],[12,8,55,0],[12,9,55,0,"defineProperty"],[12,23,55,0],[12,24,55,0,"exports"],[12,31,55,0],[13,4,55,0,"enumerable"],[13,14,55,0],[14,4,55,0,"get"],[14,7,55,0],[14,18,55,0,"get"],[14,19,55,0],[15,6,55,0],[15,13,55,0,"createScrydexAdapter"],[15,33,55,0],[16,4,55,0],[17,2,55,0],[18,2,137,2],[18,6,137,2,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,137,2],[18,45,137,2,"require"],[18,52,137,2],[18,53,137,2,"_dependencyMap"],[18,67,137,2],[19,2,137,2],[19,6,137,2,"_asyncToGenerator"],[19,23,137,2],[19,26,137,2,"_interopDefault"],[19,41,137,2],[19,42,137,2,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,137,2],[20,2,3,0],[20,6,3,0,"_normalizeScrydexNormalizeScrydex"],[20,39,3,0],[20,42,3,0,"require"],[20,49,3,0],[20,50,3,0,"_dependencyMap"],[20,64,3,0],[21,2,10,0],[21,6,10,6,"BASE_URL"],[21,14,10,14],[21,17,10,17],[21,42,10,42],[22,2,30,0],[23,0,31,0],[24,0,32,0],[25,2,33,0],[25,6,33,6,"buildHeaders"],[25,18,33,18],[25,21,33,21,"buildHeaders"],[25,22,33,22,"apiKey"],[25,28,33,36],[25,30,33,38,"teamId"],[25,36,33,52],[25,42,33,82],[26,4,34,2],[26,15,34,13],[26,17,34,15,"apiKey"],[26,23,34,21],[27,4,35,2],[27,15,35,13],[27,17,35,15,"teamId"],[27,23,35,21],[28,4,36,2],[28,18,36,16],[28,20,36,18],[29,2,37,0],[29,3,37,1],[29,4,37,2],[31,2,39,0],[32,0,40,0],[33,0,41,0],[34,0,42,0],[35,2,43,0],[35,6,43,6,"inferTcgFromId"],[35,20,43,20],[35,23,43,24,"externalId"],[35,33,43,42],[35,37,43,56],[36,4,44,2],[36,8,44,6,"externalId"],[36,18,44,16],[36,19,44,17,"startsWith"],[36,29,44,27],[36,30,44,28],[36,34,44,32],[36,35,44,33],[36,37,44,35],[36,44,44,42],[36,54,44,52],[37,4,45,2],[37,8,45,6,"externalId"],[37,18,45,16],[37,19,45,17,"includes"],[37,27,45,25],[37,28,45,26],[37,31,45,29],[37,32,45,30],[37,36,45,34],[37,51,45,49],[37,52,45,50,"test"],[37,56,45,54],[37,57,45,55,"externalId"],[37,67,45,65],[37,68,45,66],[37,70,45,68],[37,77,45,75],[37,82,45,80],[38,4,46,2],[38,11,46,9],[38,20,46,18],[39,2,47,0],[39,3,47,1],[41,2,49,0],[42,0,50,0],[43,0,51,0],[44,0,52,0],[45,0,53,0],[46,0,54,0],[47,2,55,7],[47,6,55,13,"createScrydexAdapter"],[47,26,55,33],[47,29,55,36,"createScrydexAdapter"],[47,30,56,2,"apiKey"],[47,36,56,16],[47,38,57,2,"teamId"],[47,44,57,16],[47,49,58,22],[48,4,59,2],[48,8,59,8,"headers"],[48,15,59,15],[48,18,59,18,"buildHeaders"],[48,30,59,30],[48,31,59,31,"apiKey"],[48,37,59,37],[48,39,59,39,"teamId"],[48,45,59,45],[48,46,59,46],[49,4,61,2],[49,8,61,8,"searchCards"],[49,19,61,51],[50,6,61,51],[50,10,61,51,"_ref"],[50,14,61,51],[50,21,61,51,"_asyncToGenerator"],[50,38,61,51],[50,39,61,51,"default"],[50,46,61,51],[50,48,61,54],[50,59,62,4,"query"],[50,64,62,17],[50,66,63,4,"tcg"],[50,69,63,15],[50,71,64,34],[51,8,65,4],[51,12,65,10,"tcgPath"],[51,19,65,17],[51,22,65,20],[51,26,65,20,"getScrydexTcgPath"],[51,59,65,37],[51,60,65,37,"getScrydexTcgPath"],[51,77,65,37],[51,79,65,38,"tcg"],[51,82,65,41],[51,83,65,42],[52,8,66,4],[52,12,66,10,"url"],[52,15,66,13],[52,18,66,16],[52,21,66,19,"BASE_URL"],[52,29,66,27],[52,33,66,31,"tcgPath"],[52,40,66,38],[52,60,66,58,"encodeURIComponent"],[52,78,66,76],[52,79,66,77,"query"],[52,84,66,82],[52,85,66,83],[52,161,66,159],[53,8,68,4],[53,12,68,10,"res"],[53,15,68,13],[53,24,68,22,"fetch"],[53,29,68,27],[53,30,68,28,"url"],[53,33,68,31],[53,35,68,33],[54,10,68,35,"headers"],[55,8,68,43],[55,9,68,44],[55,10,68,45],[56,8,70,4],[56,12,70,8],[56,13,70,9,"res"],[56,16,70,12],[56,17,70,13,"ok"],[56,19,70,15],[56,21,70,17],[57,10,71,6],[57,14,71,10,"res"],[57,17,71,13],[57,18,71,14,"status"],[57,24,71,20],[57,29,71,25],[57,32,71,28],[57,34,71,30],[57,41,71,37],[57,43,71,39],[58,10,72,6],[58,16,72,12],[58,20,72,16,"Error"],[58,25,72,21],[58,26,72,22],[58,51,72,47,"res"],[58,54,72,50],[58,55,72,51,"status"],[58,61,72,57],[58,64,72,60],[58,65,72,61],[59,8,73,4],[60,8,75,4],[60,12,75,10,"body"],[60,16,75,35],[60,25,75,44,"res"],[60,28,75,47],[60,29,75,48,"json"],[60,33,75,52],[60,34,75,53],[60,35,75,54],[61,8,76,4],[61,15,76,11],[61,16,76,12,"body"],[61,20,76,16],[61,21,76,17,"data"],[61,25,76,21],[61,29,76,25],[61,31,76,27],[61,33,76,29,"map"],[61,36,76,32],[61,37,76,34,"card"],[61,41,76,38],[61,45,77,6],[61,49,77,6,"normalizeScrydexCard"],[61,82,77,26],[61,83,77,26,"normalizeScrydexCard"],[61,103,77,26],[61,105,77,27,"card"],[61,109,77,31],[61,111,77,33,"tcg"],[61,114,77,47],[61,115,78,4],[61,116,78,5],[62,6,79,2],[62,7,79,3],[63,6,79,3],[63,22,61,8,"searchCards"],[63,33,61,51,"searchCards"],[63,34,61,51,"_x"],[63,36,61,51],[63,38,61,51,"_x2"],[63,41,61,51],[64,8,61,51],[64,15,61,51,"_ref"],[64,19,61,51],[64,20,61,51,"apply"],[64,25,61,51],[64,32,61,51,"arguments"],[64,41,61,51],[65,6,61,51],[66,4,61,51],[66,7,79,3],[67,4,81,2],[67,8,81,8,"getCardDetail"],[67,21,81,55],[68,6,81,55],[68,10,81,55,"_ref2"],[68,15,81,55],[68,22,81,55,"_asyncToGenerator"],[68,39,81,55],[68,40,81,55,"default"],[68,47,81,55],[68,49,81,58],[68,60,82,4,"externalId"],[68,70,82,22],[68,72,83,35],[69,8,84,4],[70,8,85,4],[70,12,85,10,"tcgsToTry"],[70,21,85,30],[70,24,85,33],[70,25,85,34,"inferTcgFromId"],[70,39,85,48],[70,40,85,49,"externalId"],[70,50,85,59],[70,51,85,60],[70,53,85,62],[70,62,85,71],[70,64,85,73],[70,69,85,78],[70,71,85,80],[70,81,85,90],[70,82,85,91],[71,8,86,4],[71,12,86,10,"tried"],[71,17,86,15],[71,20,86,18],[71,24,86,22,"Set"],[71,27,86,25],[71,28,86,34],[71,29,86,35],[72,8,88,4],[72,13,88,9],[72,17,88,15,"tcg"],[72,20,88,18],[72,24,88,22,"tcgsToTry"],[72,33,88,31],[72,35,88,33],[73,10,89,6],[73,14,89,10,"tried"],[73,19,89,15],[73,20,89,16,"has"],[73,23,89,19],[73,24,89,20,"tcg"],[73,27,89,23],[73,28,89,24],[73,30,89,26],[74,10,90,6,"tried"],[74,15,90,11],[74,16,90,12,"add"],[74,19,90,15],[74,20,90,16,"tcg"],[74,23,90,19],[74,24,90,20],[75,10,92,6],[75,14,92,12,"tcgPath"],[75,21,92,19],[75,24,92,22],[75,28,92,22,"getScrydexTcgPath"],[75,61,92,39],[75,62,92,39,"getScrydexTcgPath"],[75,79,92,39],[75,81,92,40,"tcg"],[75,84,92,43],[75,85,92,44],[76,10,93,6],[76,14,93,12,"url"],[76,17,93,15],[76,20,93,18],[76,23,93,21,"BASE_URL"],[76,31,93,29],[76,35,93,33,"tcgPath"],[76,42,93,40],[76,55,93,53,"encodeURIComponent"],[76,73,93,71],[76,74,93,72,"externalId"],[76,84,93,82],[76,85,93,83],[76,102,93,100],[77,10,95,6],[77,14,95,12,"res"],[77,17,95,15],[77,26,95,24,"fetch"],[77,31,95,29],[77,32,95,30,"url"],[77,35,95,33],[77,37,95,35],[78,12,95,37,"headers"],[79,10,95,45],[79,11,95,46],[79,12,95,47],[80,10,97,6],[80,14,97,10,"res"],[80,17,97,13],[80,18,97,14,"ok"],[80,20,97,16],[80,22,97,18],[81,12,98,8],[81,16,98,14,"body"],[81,20,98,18],[81,29,98,27,"res"],[81,32,98,30],[81,33,98,31,"json"],[81,37,98,35],[81,38,98,36],[81,39,98,37],[82,12,99,8],[82,16,99,14,"card"],[82,20,99,31],[82,23,99,34,"body"],[82,27,99,38],[82,28,99,39,"data"],[82,32,99,43],[82,36,99,47,"body"],[82,40,99,51],[83,12,100,8],[83,19,100,15],[83,23,100,15,"normalizeScrydexCardDetail"],[83,56,100,41],[83,57,100,41,"normalizeScrydexCardDetail"],[83,83,100,41],[83,85,100,42,"card"],[83,89,100,46],[83,91,100,48,"tcg"],[83,94,100,51],[83,95,100,52],[84,10,101,6],[85,10,103,6],[85,14,103,10,"res"],[85,17,103,13],[85,18,103,14,"status"],[85,24,103,20],[85,29,103,25],[85,32,103,28],[85,34,103,30],[86,12,104,8],[86,18,104,14],[86,22,104,18,"Error"],[86,27,104,23],[86,28,104,24],[86,53,104,49,"res"],[86,56,104,52],[86,57,104,53,"status"],[86,63,104,59],[86,66,104,62],[86,67,104,63],[87,10,105,6],[88,8,106,4],[89,8,108,4],[89,15,108,11],[89,19,108,15],[90,6,109,2],[90,7,109,3],[91,6,109,3],[91,22,81,8,"getCardDetail"],[91,35,81,55,"getCardDetail"],[91,36,81,55,"_x3"],[91,39,81,55],[92,8,81,55],[92,15,81,55,"_ref2"],[92,20,81,55],[92,21,81,55,"apply"],[92,26,81,55],[92,33,81,55,"arguments"],[92,42,81,55],[93,6,81,55],[94,4,81,55],[94,7,109,3],[95,4,111,2],[95,8,111,8,"searchSets"],[95,18,111,49],[96,6,111,49],[96,10,111,49,"_ref3"],[96,15,111,49],[96,22,111,49,"_asyncToGenerator"],[96,39,111,49],[96,40,111,49,"default"],[96,47,111,49],[96,49,111,52],[96,60,112,4,"query"],[96,65,112,17],[96,67,113,4,"tcg"],[96,70,113,15],[96,72,114,27],[97,8,115,4],[97,12,115,10,"tcgPath"],[97,19,115,17],[97,22,115,20],[97,26,115,20,"getScrydexTcgPath"],[97,59,115,37],[97,60,115,37,"getScrydexTcgPath"],[97,77,115,37],[97,79,115,38,"tcg"],[97,82,115,41],[97,83,115,42],[98,8,116,4],[98,12,116,10,"url"],[98,15,116,13],[98,18,116,16],[98,21,116,19,"BASE_URL"],[98,29,116,27],[98,33,116,31,"tcgPath"],[98,40,116,38],[98,65,116,63,"encodeURIComponent"],[98,83,116,81],[98,84,116,82,"query"],[98,89,116,87],[98,90,116,88],[98,92,116,90],[99,8,118,4],[99,12,118,10,"res"],[99,15,118,13],[99,24,118,22,"fetch"],[99,29,118,27],[99,30,118,28,"url"],[99,33,118,31],[99,35,118,33],[100,10,118,35,"headers"],[101,8,118,43],[101,9,118,44],[101,10,118,45],[102,8,120,4],[102,12,120,8],[102,13,120,9,"res"],[102,16,120,12],[102,17,120,13,"ok"],[102,19,120,15],[102,21,120,17],[103,10,121,6],[103,14,121,10,"res"],[103,17,121,13],[103,18,121,14,"status"],[103,24,121,20],[103,29,121,25],[103,32,121,28],[103,34,121,30],[103,41,121,37],[103,43,121,39],[104,10,122,6],[104,16,122,12],[104,20,122,16,"Error"],[104,25,122,21],[104,26,122,22],[104,49,122,45,"res"],[104,52,122,48],[104,53,122,49,"status"],[104,59,122,55],[104,62,122,58],[104,63,122,59],[105,8,123,4],[106,8,125,4],[106,12,125,10,"body"],[106,16,125,44],[106,25,125,53,"res"],[106,28,125,56],[106,29,125,57,"json"],[106,33,125,61],[106,34,125,62],[106,35,125,63],[107,8,126,4],[107,15,126,11],[107,16,126,12,"body"],[107,20,126,16],[107,21,126,17,"data"],[107,25,126,21],[107,29,126,25],[107,31,126,27],[107,33,126,29,"map"],[107,36,126,32],[107,37,126,34,"exp"],[107,40,126,37],[107,45,126,43],[108,10,127,6,"id"],[108,12,127,8],[108,14,127,10,"exp"],[108,17,127,13],[108,18,127,14,"id"],[108,20,127,16],[109,10,128,6,"name"],[109,14,128,10],[109,16,128,12,"exp"],[109,19,128,15],[109,20,128,16,"name"],[109,24,128,20],[110,10,129,6,"code"],[110,14,129,10],[110,16,129,12,"exp"],[110,19,129,15],[110,20,129,16,"code"],[110,24,129,20],[111,10,130,6,"releaseDate"],[111,21,130,17],[111,23,130,19,"exp"],[111,26,130,22],[111,27,130,23,"release_date"],[111,39,130,35],[112,10,131,6,"totalCards"],[112,20,131,16],[112,22,131,18,"exp"],[112,25,131,21],[112,26,131,22,"total_cards"],[112,37,131,33],[113,10,132,6,"logoUrl"],[113,17,132,13],[113,19,132,15,"exp"],[113,22,132,18],[113,23,132,19,"logo_url"],[113,31,132,27],[113,35,132,31],[114,8,133,4],[114,9,133,5],[114,10,133,6],[114,11,133,7],[115,6,134,2],[115,7,134,3],[116,6,134,3],[116,22,111,8,"searchSets"],[116,32,111,49,"searchSets"],[116,33,111,49,"_x4"],[116,36,111,49],[116,38,111,49,"_x5"],[116,41,111,49],[117,8,111,49],[117,15,111,49,"_ref3"],[117,20,111,49],[117,21,111,49,"apply"],[117,26,111,49],[117,33,111,49,"arguments"],[117,42,111,49],[118,6,111,49],[119,4,111,49],[119,7,134,3],[120,4,136,2],[120,11,136,9],[121,6,136,11,"searchCards"],[121,17,136,22],[122,6,136,24,"getCardDetail"],[122,19,136,37],[123,6,136,39,"searchSets"],[124,4,136,50],[124,5,136,51],[125,2,137,0],[125,3,137,1],[126,0,137,2],[126,3]],"functionMap":{"names":["<global>","buildHeaders","inferTcgFromId","createScrydexAdapter","searchCards","map$argument_0","getCardDetail","searchSets"],"mappings":"AAA;qBCgC;EDI;uBEM;CFI;oCGQ;sDCM;iCCe;gDDC;GDE;0DGE;GH4B;oDIE;iCFe;MEO;GJC;CHG"},"hasCjsExports":false},"type":"js/module"}]}