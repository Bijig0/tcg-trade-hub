{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":49,"index":142}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":43,"index":186}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"fetchLikedListings\", {\n    enumerable: true,\n    get: function () {\n      return fetchLikedListings;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[3], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Fetches listings a user has swiped \"like\" on.\n   * Extracted as a standalone function so both the hook and prefetch use the same queryFn.\n   */\n  var fetchLikedListings = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator.default)(function* (userId) {\n      // 1. Get liked listing IDs\n      var _yield$supabase$from$ = yield _libSupabase.supabase.from('swipes').select('listing_id, created_at').eq('user_id', userId).eq('direction', 'like').order('created_at', {\n          ascending: false\n        }),\n        swipes = _yield$supabase$from$.data,\n        swipeError = _yield$supabase$from$.error;\n      if (swipeError) throw swipeError;\n      if (!swipes || swipes.length === 0) return [];\n      var likedIds = swipes.map(s => s.listing_id);\n\n      // 2. Fetch the actual listings\n      var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listings').select(`\n      *,\n      listing_items (*),\n      users!inner (\n        id,\n        display_name,\n        avatar_url,\n        location,\n        rating_score,\n        total_trades\n      )\n    `).in('id', likedIds).eq('status', 'active'),\n        rawListings = _yield$supabase$from$2.data,\n        listingError = _yield$supabase$from$2.error;\n      if (listingError) throw listingError;\n      if (!rawListings) return [];\n\n      // 3. Transform to ListingWithDistance and preserve swipe order\n      var listingMap = new Map();\n      for (var listing of rawListings) {\n        var userProfile = listing.users;\n        var items = listing.listing_items ?? [];\n        listingMap.set(listing.id, {\n          id: listing.id,\n          user_id: listing.user_id,\n          type: listing.type,\n          tcg: listing.tcg,\n          title: listing.title,\n          cash_amount: listing.cash_amount,\n          total_value: listing.total_value,\n          description: listing.description,\n          photos: listing.photos,\n          status: listing.status,\n          created_at: listing.created_at,\n          updated_at: listing.updated_at,\n          distance_km: 0,\n          owner: {\n            display_name: userProfile.display_name,\n            avatar_url: userProfile.avatar_url,\n            rating_score: userProfile.rating_score ?? 0,\n            total_trades: userProfile.total_trades ?? 0\n          },\n          items,\n          offer_count: 0\n        });\n      }\n\n      // Return in swipe order (most recent first), filtering out inactive/deleted\n      return likedIds.map(id => listingMap.get(id)).filter(l => l !== undefined);\n    });\n    return function fetchLikedListings(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Fetches listings the current user has swiped \"like\" on.\n   *\n   * Queries the swipes table for likes, then fetches the corresponding active\n   * listings with items and owner profiles. Returns most-recently-liked first.\n   */\n  var useLikedListings = () => {\n    _s();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.feedKeys.liked(),\n      queryFn: () => fetchLikedListings(user.id),\n      enabled: !!user\n    });\n  };\n  _s(useLikedListings, \"feBfegY2LWvVkHAo3/+H6/HJ9O4=\", false, function () {\n    return [_contextAuthProvider.useAuth, _tanstackReactQuery.useQuery];\n  });\n  var _default = useLikedListings;\n});","lineCount":123,"map":[[13,2,108,0,"Object"],[13,8,108,0],[13,9,108,0,"defineProperty"],[13,23,108,0],[13,24,108,0,"exports"],[13,31,108,0],[14,4,108,0,"enumerable"],[14,14,108,0],[15,4,108,0,"get"],[15,7,108,0],[15,18,108,0,"get"],[15,19,108,0],[16,6,108,0],[16,13,108,0,"_default"],[16,21,108,0],[17,4,108,0],[18,2,108,0],[19,2,11,0,"Object"],[19,8,11,0],[19,9,11,0,"defineProperty"],[19,23,11,0],[19,24,11,0,"exports"],[19,31,11,0],[20,4,11,0,"enumerable"],[20,14,11,0],[21,4,11,0,"get"],[21,7,11,0],[21,18,11,0,"get"],[21,19,11,0],[22,6,11,0],[22,13,11,0,"fetchLikedListings"],[22,31,11,0],[23,4,11,0],[24,2,11,0],[25,2,90,2],[25,6,90,2,"_babelRuntimeHelpersAsyncToGenerator"],[25,42,90,2],[25,45,90,2,"require"],[25,52,90,2],[25,53,90,2,"_dependencyMap"],[25,67,90,2],[26,2,90,2],[26,6,90,2,"_asyncToGenerator"],[26,23,90,2],[26,26,90,2,"_interopDefault"],[26,41,90,2],[26,42,90,2,"_babelRuntimeHelpersAsyncToGenerator"],[26,78,90,2],[27,2,1,0],[27,6,1,0,"_tanstackReactQuery"],[27,25,1,0],[27,28,1,0,"require"],[27,35,1,0],[27,36,1,0,"_dependencyMap"],[27,50,1,0],[28,2,2,0],[28,6,2,0,"_libSupabase"],[28,18,2,0],[28,21,2,0,"require"],[28,28,2,0],[28,29,2,0,"_dependencyMap"],[28,43,2,0],[29,2,3,0],[29,6,3,0,"_contextAuthProvider"],[29,26,3,0],[29,29,3,0,"require"],[29,36,3,0],[29,37,3,0,"_dependencyMap"],[29,51,3,0],[30,2,4,0],[30,6,4,0,"_queryKeys"],[30,16,4,0],[30,19,4,0,"require"],[30,26,4,0],[30,27,4,0,"_dependencyMap"],[30,41,4,0],[31,2,7,0],[32,0,8,0],[33,0,9,0],[34,0,10,0],[35,2,11,7],[35,6,11,13,"fetchLikedListings"],[35,24,11,31],[36,4,11,31],[36,8,11,31,"_ref"],[36,12,11,31],[36,19,11,31,"_asyncToGenerator"],[36,36,11,31],[36,37,11,31,"default"],[36,44,11,31],[36,46,11,34],[36,57,11,41,"userId"],[36,63,11,55],[36,65,11,60],[37,6,12,2],[38,6,13,2],[38,10,13,2,"_yield$supabase$from$"],[38,31,13,2],[38,40,13,52,"supabase"],[38,52,13,60],[38,53,13,60,"supabase"],[38,61,13,60],[38,62,14,5,"from"],[38,66,14,9],[38,67,14,10],[38,75,14,18],[38,76,14,19],[38,77,15,5,"select"],[38,83,15,11],[38,84,15,12],[38,108,15,36],[38,109,15,37],[38,110,16,5,"eq"],[38,112,16,7],[38,113,16,8],[38,122,16,17],[38,124,16,19,"userId"],[38,130,16,25],[38,131,16,26],[38,132,17,5,"eq"],[38,134,17,7],[38,135,17,8],[38,146,17,19],[38,148,17,21],[38,154,17,27],[38,155,17,28],[38,156,18,5,"order"],[38,161,18,10],[38,162,18,11],[38,174,18,23],[38,176,18,25],[39,10,18,27,"ascending"],[39,19,18,36],[39,21,18,38],[40,8,18,44],[40,9,18,45],[40,10,18,46],[41,8,13,16,"swipes"],[41,14,13,22],[41,17,13,22,"_yield$supabase$from$"],[41,38,13,22],[41,39,13,10,"data"],[41,43,13,14],[42,8,13,31,"swipeError"],[42,18,13,41],[42,21,13,41,"_yield$supabase$from$"],[42,42,13,41],[42,43,13,24,"error"],[42,48,13,29],[43,6,20,2],[43,10,20,6,"swipeError"],[43,20,20,16],[43,22,20,18],[43,28,20,24,"swipeError"],[43,38,20,34],[44,6,21,2],[44,10,21,6],[44,11,21,7,"swipes"],[44,17,21,13],[44,21,21,17,"swipes"],[44,27,21,23],[44,28,21,24,"length"],[44,34,21,30],[44,39,21,35],[44,40,21,36],[44,42,21,38],[44,49,21,45],[44,51,21,47],[45,6,23,2],[45,10,23,8,"likedIds"],[45,18,23,16],[45,21,23,19,"swipes"],[45,27,23,25],[45,28,23,26,"map"],[45,31,23,29],[45,32,23,31,"s"],[45,33,23,32],[45,37,23,37,"s"],[45,38,23,38],[45,39,23,39,"listing_id"],[45,49,23,49],[45,50,23,50],[47,6,25,2],[48,6,26,2],[48,10,26,2,"_yield$supabase$from$2"],[48,32,26,2],[48,41,26,59,"supabase"],[48,53,26,67],[48,54,26,67,"supabase"],[48,62,26,67],[48,63,27,5,"from"],[48,67,27,9],[48,68,27,10],[48,78,27,20],[48,79,27,21],[48,80,28,5,"select"],[48,86,28,11],[48,87,28,12],[49,0,29,0],[50,0,30,0],[51,0,31,0],[52,0,32,0],[53,0,33,0],[54,0,34,0],[55,0,35,0],[56,0,36,0],[57,0,37,0],[58,0,38,0],[59,0,39,0],[59,5,39,5],[59,6,39,6],[59,7,40,5,"in"],[59,9,40,7],[59,10,40,8],[59,14,40,12],[59,16,40,14,"likedIds"],[59,24,40,22],[59,25,40,23],[59,26,41,5,"eq"],[59,28,41,7],[59,29,41,8],[59,37,41,16],[59,39,41,18],[59,47,41,26],[59,48,41,27],[60,8,26,16,"rawListings"],[60,19,26,27],[60,22,26,27,"_yield$supabase$from$2"],[60,44,26,27],[60,45,26,10,"data"],[60,49,26,14],[61,8,26,36,"listingError"],[61,20,26,48],[61,23,26,48,"_yield$supabase$from$2"],[61,45,26,48],[61,46,26,29,"error"],[61,51,26,34],[62,6,43,2],[62,10,43,6,"listingError"],[62,22,43,18],[62,24,43,20],[62,30,43,26,"listingError"],[62,42,43,38],[63,6,44,2],[63,10,44,6],[63,11,44,7,"rawListings"],[63,22,44,18],[63,24,44,20],[63,31,44,27],[63,33,44,29],[65,6,46,2],[66,6,47,2],[66,10,47,8,"listingMap"],[66,20,47,18],[66,23,47,21],[66,27,47,25,"Map"],[66,30,47,28],[66,31,47,58],[66,32,47,59],[67,6,49,2],[67,11,49,7],[67,15,49,13,"listing"],[67,22,49,20],[67,26,49,24,"rawListings"],[67,37,49,35],[67,39,49,37],[68,8,50,4],[68,12,50,10,"userProfile"],[68,23,50,21],[68,26,50,24,"listing"],[68,33,50,31],[68,34,50,32,"users"],[68,39,57,5],[69,8,59,4],[69,12,59,10,"items"],[69,17,59,15],[69,20,59,19,"listing"],[69,27,59,26],[69,28,59,27,"listing_items"],[69,41,59,40],[69,45,59,44],[69,47,59,90],[70,8,61,4,"listingMap"],[70,18,61,14],[70,19,61,15,"set"],[70,22,61,18],[70,23,61,19,"listing"],[70,30,61,26],[70,31,61,27,"id"],[70,33,61,29],[70,35,61,31],[71,10,62,6,"id"],[71,12,62,8],[71,14,62,10,"listing"],[71,21,62,17],[71,22,62,18,"id"],[71,24,62,20],[72,10,63,6,"user_id"],[72,17,63,13],[72,19,63,15,"listing"],[72,26,63,22],[72,27,63,23,"user_id"],[72,34,63,30],[73,10,64,6,"type"],[73,14,64,10],[73,16,64,12,"listing"],[73,23,64,19],[73,24,64,20,"type"],[73,28,64,24],[74,10,65,6,"tcg"],[74,13,65,9],[74,15,65,11,"listing"],[74,22,65,18],[74,23,65,19,"tcg"],[74,26,65,22],[75,10,66,6,"title"],[75,15,66,11],[75,17,66,13,"listing"],[75,24,66,20],[75,25,66,21,"title"],[75,30,66,26],[76,10,67,6,"cash_amount"],[76,21,67,17],[76,23,67,19,"listing"],[76,30,67,26],[76,31,67,27,"cash_amount"],[76,42,67,38],[77,10,68,6,"total_value"],[77,21,68,17],[77,23,68,19,"listing"],[77,30,68,26],[77,31,68,27,"total_value"],[77,42,68,38],[78,10,69,6,"description"],[78,21,69,17],[78,23,69,19,"listing"],[78,30,69,26],[78,31,69,27,"description"],[78,42,69,38],[79,10,70,6,"photos"],[79,16,70,12],[79,18,70,14,"listing"],[79,25,70,21],[79,26,70,22,"photos"],[79,32,70,28],[80,10,71,6,"status"],[80,16,71,12],[80,18,71,14,"listing"],[80,25,71,21],[80,26,71,22,"status"],[80,32,71,28],[81,10,72,6,"created_at"],[81,20,72,16],[81,22,72,18,"listing"],[81,29,72,25],[81,30,72,26,"created_at"],[81,40,72,36],[82,10,73,6,"updated_at"],[82,20,73,16],[82,22,73,18,"listing"],[82,29,73,25],[82,30,73,26,"updated_at"],[82,40,73,36],[83,10,74,6,"distance_km"],[83,21,74,17],[83,23,74,19],[83,24,74,20],[84,10,75,6,"owner"],[84,15,75,11],[84,17,75,13],[85,12,76,8,"display_name"],[85,24,76,20],[85,26,76,22,"userProfile"],[85,37,76,33],[85,38,76,34,"display_name"],[85,50,76,46],[86,12,77,8,"avatar_url"],[86,22,77,18],[86,24,77,20,"userProfile"],[86,35,77,31],[86,36,77,32,"avatar_url"],[86,46,77,42],[87,12,78,8,"rating_score"],[87,24,78,20],[87,26,78,22,"userProfile"],[87,37,78,33],[87,38,78,34,"rating_score"],[87,50,78,46],[87,54,78,50],[87,55,78,51],[88,12,79,8,"total_trades"],[88,24,79,20],[88,26,79,22,"userProfile"],[88,37,79,33],[88,38,79,34,"total_trades"],[88,50,79,46],[88,54,79,50],[89,10,80,6],[89,11,80,7],[90,10,81,6,"items"],[90,15,81,11],[91,10,82,6,"offer_count"],[91,21,82,17],[91,23,82,19],[92,8,83,4],[92,9,83,5],[92,10,83,6],[93,6,84,2],[95,6,86,2],[96,6,87,2],[96,13,87,9,"likedIds"],[96,21,87,17],[96,22,88,5,"map"],[96,25,88,8],[96,26,88,10,"id"],[96,28,88,12],[96,32,88,17,"listingMap"],[96,42,88,27],[96,43,88,28,"get"],[96,46,88,31],[96,47,88,32,"id"],[96,49,88,34],[96,50,88,35],[96,51,88,36],[96,52,89,5,"filter"],[96,58,89,11],[96,59,89,13,"l"],[96,60,89,14],[96,64,89,45,"l"],[96,65,89,46],[96,70,89,51,"undefined"],[96,79,89,60],[96,80,89,61],[97,4,90,0],[97,5,90,1],[98,4,90,1],[98,20,11,13,"fetchLikedListings"],[98,38,11,31,"fetchLikedListings"],[98,39,11,31,"_x"],[98,41,11,31],[99,6,11,31],[99,13,11,31,"_ref"],[99,17,11,31],[99,18,11,31,"apply"],[99,23,11,31],[99,30,11,31,"arguments"],[99,39,11,31],[100,4,11,31],[101,2,11,31],[101,5,90,1],[103,2,92,0],[104,0,93,0],[105,0,94,0],[106,0,95,0],[107,0,96,0],[108,0,97,0],[109,2,98,0],[109,6,98,6,"useLikedListings"],[109,22,98,22],[109,25,98,25,"useLikedListings"],[109,26,98,25],[109,31,98,31],[110,4,98,31,"_s"],[110,6,98,31],[111,4,99,2],[111,8,99,2,"_useAuth"],[111,16,99,2],[111,19,99,19],[111,23,99,19,"useAuth"],[111,43,99,26],[111,44,99,26,"useAuth"],[111,51,99,26],[111,53,99,27],[111,54,99,28],[112,6,99,10,"user"],[112,10,99,14],[112,13,99,14,"_useAuth"],[112,21,99,14],[112,22,99,10,"user"],[112,26,99,14],[113,4,101,2],[113,11,101,9],[113,15,101,9,"useQuery"],[113,34,101,17],[113,35,101,17,"useQuery"],[113,43,101,17],[113,45,101,48],[114,6,102,4,"queryKey"],[114,14,102,12],[114,16,102,14,"feedKeys"],[114,26,102,22],[114,27,102,22,"feedKeys"],[114,35,102,22],[114,36,102,23,"liked"],[114,41,102,28],[114,42,102,29],[114,43,102,30],[115,6,103,4,"queryFn"],[115,13,103,11],[115,15,103,13,"queryFn"],[115,16,103,13],[115,21,103,19,"fetchLikedListings"],[115,39,103,37],[115,40,103,38,"user"],[115,44,103,42],[115,45,103,44,"id"],[115,47,103,46],[115,48,103,47],[116,6,104,4,"enabled"],[116,13,104,11],[116,15,104,13],[116,16,104,14],[116,17,104,15,"user"],[117,4,105,2],[117,5,105,3],[117,6,105,4],[118,2,106,0],[118,3,106,1],[119,2,106,2,"_s"],[119,4,106,2],[119,5,98,6,"useLikedListings"],[119,21,98,22],[120,4,98,22],[120,12,99,19,"useAuth"],[120,32,99,26],[120,33,99,26,"useAuth"],[120,40,99,26],[120,42,101,9,"useQuery"],[120,61,101,17],[120,62,101,17,"useQuery"],[120,70,101,17],[121,2,101,17],[122,2,108,0],[122,6,108,0,"_default"],[122,14,108,0],[122,17,108,15,"useLikedListings"],[122,33,108,31],[123,0,108,32],[123,3]],"functionMap":{"names":["<global>","fetchLikedListings","swipes.map$argument_0","likedIds.map$argument_0","likedIds.map.filter$argument_0","useLikedListings","useQuery$argument_0.queryFn"],"mappings":"AAA;kCCU;8BCY,mBD;SEiE,0BF;YGC,gDH;CDC;yBKQ;aCK,kCD;CLG"},"hasCjsExports":false},"type":"js/module"}]}