{"dependencies":[{"name":"@/utils/parseLocationCoords/parseLocationCoords","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":82,"index":140}}],"key":"qd6WXtcycH/euWng1Negl3DCKIM=","exportNames":["*"],"imports":1}},{"name":"@/utils/haversineDistance/haversineDistance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":141},"end":{"line":3,"column":76,"index":217}}],"key":"JuSMlqvSjDI9z8uumb0S5tj7ov0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _utilsParseLocationCoordsParseLocationCoords = require(_dependencyMap[0], \"@/utils/parseLocationCoords/parseLocationCoords\");\n  var parseLocationCoords = _interopDefault(_utilsParseLocationCoordsParseLocationCoords);\n  var _utilsHaversineDistanceHaversineDistance = require(_dependencyMap[1], \"@/utils/haversineDistance/haversineDistance\");\n  var haversineDistance = _interopDefault(_utilsHaversineDistanceHaversineDistance);\n  /**\n   * Shape of a raw listing row returned from the Supabase query\n   * with joined `listing_items` and `users`.\n   */\n\n  /**\n   * Transforms a raw Supabase listing row (with joined relations)\n   * into the `ListingWithDistance` shape used by the feed UI.\n   *\n   * Computes real distance_km using the Haversine formula when\n   * both listing location and user location are available.\n   * Falls back to 0 when either location is missing.\n   */\n  var transformRawListing = (raw, userLocation) => {\n    var userProfile = raw.users;\n    var items = raw.listing_items ?? [];\n\n    // Resolve listing location: prefer listing.location, fall back to owner's location\n    var listingCoords = (0, parseLocationCoords.default)(raw.location) ?? (0, parseLocationCoords.default)(userProfile.location);\n    var distanceKm = listingCoords && userLocation ? (0, haversineDistance.default)(userLocation, listingCoords) : 0;\n    return {\n      id: raw.id,\n      user_id: raw.user_id,\n      type: raw.type,\n      tcg: raw.tcg,\n      title: raw.title,\n      cash_amount: raw.cash_amount,\n      total_value: raw.total_value,\n      description: raw.description,\n      photos: raw.photos,\n      trade_wants: raw.trade_wants ?? [],\n      accepts_cash: raw.accepts_cash ?? false,\n      accepts_trades: raw.accepts_trades ?? false,\n      location: raw.location ?? null,\n      location_name: raw.location_name ?? null,\n      status: raw.status,\n      created_at: raw.created_at,\n      updated_at: raw.updated_at,\n      distance_km: Math.round(distanceKm * 10) / 10,\n      owner: {\n        display_name: userProfile.display_name,\n        avatar_url: userProfile.avatar_url,\n        rating_score: userProfile.rating_score ?? 0,\n        total_trades: userProfile.total_trades ?? 0\n      },\n      items,\n      offer_count: 0\n    };\n  };\n  var _default = transformRawListing;\n});","lineCount":72,"map":[[12,2,97,0,"Object"],[12,8,97,0],[12,9,97,0,"defineProperty"],[12,23,97,0],[12,24,97,0,"exports"],[12,31,97,0],[13,4,97,0,"enumerable"],[13,14,97,0],[14,4,97,0,"get"],[14,7,97,0],[14,18,97,0,"get"],[14,19,97,0],[15,6,97,0],[15,13,97,0,"_default"],[15,21,97,0],[16,4,97,0],[17,2,97,0],[18,2,2,0],[18,6,2,0,"_utilsParseLocationCoordsParseLocationCoords"],[18,50,2,0],[18,53,2,0,"require"],[18,60,2,0],[18,61,2,0,"_dependencyMap"],[18,75,2,0],[19,2,2,0],[19,6,2,0,"parseLocationCoords"],[19,25,2,0],[19,28,2,0,"_interopDefault"],[19,43,2,0],[19,44,2,0,"_utilsParseLocationCoordsParseLocationCoords"],[19,88,2,0],[20,2,3,0],[20,6,3,0,"_utilsHaversineDistanceHaversineDistance"],[20,46,3,0],[20,49,3,0,"require"],[20,56,3,0],[20,57,3,0,"_dependencyMap"],[20,71,3,0],[21,2,3,0],[21,6,3,0,"haversineDistance"],[21,23,3,0],[21,26,3,0,"_interopDefault"],[21,41,3,0],[21,42,3,0,"_utilsHaversineDistanceHaversineDistance"],[21,82,3,0],[22,2,14,0],[23,0,15,0],[24,0,16,0],[25,0,17,0],[27,2,42,0],[28,0,43,0],[29,0,44,0],[30,0,45,0],[31,0,46,0],[32,0,47,0],[33,0,48,0],[34,0,49,0],[35,2,50,0],[35,6,50,6,"transformRawListing"],[35,25,50,25],[35,28,50,28,"transformRawListing"],[35,29,51,2,"raw"],[35,32,51,21],[35,34,52,2,"userLocation"],[35,46,52,34],[35,51,53,26],[36,4,54,2],[36,8,54,8,"userProfile"],[36,19,54,19],[36,22,54,22,"raw"],[36,25,54,25],[36,26,54,26,"users"],[36,31,54,49],[37,4,55,2],[37,8,55,8,"items"],[37,13,55,13],[37,16,55,17,"raw"],[37,19,55,20],[37,20,55,21,"listing_items"],[37,33,55,34],[37,37,55,38],[37,39,55,84],[39,4,57,2],[40,4,58,2],[40,8,58,8,"listingCoords"],[40,21,58,21],[40,24,59,4],[40,28,59,4,"parseLocationCoords"],[40,47,59,23],[40,48,59,23,"default"],[40,55,59,23],[40,57,59,24,"raw"],[40,60,59,27],[40,61,59,28,"location"],[40,69,59,36],[40,70,59,37],[40,74,60,4],[40,78,60,4,"parseLocationCoords"],[40,97,60,23],[40,98,60,23,"default"],[40,105,60,23],[40,107,60,24,"userProfile"],[40,118,60,35],[40,119,60,36,"location"],[40,127,60,44],[40,128,60,45],[41,4,62,2],[41,8,62,8,"distanceKm"],[41,18,62,18],[41,21,63,4,"listingCoords"],[41,34,63,17],[41,38,63,21,"userLocation"],[41,50,63,33],[41,53,64,8],[41,57,64,8,"haversineDistance"],[41,74,64,25],[41,75,64,25,"default"],[41,82,64,25],[41,84,64,26,"userLocation"],[41,96,64,38],[41,98,64,40,"listingCoords"],[41,111,64,53],[41,112,64,54],[41,115,65,8],[41,116,65,9],[42,4,67,2],[42,11,67,9],[43,6,68,4,"id"],[43,8,68,6],[43,10,68,8,"raw"],[43,13,68,11],[43,14,68,12,"id"],[43,16,68,14],[44,6,69,4,"user_id"],[44,13,69,11],[44,15,69,13,"raw"],[44,18,69,16],[44,19,69,17,"user_id"],[44,26,69,24],[45,6,70,4,"type"],[45,10,70,8],[45,12,70,10,"raw"],[45,15,70,13],[45,16,70,14,"type"],[45,20,70,18],[46,6,71,4,"tcg"],[46,9,71,7],[46,11,71,9,"raw"],[46,14,71,12],[46,15,71,13,"tcg"],[46,18,71,16],[47,6,72,4,"title"],[47,11,72,9],[47,13,72,11,"raw"],[47,16,72,14],[47,17,72,15,"title"],[47,22,72,20],[48,6,73,4,"cash_amount"],[48,17,73,15],[48,19,73,17,"raw"],[48,22,73,20],[48,23,73,21,"cash_amount"],[48,34,73,32],[49,6,74,4,"total_value"],[49,17,74,15],[49,19,74,17,"raw"],[49,22,74,20],[49,23,74,21,"total_value"],[49,34,74,32],[50,6,75,4,"description"],[50,17,75,15],[50,19,75,17,"raw"],[50,22,75,20],[50,23,75,21,"description"],[50,34,75,32],[51,6,76,4,"photos"],[51,12,76,10],[51,14,76,12,"raw"],[51,17,76,15],[51,18,76,16,"photos"],[51,24,76,22],[52,6,77,4,"trade_wants"],[52,17,77,15],[52,19,77,17,"raw"],[52,22,77,20],[52,23,77,21,"trade_wants"],[52,34,77,32],[52,38,77,36],[52,40,77,38],[53,6,78,4,"accepts_cash"],[53,18,78,16],[53,20,78,18,"raw"],[53,23,78,21],[53,24,78,22,"accepts_cash"],[53,36,78,34],[53,40,78,38],[53,45,78,43],[54,6,79,4,"accepts_trades"],[54,20,79,18],[54,22,79,20,"raw"],[54,25,79,23],[54,26,79,24,"accepts_trades"],[54,40,79,38],[54,44,79,42],[54,49,79,47],[55,6,80,4,"location"],[55,14,80,12],[55,16,80,14,"raw"],[55,19,80,17],[55,20,80,18,"location"],[55,28,80,26],[55,32,80,30],[55,36,80,34],[56,6,81,4,"location_name"],[56,19,81,17],[56,21,81,19,"raw"],[56,24,81,22],[56,25,81,23,"location_name"],[56,38,81,36],[56,42,81,40],[56,46,81,44],[57,6,82,4,"status"],[57,12,82,10],[57,14,82,12,"raw"],[57,17,82,15],[57,18,82,16,"status"],[57,24,82,22],[58,6,83,4,"created_at"],[58,16,83,14],[58,18,83,16,"raw"],[58,21,83,19],[58,22,83,20,"created_at"],[58,32,83,30],[59,6,84,4,"updated_at"],[59,16,84,14],[59,18,84,16,"raw"],[59,21,84,19],[59,22,84,20,"updated_at"],[59,32,84,30],[60,6,85,4,"distance_km"],[60,17,85,15],[60,19,85,17,"Math"],[60,23,85,21],[60,24,85,22,"round"],[60,29,85,27],[60,30,85,28,"distanceKm"],[60,40,85,38],[60,43,85,41],[60,45,85,43],[60,46,85,44],[60,49,85,47],[60,51,85,49],[61,6,86,4,"owner"],[61,11,86,9],[61,13,86,11],[62,8,87,6,"display_name"],[62,20,87,18],[62,22,87,20,"userProfile"],[62,33,87,31],[62,34,87,32,"display_name"],[62,46,87,44],[63,8,88,6,"avatar_url"],[63,18,88,16],[63,20,88,18,"userProfile"],[63,31,88,29],[63,32,88,30,"avatar_url"],[63,42,88,40],[64,8,89,6,"rating_score"],[64,20,89,18],[64,22,89,20,"userProfile"],[64,33,89,31],[64,34,89,32,"rating_score"],[64,46,89,44],[64,50,89,48],[64,51,89,49],[65,8,90,6,"total_trades"],[65,20,90,18],[65,22,90,20,"userProfile"],[65,33,90,31],[65,34,90,32,"total_trades"],[65,46,90,44],[65,50,90,48],[66,6,91,4],[66,7,91,5],[67,6,92,4,"items"],[67,11,92,9],[68,6,93,4,"offer_count"],[68,17,93,15],[68,19,93,17],[69,4,94,2],[69,5,94,3],[70,2,95,0],[70,3,95,1],[71,2,97,0],[71,6,97,0,"_default"],[71,14,97,0],[71,17,97,15,"transformRawListing"],[71,36,97,34],[72,0,97,35],[72,3]],"functionMap":{"names":["<global>","transformRawListing"],"mappings":"AAA;4BCiD;CD6C"},"hasCjsExports":false},"type":"js/module"}]}