{"dependencies":[{"name":"@/utils/parseLocationCoords/parseLocationCoords","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":82,"index":140}}],"key":"qd6WXtcycH/euWng1Negl3DCKIM=","exportNames":["*"],"imports":1}},{"name":"@/utils/haversineDistance/haversineDistance","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":141},"end":{"line":3,"column":76,"index":217}}],"key":"JuSMlqvSjDI9z8uumb0S5tj7ov0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _utilsParseLocationCoordsParseLocationCoords = require(_dependencyMap[0], \"@/utils/parseLocationCoords/parseLocationCoords\");\n  var parseLocationCoords = _interopDefault(_utilsParseLocationCoordsParseLocationCoords);\n  var _utilsHaversineDistanceHaversineDistance = require(_dependencyMap[1], \"@/utils/haversineDistance/haversineDistance\");\n  var haversineDistance = _interopDefault(_utilsHaversineDistanceHaversineDistance);\n  /**\n   * Shape of a raw listing row returned from the Supabase query\n   * with joined `listing_items` and `users`.\n   */\n\n  /**\n   * Transforms a raw Supabase listing row (with joined relations)\n   * into the `ListingWithDistance` shape used by the feed UI.\n   *\n   * Computes real distance_km using the Haversine formula when\n   * both listing location and user location are available.\n   * Falls back to 0 when either location is missing.\n   */\n  var transformRawListing = (raw, userLocation) => {\n    var userProfile = raw.users;\n    var items = raw.listing_items ?? [];\n    var shopData = raw.shops;\n\n    // Resolve listing location: prefer listing.location, fall back to owner's location\n    var listingCoords = (0, parseLocationCoords.default)(raw.location) ?? (0, parseLocationCoords.default)(userProfile.location);\n    var distanceKm = listingCoords && userLocation ? (0, haversineDistance.default)(userLocation, listingCoords) : 0;\n    return {\n      id: raw.id,\n      user_id: raw.user_id,\n      type: raw.type,\n      tcg: raw.tcg,\n      title: raw.title,\n      cash_amount: raw.cash_amount,\n      total_value: raw.total_value,\n      description: raw.description,\n      photos: raw.photos,\n      trade_wants: raw.trade_wants ?? [],\n      accepts_cash: raw.accepts_cash ?? false,\n      accepts_trades: raw.accepts_trades ?? false,\n      location: raw.location ?? null,\n      location_name: raw.location_name ?? null,\n      status: raw.status,\n      created_at: raw.created_at,\n      updated_at: raw.updated_at,\n      distance_km: Math.round(distanceKm * 10) / 10,\n      owner: {\n        display_name: userProfile.display_name,\n        avatar_url: userProfile.avatar_url,\n        rating_score: userProfile.rating_score ?? 0,\n        total_trades: userProfile.total_trades ?? 0\n      },\n      items,\n      offer_count: 0,\n      shop: shopData ?? null\n    };\n  };\n  var _default = transformRawListing;\n});","lineCount":74,"map":[[12,2,100,0,"Object"],[12,8,100,0],[12,9,100,0,"defineProperty"],[12,23,100,0],[12,24,100,0,"exports"],[12,31,100,0],[13,4,100,0,"enumerable"],[13,14,100,0],[14,4,100,0,"get"],[14,7,100,0],[14,18,100,0,"get"],[14,19,100,0],[15,6,100,0],[15,13,100,0,"_default"],[15,21,100,0],[16,4,100,0],[17,2,100,0],[18,2,2,0],[18,6,2,0,"_utilsParseLocationCoordsParseLocationCoords"],[18,50,2,0],[18,53,2,0,"require"],[18,60,2,0],[18,61,2,0,"_dependencyMap"],[18,75,2,0],[19,2,2,0],[19,6,2,0,"parseLocationCoords"],[19,25,2,0],[19,28,2,0,"_interopDefault"],[19,43,2,0],[19,44,2,0,"_utilsParseLocationCoordsParseLocationCoords"],[19,88,2,0],[20,2,3,0],[20,6,3,0,"_utilsHaversineDistanceHaversineDistance"],[20,46,3,0],[20,49,3,0,"require"],[20,56,3,0],[20,57,3,0,"_dependencyMap"],[20,71,3,0],[21,2,3,0],[21,6,3,0,"haversineDistance"],[21,23,3,0],[21,26,3,0,"_interopDefault"],[21,41,3,0],[21,42,3,0,"_utilsHaversineDistanceHaversineDistance"],[21,82,3,0],[22,2,14,0],[23,0,15,0],[24,0,16,0],[25,0,17,0],[27,2,43,0],[28,0,44,0],[29,0,45,0],[30,0,46,0],[31,0,47,0],[32,0,48,0],[33,0,49,0],[34,0,50,0],[35,2,51,0],[35,6,51,6,"transformRawListing"],[35,25,51,25],[35,28,51,28,"transformRawListing"],[35,29,52,2,"raw"],[35,32,52,21],[35,34,53,2,"userLocation"],[35,46,53,34],[35,51,54,26],[36,4,55,2],[36,8,55,8,"userProfile"],[36,19,55,19],[36,22,55,22,"raw"],[36,25,55,25],[36,26,55,26,"users"],[36,31,55,49],[37,4,56,2],[37,8,56,8,"items"],[37,13,56,13],[37,16,56,17,"raw"],[37,19,56,20],[37,20,56,21,"listing_items"],[37,33,56,34],[37,37,56,38],[37,39,56,84],[38,4,57,2],[38,8,57,8,"shopData"],[38,16,57,16],[38,19,57,19,"raw"],[38,22,57,22],[38,23,57,23,"shops"],[38,28,57,99],[40,4,59,2],[41,4,60,2],[41,8,60,8,"listingCoords"],[41,21,60,21],[41,24,61,4],[41,28,61,4,"parseLocationCoords"],[41,47,61,23],[41,48,61,23,"default"],[41,55,61,23],[41,57,61,24,"raw"],[41,60,61,27],[41,61,61,28,"location"],[41,69,61,36],[41,70,61,37],[41,74,62,4],[41,78,62,4,"parseLocationCoords"],[41,97,62,23],[41,98,62,23,"default"],[41,105,62,23],[41,107,62,24,"userProfile"],[41,118,62,35],[41,119,62,36,"location"],[41,127,62,44],[41,128,62,45],[42,4,64,2],[42,8,64,8,"distanceKm"],[42,18,64,18],[42,21,65,4,"listingCoords"],[42,34,65,17],[42,38,65,21,"userLocation"],[42,50,65,33],[42,53,66,8],[42,57,66,8,"haversineDistance"],[42,74,66,25],[42,75,66,25,"default"],[42,82,66,25],[42,84,66,26,"userLocation"],[42,96,66,38],[42,98,66,40,"listingCoords"],[42,111,66,53],[42,112,66,54],[42,115,67,8],[42,116,67,9],[43,4,69,2],[43,11,69,9],[44,6,70,4,"id"],[44,8,70,6],[44,10,70,8,"raw"],[44,13,70,11],[44,14,70,12,"id"],[44,16,70,14],[45,6,71,4,"user_id"],[45,13,71,11],[45,15,71,13,"raw"],[45,18,71,16],[45,19,71,17,"user_id"],[45,26,71,24],[46,6,72,4,"type"],[46,10,72,8],[46,12,72,10,"raw"],[46,15,72,13],[46,16,72,14,"type"],[46,20,72,18],[47,6,73,4,"tcg"],[47,9,73,7],[47,11,73,9,"raw"],[47,14,73,12],[47,15,73,13,"tcg"],[47,18,73,16],[48,6,74,4,"title"],[48,11,74,9],[48,13,74,11,"raw"],[48,16,74,14],[48,17,74,15,"title"],[48,22,74,20],[49,6,75,4,"cash_amount"],[49,17,75,15],[49,19,75,17,"raw"],[49,22,75,20],[49,23,75,21,"cash_amount"],[49,34,75,32],[50,6,76,4,"total_value"],[50,17,76,15],[50,19,76,17,"raw"],[50,22,76,20],[50,23,76,21,"total_value"],[50,34,76,32],[51,6,77,4,"description"],[51,17,77,15],[51,19,77,17,"raw"],[51,22,77,20],[51,23,77,21,"description"],[51,34,77,32],[52,6,78,4,"photos"],[52,12,78,10],[52,14,78,12,"raw"],[52,17,78,15],[52,18,78,16,"photos"],[52,24,78,22],[53,6,79,4,"trade_wants"],[53,17,79,15],[53,19,79,17,"raw"],[53,22,79,20],[53,23,79,21,"trade_wants"],[53,34,79,32],[53,38,79,36],[53,40,79,38],[54,6,80,4,"accepts_cash"],[54,18,80,16],[54,20,80,18,"raw"],[54,23,80,21],[54,24,80,22,"accepts_cash"],[54,36,80,34],[54,40,80,38],[54,45,80,43],[55,6,81,4,"accepts_trades"],[55,20,81,18],[55,22,81,20,"raw"],[55,25,81,23],[55,26,81,24,"accepts_trades"],[55,40,81,38],[55,44,81,42],[55,49,81,47],[56,6,82,4,"location"],[56,14,82,12],[56,16,82,14,"raw"],[56,19,82,17],[56,20,82,18,"location"],[56,28,82,26],[56,32,82,30],[56,36,82,34],[57,6,83,4,"location_name"],[57,19,83,17],[57,21,83,19,"raw"],[57,24,83,22],[57,25,83,23,"location_name"],[57,38,83,36],[57,42,83,40],[57,46,83,44],[58,6,84,4,"status"],[58,12,84,10],[58,14,84,12,"raw"],[58,17,84,15],[58,18,84,16,"status"],[58,24,84,22],[59,6,85,4,"created_at"],[59,16,85,14],[59,18,85,16,"raw"],[59,21,85,19],[59,22,85,20,"created_at"],[59,32,85,30],[60,6,86,4,"updated_at"],[60,16,86,14],[60,18,86,16,"raw"],[60,21,86,19],[60,22,86,20,"updated_at"],[60,32,86,30],[61,6,87,4,"distance_km"],[61,17,87,15],[61,19,87,17,"Math"],[61,23,87,21],[61,24,87,22,"round"],[61,29,87,27],[61,30,87,28,"distanceKm"],[61,40,87,38],[61,43,87,41],[61,45,87,43],[61,46,87,44],[61,49,87,47],[61,51,87,49],[62,6,88,4,"owner"],[62,11,88,9],[62,13,88,11],[63,8,89,6,"display_name"],[63,20,89,18],[63,22,89,20,"userProfile"],[63,33,89,31],[63,34,89,32,"display_name"],[63,46,89,44],[64,8,90,6,"avatar_url"],[64,18,90,16],[64,20,90,18,"userProfile"],[64,31,90,29],[64,32,90,30,"avatar_url"],[64,42,90,40],[65,8,91,6,"rating_score"],[65,20,91,18],[65,22,91,20,"userProfile"],[65,33,91,31],[65,34,91,32,"rating_score"],[65,46,91,44],[65,50,91,48],[65,51,91,49],[66,8,92,6,"total_trades"],[66,20,92,18],[66,22,92,20,"userProfile"],[66,33,92,31],[66,34,92,32,"total_trades"],[66,46,92,44],[66,50,92,48],[67,6,93,4],[67,7,93,5],[68,6,94,4,"items"],[68,11,94,9],[69,6,95,4,"offer_count"],[69,17,95,15],[69,19,95,17],[69,20,95,18],[70,6,96,4,"shop"],[70,10,96,8],[70,12,96,10,"shopData"],[70,20,96,18],[70,24,96,22],[71,4,97,2],[71,5,97,3],[72,2,98,0],[72,3,98,1],[73,2,100,0],[73,6,100,0,"_default"],[73,14,100,0],[73,17,100,15,"transformRawListing"],[73,36,100,34],[74,0,100,35],[74,3]],"functionMap":{"names":["<global>","transformRawListing"],"mappings":"AAA;4BCkD;CD+C"},"hasCjsExports":false},"type":"js/module"}]}