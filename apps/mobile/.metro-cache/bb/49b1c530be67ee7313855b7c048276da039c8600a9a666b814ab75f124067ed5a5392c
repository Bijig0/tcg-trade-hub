{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"../../../feed/queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":159},"end":{"line":4,"column":51,"index":210}}],"key":"fOhRZkI3VX68oiFPDy9rlJOS+w8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _queryKeys = require(_dependencyMap[3]);\n  var _feedQueryKeys = require(_dependencyMap[4]);\n  /**\n   * Hook that expires a listing via atomic Postgres RPC.\n   *\n   * Atomically transitions the listing to 'expired' and withdraws\n   * all pending offers. Invalidates myListings and feed queries on success.\n   *\n   * @see packages/api/src/pipelines/expireListing/expireListing.ts\n   */\n  var useDeleteListing = () => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (listingId) {\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session?.user?.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('expire_listing_v1', {\n              p_listing_id: listingId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          return data;\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.myListings()\n        });\n        queryClient.invalidateQueries({\n          queryKey: _feedQueryKeys.feedKeys.lists()\n        });\n      }\n    });\n  };\n  var _default = useDeleteListing;\n});","lineCount":65,"map":[[12,2,47,0,"Object"],[12,8,47,0],[12,9,47,0,"defineProperty"],[12,23,47,0],[12,24,47,0,"exports"],[12,31,47,0],[13,4,47,0,"enumerable"],[13,14,47,0],[14,4,47,0,"get"],[14,7,47,0],[14,18,47,0,"get"],[14,19,47,0],[15,6,47,0],[15,13,47,0,"_default"],[15,21,47,0],[16,4,47,0],[17,2,47,0],[18,2,47,32],[18,6,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,47,32],[18,45,47,32,"require"],[18,52,47,32],[18,53,47,32,"_dependencyMap"],[18,67,47,32],[19,2,47,32],[19,6,47,32,"_asyncToGenerator"],[19,23,47,32],[19,26,47,32,"_interopDefault"],[19,41,47,32],[19,42,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,47,32],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_libSupabase"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_queryKeys"],[22,16,3,0],[22,19,3,0,"require"],[22,26,3,0],[22,27,3,0,"_dependencyMap"],[22,41,3,0],[23,2,4,0],[23,6,4,0,"_feedQueryKeys"],[23,20,4,0],[23,23,4,0,"require"],[23,30,4,0],[23,31,4,0,"_dependencyMap"],[23,45,4,0],[24,2,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[30,0,17,0],[31,0,18,0],[32,2,19,0],[32,6,19,6,"useDeleteListing"],[32,22,19,22],[32,25,19,25,"useDeleteListing"],[32,26,19,25],[32,31,19,31],[33,4,20,2],[33,8,20,8,"queryClient"],[33,19,20,19],[33,22,20,22],[33,26,20,22,"useQueryClient"],[33,45,20,36],[33,46,20,36,"useQueryClient"],[33,60,20,36],[33,62,20,37],[33,63,20,38],[34,4,22,2],[34,11,22,9],[34,15,22,9,"useMutation"],[34,34,22,20],[34,35,22,20,"useMutation"],[34,46,22,20],[34,48,22,50],[35,6,23,4,"mutationFn"],[35,16,23,14],[36,8,23,14],[36,12,23,14,"_ref"],[36,16,23,14],[36,23,23,14,"_asyncToGenerator"],[36,40,23,14],[36,41,23,14,"default"],[36,48,23,14],[36,50,23,16],[36,61,23,23,"listingId"],[36,70,23,32],[36,72,23,37],[37,10,24,6],[37,14,24,6,"_yield$supabase$auth$"],[37,35,24,6],[37,44,26,16,"supabase"],[37,56,26,24],[37,57,26,24,"supabase"],[37,65,26,24],[37,66,26,25,"auth"],[37,70,26,29],[37,71,26,30,"getSession"],[37,81,26,40],[37,82,26,41],[37,83,26,42],[38,12,25,16,"session"],[38,19,25,23],[38,22,25,23,"_yield$supabase$auth$"],[38,43,25,23],[38,44,25,8,"data"],[38,48,25,12],[38,49,25,16,"session"],[38,56,25,23],[39,10,27,6],[39,14,27,12,"userId"],[39,20,27,18],[39,23,27,21,"session"],[39,30,27,28],[39,32,27,30,"user"],[39,36,27,34],[39,38,27,36,"id"],[39,40,27,38],[40,10,29,6],[40,14,29,10],[40,15,29,11,"userId"],[40,21,29,17],[40,23,29,19],[40,29,29,25],[40,33,29,29,"Error"],[40,38,29,34],[40,39,29,35],[40,58,29,54],[40,59,29,55],[41,10,31,6],[41,14,31,6,"_yield$supabase$rpc"],[41,33,31,6],[41,42,31,36,"supabase"],[41,54,31,44],[41,55,31,44,"supabase"],[41,63,31,44],[41,64,31,45,"rpc"],[41,67,31,48],[41,68,31,49],[41,87,31,68],[41,89,31,70],[42,14,32,8,"p_listing_id"],[42,26,32,20],[42,28,32,22,"listingId"],[42,37,32,31],[43,14,33,8,"p_user_id"],[43,23,33,17],[43,25,33,19,"userId"],[44,12,34,6],[44,13,34,7],[44,14,34,8],[45,12,31,14,"data"],[45,16,31,18],[45,19,31,18,"_yield$supabase$rpc"],[45,38,31,18],[45,39,31,14,"data"],[45,43,31,18],[46,12,31,20,"error"],[46,17,31,25],[46,20,31,25,"_yield$supabase$rpc"],[46,39,31,25],[46,40,31,20,"error"],[46,45,31,25],[47,10,36,6],[47,14,36,10,"error"],[47,19,36,15],[47,21,36,17],[47,27,36,23,"error"],[47,32,36,28],[48,10,38,6],[48,17,38,13,"data"],[48,21,38,17],[49,8,39,4],[49,9,39,5],[50,8,39,5],[50,24,23,4,"mutationFn"],[50,34,23,14,"mutationFn"],[50,35,23,14,"_x"],[50,37,23,14],[51,10,23,14],[51,17,23,14,"_ref"],[51,21,23,14],[51,22,23,14,"apply"],[51,27,23,14],[51,34,23,14,"arguments"],[51,43,23,14],[52,8,23,14],[53,6,23,14],[53,9,39,5],[54,6,40,4,"onSuccess"],[54,15,40,13],[54,17,40,15,"onSuccess"],[54,18,40,15],[54,23,40,21],[55,8,41,6,"queryClient"],[55,19,41,17],[55,20,41,18,"invalidateQueries"],[55,37,41,35],[55,38,41,36],[56,10,41,38,"queryKey"],[56,18,41,46],[56,20,41,48,"listingKeys"],[56,30,41,59],[56,31,41,59,"listingKeys"],[56,42,41,59],[56,43,41,60,"myListings"],[56,53,41,70],[56,54,41,71],[57,8,41,73],[57,9,41,74],[57,10,41,75],[58,8,42,6,"queryClient"],[58,19,42,17],[58,20,42,18,"invalidateQueries"],[58,37,42,35],[58,38,42,36],[59,10,42,38,"queryKey"],[59,18,42,46],[59,20,42,48,"feedKeys"],[59,34,42,56],[59,35,42,56,"feedKeys"],[59,43,42,56],[59,44,42,57,"lists"],[59,49,42,62],[59,50,42,63],[60,8,42,65],[60,9,42,66],[60,10,42,67],[61,6,43,4],[62,4,44,2],[62,5,44,3],[62,6,44,4],[63,2,45,0],[63,3,45,1],[64,2,47,0],[64,6,47,0,"_default"],[64,14,47,0],[64,17,47,15,"useDeleteListing"],[64,33,47,31],[65,0,47,32],[65,3]],"functionMap":{"names":["<global>","useDeleteListing","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCkB;gBCI;KDgB;eEC;KFG;CDE"},"hasCjsExports":false},"type":"js/module"}]}