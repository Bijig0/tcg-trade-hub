{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":49,"index":142}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":43,"index":186}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"fetchLikedListings\", {\n    enumerable: true,\n    get: function () {\n      return fetchLikedListings;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _contextAuthProvider = require(_dependencyMap[3]);\n  var _queryKeys = require(_dependencyMap[4]);\n  /**\n   * Fetches listings a user has swiped \"like\" on.\n   * Extracted as a standalone function so both the hook and prefetch use the same queryFn.\n   */\n  var fetchLikedListings = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator.default)(function* (userId) {\n      // 1. Get liked listing IDs\n      var _yield$supabase$from$ = yield _libSupabase.supabase.from('swipes').select('listing_id, created_at').eq('user_id', userId).eq('direction', 'like').order('created_at', {\n          ascending: false\n        }),\n        swipes = _yield$supabase$from$.data,\n        swipeError = _yield$supabase$from$.error;\n      if (swipeError) throw swipeError;\n      if (!swipes || swipes.length === 0) return [];\n      var likedIds = swipes.map(s => s.listing_id);\n\n      // 2. Fetch the actual listings\n      var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listings').select(`\n      *,\n      listing_items (*),\n      users!inner (\n        id,\n        display_name,\n        avatar_url,\n        location,\n        rating_score,\n        total_trades\n      )\n    `).in('id', likedIds).eq('status', 'active'),\n        rawListings = _yield$supabase$from$2.data,\n        listingError = _yield$supabase$from$2.error;\n      if (listingError) throw listingError;\n      if (!rawListings) return [];\n\n      // 3. Transform to ListingWithDistance and preserve swipe order\n      var listingMap = new Map();\n      for (var listing of rawListings) {\n        var userProfile = listing.users;\n        var items = listing.listing_items ?? [];\n        listingMap.set(listing.id, {\n          id: listing.id,\n          user_id: listing.user_id,\n          type: listing.type,\n          tcg: listing.tcg,\n          title: listing.title,\n          cash_amount: listing.cash_amount,\n          total_value: listing.total_value,\n          description: listing.description,\n          photos: listing.photos,\n          status: listing.status,\n          created_at: listing.created_at,\n          updated_at: listing.updated_at,\n          distance_km: 0,\n          owner: {\n            display_name: userProfile.display_name,\n            avatar_url: userProfile.avatar_url,\n            rating_score: userProfile.rating_score ?? 0,\n            total_trades: userProfile.total_trades ?? 0\n          },\n          items,\n          offer_count: 0\n        });\n      }\n\n      // Return in swipe order (most recent first), filtering out inactive/deleted\n      return likedIds.map(id => listingMap.get(id)).filter(l => l !== undefined);\n    });\n    return function fetchLikedListings(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Fetches listings the current user has swiped \"like\" on.\n   *\n   * Queries the swipes table for likes, then fetches the corresponding active\n   * listings with items and owner profiles. Returns most-recently-liked first.\n   */\n  var useLikedListings = () => {\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.feedKeys.liked(),\n      queryFn: () => fetchLikedListings(user.id),\n      enabled: !!user\n    });\n  };\n  var _default = useLikedListings;\n});","lineCount":118,"map":[[12,2,108,0,"Object"],[12,8,108,0],[12,9,108,0,"defineProperty"],[12,23,108,0],[12,24,108,0,"exports"],[12,31,108,0],[13,4,108,0,"enumerable"],[13,14,108,0],[14,4,108,0,"get"],[14,7,108,0],[14,18,108,0,"get"],[14,19,108,0],[15,6,108,0],[15,13,108,0,"_default"],[15,21,108,0],[16,4,108,0],[17,2,108,0],[18,2,11,0,"Object"],[18,8,11,0],[18,9,11,0,"defineProperty"],[18,23,11,0],[18,24,11,0,"exports"],[18,31,11,0],[19,4,11,0,"enumerable"],[19,14,11,0],[20,4,11,0,"get"],[20,7,11,0],[20,18,11,0,"get"],[20,19,11,0],[21,6,11,0],[21,13,11,0,"fetchLikedListings"],[21,31,11,0],[22,4,11,0],[23,2,11,0],[24,2,90,2],[24,6,90,2,"_babelRuntimeHelpersAsyncToGenerator"],[24,42,90,2],[24,45,90,2,"require"],[24,52,90,2],[24,53,90,2,"_dependencyMap"],[24,67,90,2],[25,2,90,2],[25,6,90,2,"_asyncToGenerator"],[25,23,90,2],[25,26,90,2,"_interopDefault"],[25,41,90,2],[25,42,90,2,"_babelRuntimeHelpersAsyncToGenerator"],[25,78,90,2],[26,2,1,0],[26,6,1,0,"_tanstackReactQuery"],[26,25,1,0],[26,28,1,0,"require"],[26,35,1,0],[26,36,1,0,"_dependencyMap"],[26,50,1,0],[27,2,2,0],[27,6,2,0,"_libSupabase"],[27,18,2,0],[27,21,2,0,"require"],[27,28,2,0],[27,29,2,0,"_dependencyMap"],[27,43,2,0],[28,2,3,0],[28,6,3,0,"_contextAuthProvider"],[28,26,3,0],[28,29,3,0,"require"],[28,36,3,0],[28,37,3,0,"_dependencyMap"],[28,51,3,0],[29,2,4,0],[29,6,4,0,"_queryKeys"],[29,16,4,0],[29,19,4,0,"require"],[29,26,4,0],[29,27,4,0,"_dependencyMap"],[29,41,4,0],[30,2,7,0],[31,0,8,0],[32,0,9,0],[33,0,10,0],[34,2,11,7],[34,6,11,13,"fetchLikedListings"],[34,24,11,31],[35,4,11,31],[35,8,11,31,"_ref"],[35,12,11,31],[35,19,11,31,"_asyncToGenerator"],[35,36,11,31],[35,37,11,31,"default"],[35,44,11,31],[35,46,11,34],[35,57,11,41,"userId"],[35,63,11,55],[35,65,11,60],[36,6,12,2],[37,6,13,2],[37,10,13,2,"_yield$supabase$from$"],[37,31,13,2],[37,40,13,52,"supabase"],[37,52,13,60],[37,53,13,60,"supabase"],[37,61,13,60],[37,62,14,5,"from"],[37,66,14,9],[37,67,14,10],[37,75,14,18],[37,76,14,19],[37,77,15,5,"select"],[37,83,15,11],[37,84,15,12],[37,108,15,36],[37,109,15,37],[37,110,16,5,"eq"],[37,112,16,7],[37,113,16,8],[37,122,16,17],[37,124,16,19,"userId"],[37,130,16,25],[37,131,16,26],[37,132,17,5,"eq"],[37,134,17,7],[37,135,17,8],[37,146,17,19],[37,148,17,21],[37,154,17,27],[37,155,17,28],[37,156,18,5,"order"],[37,161,18,10],[37,162,18,11],[37,174,18,23],[37,176,18,25],[38,10,18,27,"ascending"],[38,19,18,36],[38,21,18,38],[39,8,18,44],[39,9,18,45],[39,10,18,46],[40,8,13,16,"swipes"],[40,14,13,22],[40,17,13,22,"_yield$supabase$from$"],[40,38,13,22],[40,39,13,10,"data"],[40,43,13,14],[41,8,13,31,"swipeError"],[41,18,13,41],[41,21,13,41,"_yield$supabase$from$"],[41,42,13,41],[41,43,13,24,"error"],[41,48,13,29],[42,6,20,2],[42,10,20,6,"swipeError"],[42,20,20,16],[42,22,20,18],[42,28,20,24,"swipeError"],[42,38,20,34],[43,6,21,2],[43,10,21,6],[43,11,21,7,"swipes"],[43,17,21,13],[43,21,21,17,"swipes"],[43,27,21,23],[43,28,21,24,"length"],[43,34,21,30],[43,39,21,35],[43,40,21,36],[43,42,21,38],[43,49,21,45],[43,51,21,47],[44,6,23,2],[44,10,23,8,"likedIds"],[44,18,23,16],[44,21,23,19,"swipes"],[44,27,23,25],[44,28,23,26,"map"],[44,31,23,29],[44,32,23,31,"s"],[44,33,23,32],[44,37,23,37,"s"],[44,38,23,38],[44,39,23,39,"listing_id"],[44,49,23,49],[44,50,23,50],[46,6,25,2],[47,6,26,2],[47,10,26,2,"_yield$supabase$from$2"],[47,32,26,2],[47,41,26,59,"supabase"],[47,53,26,67],[47,54,26,67,"supabase"],[47,62,26,67],[47,63,27,5,"from"],[47,67,27,9],[47,68,27,10],[47,78,27,20],[47,79,27,21],[47,80,28,5,"select"],[47,86,28,11],[47,87,28,12],[48,0,29,0],[49,0,30,0],[50,0,31,0],[51,0,32,0],[52,0,33,0],[53,0,34,0],[54,0,35,0],[55,0,36,0],[56,0,37,0],[57,0,38,0],[58,0,39,0],[58,5,39,5],[58,6,39,6],[58,7,40,5,"in"],[58,9,40,7],[58,10,40,8],[58,14,40,12],[58,16,40,14,"likedIds"],[58,24,40,22],[58,25,40,23],[58,26,41,5,"eq"],[58,28,41,7],[58,29,41,8],[58,37,41,16],[58,39,41,18],[58,47,41,26],[58,48,41,27],[59,8,26,16,"rawListings"],[59,19,26,27],[59,22,26,27,"_yield$supabase$from$2"],[59,44,26,27],[59,45,26,10,"data"],[59,49,26,14],[60,8,26,36,"listingError"],[60,20,26,48],[60,23,26,48,"_yield$supabase$from$2"],[60,45,26,48],[60,46,26,29,"error"],[60,51,26,34],[61,6,43,2],[61,10,43,6,"listingError"],[61,22,43,18],[61,24,43,20],[61,30,43,26,"listingError"],[61,42,43,38],[62,6,44,2],[62,10,44,6],[62,11,44,7,"rawListings"],[62,22,44,18],[62,24,44,20],[62,31,44,27],[62,33,44,29],[64,6,46,2],[65,6,47,2],[65,10,47,8,"listingMap"],[65,20,47,18],[65,23,47,21],[65,27,47,25,"Map"],[65,30,47,28],[65,31,47,58],[65,32,47,59],[66,6,49,2],[66,11,49,7],[66,15,49,13,"listing"],[66,22,49,20],[66,26,49,24,"rawListings"],[66,37,49,35],[66,39,49,37],[67,8,50,4],[67,12,50,10,"userProfile"],[67,23,50,21],[67,26,50,24,"listing"],[67,33,50,31],[67,34,50,32,"users"],[67,39,57,5],[68,8,59,4],[68,12,59,10,"items"],[68,17,59,15],[68,20,59,19,"listing"],[68,27,59,26],[68,28,59,27,"listing_items"],[68,41,59,40],[68,45,59,44],[68,47,59,90],[69,8,61,4,"listingMap"],[69,18,61,14],[69,19,61,15,"set"],[69,22,61,18],[69,23,61,19,"listing"],[69,30,61,26],[69,31,61,27,"id"],[69,33,61,29],[69,35,61,31],[70,10,62,6,"id"],[70,12,62,8],[70,14,62,10,"listing"],[70,21,62,17],[70,22,62,18,"id"],[70,24,62,20],[71,10,63,6,"user_id"],[71,17,63,13],[71,19,63,15,"listing"],[71,26,63,22],[71,27,63,23,"user_id"],[71,34,63,30],[72,10,64,6,"type"],[72,14,64,10],[72,16,64,12,"listing"],[72,23,64,19],[72,24,64,20,"type"],[72,28,64,24],[73,10,65,6,"tcg"],[73,13,65,9],[73,15,65,11,"listing"],[73,22,65,18],[73,23,65,19,"tcg"],[73,26,65,22],[74,10,66,6,"title"],[74,15,66,11],[74,17,66,13,"listing"],[74,24,66,20],[74,25,66,21,"title"],[74,30,66,26],[75,10,67,6,"cash_amount"],[75,21,67,17],[75,23,67,19,"listing"],[75,30,67,26],[75,31,67,27,"cash_amount"],[75,42,67,38],[76,10,68,6,"total_value"],[76,21,68,17],[76,23,68,19,"listing"],[76,30,68,26],[76,31,68,27,"total_value"],[76,42,68,38],[77,10,69,6,"description"],[77,21,69,17],[77,23,69,19,"listing"],[77,30,69,26],[77,31,69,27,"description"],[77,42,69,38],[78,10,70,6,"photos"],[78,16,70,12],[78,18,70,14,"listing"],[78,25,70,21],[78,26,70,22,"photos"],[78,32,70,28],[79,10,71,6,"status"],[79,16,71,12],[79,18,71,14,"listing"],[79,25,71,21],[79,26,71,22,"status"],[79,32,71,28],[80,10,72,6,"created_at"],[80,20,72,16],[80,22,72,18,"listing"],[80,29,72,25],[80,30,72,26,"created_at"],[80,40,72,36],[81,10,73,6,"updated_at"],[81,20,73,16],[81,22,73,18,"listing"],[81,29,73,25],[81,30,73,26,"updated_at"],[81,40,73,36],[82,10,74,6,"distance_km"],[82,21,74,17],[82,23,74,19],[82,24,74,20],[83,10,75,6,"owner"],[83,15,75,11],[83,17,75,13],[84,12,76,8,"display_name"],[84,24,76,20],[84,26,76,22,"userProfile"],[84,37,76,33],[84,38,76,34,"display_name"],[84,50,76,46],[85,12,77,8,"avatar_url"],[85,22,77,18],[85,24,77,20,"userProfile"],[85,35,77,31],[85,36,77,32,"avatar_url"],[85,46,77,42],[86,12,78,8,"rating_score"],[86,24,78,20],[86,26,78,22,"userProfile"],[86,37,78,33],[86,38,78,34,"rating_score"],[86,50,78,46],[86,54,78,50],[86,55,78,51],[87,12,79,8,"total_trades"],[87,24,79,20],[87,26,79,22,"userProfile"],[87,37,79,33],[87,38,79,34,"total_trades"],[87,50,79,46],[87,54,79,50],[88,10,80,6],[88,11,80,7],[89,10,81,6,"items"],[89,15,81,11],[90,10,82,6,"offer_count"],[90,21,82,17],[90,23,82,19],[91,8,83,4],[91,9,83,5],[91,10,83,6],[92,6,84,2],[94,6,86,2],[95,6,87,2],[95,13,87,9,"likedIds"],[95,21,87,17],[95,22,88,5,"map"],[95,25,88,8],[95,26,88,10,"id"],[95,28,88,12],[95,32,88,17,"listingMap"],[95,42,88,27],[95,43,88,28,"get"],[95,46,88,31],[95,47,88,32,"id"],[95,49,88,34],[95,50,88,35],[95,51,88,36],[95,52,89,5,"filter"],[95,58,89,11],[95,59,89,13,"l"],[95,60,89,14],[95,64,89,45,"l"],[95,65,89,46],[95,70,89,51,"undefined"],[95,79,89,60],[95,80,89,61],[96,4,90,0],[96,5,90,1],[97,4,90,1],[97,20,11,13,"fetchLikedListings"],[97,38,11,31,"fetchLikedListings"],[97,39,11,31,"_x"],[97,41,11,31],[98,6,11,31],[98,13,11,31,"_ref"],[98,17,11,31],[98,18,11,31,"apply"],[98,23,11,31],[98,30,11,31,"arguments"],[98,39,11,31],[99,4,11,31],[100,2,11,31],[100,5,90,1],[102,2,92,0],[103,0,93,0],[104,0,94,0],[105,0,95,0],[106,0,96,0],[107,0,97,0],[108,2,98,0],[108,6,98,6,"useLikedListings"],[108,22,98,22],[108,25,98,25,"useLikedListings"],[108,26,98,25],[108,31,98,31],[109,4,99,2],[109,8,99,2,"_useAuth"],[109,16,99,2],[109,19,99,19],[109,23,99,19,"useAuth"],[109,43,99,26],[109,44,99,26,"useAuth"],[109,51,99,26],[109,53,99,27],[109,54,99,28],[110,6,99,10,"user"],[110,10,99,14],[110,13,99,14,"_useAuth"],[110,21,99,14],[110,22,99,10,"user"],[110,26,99,14],[111,4,101,2],[111,11,101,9],[111,15,101,9,"useQuery"],[111,34,101,17],[111,35,101,17,"useQuery"],[111,43,101,17],[111,45,101,48],[112,6,102,4,"queryKey"],[112,14,102,12],[112,16,102,14,"feedKeys"],[112,26,102,22],[112,27,102,22,"feedKeys"],[112,35,102,22],[112,36,102,23,"liked"],[112,41,102,28],[112,42,102,29],[112,43,102,30],[113,6,103,4,"queryFn"],[113,13,103,11],[113,15,103,13,"queryFn"],[113,16,103,13],[113,21,103,19,"fetchLikedListings"],[113,39,103,37],[113,40,103,38,"user"],[113,44,103,42],[113,45,103,44,"id"],[113,47,103,46],[113,48,103,47],[114,6,104,4,"enabled"],[114,13,104,11],[114,15,104,13],[114,16,104,14],[114,17,104,15,"user"],[115,4,105,2],[115,5,105,3],[115,6,105,4],[116,2,106,0],[116,3,106,1],[117,2,108,0],[117,6,108,0,"_default"],[117,14,108,0],[117,17,108,15,"useLikedListings"],[117,33,108,31],[118,0,108,32],[118,3]],"functionMap":{"names":["<global>","fetchLikedListings","swipes.map$argument_0","likedIds.map$argument_0","likedIds.map.filter$argument_0","useLikedListings","useQuery$argument_0.queryFn"],"mappings":"AAA;kCCU;8BCY,mBD;SEiE,0BF;YGC,gDH;CDC;yBKQ;aCK,kCD;CLG"},"hasCjsExports":false},"type":"js/module"}]}