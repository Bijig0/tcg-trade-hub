{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"expo-auth-session","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":52,"index":105}}],"key":"s3shNvVlaQeRdxbAJkHAKmToFDc=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":47,"index":153}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":154},"end":{"line":4,"column":42,"index":196}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _expoAuthSession = require(_dependencyMap[2], \"expo-auth-session\");\n  var _expoWebBrowser = require(_dependencyMap[3], \"expo-web-browser\");\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _libSupabase = require(_dependencyMap[4], \"@/lib/supabase\");\n  WebBrowser.maybeCompleteAuthSession();\n  /** Hook for OAuth sign-in with Google or Apple via Supabase */\n  var useOAuth = () => {\n    _s();\n    var signIn = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (provider) {\n          var redirectTo = (0, _expoAuthSession.makeRedirectUri)({\n            scheme: 'tcg-trade-hub'\n          });\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.signInWithOAuth({\n              provider,\n              options: {\n                redirectTo,\n                skipBrowserRedirect: true\n              }\n            }),\n            data = _yield$supabase$auth$.data,\n            error = _yield$supabase$auth$.error;\n          if (error) throw error;\n          if (!data.url) throw new Error('No OAuth URL returned');\n          var result = yield WebBrowser.openAuthSessionAsync(data.url, redirectTo);\n          if (result.type === 'success') {\n            var url = new URL(result.url);\n            var params = new URLSearchParams(url.hash.substring(1));\n            var accessToken = params.get('access_token');\n            var refreshToken = params.get('refresh_token');\n            if (accessToken && refreshToken) {\n              var _yield$supabase$auth$2 = yield _libSupabase.supabase.auth.setSession({\n                  access_token: accessToken,\n                  refresh_token: refreshToken\n                }),\n                sessionData = _yield$supabase$auth$2.data,\n                sessionError = _yield$supabase$auth$2.error;\n              if (sessionError) throw sessionError;\n\n              // Create profile if first sign-in\n              if (sessionData.user) {\n                var _yield$supabase$from$ = yield _libSupabase.supabase.from('users').select('id').eq('id', sessionData.user.id).single(),\n                  existingProfile = _yield$supabase$from$.data;\n                if (!existingProfile) {\n                  yield _libSupabase.supabase.from('users').insert({\n                    id: sessionData.user.id,\n                    email: sessionData.user.email ?? '',\n                    display_name: sessionData.user.user_metadata?.['full_name'] ?? sessionData.user.user_metadata?.['name'] ?? sessionData.user.email?.split('@')[0] ?? 'Trader',\n                    avatar_url: sessionData.user.user_metadata?.['avatar_url'] ?? null\n                  });\n                }\n              }\n              return sessionData;\n            }\n          }\n          throw new Error('OAuth sign-in was cancelled or failed');\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()\n    });\n    return {\n      signIn\n    };\n  };\n  _s(useOAuth, \"ZMAZZopxC/jRnXzjmSHprhvfnSI=\", false, function () {\n    return [_tanstackReactQuery.useMutation];\n  });\n  var _default = useOAuth;\n});","lineCount":108,"map":[[28,2,73,0,"Object"],[28,8,73,0],[28,9,73,0,"defineProperty"],[28,23,73,0],[28,24,73,0,"exports"],[28,31,73,0],[29,4,73,0,"enumerable"],[29,14,73,0],[30,4,73,0,"get"],[30,7,73,0],[30,18,73,0,"get"],[30,19,73,0],[31,6,73,0],[31,13,73,0,"_default"],[31,21,73,0],[32,4,73,0],[33,2,73,0],[34,2,73,24],[34,6,73,24,"_babelRuntimeHelpersAsyncToGenerator"],[34,42,73,24],[34,45,73,24,"require"],[34,52,73,24],[34,53,73,24,"_dependencyMap"],[34,67,73,24],[35,2,73,24],[35,6,73,24,"_asyncToGenerator"],[35,23,73,24],[35,26,73,24,"_interopDefault"],[35,41,73,24],[35,42,73,24,"_babelRuntimeHelpersAsyncToGenerator"],[35,78,73,24],[36,2,1,0],[36,6,1,0,"_tanstackReactQuery"],[36,25,1,0],[36,28,1,0,"require"],[36,35,1,0],[36,36,1,0,"_dependencyMap"],[36,50,1,0],[37,2,2,0],[37,6,2,0,"_expoAuthSession"],[37,22,2,0],[37,25,2,0,"require"],[37,32,2,0],[37,33,2,0,"_dependencyMap"],[37,47,2,0],[38,2,3,0],[38,6,3,0,"_expoWebBrowser"],[38,21,3,0],[38,24,3,0,"require"],[38,31,3,0],[38,32,3,0,"_dependencyMap"],[38,46,3,0],[39,2,3,0],[39,6,3,0,"WebBrowser"],[39,16,3,0],[39,19,3,0,"_interopNamespace"],[39,36,3,0],[39,37,3,0,"_expoWebBrowser"],[39,52,3,0],[40,2,4,0],[40,6,4,0,"_libSupabase"],[40,18,4,0],[40,21,4,0,"require"],[40,28,4,0],[40,29,4,0,"_dependencyMap"],[40,43,4,0],[41,2,6,0,"WebBrowser"],[41,12,6,10],[41,13,6,11,"maybeCompleteAuthSession"],[41,37,6,35],[41,38,6,36],[41,39,6,37],[42,2,10,0],[43,2,11,0],[43,6,11,6,"useOAuth"],[43,14,11,14],[43,17,11,17,"useOAuth"],[43,18,11,17],[43,23,11,23],[44,4,11,23,"_s"],[44,6,11,23],[45,4,12,2],[45,8,12,8,"signIn"],[45,14,12,14],[45,17,12,17],[45,21,12,17,"useMutation"],[45,40,12,28],[45,41,12,28,"useMutation"],[45,52,12,28],[45,54,12,29],[46,6,13,4,"mutationFn"],[46,16,13,14],[47,8,13,14],[47,12,13,14,"_ref"],[47,16,13,14],[47,23,13,14,"_asyncToGenerator"],[47,40,13,14],[47,41,13,14,"default"],[47,48,13,14],[47,50,13,16],[47,61,13,23,"provider"],[47,69,13,46],[47,71,13,51],[48,10,14,6],[48,14,14,12,"redirectTo"],[48,24,14,22],[48,27,14,25],[48,31,14,25,"makeRedirectUri"],[48,47,14,40],[48,48,14,40,"makeRedirectUri"],[48,63,14,40],[48,65,14,41],[49,12,14,43,"scheme"],[49,18,14,49],[49,20,14,51],[50,10,14,67],[50,11,14,68],[50,12,14,69],[51,10,16,6],[51,14,16,6,"_yield$supabase$auth$"],[51,35,16,6],[51,44,16,36,"supabase"],[51,56,16,44],[51,57,16,44,"supabase"],[51,65,16,44],[51,66,16,45,"auth"],[51,70,16,49],[51,71,16,50,"signInWithOAuth"],[51,86,16,65],[51,87,16,66],[52,14,17,8,"provider"],[52,22,17,16],[53,14,18,8,"options"],[53,21,18,15],[53,23,18,17],[54,16,19,10,"redirectTo"],[54,26,19,20],[55,16,20,10,"skipBrowserRedirect"],[55,35,20,29],[55,37,20,31],[56,14,21,8],[57,12,22,6],[57,13,22,7],[57,14,22,8],[58,12,16,14,"data"],[58,16,16,18],[58,19,16,18,"_yield$supabase$auth$"],[58,40,16,18],[58,41,16,14,"data"],[58,45,16,18],[59,12,16,20,"error"],[59,17,16,25],[59,20,16,25,"_yield$supabase$auth$"],[59,41,16,25],[59,42,16,20,"error"],[59,47,16,25],[60,10,24,6],[60,14,24,10,"error"],[60,19,24,15],[60,21,24,17],[60,27,24,23,"error"],[60,32,24,28],[61,10,25,6],[61,14,25,10],[61,15,25,11,"data"],[61,19,25,15],[61,20,25,16,"url"],[61,23,25,19],[61,25,25,21],[61,31,25,27],[61,35,25,31,"Error"],[61,40,25,36],[61,41,25,37],[61,64,25,60],[61,65,25,61],[62,10,27,6],[62,14,27,12,"result"],[62,20,27,18],[62,29,27,27,"WebBrowser"],[62,39,27,37],[62,40,27,38,"openAuthSessionAsync"],[62,60,27,58],[62,61,27,59,"data"],[62,65,27,63],[62,66,27,64,"url"],[62,69,27,67],[62,71,27,69,"redirectTo"],[62,81,27,79],[62,82,27,80],[63,10,29,6],[63,14,29,10,"result"],[63,20,29,16],[63,21,29,17,"type"],[63,25,29,21],[63,30,29,26],[63,39,29,35],[63,41,29,37],[64,12,30,8],[64,16,30,14,"url"],[64,19,30,17],[64,22,30,20],[64,26,30,24,"URL"],[64,29,30,27],[64,30,30,28,"result"],[64,36,30,34],[64,37,30,35,"url"],[64,40,30,38],[64,41,30,39],[65,12,31,8],[65,16,31,14,"params"],[65,22,31,20],[65,25,31,23],[65,29,31,27,"URLSearchParams"],[65,44,31,42],[65,45,31,43,"url"],[65,48,31,46],[65,49,31,47,"hash"],[65,53,31,51],[65,54,31,52,"substring"],[65,63,31,61],[65,64,31,62],[65,65,31,63],[65,66,31,64],[65,67,31,65],[66,12,32,8],[66,16,32,14,"accessToken"],[66,27,32,25],[66,30,32,28,"params"],[66,36,32,34],[66,37,32,35,"get"],[66,40,32,38],[66,41,32,39],[66,55,32,53],[66,56,32,54],[67,12,33,8],[67,16,33,14,"refreshToken"],[67,28,33,26],[67,31,33,29,"params"],[67,37,33,35],[67,38,33,36,"get"],[67,41,33,39],[67,42,33,40],[67,57,33,55],[67,58,33,56],[68,12,35,8],[68,16,35,12,"accessToken"],[68,27,35,23],[68,31,35,27,"refreshToken"],[68,43,35,39],[68,45,35,41],[69,14,36,10],[69,18,36,10,"_yield$supabase$auth$2"],[69,40,36,10],[69,49,37,18,"supabase"],[69,61,37,26],[69,62,37,26,"supabase"],[69,70,37,26],[69,71,37,27,"auth"],[69,75,37,31],[69,76,37,32,"setSession"],[69,86,37,42],[69,87,37,43],[70,18,37,45,"access_token"],[70,30,37,57],[70,32,37,59,"accessToken"],[70,43,37,70],[71,18,37,72,"refresh_token"],[71,31,37,85],[71,33,37,87,"refreshToken"],[72,16,37,100],[72,17,37,101],[72,18,37,102],[73,16,36,24,"sessionData"],[73,27,36,35],[73,30,36,35,"_yield$supabase$auth$2"],[73,52,36,35],[73,53,36,18,"data"],[73,57,36,22],[74,16,36,44,"sessionError"],[74,28,36,56],[74,31,36,56,"_yield$supabase$auth$2"],[74,53,36,56],[74,54,36,37,"error"],[74,59,36,42],[75,14,38,10],[75,18,38,14,"sessionError"],[75,30,38,26],[75,32,38,28],[75,38,38,34,"sessionError"],[75,50,38,46],[77,14,40,10],[78,14,41,10],[78,18,41,14,"sessionData"],[78,29,41,25],[78,30,41,26,"user"],[78,34,41,30],[78,36,41,32],[79,16,42,12],[79,20,42,12,"_yield$supabase$from$"],[79,41,42,12],[79,50,42,52,"supabase"],[79,62,42,60],[79,63,42,60,"supabase"],[79,71,42,60],[79,72,43,15,"from"],[79,76,43,19],[79,77,43,20],[79,84,43,27],[79,85,43,28],[79,86,44,15,"select"],[79,92,44,21],[79,93,44,22],[79,97,44,26],[79,98,44,27],[79,99,45,15,"eq"],[79,101,45,17],[79,102,45,18],[79,106,45,22],[79,108,45,24,"sessionData"],[79,119,45,35],[79,120,45,36,"user"],[79,124,45,40],[79,125,45,41,"id"],[79,127,45,43],[79,128,45,44],[79,129,46,15,"single"],[79,135,46,21],[79,136,46,22],[79,137,46,23],[80,18,42,26,"existingProfile"],[80,33,42,41],[80,36,42,41,"_yield$supabase$from$"],[80,57,42,41],[80,58,42,20,"data"],[80,62,42,24],[81,16,48,12],[81,20,48,16],[81,21,48,17,"existingProfile"],[81,36,48,32],[81,38,48,34],[82,18,49,14],[82,24,49,20,"supabase"],[82,36,49,28],[82,37,49,28,"supabase"],[82,45,49,28],[82,46,49,29,"from"],[82,50,49,33],[82,51,49,34],[82,58,49,41],[82,59,49,42],[82,60,49,43,"insert"],[82,66,49,49],[82,67,49,50],[83,20,50,16,"id"],[83,22,50,18],[83,24,50,20,"sessionData"],[83,35,50,31],[83,36,50,32,"user"],[83,40,50,36],[83,41,50,37,"id"],[83,43,50,39],[84,20,51,16,"email"],[84,25,51,21],[84,27,51,23,"sessionData"],[84,38,51,34],[84,39,51,35,"user"],[84,43,51,39],[84,44,51,40,"email"],[84,49,51,45],[84,53,51,49],[84,55,51,51],[85,20,52,16,"display_name"],[85,32,52,28],[85,34,53,18,"sessionData"],[85,45,53,29],[85,46,53,30,"user"],[85,50,53,34],[85,51,53,35,"user_metadata"],[85,64,53,48],[85,67,53,51],[85,78,53,62],[85,79,53,63],[85,83,54,18,"sessionData"],[85,94,54,29],[85,95,54,30,"user"],[85,99,54,34],[85,100,54,35,"user_metadata"],[85,113,54,48],[85,116,54,51],[85,122,54,57],[85,123,54,58],[85,127,55,18,"sessionData"],[85,138,55,29],[85,139,55,30,"user"],[85,143,55,34],[85,144,55,35,"email"],[85,149,55,40],[85,151,55,42,"split"],[85,156,55,47],[85,157,55,48],[85,160,55,51],[85,161,55,52],[85,162,55,53],[85,163,55,54],[85,164,55,55],[85,168,56,18],[85,176,56,26],[86,20,57,16,"avatar_url"],[86,30,57,26],[86,32,57,28,"sessionData"],[86,43,57,39],[86,44,57,40,"user"],[86,48,57,44],[86,49,57,45,"user_metadata"],[86,62,57,58],[86,65,57,61],[86,77,57,73],[86,78,57,74],[86,82,57,78],[87,18,58,14],[87,19,58,15],[87,20,58,16],[88,16,59,12],[89,14,60,10],[90,14,62,10],[90,21,62,17,"sessionData"],[90,32,62,28],[91,12,63,8],[92,10,64,6],[93,10,66,6],[93,16,66,12],[93,20,66,16,"Error"],[93,25,66,21],[93,26,66,22],[93,65,66,61],[93,66,66,62],[94,8,67,4],[94,9,67,5],[95,8,67,5],[95,24,13,4,"mutationFn"],[95,34,13,14,"mutationFn"],[95,35,13,14,"_x"],[95,37,13,14],[96,10,13,14],[96,17,13,14,"_ref"],[96,21,13,14],[96,22,13,14,"apply"],[96,27,13,14],[96,34,13,14,"arguments"],[96,43,13,14],[97,8,13,14],[98,6,13,14],[99,4,68,2],[99,5,68,3],[99,6,68,4],[100,4,70,2],[100,11,70,9],[101,6,70,11,"signIn"],[102,4,70,18],[102,5,70,19],[103,2,71,0],[103,3,71,1],[104,2,71,2,"_s"],[104,4,71,2],[104,5,11,6,"useOAuth"],[104,13,11,14],[105,4,11,14],[105,12,12,17,"useMutation"],[105,31,12,28],[105,32,12,28,"useMutation"],[105,43,12,28],[106,2,12,28],[107,2,73,0],[107,6,73,0,"_default"],[107,14,73,0],[107,17,73,15,"useOAuth"],[107,25,73,23],[108,0,73,24],[108,3]],"functionMap":{"names":["<global>","useOAuth","useMutation$argument_0.mutationFn"],"mappings":"AAA;iBCU;gBCE;KDsD;CDI"},"hasCjsExports":false},"type":"js/module"}]}