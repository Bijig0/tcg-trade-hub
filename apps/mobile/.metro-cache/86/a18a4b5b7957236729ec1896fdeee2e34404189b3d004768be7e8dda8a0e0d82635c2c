{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":43,"index":136}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Fetches the trade context for a conversation — listing info, offer info,\n   * and negotiation status. Joins through conversations → matches → listings/offers.\n   */\n  var useTradeContext = conversationId => {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.chatKeys.tradeContext(conversationId),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          // Get conversation with match, listing, and offer data\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('conversations').select(`\n          id,\n          negotiation_status,\n          matches!inner (\n            id,\n            user_a_id,\n            user_b_id,\n            listing_id,\n            offer_id,\n            listings!inner (\n              id,\n              user_id,\n              title,\n              type,\n              tcg,\n              total_value\n            ),\n            offers!inner (\n              id,\n              offerer_id,\n              cash_amount\n            )\n          )\n        `).eq('id', conversationId).single(),\n            conv = _yield$supabase$from$.data,\n            convError = _yield$supabase$from$.error;\n          if (convError || !conv) return null;\n          var match = conv.matches;\n\n          // Fetch listing items\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listing_items').select('card_name, card_image_url, card_external_id, tcg, condition, quantity, market_price').eq('listing_id', match.listings.id),\n            listingItems = _yield$supabase$from$2.data;\n\n          // Fetch offer items\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('offer_items').select('card_name, card_image_url, card_external_id, tcg, condition, quantity, market_price').eq('offer_id', match.offers.id),\n            offerItems = _yield$supabase$from$3.data;\n          return {\n            listingId: match.listings.id,\n            listingTitle: match.listings.title,\n            listingType: match.listings.type,\n            listingTcg: match.listings.tcg,\n            listingOwnerId: match.listings.user_id,\n            listingItems: (listingItems ?? []).map(li => ({\n              cardName: li.card_name,\n              cardImageUrl: li.card_image_url,\n              cardExternalId: li.card_external_id,\n              tcg: li.tcg,\n              condition: li.condition,\n              quantity: li.quantity,\n              marketPrice: li.market_price\n            })),\n            listingTotalValue: match.listings.total_value,\n            offererId: match.offers.offerer_id,\n            offerItems: (offerItems ?? []).map(oi => ({\n              cardName: oi.card_name,\n              cardImageUrl: oi.card_image_url,\n              cardExternalId: oi.card_external_id,\n              tcg: oi.tcg,\n              condition: oi.condition,\n              quantity: oi.quantity,\n              marketPrice: oi.market_price\n            })),\n            offerCashAmount: match.offers.cash_amount,\n            negotiationStatus: conv.negotiation_status\n          };\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!conversationId,\n      staleTime: 5 * 60 * 1000 // 5 minutes\n    });\n  };\n  _s(useTradeContext, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = useTradeContext;\n});","lineCount":113,"map":[[13,2,140,0,"Object"],[13,8,140,0],[13,9,140,0,"defineProperty"],[13,23,140,0],[13,24,140,0,"exports"],[13,31,140,0],[14,4,140,0,"enumerable"],[14,14,140,0],[15,4,140,0,"get"],[15,7,140,0],[15,18,140,0,"get"],[15,19,140,0],[16,6,140,0],[16,13,140,0,"_default"],[16,21,140,0],[17,4,140,0],[18,2,140,0],[19,2,140,31],[19,6,140,31,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,140,31],[19,45,140,31,"require"],[19,52,140,31],[19,53,140,31,"_dependencyMap"],[19,67,140,31],[20,2,140,31],[20,6,140,31,"_asyncToGenerator"],[20,23,140,31],[20,26,140,31,"_interopDefault"],[20,41,140,31],[20,42,140,31,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,140,31],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,30,0],[25,0,31,0],[26,0,32,0],[27,0,33,0],[28,2,34,0],[28,6,34,6,"useTradeContext"],[28,21,34,21],[28,24,34,25,"conversationId"],[28,38,34,47],[28,42,34,52],[29,4,34,52,"_s"],[29,6,34,52],[30,4,35,2],[30,11,35,9],[30,15,35,9,"useQuery"],[30,34,35,17],[30,35,35,17,"useQuery"],[30,43,35,17],[30,45,35,18],[31,6,36,4,"queryKey"],[31,14,36,12],[31,16,36,14,"chatKeys"],[31,26,36,22],[31,27,36,22,"chatKeys"],[31,35,36,22],[31,36,36,23,"tradeContext"],[31,48,36,35],[31,49,36,36,"conversationId"],[31,63,36,50],[31,64,36,51],[32,6,37,4,"queryFn"],[32,13,37,11],[33,8,37,11],[33,12,37,11,"_ref"],[33,16,37,11],[33,23,37,11,"_asyncToGenerator"],[33,40,37,11],[33,41,37,11,"default"],[33,48,37,11],[33,50,37,13],[33,63,37,55],[34,10,38,6],[35,10,39,6],[35,14,39,6,"_yield$supabase$from$"],[35,35,39,6],[35,44,39,53,"supabase"],[35,56,39,61],[35,57,39,61,"supabase"],[35,65,39,61],[35,66,40,9,"from"],[35,70,40,13],[35,71,40,14],[35,86,40,29],[35,87,40,30],[35,88,41,9,"select"],[35,94,41,15],[35,95,42,10],[36,0,43,0],[37,0,44,0],[38,0,45,0],[39,0,46,0],[40,0,47,0],[41,0,48,0],[42,0,49,0],[43,0,50,0],[44,0,51,0],[45,0,52,0],[46,0,53,0],[47,0,54,0],[48,0,55,0],[49,0,56,0],[50,0,57,0],[51,0,58,0],[52,0,59,0],[53,0,60,0],[54,0,61,0],[55,0,62,0],[56,0,63,0],[57,0,64,0],[58,0,65,0],[58,9,66,8],[58,10,66,9],[58,11,67,9,"eq"],[58,13,67,11],[58,14,67,12],[58,18,67,16],[58,20,67,18,"conversationId"],[58,34,67,32],[58,35,67,33],[58,36,68,9,"single"],[58,42,68,15],[58,43,68,16],[58,44,68,17],[59,12,39,20,"conv"],[59,16,39,24],[59,19,39,24,"_yield$supabase$from$"],[59,40,39,24],[59,41,39,14,"data"],[59,45,39,18],[60,12,39,33,"convError"],[60,21,39,42],[60,24,39,42,"_yield$supabase$from$"],[60,45,39,42],[60,46,39,26,"error"],[60,51,39,31],[61,10,70,6],[61,14,70,10,"convError"],[61,23,70,19],[61,27,70,23],[61,28,70,24,"conv"],[61,32,70,28],[61,34,70,30],[61,41,70,37],[61,45,70,41],[62,10,72,6],[62,14,72,12,"match"],[62,19,72,17],[62,22,72,20,"conv"],[62,26,72,24],[62,27,72,25,"matches"],[62,34,91,7],[64,10,93,6],[65,10,94,6],[65,14,94,6,"_yield$supabase$from$2"],[65,36,94,6],[65,45,94,43,"supabase"],[65,57,94,51],[65,58,94,51,"supabase"],[65,66,94,51],[65,67,95,9,"from"],[65,71,95,13],[65,72,95,14],[65,87,95,29],[65,88,95,30],[65,89,96,9,"select"],[65,95,96,15],[65,96,96,16],[65,181,96,101],[65,182,96,102],[65,183,97,9,"eq"],[65,185,97,11],[65,186,97,12],[65,198,97,24],[65,200,97,26,"match"],[65,205,97,31],[65,206,97,32,"listings"],[65,214,97,40],[65,215,97,41,"id"],[65,217,97,43],[65,218,97,44],[66,12,94,20,"listingItems"],[66,24,94,32],[66,27,94,32,"_yield$supabase$from$2"],[66,49,94,32],[66,50,94,14,"data"],[66,54,94,18],[68,10,99,6],[69,10,100,6],[69,14,100,6,"_yield$supabase$from$3"],[69,36,100,6],[69,45,100,41,"supabase"],[69,57,100,49],[69,58,100,49,"supabase"],[69,66,100,49],[69,67,101,9,"from"],[69,71,101,13],[69,72,101,14],[69,85,101,27],[69,86,101,28],[69,87,102,9,"select"],[69,93,102,15],[69,94,102,16],[69,179,102,101],[69,180,102,102],[69,181,103,9,"eq"],[69,183,103,11],[69,184,103,12],[69,194,103,22],[69,196,103,24,"match"],[69,201,103,29],[69,202,103,30,"offers"],[69,208,103,36],[69,209,103,37,"id"],[69,211,103,39],[69,212,103,40],[70,12,100,20,"offerItems"],[70,22,100,30],[70,25,100,30,"_yield$supabase$from$3"],[70,47,100,30],[70,48,100,14,"data"],[70,52,100,18],[71,10,105,6],[71,17,105,13],[72,12,106,8,"listingId"],[72,21,106,17],[72,23,106,19,"match"],[72,28,106,24],[72,29,106,25,"listings"],[72,37,106,33],[72,38,106,34,"id"],[72,40,106,36],[73,12,107,8,"listingTitle"],[73,24,107,20],[73,26,107,22,"match"],[73,31,107,27],[73,32,107,28,"listings"],[73,40,107,36],[73,41,107,37,"title"],[73,46,107,42],[74,12,108,8,"listingType"],[74,23,108,19],[74,25,108,21,"match"],[74,30,108,26],[74,31,108,27,"listings"],[74,39,108,35],[74,40,108,36,"type"],[74,44,108,55],[75,12,109,8,"listingTcg"],[75,22,109,18],[75,24,109,20,"match"],[75,29,109,25],[75,30,109,26,"listings"],[75,38,109,34],[75,39,109,35,"tcg"],[75,42,109,49],[76,12,110,8,"listingOwnerId"],[76,26,110,22],[76,28,110,24,"match"],[76,33,110,29],[76,34,110,30,"listings"],[76,42,110,38],[76,43,110,39,"user_id"],[76,50,110,46],[77,12,111,8,"listingItems"],[77,24,111,20],[77,26,111,22],[77,27,111,23,"listingItems"],[77,39,111,35],[77,43,111,39],[77,45,111,41],[77,47,111,43,"map"],[77,50,111,46],[77,51,111,48,"li"],[77,53,111,50],[77,58,111,56],[78,14,112,10,"cardName"],[78,22,112,18],[78,24,112,20,"li"],[78,26,112,22],[78,27,112,23,"card_name"],[78,36,112,32],[79,14,113,10,"cardImageUrl"],[79,26,113,22],[79,28,113,24,"li"],[79,30,113,26],[79,31,113,27,"card_image_url"],[79,45,113,41],[80,14,114,10,"cardExternalId"],[80,28,114,24],[80,30,114,26,"li"],[80,32,114,28],[80,33,114,29,"card_external_id"],[80,49,114,45],[81,14,115,10,"tcg"],[81,17,115,13],[81,19,115,15,"li"],[81,21,115,17],[81,22,115,18,"tcg"],[81,25,115,21],[82,14,116,10,"condition"],[82,23,116,19],[82,25,116,21,"li"],[82,27,116,23],[82,28,116,24,"condition"],[82,37,116,33],[83,14,117,10,"quantity"],[83,22,117,18],[83,24,117,20,"li"],[83,26,117,22],[83,27,117,23,"quantity"],[83,35,117,31],[84,14,118,10,"marketPrice"],[84,25,118,21],[84,27,118,23,"li"],[84,29,118,25],[84,30,118,26,"market_price"],[85,12,119,8],[85,13,119,9],[85,14,119,10],[85,15,119,11],[86,12,120,8,"listingTotalValue"],[86,29,120,25],[86,31,120,27,"match"],[86,36,120,32],[86,37,120,33,"listings"],[86,45,120,41],[86,46,120,42,"total_value"],[86,57,120,53],[87,12,121,8,"offererId"],[87,21,121,17],[87,23,121,19,"match"],[87,28,121,24],[87,29,121,25,"offers"],[87,35,121,31],[87,36,121,32,"offerer_id"],[87,46,121,42],[88,12,122,8,"offerItems"],[88,22,122,18],[88,24,122,20],[88,25,122,21,"offerItems"],[88,35,122,31],[88,39,122,35],[88,41,122,37],[88,43,122,39,"map"],[88,46,122,42],[88,47,122,44,"oi"],[88,49,122,46],[88,54,122,52],[89,14,123,10,"cardName"],[89,22,123,18],[89,24,123,20,"oi"],[89,26,123,22],[89,27,123,23,"card_name"],[89,36,123,32],[90,14,124,10,"cardImageUrl"],[90,26,124,22],[90,28,124,24,"oi"],[90,30,124,26],[90,31,124,27,"card_image_url"],[90,45,124,41],[91,14,125,10,"cardExternalId"],[91,28,125,24],[91,30,125,26,"oi"],[91,32,125,28],[91,33,125,29,"card_external_id"],[91,49,125,45],[92,14,126,10,"tcg"],[92,17,126,13],[92,19,126,15,"oi"],[92,21,126,17],[92,22,126,18,"tcg"],[92,25,126,21],[93,14,127,10,"condition"],[93,23,127,19],[93,25,127,21,"oi"],[93,27,127,23],[93,28,127,24,"condition"],[93,37,127,33],[94,14,128,10,"quantity"],[94,22,128,18],[94,24,128,20,"oi"],[94,26,128,22],[94,27,128,23,"quantity"],[94,35,128,31],[95,14,129,10,"marketPrice"],[95,25,129,21],[95,27,129,23,"oi"],[95,29,129,25],[95,30,129,26,"market_price"],[96,12,130,8],[96,13,130,9],[96,14,130,10],[96,15,130,11],[97,12,131,8,"offerCashAmount"],[97,27,131,23],[97,29,131,25,"match"],[97,34,131,30],[97,35,131,31,"offers"],[97,41,131,37],[97,42,131,38,"cash_amount"],[97,53,131,49],[98,12,132,8,"negotiationStatus"],[98,29,132,25],[98,31,132,27,"conv"],[98,35,132,31],[98,36,132,32,"negotiation_status"],[99,10,133,6],[99,11,133,7],[100,8,134,4],[100,9,134,5],[101,8,134,5],[101,24,37,4,"queryFn"],[101,31,37,11,"queryFn"],[101,32,37,11],[102,10,37,11],[102,17,37,11,"_ref"],[102,21,37,11],[102,22,37,11,"apply"],[102,27,37,11],[102,34,37,11,"arguments"],[102,43,37,11],[103,8,37,11],[104,6,37,11],[104,9,134,5],[105,6,135,4,"enabled"],[105,13,135,11],[105,15,135,13],[105,16,135,14],[105,17,135,15,"conversationId"],[105,31,135,29],[106,6,136,4,"staleTime"],[106,15,136,13],[106,17,136,15],[106,18,136,16],[106,21,136,19],[106,23,136,21],[106,26,136,24],[106,30,136,28],[106,31,136,30],[107,4,137,2],[107,5,137,3],[107,6,137,4],[108,2,138,0],[108,3,138,1],[109,2,138,2,"_s"],[109,4,138,2],[109,5,34,6,"useTradeContext"],[109,20,34,21],[110,4,34,21],[110,12,35,9,"useQuery"],[110,31,35,17],[110,32,35,17,"useQuery"],[110,40,35,17],[111,2,35,17],[112,2,140,0],[112,6,140,0,"_default"],[112,14,140,0],[112,17,140,15,"useTradeContext"],[112,32,140,30],[113,0,140,31],[113,3]],"functionMap":{"names":["<global>","useTradeContext","useQuery$argument_0.queryFn","map$argument_0"],"mappings":"AAA;wBCiC;aCG;+CC0E;UDQ;2CCG;UDQ;KDI;CDI"},"hasCjsExports":false},"type":"js/module"}]}