{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":43,"index":136}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"fetchListingDetail\", {\n    enumerable: true,\n    get: function () {\n      return fetchListingDetail;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _queryKeys = require(_dependencyMap[3]);\n  /**\n   * Fetches a single listing by ID with its items, owner information, and pending offer count.\n   *\n   * Joins the `users` table to include owner display_name, avatar_url,\n   * rating_score, and total_trades alongside all listing fields.\n   * Also fetches listing_items and counts pending offers.\n   */\n  var fetchListingDetail = /*#__PURE__*/function () {\n    var _ref = (0, _asyncToGenerator.default)(function* (listingId) {\n      // Fetch listing with owner\n      var _yield$supabase$from$ = yield _libSupabase.supabase.from('listings').select(`\n      *,\n      owner:users!user_id (\n        display_name,\n        avatar_url,\n        rating_score,\n        total_trades\n      )\n    `).eq('id', listingId).single(),\n        data = _yield$supabase$from$.data,\n        error = _yield$supabase$from$.error;\n      if (error) throw error;\n\n      // Fetch listing items\n      var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listing_items').select('*').eq('listing_id', listingId).order('created_at', {\n          ascending: true\n        }),\n        items = _yield$supabase$from$2.data,\n        itemsError = _yield$supabase$from$2.error;\n      if (itemsError) throw itemsError;\n\n      // Count pending offers\n      var _yield$supabase$from$3 = yield _libSupabase.supabase.from('offers').select('id', {\n          count: 'exact',\n          head: true\n        }).eq('listing_id', listingId).eq('status', 'pending'),\n        count = _yield$supabase$from$3.count,\n        countError = _yield$supabase$from$3.error;\n      if (countError) throw countError;\n\n      // Supabase returns the joined user as an object under the alias `owner`\n      var listing = data;\n\n      // distance_km is not available from a direct query; default to 0\n      // The feed edge function normally provides this value\n      if (listing.distance_km === undefined) {\n        listing.distance_km = 0;\n      }\n      listing.items = items ?? [];\n      listing.offer_count = count ?? 0;\n      return listing;\n    });\n    return function fetchListingDetail(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  /**\n   * Hook that fetches a single listing by ID with its items and owner information.\n   */\n  var useListingDetail = listingId => {\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.feedKeys.detail(listingId),\n      queryFn: () => fetchListingDetail(listingId),\n      enabled: !!listingId\n    });\n  };\n  var _default = useListingDetail;\n});","lineCount":97,"map":[[12,2,78,0,"Object"],[12,8,78,0],[12,9,78,0,"defineProperty"],[12,23,78,0],[12,24,78,0,"exports"],[12,31,78,0],[13,4,78,0,"enumerable"],[13,14,78,0],[14,4,78,0,"get"],[14,7,78,0],[14,18,78,0,"get"],[14,19,78,0],[15,6,78,0],[15,13,78,0,"_default"],[15,21,78,0],[16,4,78,0],[17,2,78,0],[18,2,14,0,"Object"],[18,8,14,0],[18,9,14,0,"defineProperty"],[18,23,14,0],[18,24,14,0,"exports"],[18,31,14,0],[19,4,14,0,"enumerable"],[19,14,14,0],[20,4,14,0,"get"],[20,7,14,0],[20,18,14,0,"get"],[20,19,14,0],[21,6,14,0],[21,13,14,0,"fetchListingDetail"],[21,31,14,0],[22,4,14,0],[23,2,14,0],[24,2,65,2],[24,6,65,2,"_babelRuntimeHelpersAsyncToGenerator"],[24,42,65,2],[24,45,65,2,"require"],[24,52,65,2],[24,53,65,2,"_dependencyMap"],[24,67,65,2],[25,2,65,2],[25,6,65,2,"_asyncToGenerator"],[25,23,65,2],[25,26,65,2,"_interopDefault"],[25,41,65,2],[25,42,65,2,"_babelRuntimeHelpersAsyncToGenerator"],[25,78,65,2],[26,2,1,0],[26,6,1,0,"_tanstackReactQuery"],[26,25,1,0],[26,28,1,0,"require"],[26,35,1,0],[26,36,1,0,"_dependencyMap"],[26,50,1,0],[27,2,2,0],[27,6,2,0,"_libSupabase"],[27,18,2,0],[27,21,2,0,"require"],[27,28,2,0],[27,29,2,0,"_dependencyMap"],[27,43,2,0],[28,2,3,0],[28,6,3,0,"_queryKeys"],[28,16,3,0],[28,19,3,0,"require"],[28,26,3,0],[28,27,3,0,"_dependencyMap"],[28,41,3,0],[29,2,7,0],[30,0,8,0],[31,0,9,0],[32,0,10,0],[33,0,11,0],[34,0,12,0],[35,0,13,0],[36,2,14,7],[36,6,14,13,"fetchListingDetail"],[36,24,14,31],[37,4,14,31],[37,8,14,31,"_ref"],[37,12,14,31],[37,19,14,31,"_asyncToGenerator"],[37,36,14,31],[37,37,14,31,"default"],[37,44,14,31],[37,46,14,34],[37,57,14,41,"listingId"],[37,66,14,58],[37,68,14,93],[38,6,15,2],[39,6,16,2],[39,10,16,2,"_yield$supabase$from$"],[39,31,16,2],[39,40,16,32,"supabase"],[39,52,16,40],[39,53,16,40,"supabase"],[39,61,16,40],[39,62,17,5,"from"],[39,66,17,9],[39,67,17,10],[39,77,17,20],[39,78,17,21],[39,79,18,5,"select"],[39,85,18,11],[39,86,19,6],[40,0,20,0],[41,0,21,0],[42,0,22,0],[43,0,23,0],[44,0,24,0],[45,0,25,0],[46,0,26,0],[47,0,27,0],[47,5,28,4],[47,6,28,5],[47,7,29,5,"eq"],[47,9,29,7],[47,10,29,8],[47,14,29,12],[47,16,29,14,"listingId"],[47,25,29,23],[47,26,29,24],[47,27,30,5,"single"],[47,33,30,11],[47,34,30,12],[47,35,30,13],[48,8,16,10,"data"],[48,12,16,14],[48,15,16,14,"_yield$supabase$from$"],[48,36,16,14],[48,37,16,10,"data"],[48,41,16,14],[49,8,16,16,"error"],[49,13,16,21],[49,16,16,21,"_yield$supabase$from$"],[49,37,16,21],[49,38,16,16,"error"],[49,43,16,21],[50,6,32,2],[50,10,32,6,"error"],[50,15,32,11],[50,17,32,13],[50,23,32,19,"error"],[50,28,32,24],[52,6,34,2],[53,6,35,2],[53,10,35,2,"_yield$supabase$from$2"],[53,32,35,2],[53,41,35,51,"supabase"],[53,53,35,59],[53,54,35,59,"supabase"],[53,62,35,59],[53,63,36,5,"from"],[53,67,36,9],[53,68,36,10],[53,83,36,25],[53,84,36,26],[53,85,37,5,"select"],[53,91,37,11],[53,92,37,12],[53,95,37,15],[53,96,37,16],[53,97,38,5,"eq"],[53,99,38,7],[53,100,38,8],[53,112,38,20],[53,114,38,22,"listingId"],[53,123,38,31],[53,124,38,32],[53,125,39,5,"order"],[53,130,39,10],[53,131,39,11],[53,143,39,23],[53,145,39,25],[54,10,39,27,"ascending"],[54,19,39,36],[54,21,39,38],[55,8,39,43],[55,9,39,44],[55,10,39,45],[56,8,35,16,"items"],[56,13,35,21],[56,16,35,21,"_yield$supabase$from$2"],[56,38,35,21],[56,39,35,10,"data"],[56,43,35,14],[57,8,35,30,"itemsError"],[57,18,35,40],[57,21,35,40,"_yield$supabase$from$2"],[57,43,35,40],[57,44,35,23,"error"],[57,49,35,28],[58,6,41,2],[58,10,41,6,"itemsError"],[58,20,41,16],[58,22,41,18],[58,28,41,24,"itemsError"],[58,38,41,34],[60,6,43,2],[61,6,44,2],[61,10,44,2,"_yield$supabase$from$3"],[61,32,44,2],[61,41,44,45,"supabase"],[61,53,44,53],[61,54,44,53,"supabase"],[61,62,44,53],[61,63,45,5,"from"],[61,67,45,9],[61,68,45,10],[61,76,45,18],[61,77,45,19],[61,78,46,5,"select"],[61,84,46,11],[61,85,46,12],[61,89,46,16],[61,91,46,18],[62,10,46,20,"count"],[62,15,46,25],[62,17,46,27],[62,24,46,34],[63,10,46,36,"head"],[63,14,46,40],[63,16,46,42],[64,8,46,47],[64,9,46,48],[64,10,46,49],[64,11,47,5,"eq"],[64,13,47,7],[64,14,47,8],[64,26,47,20],[64,28,47,22,"listingId"],[64,37,47,31],[64,38,47,32],[64,39,48,5,"eq"],[64,41,48,7],[64,42,48,8],[64,50,48,16],[64,52,48,18],[64,61,48,27],[64,62,48,28],[65,8,44,10,"count"],[65,13,44,15],[65,16,44,15,"_yield$supabase$from$3"],[65,38,44,15],[65,39,44,10,"count"],[65,44,44,15],[66,8,44,24,"countError"],[66,18,44,34],[66,21,44,34,"_yield$supabase$from$3"],[66,43,44,34],[66,44,44,17,"error"],[66,49,44,22],[67,6,50,2],[67,10,50,6,"countError"],[67,20,50,16],[67,22,50,18],[67,28,50,24,"countError"],[67,38,50,34],[69,6,52,2],[70,6,53,2],[70,10,53,8,"listing"],[70,17,53,15],[70,20,53,18,"data"],[70,24,53,56],[72,6,55,2],[73,6,56,2],[74,6,57,2],[74,10,57,6,"listing"],[74,17,57,13],[74,18,57,14,"distance_km"],[74,29,57,25],[74,34,57,30,"undefined"],[74,43,57,39],[74,45,57,41],[75,8,58,5,"listing"],[75,15,58,12],[75,16,58,41,"distance_km"],[75,27,58,52],[75,30,58,55],[75,31,58,56],[76,6,59,2],[77,6,61,3,"listing"],[77,13,61,10],[77,14,61,39,"items"],[77,19,61,44],[77,22,61,48,"items"],[77,27,61,53],[77,31,61,57],[77,33,61,80],[78,6,62,3,"listing"],[78,13,62,10],[78,14,62,39,"offer_count"],[78,25,62,50],[78,28,62,53,"count"],[78,33,62,58],[78,37,62,62],[78,38,62,63],[79,6,64,2],[79,13,64,9,"listing"],[79,20,64,16],[80,4,65,0],[80,5,65,1],[81,4,65,1],[81,20,14,13,"fetchListingDetail"],[81,38,14,31,"fetchListingDetail"],[81,39,14,31,"_x"],[81,41,14,31],[82,6,14,31],[82,13,14,31,"_ref"],[82,17,14,31],[82,18,14,31,"apply"],[82,23,14,31],[82,30,14,31,"arguments"],[82,39,14,31],[83,4,14,31],[84,2,14,31],[84,5,65,1],[86,2,67,0],[87,0,68,0],[88,0,69,0],[89,2,70,0],[89,6,70,6,"useListingDetail"],[89,22,70,22],[89,25,70,26,"listingId"],[89,34,70,43],[89,38,70,48],[90,4,71,2],[90,11,71,9],[90,15,71,9,"useQuery"],[90,34,71,17],[90,35,71,17,"useQuery"],[90,43,71,17],[90,45,71,46],[91,6,72,4,"queryKey"],[91,14,72,12],[91,16,72,14,"feedKeys"],[91,26,72,22],[91,27,72,22,"feedKeys"],[91,35,72,22],[91,36,72,23,"detail"],[91,42,72,29],[91,43,72,30,"listingId"],[91,52,72,39],[91,53,72,40],[92,6,73,4,"queryFn"],[92,13,73,11],[92,15,73,13,"queryFn"],[92,16,73,13],[92,21,73,19,"fetchListingDetail"],[92,39,73,37],[92,40,73,38,"listingId"],[92,49,73,47],[92,50,73,48],[93,6,74,4,"enabled"],[93,13,74,11],[93,15,74,13],[93,16,74,14],[93,17,74,15,"listingId"],[94,4,75,2],[94,5,75,3],[94,6,75,4],[95,2,76,0],[95,3,76,1],[96,2,78,0],[96,6,78,0,"_default"],[96,14,78,0],[96,17,78,15,"useListingDetail"],[96,33,78,31],[97,0,78,32],[97,3]],"functionMap":{"names":["<global>","fetchListingDetail","useListingDetail","useQuery$argument_0.queryFn"],"mappings":"AAA;kCCa;CDmD;yBEK;aCG,mCD;CFG"},"hasCjsExports":false},"type":"js/module"}]}