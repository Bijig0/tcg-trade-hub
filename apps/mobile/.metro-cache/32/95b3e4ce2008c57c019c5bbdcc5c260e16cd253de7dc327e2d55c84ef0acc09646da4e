{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":49,"index":199}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":200},"end":{"line":5,"column":45,"index":245}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"@tcg-trade-hub/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":246},"end":{"line":6,"column":75,"index":321}}],"key":"5m5x3CfVnTLecgF7rw3ym/c0mII=","exportNames":["*"],"imports":1}},{"name":"@/services/devLiveEmitter/devLiveEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":383},"end":{"line":8,"column":85,"index":468}}],"key":"+12q/uGkja92D/Tp4S2X61mlsvU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _libSupabase = require(_dependencyMap[3], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[4], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[5], \"../../queryKeys\");\n  var _tcgTradeHubDatabase = require(_dependencyMap[6], \"@tcg-trade-hub/database\");\n  var _servicesDevLiveEmitterDevLiveEmitter = require(_dependencyMap[7], \"@/services/devLiveEmitter/devLiveEmitter\");\n  /**\n   * Hook that cancels a meetup by updating its status and sending\n   * a system message in the related chat conversation.\n   */\n  var useCancelMeetup = () => {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var meetupId = _ref.meetupId,\n            conversationId = _ref.conversationId;\n          if (!user) throw new Error('Not authenticated');\n          var stepIdx = (0, _tcgTradeHubDatabase.stateStepIndex)('meetup', 'confirmed', 'cancelled');\n          var scoped = __DEV__ ? _servicesDevLiveEmitterDevLiveEmitter.devEmitter.forPath('state:meetup', (0, _servicesDevLiveEmitterDevLiveEmitter.createTraceId)(), 'mobile:cancelMeetup') : undefined;\n          scoped?.(stepIdx, 'started');\n          try {\n            // Fetch current meetup to validate transition\n            var _yield$supabase$from$ = yield _libSupabase.supabase.from('meetups').select('status').eq('id', meetupId).single(),\n              currentMeetup = _yield$supabase$from$.data,\n              fetchError = _yield$supabase$from$.error;\n            if (fetchError) throw fetchError;\n            (0, _tcgTradeHubDatabase.assertTransition)('meetup', currentMeetup.status, 'cancelled');\n\n            // Update meetup status to cancelled\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('meetups').update({\n                status: 'cancelled'\n              }).eq('id', meetupId),\n              meetupError = _yield$supabase$from$2.error;\n            if (meetupError) throw meetupError;\n\n            // Send system message in the conversation\n            var _yield$supabase$from$3 = yield _libSupabase.supabase.from('messages').insert({\n                conversation_id: conversationId,\n                sender_id: user.id,\n                type: 'system',\n                body: 'Meetup was cancelled.',\n                payload: {\n                  event: 'meetup_cancelled'\n                }\n              }),\n              messageError = _yield$supabase$from$3.error;\n            if (messageError) throw messageError;\n            scoped?.(stepIdx, 'success');\n            return {\n              meetupId\n            };\n          } catch (err) {\n            scoped?.(stepIdx, 'error', {\n              message: err.message\n            });\n            throw err;\n          }\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: _ref3 => {\n        var meetupId = _ref3.meetupId;\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(meetupId)\n        });\n      },\n      onError: error => {\n        _reactNative.Alert.alert('Error', error.message ?? 'Failed to cancel meetup');\n      }\n    });\n  };\n  _s(useCancelMeetup, \"F80WCgOaBMKe49pooE2QTJGb66o=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _contextAuthProvider.useAuth, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCancelMeetup;\n});","lineCount":106,"map":[[13,2,82,0,"Object"],[13,8,82,0],[13,9,82,0,"defineProperty"],[13,23,82,0],[13,24,82,0,"exports"],[13,31,82,0],[14,4,82,0,"enumerable"],[14,14,82,0],[15,4,82,0,"get"],[15,7,82,0],[15,18,82,0,"get"],[15,19,82,0],[16,6,82,0],[16,13,82,0,"_default"],[16,21,82,0],[17,4,82,0],[18,2,82,0],[19,2,82,31],[19,6,82,31,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,82,31],[19,45,82,31,"require"],[19,52,82,31],[19,53,82,31,"_dependencyMap"],[19,67,82,31],[20,2,82,31],[20,6,82,31,"_asyncToGenerator"],[20,23,82,31],[20,26,82,31,"_interopDefault"],[20,41,82,31],[20,42,82,31,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,82,31],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_reactNative"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_libSupabase"],[23,18,3,0],[23,21,3,0,"require"],[23,28,3,0],[23,29,3,0,"_dependencyMap"],[23,43,3,0],[24,2,4,0],[24,6,4,0,"_contextAuthProvider"],[24,26,4,0],[24,29,4,0,"require"],[24,36,4,0],[24,37,4,0,"_dependencyMap"],[24,51,4,0],[25,2,5,0],[25,6,5,0,"_queryKeys"],[25,16,5,0],[25,19,5,0,"require"],[25,26,5,0],[25,27,5,0,"_dependencyMap"],[25,41,5,0],[26,2,6,0],[26,6,6,0,"_tcgTradeHubDatabase"],[26,26,6,0],[26,29,6,0,"require"],[26,36,6,0],[26,37,6,0,"_dependencyMap"],[26,51,6,0],[27,2,8,0],[27,6,8,0,"_servicesDevLiveEmitterDevLiveEmitter"],[27,43,8,0],[27,46,8,0,"require"],[27,53,8,0],[27,54,8,0,"_dependencyMap"],[27,68,8,0],[28,2,15,0],[29,0,16,0],[30,0,17,0],[31,0,18,0],[32,2,19,0],[32,6,19,6,"useCancelMeetup"],[32,21,19,21],[32,24,19,24,"useCancelMeetup"],[32,25,19,24],[32,30,19,30],[33,4,19,30,"_s"],[33,6,19,30],[34,4,20,2],[34,8,20,8,"queryClient"],[34,19,20,19],[34,22,20,22],[34,26,20,22,"useQueryClient"],[34,45,20,36],[34,46,20,36,"useQueryClient"],[34,60,20,36],[34,62,20,37],[34,63,20,38],[35,4,21,2],[35,8,21,2,"_useAuth"],[35,16,21,2],[35,19,21,19],[35,23,21,19,"useAuth"],[35,43,21,26],[35,44,21,26,"useAuth"],[35,51,21,26],[35,53,21,27],[35,54,21,28],[36,6,21,10,"user"],[36,10,21,14],[36,13,21,14,"_useAuth"],[36,21,21,14],[36,22,21,10,"user"],[36,26,21,14],[37,4,23,2],[37,11,23,9],[37,15,23,9,"useMutation"],[37,34,23,20],[37,35,23,20,"useMutation"],[37,46,23,20],[37,48,23,21],[38,6,24,4,"mutationFn"],[38,16,24,14],[39,8,24,14],[39,12,24,14,"_ref2"],[39,17,24,14],[39,24,24,14,"_asyncToGenerator"],[39,41,24,14],[39,42,24,14,"default"],[39,49,24,14],[39,51,24,16],[39,62,24,16,"_ref"],[39,66,24,16],[39,68,24,76],[40,10,24,76],[40,14,24,25,"meetupId"],[40,22,24,33],[40,25,24,33,"_ref"],[40,29,24,33],[40,30,24,25,"meetupId"],[40,38,24,33],[41,12,24,35,"conversationId"],[41,26,24,49],[41,29,24,49,"_ref"],[41,33,24,49],[41,34,24,35,"conversationId"],[41,48,24,49],[42,10,25,6],[42,14,25,10],[42,15,25,11,"user"],[42,19,25,15],[42,21,25,17],[42,27,25,23],[42,31,25,27,"Error"],[42,36,25,32],[42,37,25,33],[42,56,25,52],[42,57,25,53],[43,10,27,6],[43,14,27,12,"stepIdx"],[43,21,27,19],[43,24,27,22],[43,28,27,22,"stateStepIndex"],[43,48,27,36],[43,49,27,36,"stateStepIndex"],[43,63,27,36],[43,65,27,37],[43,73,27,45],[43,75,27,47],[43,86,27,58],[43,88,27,60],[43,99,27,71],[43,100,27,72],[44,10,28,6],[44,14,28,12,"scoped"],[44,20,28,18],[44,23,28,21,"__DEV__"],[44,30,28,28],[44,33,29,10,"devEmitter"],[44,70,29,20],[44,71,29,20,"devEmitter"],[44,81,29,20],[44,82,29,21,"forPath"],[44,89,29,28],[44,90,29,29],[44,104,29,43],[44,106,29,45],[44,110,29,45,"createTraceId"],[44,147,29,58],[44,148,29,58,"createTraceId"],[44,161,29,58],[44,163,29,59],[44,164,29,60],[44,166,29,62],[44,187,29,83],[44,188,29,84],[44,191,30,10,"undefined"],[44,200,30,19],[45,10,32,6,"scoped"],[45,16,32,12],[45,19,32,15,"stepIdx"],[45,26,32,22],[45,28,32,24],[45,37,32,33],[45,38,32,34],[46,10,34,6],[46,14,34,10],[47,12,35,8],[48,12,36,8],[48,16,36,8,"_yield$supabase$from$"],[48,37,36,8],[48,46,36,65,"supabase"],[48,58,36,73],[48,59,36,73,"supabase"],[48,67,36,73],[48,68,37,11,"from"],[48,72,37,15],[48,73,37,16],[48,82,37,25],[48,83,37,26],[48,84,38,11,"select"],[48,90,38,17],[48,91,38,18],[48,99,38,26],[48,100,38,27],[48,101,39,11,"eq"],[48,103,39,13],[48,104,39,14],[48,108,39,18],[48,110,39,20,"meetupId"],[48,118,39,28],[48,119,39,29],[48,120,40,11,"single"],[48,126,40,17],[48,127,40,18],[48,128,40,19],[49,14,36,22,"currentMeetup"],[49,27,36,35],[49,30,36,35,"_yield$supabase$from$"],[49,51,36,35],[49,52,36,16,"data"],[49,56,36,20],[50,14,36,44,"fetchError"],[50,24,36,54],[50,27,36,54,"_yield$supabase$from$"],[50,48,36,54],[50,49,36,37,"error"],[50,54,36,42],[51,12,42,8],[51,16,42,12,"fetchError"],[51,26,42,22],[51,28,42,24],[51,34,42,30,"fetchError"],[51,44,42,40],[52,12,44,8],[52,16,44,8,"assertTransition"],[52,36,44,24],[52,37,44,24,"assertTransition"],[52,53,44,24],[52,55,44,25],[52,63,44,33],[52,65,44,35,"currentMeetup"],[52,78,44,48],[52,79,44,49,"status"],[52,85,44,55],[52,87,44,73],[52,98,44,84],[52,99,44,85],[54,12,46,8],[55,12,47,8],[55,16,47,8,"_yield$supabase$from$2"],[55,38,47,8],[55,47,47,45,"supabase"],[55,59,47,53],[55,60,47,53,"supabase"],[55,68,47,53],[55,69,48,11,"from"],[55,73,48,15],[55,74,48,16],[55,83,48,25],[55,84,48,26],[55,85,49,11,"update"],[55,91,49,17],[55,92,49,18],[56,16,49,20,"status"],[56,22,49,26],[56,24,49,28],[57,14,49,40],[57,15,49,41],[57,16,49,42],[57,17,50,11,"eq"],[57,19,50,13],[57,20,50,14],[57,24,50,18],[57,26,50,20,"meetupId"],[57,34,50,28],[57,35,50,29],[58,14,47,23,"meetupError"],[58,25,47,34],[58,28,47,34,"_yield$supabase$from$2"],[58,50,47,34],[58,51,47,16,"error"],[58,56,47,21],[59,12,52,8],[59,16,52,12,"meetupError"],[59,27,52,23],[59,29,52,25],[59,35,52,31,"meetupError"],[59,46,52,42],[61,12,54,8],[62,12,55,8],[62,16,55,8,"_yield$supabase$from$3"],[62,38,55,8],[62,47,55,46,"supabase"],[62,59,55,54],[62,60,55,54,"supabase"],[62,68,55,54],[62,69,55,55,"from"],[62,73,55,59],[62,74,55,60],[62,84,55,70],[62,85,55,71],[62,86,55,72,"insert"],[62,92,55,78],[62,93,55,79],[63,16,56,10,"conversation_id"],[63,31,56,25],[63,33,56,27,"conversationId"],[63,47,56,41],[64,16,57,10,"sender_id"],[64,25,57,19],[64,27,57,21,"user"],[64,31,57,25],[64,32,57,26,"id"],[64,34,57,28],[65,16,58,10,"type"],[65,20,58,14],[65,22,58,16],[65,30,58,24],[66,16,59,10,"body"],[66,20,59,14],[66,22,59,16],[66,45,59,39],[67,16,60,10,"payload"],[67,23,60,17],[67,25,60,19],[68,18,60,21,"event"],[68,23,60,26],[68,25,60,28],[69,16,60,47],[70,14,61,8],[70,15,61,9],[70,16,61,10],[71,14,55,23,"messageError"],[71,26,55,35],[71,29,55,35,"_yield$supabase$from$3"],[71,51,55,35],[71,52,55,16,"error"],[71,57,55,21],[72,12,63,8],[72,16,63,12,"messageError"],[72,28,63,24],[72,30,63,26],[72,36,63,32,"messageError"],[72,48,63,44],[73,12,65,8,"scoped"],[73,18,65,14],[73,21,65,17,"stepIdx"],[73,28,65,24],[73,30,65,26],[73,39,65,35],[73,40,65,36],[74,12,66,8],[74,19,66,15],[75,14,66,17,"meetupId"],[76,12,66,26],[76,13,66,27],[77,10,67,6],[77,11,67,7],[77,12,67,8],[77,19,67,15,"err"],[77,22,67,18],[77,24,67,20],[78,12,68,8,"scoped"],[78,18,68,14],[78,21,68,17,"stepIdx"],[78,28,68,24],[78,30,68,26],[78,37,68,33],[78,39,68,35],[79,14,68,37,"message"],[79,21,68,44],[79,23,68,47,"err"],[79,26,68,50],[79,27,68,61,"message"],[80,12,68,69],[80,13,68,70],[80,14,68,71],[81,12,69,8],[81,18,69,14,"err"],[81,21,69,17],[82,10,70,6],[83,8,71,4],[83,9,71,5],[84,8,71,5],[84,24,24,4,"mutationFn"],[84,34,24,14,"mutationFn"],[84,35,24,14,"_x"],[84,37,24,14],[85,10,24,14],[85,17,24,14,"_ref2"],[85,22,24,14],[85,23,24,14,"apply"],[85,28,24,14],[85,35,24,14,"arguments"],[85,44,24,14],[86,8,24,14],[87,6,24,14],[87,9,71,5],[88,6,72,4,"onSuccess"],[88,15,72,13],[88,17,72,15,"_ref3"],[88,22,72,15],[88,26,72,33],[89,8,72,33],[89,12,72,18,"meetupId"],[89,20,72,26],[89,23,72,26,"_ref3"],[89,28,72,26],[89,29,72,18,"meetupId"],[89,37,72,26],[90,8,73,6,"queryClient"],[90,19,73,17],[90,20,73,18,"invalidateQueries"],[90,37,73,35],[90,38,73,36],[91,10,73,38,"queryKey"],[91,18,73,46],[91,20,73,48,"meetupKeys"],[91,30,73,58],[91,31,73,58,"meetupKeys"],[91,41,73,58],[91,42,73,59,"all"],[92,8,73,63],[92,9,73,64],[92,10,73,65],[93,8,74,6,"queryClient"],[93,19,74,17],[93,20,74,18,"invalidateQueries"],[93,37,74,35],[93,38,74,36],[94,10,74,38,"queryKey"],[94,18,74,46],[94,20,74,48,"meetupKeys"],[94,30,74,58],[94,31,74,58,"meetupKeys"],[94,41,74,58],[94,42,74,59,"detail"],[94,48,74,65],[94,49,74,66,"meetupId"],[94,57,74,74],[95,8,74,76],[95,9,74,77],[95,10,74,78],[96,6,75,4],[96,7,75,5],[97,6,76,4,"onError"],[97,13,76,11],[97,15,76,14,"error"],[97,20,76,26],[97,24,76,31],[98,8,77,6,"Alert"],[98,20,77,11],[98,21,77,11,"Alert"],[98,26,77,11],[98,27,77,12,"alert"],[98,32,77,17],[98,33,77,18],[98,40,77,25],[98,42,77,27,"error"],[98,47,77,32],[98,48,77,33,"message"],[98,55,77,40],[98,59,77,44],[98,84,77,69],[98,85,77,70],[99,6,78,4],[100,4,79,2],[100,5,79,3],[100,6,79,4],[101,2,80,0],[101,3,80,1],[102,2,80,2,"_s"],[102,4,80,2],[102,5,19,6,"useCancelMeetup"],[102,20,19,21],[103,4,19,21],[103,12,20,22,"useQueryClient"],[103,31,20,36],[103,32,20,36,"useQueryClient"],[103,46,20,36],[103,48,21,19,"useAuth"],[103,68,21,26],[103,69,21,26,"useAuth"],[103,76,21,26],[103,78,23,9,"useMutation"],[103,97,23,20],[103,98,23,20,"useMutation"],[103,109,23,20],[104,2,23,20],[105,2,82,0],[105,6,82,0,"_default"],[105,14,82,0],[105,17,82,15,"useCancelMeetup"],[105,32,82,30],[106,0,82,31],[106,3]],"functionMap":{"names":["<global>","useCancelMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;wBCkB;gBCK;KD+C;eEC;KFG;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}