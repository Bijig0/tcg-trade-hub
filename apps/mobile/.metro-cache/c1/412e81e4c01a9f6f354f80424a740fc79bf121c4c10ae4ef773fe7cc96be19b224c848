{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":40,"index":98}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":42,"index":141}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":142},"end":{"line":4,"column":49,"index":191}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1], \"@babel/runtime/helpers/slicedToArray\");\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2], \"react\");\n  var _reactNative = require(_dependencyMap[3], \"react-native\");\n  var _libSupabase = require(_dependencyMap[4], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[5], \"@/context/AuthProvider\");\n  /**\n   * Tracks online presence using Supabase Realtime Presence.\n   * Automatically tracks/untracks when the app goes to background/foreground.\n   *\n   * Returns the set of online user IDs and a convenience `isOnline` checker.\n   */\n  var useOnlinePresence = () => {\n    _s();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var _useState = (0, _react.useState)(new Set()),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      onlineUserIds = _useState2[0],\n      setOnlineUserIds = _useState2[1];\n    var isOnline = (0, _react.useCallback)(userId => onlineUserIds.has(userId), [onlineUserIds]);\n    (0, _react.useEffect)(() => {\n      if (!user) return;\n      var channel = _libSupabase.supabase.channel('presence:global', {\n        config: {\n          presence: {\n            key: user.id\n          }\n        }\n      });\n      channel.on('presence', {\n        event: 'sync'\n      }, () => {\n        var state = channel.presenceState();\n        var ids = new Set(Object.keys(state));\n        setOnlineUserIds(ids);\n      }).subscribe(/*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (status) {\n          if (status === 'SUBSCRIBED') {\n            yield channel.track({\n              online_at: new Date().toISOString()\n            });\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n\n      // Track/untrack based on app state\n      var subscription = _reactNative.AppState.addEventListener('change', /*#__PURE__*/function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (nextState) {\n          if (nextState === 'active') {\n            yield channel.track({\n              online_at: new Date().toISOString()\n            });\n          } else {\n            yield channel.untrack();\n          }\n        });\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      return () => {\n        subscription.remove();\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [user]);\n    return {\n      onlineUserIds,\n      isOnline\n    };\n  };\n  _s(useOnlinePresence, \"8tr9KY6q8CtCYp5wM6LlhTlhYjo=\", false, function () {\n    return [_contextAuthProvider.useAuth];\n  });\n  var _default = useOnlinePresence;\n});","lineCount":99,"map":[[13,2,58,0,"Object"],[13,8,58,0],[13,9,58,0,"defineProperty"],[13,23,58,0],[13,24,58,0,"exports"],[13,31,58,0],[14,4,58,0,"enumerable"],[14,14,58,0],[15,4,58,0,"get"],[15,7,58,0],[15,18,58,0,"get"],[15,19,58,0],[16,6,58,0],[16,13,58,0,"_default"],[16,21,58,0],[17,4,58,0],[18,2,58,0],[19,2,58,33],[19,6,58,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,58,33],[19,45,58,33,"require"],[19,52,58,33],[19,53,58,33,"_dependencyMap"],[19,67,58,33],[20,2,58,33],[20,6,58,33,"_asyncToGenerator"],[20,23,58,33],[20,26,58,33,"_interopDefault"],[20,41,58,33],[20,42,58,33,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,58,33],[21,2,58,33],[21,6,58,33,"_babelRuntimeHelpersSlicedToArray"],[21,39,58,33],[21,42,58,33,"require"],[21,49,58,33],[21,50,58,33,"_dependencyMap"],[21,64,58,33],[22,2,58,33],[22,6,58,33,"_slicedToArray"],[22,20,58,33],[22,23,58,33,"_interopDefault"],[22,38,58,33],[22,39,58,33,"_babelRuntimeHelpersSlicedToArray"],[22,72,58,33],[23,2,1,0],[23,6,1,0,"_react"],[23,12,1,0],[23,15,1,0,"require"],[23,22,1,0],[23,23,1,0,"_dependencyMap"],[23,37,1,0],[24,2,2,0],[24,6,2,0,"_reactNative"],[24,18,2,0],[24,21,2,0,"require"],[24,28,2,0],[24,29,2,0,"_dependencyMap"],[24,43,2,0],[25,2,3,0],[25,6,3,0,"_libSupabase"],[25,18,3,0],[25,21,3,0,"require"],[25,28,3,0],[25,29,3,0,"_dependencyMap"],[25,43,3,0],[26,2,4,0],[26,6,4,0,"_contextAuthProvider"],[26,26,4,0],[26,29,4,0,"require"],[26,36,4,0],[26,37,4,0,"_dependencyMap"],[26,51,4,0],[27,2,6,0],[28,0,7,0],[29,0,8,0],[30,0,9,0],[31,0,10,0],[32,0,11,0],[33,2,12,0],[33,6,12,6,"useOnlinePresence"],[33,23,12,23],[33,26,12,26,"useOnlinePresence"],[33,27,12,26],[33,32,12,32],[34,4,12,32,"_s"],[34,6,12,32],[35,4,13,2],[35,8,13,2,"_useAuth"],[35,16,13,2],[35,19,13,19],[35,23,13,19,"useAuth"],[35,43,13,26],[35,44,13,26,"useAuth"],[35,51,13,26],[35,53,13,27],[35,54,13,28],[36,6,13,10,"user"],[36,10,13,14],[36,13,13,14,"_useAuth"],[36,21,13,14],[36,22,13,10,"user"],[36,26,13,14],[37,4,14,2],[37,8,14,2,"_useState"],[37,17,14,2],[37,20,14,44],[37,24,14,44,"useState"],[37,30,14,52],[37,31,14,52,"useState"],[37,39,14,52],[37,41,14,66],[37,45,14,70,"Set"],[37,48,14,73],[37,49,14,74],[37,50,14,75],[37,51,14,76],[38,6,14,76,"_useState2"],[38,16,14,76],[38,23,14,76,"_slicedToArray"],[38,37,14,76],[38,38,14,76,"default"],[38,45,14,76],[38,47,14,76,"_useState"],[38,56,14,76],[39,6,14,9,"onlineUserIds"],[39,19,14,22],[39,22,14,22,"_useState2"],[39,32,14,22],[40,6,14,24,"setOnlineUserIds"],[40,22,14,40],[40,25,14,40,"_useState2"],[40,35,14,40],[41,4,16,2],[41,8,16,8,"isOnline"],[41,16,16,16],[41,19,16,19],[41,23,16,19,"useCallback"],[41,29,16,30],[41,30,16,30,"useCallback"],[41,41,16,30],[41,43,17,5,"userId"],[41,49,17,19],[41,53,17,24,"onlineUserIds"],[41,66,17,37],[41,67,17,38,"has"],[41,70,17,41],[41,71,17,42,"userId"],[41,77,17,48],[41,78,17,49],[41,80,18,4],[41,81,18,5,"onlineUserIds"],[41,94,18,18],[41,95,19,2],[41,96,19,3],[42,4,21,2],[42,8,21,2,"useEffect"],[42,14,21,11],[42,15,21,11,"useEffect"],[42,24,21,11],[42,26,21,12],[42,32,21,18],[43,6,22,4],[43,10,22,8],[43,11,22,9,"user"],[43,15,22,13],[43,17,22,15],[44,6,24,4],[44,10,24,10,"channel"],[44,17,24,17],[44,20,24,20,"supabase"],[44,32,24,28],[44,33,24,28,"supabase"],[44,41,24,28],[44,42,24,29,"channel"],[44,49,24,36],[44,50,24,37],[44,67,24,54],[44,69,24,56],[45,8,25,6,"config"],[45,14,25,12],[45,16,25,14],[46,10,25,16,"presence"],[46,18,25,24],[46,20,25,26],[47,12,25,28,"key"],[47,15,25,31],[47,17,25,33,"user"],[47,21,25,37],[47,22,25,38,"id"],[48,10,25,41],[49,8,25,43],[50,6,26,4],[50,7,26,5],[50,8,26,6],[51,6,28,4,"channel"],[51,13,28,11],[51,14,29,7,"on"],[51,16,29,9],[51,17,29,10],[51,27,29,20],[51,29,29,22],[52,8,29,24,"event"],[52,13,29,29],[52,15,29,31],[53,6,29,38],[53,7,29,39],[53,9,29,41],[53,15,29,47],[54,8,30,8],[54,12,30,14,"state"],[54,17,30,19],[54,20,30,22,"channel"],[54,27,30,29],[54,28,30,30,"presenceState"],[54,41,30,43],[54,42,30,44],[54,43,30,45],[55,8,31,8],[55,12,31,14,"ids"],[55,15,31,17],[55,18,31,20],[55,22,31,24,"Set"],[55,25,31,27],[55,26,31,28,"Object"],[55,32,31,34],[55,33,31,35,"keys"],[55,37,31,39],[55,38,31,40,"state"],[55,43,31,45],[55,44,31,46],[55,45,31,47],[56,8,32,8,"setOnlineUserIds"],[56,24,32,24],[56,25,32,25,"ids"],[56,28,32,28],[56,29,32,29],[57,6,33,6],[57,7,33,7],[57,8,33,8],[57,9,34,7,"subscribe"],[57,18,34,16],[58,8,34,16],[58,12,34,16,"_ref"],[58,16,34,16],[58,23,34,16,"_asyncToGenerator"],[58,40,34,16],[58,41,34,16,"default"],[58,48,34,16],[58,50,34,17],[58,61,34,24,"status"],[58,67,34,30],[58,69,34,35],[59,10,35,8],[59,14,35,12,"status"],[59,20,35,18],[59,25,35,23],[59,37,35,35],[59,39,35,37],[60,12,36,10],[60,18,36,16,"channel"],[60,25,36,23],[60,26,36,24,"track"],[60,31,36,29],[60,32,36,30],[61,14,36,32,"online_at"],[61,23,36,41],[61,25,36,43],[61,29,36,47,"Date"],[61,33,36,51],[61,34,36,52],[61,35,36,53],[61,36,36,54,"toISOString"],[61,47,36,65],[61,48,36,66],[62,12,36,68],[62,13,36,69],[62,14,36,70],[63,10,37,8],[64,8,38,6],[64,9,38,7],[65,8,38,7],[65,25,38,7,"_x"],[65,27,38,7],[66,10,38,7],[66,17,38,7,"_ref"],[66,21,38,7],[66,22,38,7,"apply"],[66,27,38,7],[66,34,38,7,"arguments"],[66,43,38,7],[67,8,38,7],[68,6,38,7],[68,10,38,8],[70,6,40,4],[71,6,41,4],[71,10,41,10,"subscription"],[71,22,41,22],[71,25,41,25,"AppState"],[71,37,41,33],[71,38,41,33,"AppState"],[71,46,41,33],[71,47,41,34,"addEventListener"],[71,63,41,50],[71,64,41,51],[71,72,41,59],[72,8,41,59],[72,12,41,59,"_ref2"],[72,17,41,59],[72,24,41,59,"_asyncToGenerator"],[72,41,41,59],[72,42,41,59,"default"],[72,49,41,59],[72,51,41,61],[72,62,41,68,"nextState"],[72,71,41,77],[72,73,41,82],[73,10,42,6],[73,14,42,10,"nextState"],[73,23,42,19],[73,28,42,24],[73,36,42,32],[73,38,42,34],[74,12,43,8],[74,18,43,14,"channel"],[74,25,43,21],[74,26,43,22,"track"],[74,31,43,27],[74,32,43,28],[75,14,43,30,"online_at"],[75,23,43,39],[75,25,43,41],[75,29,43,45,"Date"],[75,33,43,49],[75,34,43,50],[75,35,43,51],[75,36,43,52,"toISOString"],[75,47,43,63],[75,48,43,64],[76,12,43,66],[76,13,43,67],[76,14,43,68],[77,10,44,6],[77,11,44,7],[77,17,44,13],[78,12,45,8],[78,18,45,14,"channel"],[78,25,45,21],[78,26,45,22,"untrack"],[78,33,45,29],[78,34,45,30],[78,35,45,31],[79,10,46,6],[80,8,47,4],[80,9,47,5],[81,8,47,5],[81,25,47,5,"_x2"],[81,28,47,5],[82,10,47,5],[82,17,47,5,"_ref2"],[82,22,47,5],[82,23,47,5,"apply"],[82,28,47,5],[82,35,47,5,"arguments"],[82,44,47,5],[83,8,47,5],[84,6,47,5],[84,10,47,6],[85,6,49,4],[85,13,49,11],[85,19,49,17],[86,8,50,6,"subscription"],[86,20,50,18],[86,21,50,19,"remove"],[86,27,50,25],[86,28,50,26],[86,29,50,27],[87,8,51,6,"supabase"],[87,20,51,14],[87,21,51,14,"supabase"],[87,29,51,14],[87,30,51,15,"removeChannel"],[87,43,51,28],[87,44,51,29,"channel"],[87,51,51,36],[87,52,51,37],[88,6,52,4],[88,7,52,5],[89,4,53,2],[89,5,53,3],[89,7,53,5],[89,8,53,6,"user"],[89,12,53,10],[89,13,53,11],[89,14,53,12],[90,4,55,2],[90,11,55,9],[91,6,55,11,"onlineUserIds"],[91,19,55,24],[92,6,55,26,"isOnline"],[93,4,55,35],[93,5,55,36],[94,2,56,0],[94,3,56,1],[95,2,56,2,"_s"],[95,4,56,2],[95,5,12,6,"useOnlinePresence"],[95,22,12,23],[96,4,12,23],[96,12,13,19,"useAuth"],[96,32,13,26],[96,33,13,26,"useAuth"],[96,40,13,26],[97,2,13,26],[98,2,58,0],[98,6,58,0,"_default"],[98,14,58,0],[98,17,58,15,"useOnlinePresence"],[98,34,58,32],[99,0,58,33],[99,3]],"functionMap":{"names":["<global>","useOnlinePresence","isOnline","useEffect$argument_0","channel.on$argument_2","channel.on.subscribe$argument_0","AppState.addEventListener$argument_1","<anonymous>"],"mappings":"AAA;0BCW;ICK,6CD;YEI;yCCQ;ODI;iBEC;OFI;6DGG;KHM;WIE;KJG;GFC;CDG"},"hasCjsExports":false},"type":"js/module"}]}