{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":49,"index":199}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":200},"end":{"line":5,"column":45,"index":245}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"@tcg-trade-hub/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":246},"end":{"line":6,"column":75,"index":321}}],"key":"5m5x3CfVnTLecgF7rw3ym/c0mII=","exportNames":["*"],"imports":1}},{"name":"@/services/devLiveEmitter/devLiveEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":8,"column":0,"index":383},"end":{"line":8,"column":85,"index":468}}],"key":"+12q/uGkja92D/Tp4S2X61mlsvU=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _reactNative = require(_dependencyMap[2]);\n  var _libSupabase = require(_dependencyMap[3]);\n  var _contextAuthProvider = require(_dependencyMap[4]);\n  var _queryKeys = require(_dependencyMap[5]);\n  var _tcgTradeHubDatabase = require(_dependencyMap[6]);\n  var _servicesDevLiveEmitterDevLiveEmitter = require(_dependencyMap[7]);\n  /**\n   * Hook that cancels a meetup by updating its status and sending\n   * a system message in the related chat conversation.\n   */\n  var useCancelMeetup = () => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var meetupId = _ref.meetupId,\n            conversationId = _ref.conversationId;\n          if (!user) throw new Error('Not authenticated');\n          var stepIdx = (0, _tcgTradeHubDatabase.stateStepIndex)('meetup', 'confirmed', 'cancelled');\n          var scoped = undefined;\n          scoped?.(stepIdx, 'started');\n          try {\n            // Fetch current meetup to validate transition\n            var _yield$supabase$from$ = yield _libSupabase.supabase.from('meetups').select('status').eq('id', meetupId).single(),\n              currentMeetup = _yield$supabase$from$.data,\n              fetchError = _yield$supabase$from$.error;\n            if (fetchError) throw fetchError;\n            (0, _tcgTradeHubDatabase.assertTransition)('meetup', currentMeetup.status, 'cancelled');\n\n            // Update meetup status to cancelled\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('meetups').update({\n                status: 'cancelled'\n              }).eq('id', meetupId),\n              meetupError = _yield$supabase$from$2.error;\n            if (meetupError) throw meetupError;\n\n            // Send system message in the conversation\n            var _yield$supabase$from$3 = yield _libSupabase.supabase.from('messages').insert({\n                conversation_id: conversationId,\n                sender_id: user.id,\n                type: 'system',\n                body: 'Meetup was cancelled.',\n                payload: {\n                  event: 'meetup_cancelled'\n                }\n              }),\n              messageError = _yield$supabase$from$3.error;\n            if (messageError) throw messageError;\n            scoped?.(stepIdx, 'success');\n            return {\n              meetupId\n            };\n          } catch (err) {\n            scoped?.(stepIdx, 'error', {\n              message: err.message\n            });\n            throw err;\n          }\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: _ref3 => {\n        var meetupId = _ref3.meetupId;\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(meetupId)\n        });\n      },\n      onError: error => {\n        _reactNative.Alert.alert('Error', error.message ?? 'Failed to cancel meetup');\n      }\n    });\n  };\n  var _default = useCancelMeetup;\n});","lineCount":101,"map":[[12,2,82,0,"Object"],[12,8,82,0],[12,9,82,0,"defineProperty"],[12,23,82,0],[12,24,82,0,"exports"],[12,31,82,0],[13,4,82,0,"enumerable"],[13,14,82,0],[14,4,82,0,"get"],[14,7,82,0],[14,18,82,0,"get"],[14,19,82,0],[15,6,82,0],[15,13,82,0,"_default"],[15,21,82,0],[16,4,82,0],[17,2,82,0],[18,2,82,31],[18,6,82,31,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,82,31],[18,45,82,31,"require"],[18,52,82,31],[18,53,82,31,"_dependencyMap"],[18,67,82,31],[19,2,82,31],[19,6,82,31,"_asyncToGenerator"],[19,23,82,31],[19,26,82,31,"_interopDefault"],[19,41,82,31],[19,42,82,31,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,82,31],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_reactNative"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_libSupabase"],[22,18,3,0],[22,21,3,0,"require"],[22,28,3,0],[22,29,3,0,"_dependencyMap"],[22,43,3,0],[23,2,4,0],[23,6,4,0,"_contextAuthProvider"],[23,26,4,0],[23,29,4,0,"require"],[23,36,4,0],[23,37,4,0,"_dependencyMap"],[23,51,4,0],[24,2,5,0],[24,6,5,0,"_queryKeys"],[24,16,5,0],[24,19,5,0,"require"],[24,26,5,0],[24,27,5,0,"_dependencyMap"],[24,41,5,0],[25,2,6,0],[25,6,6,0,"_tcgTradeHubDatabase"],[25,26,6,0],[25,29,6,0,"require"],[25,36,6,0],[25,37,6,0,"_dependencyMap"],[25,51,6,0],[26,2,8,0],[26,6,8,0,"_servicesDevLiveEmitterDevLiveEmitter"],[26,43,8,0],[26,46,8,0,"require"],[26,53,8,0],[26,54,8,0,"_dependencyMap"],[26,68,8,0],[27,2,15,0],[28,0,16,0],[29,0,17,0],[30,0,18,0],[31,2,19,0],[31,6,19,6,"useCancelMeetup"],[31,21,19,21],[31,24,19,24,"useCancelMeetup"],[31,25,19,24],[31,30,19,30],[32,4,20,2],[32,8,20,8,"queryClient"],[32,19,20,19],[32,22,20,22],[32,26,20,22,"useQueryClient"],[32,45,20,36],[32,46,20,36,"useQueryClient"],[32,60,20,36],[32,62,20,37],[32,63,20,38],[33,4,21,2],[33,8,21,2,"_useAuth"],[33,16,21,2],[33,19,21,19],[33,23,21,19,"useAuth"],[33,43,21,26],[33,44,21,26,"useAuth"],[33,51,21,26],[33,53,21,27],[33,54,21,28],[34,6,21,10,"user"],[34,10,21,14],[34,13,21,14,"_useAuth"],[34,21,21,14],[34,22,21,10,"user"],[34,26,21,14],[35,4,23,2],[35,11,23,9],[35,15,23,9,"useMutation"],[35,34,23,20],[35,35,23,20,"useMutation"],[35,46,23,20],[35,48,23,21],[36,6,24,4,"mutationFn"],[36,16,24,14],[37,8,24,14],[37,12,24,14,"_ref2"],[37,17,24,14],[37,24,24,14,"_asyncToGenerator"],[37,41,24,14],[37,42,24,14,"default"],[37,49,24,14],[37,51,24,16],[37,62,24,16,"_ref"],[37,66,24,16],[37,68,24,76],[38,10,24,76],[38,14,24,25,"meetupId"],[38,22,24,33],[38,25,24,33,"_ref"],[38,29,24,33],[38,30,24,25,"meetupId"],[38,38,24,33],[39,12,24,35,"conversationId"],[39,26,24,49],[39,29,24,49,"_ref"],[39,33,24,49],[39,34,24,35,"conversationId"],[39,48,24,49],[40,10,25,6],[40,14,25,10],[40,15,25,11,"user"],[40,19,25,15],[40,21,25,17],[40,27,25,23],[40,31,25,27,"Error"],[40,36,25,32],[40,37,25,33],[40,56,25,52],[40,57,25,53],[41,10,27,6],[41,14,27,12,"stepIdx"],[41,21,27,19],[41,24,27,22],[41,28,27,22,"stateStepIndex"],[41,48,27,36],[41,49,27,36,"stateStepIndex"],[41,63,27,36],[41,65,27,37],[41,73,27,45],[41,75,27,47],[41,86,27,58],[41,88,27,60],[41,99,27,71],[41,100,27,72],[42,10,28,6],[42,14,28,12,"scoped"],[42,20,28,18],[42,23,30,10,"undefined"],[42,32,30,19],[43,10,32,6,"scoped"],[43,16,32,12],[43,19,32,15,"stepIdx"],[43,26,32,22],[43,28,32,24],[43,37,32,33],[43,38,32,34],[44,10,34,6],[44,14,34,10],[45,12,35,8],[46,12,36,8],[46,16,36,8,"_yield$supabase$from$"],[46,37,36,8],[46,46,36,65,"supabase"],[46,58,36,73],[46,59,36,73,"supabase"],[46,67,36,73],[46,68,37,11,"from"],[46,72,37,15],[46,73,37,16],[46,82,37,25],[46,83,37,26],[46,84,38,11,"select"],[46,90,38,17],[46,91,38,18],[46,99,38,26],[46,100,38,27],[46,101,39,11,"eq"],[46,103,39,13],[46,104,39,14],[46,108,39,18],[46,110,39,20,"meetupId"],[46,118,39,28],[46,119,39,29],[46,120,40,11,"single"],[46,126,40,17],[46,127,40,18],[46,128,40,19],[47,14,36,22,"currentMeetup"],[47,27,36,35],[47,30,36,35,"_yield$supabase$from$"],[47,51,36,35],[47,52,36,16,"data"],[47,56,36,20],[48,14,36,44,"fetchError"],[48,24,36,54],[48,27,36,54,"_yield$supabase$from$"],[48,48,36,54],[48,49,36,37,"error"],[48,54,36,42],[49,12,42,8],[49,16,42,12,"fetchError"],[49,26,42,22],[49,28,42,24],[49,34,42,30,"fetchError"],[49,44,42,40],[50,12,44,8],[50,16,44,8,"assertTransition"],[50,36,44,24],[50,37,44,24,"assertTransition"],[50,53,44,24],[50,55,44,25],[50,63,44,33],[50,65,44,35,"currentMeetup"],[50,78,44,48],[50,79,44,49,"status"],[50,85,44,55],[50,87,44,73],[50,98,44,84],[50,99,44,85],[52,12,46,8],[53,12,47,8],[53,16,47,8,"_yield$supabase$from$2"],[53,38,47,8],[53,47,47,45,"supabase"],[53,59,47,53],[53,60,47,53,"supabase"],[53,68,47,53],[53,69,48,11,"from"],[53,73,48,15],[53,74,48,16],[53,83,48,25],[53,84,48,26],[53,85,49,11,"update"],[53,91,49,17],[53,92,49,18],[54,16,49,20,"status"],[54,22,49,26],[54,24,49,28],[55,14,49,40],[55,15,49,41],[55,16,49,42],[55,17,50,11,"eq"],[55,19,50,13],[55,20,50,14],[55,24,50,18],[55,26,50,20,"meetupId"],[55,34,50,28],[55,35,50,29],[56,14,47,23,"meetupError"],[56,25,47,34],[56,28,47,34,"_yield$supabase$from$2"],[56,50,47,34],[56,51,47,16,"error"],[56,56,47,21],[57,12,52,8],[57,16,52,12,"meetupError"],[57,27,52,23],[57,29,52,25],[57,35,52,31,"meetupError"],[57,46,52,42],[59,12,54,8],[60,12,55,8],[60,16,55,8,"_yield$supabase$from$3"],[60,38,55,8],[60,47,55,46,"supabase"],[60,59,55,54],[60,60,55,54,"supabase"],[60,68,55,54],[60,69,55,55,"from"],[60,73,55,59],[60,74,55,60],[60,84,55,70],[60,85,55,71],[60,86,55,72,"insert"],[60,92,55,78],[60,93,55,79],[61,16,56,10,"conversation_id"],[61,31,56,25],[61,33,56,27,"conversationId"],[61,47,56,41],[62,16,57,10,"sender_id"],[62,25,57,19],[62,27,57,21,"user"],[62,31,57,25],[62,32,57,26,"id"],[62,34,57,28],[63,16,58,10,"type"],[63,20,58,14],[63,22,58,16],[63,30,58,24],[64,16,59,10,"body"],[64,20,59,14],[64,22,59,16],[64,45,59,39],[65,16,60,10,"payload"],[65,23,60,17],[65,25,60,19],[66,18,60,21,"event"],[66,23,60,26],[66,25,60,28],[67,16,60,47],[68,14,61,8],[68,15,61,9],[68,16,61,10],[69,14,55,23,"messageError"],[69,26,55,35],[69,29,55,35,"_yield$supabase$from$3"],[69,51,55,35],[69,52,55,16,"error"],[69,57,55,21],[70,12,63,8],[70,16,63,12,"messageError"],[70,28,63,24],[70,30,63,26],[70,36,63,32,"messageError"],[70,48,63,44],[71,12,65,8,"scoped"],[71,18,65,14],[71,21,65,17,"stepIdx"],[71,28,65,24],[71,30,65,26],[71,39,65,35],[71,40,65,36],[72,12,66,8],[72,19,66,15],[73,14,66,17,"meetupId"],[74,12,66,26],[74,13,66,27],[75,10,67,6],[75,11,67,7],[75,12,67,8],[75,19,67,15,"err"],[75,22,67,18],[75,24,67,20],[76,12,68,8,"scoped"],[76,18,68,14],[76,21,68,17,"stepIdx"],[76,28,68,24],[76,30,68,26],[76,37,68,33],[76,39,68,35],[77,14,68,37,"message"],[77,21,68,44],[77,23,68,47,"err"],[77,26,68,50],[77,27,68,61,"message"],[78,12,68,69],[78,13,68,70],[78,14,68,71],[79,12,69,8],[79,18,69,14,"err"],[79,21,69,17],[80,10,70,6],[81,8,71,4],[81,9,71,5],[82,8,71,5],[82,24,24,4,"mutationFn"],[82,34,24,14,"mutationFn"],[82,35,24,14,"_x"],[82,37,24,14],[83,10,24,14],[83,17,24,14,"_ref2"],[83,22,24,14],[83,23,24,14,"apply"],[83,28,24,14],[83,35,24,14,"arguments"],[83,44,24,14],[84,8,24,14],[85,6,24,14],[85,9,71,5],[86,6,72,4,"onSuccess"],[86,15,72,13],[86,17,72,15,"_ref3"],[86,22,72,15],[86,26,72,33],[87,8,72,33],[87,12,72,18,"meetupId"],[87,20,72,26],[87,23,72,26,"_ref3"],[87,28,72,26],[87,29,72,18,"meetupId"],[87,37,72,26],[88,8,73,6,"queryClient"],[88,19,73,17],[88,20,73,18,"invalidateQueries"],[88,37,73,35],[88,38,73,36],[89,10,73,38,"queryKey"],[89,18,73,46],[89,20,73,48,"meetupKeys"],[89,30,73,58],[89,31,73,58,"meetupKeys"],[89,41,73,58],[89,42,73,59,"all"],[90,8,73,63],[90,9,73,64],[90,10,73,65],[91,8,74,6,"queryClient"],[91,19,74,17],[91,20,74,18,"invalidateQueries"],[91,37,74,35],[91,38,74,36],[92,10,74,38,"queryKey"],[92,18,74,46],[92,20,74,48,"meetupKeys"],[92,30,74,58],[92,31,74,58,"meetupKeys"],[92,41,74,58],[92,42,74,59,"detail"],[92,48,74,65],[92,49,74,66,"meetupId"],[92,57,74,74],[93,8,74,76],[93,9,74,77],[93,10,74,78],[94,6,75,4],[94,7,75,5],[95,6,76,4,"onError"],[95,13,76,11],[95,15,76,14,"error"],[95,20,76,26],[95,24,76,31],[96,8,77,6,"Alert"],[96,20,77,11],[96,21,77,11,"Alert"],[96,26,77,11],[96,27,77,12,"alert"],[96,32,77,17],[96,33,77,18],[96,40,77,25],[96,42,77,27,"error"],[96,47,77,32],[96,48,77,33,"message"],[96,55,77,40],[96,59,77,44],[96,84,77,69],[96,85,77,70],[97,6,78,4],[98,4,79,2],[98,5,79,3],[98,6,79,4],[99,2,80,0],[99,3,80,1],[100,2,82,0],[100,6,82,0,"_default"],[100,14,82,0],[100,17,82,15,"useCancelMeetup"],[100,32,82,30],[101,0,82,31],[101,3]],"functionMap":{"names":["<global>","useCancelMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;wBCkB;gBCK;KD+C;eEC;KFG;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}