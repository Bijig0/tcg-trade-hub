{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Mutation hook that creates an offer on a listing via atomic Postgres RPC.\n   *\n   * Atomically inserts an offer row and all offer_items in a single transaction.\n   *\n   * @see packages/api/src/pipelines/createOffer/createOffer.ts\n   */\n  var useCreateOffer = function useCreateOffer() {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _mutationFn = (0, _asyncToGenerator.default)(function* (_ref) {\n          var _session$user;\n          var listingId = _ref.listingId,\n            selectedCards = _ref.selectedCards,\n            cashAmount = _ref.cashAmount,\n            message = _ref.message;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var user = (_session$user = session == null ? void 0 : session.user) != null ? _session$user : null;\n          if (!user) throw new Error('User not authenticated');\n          var items = selectedCards.map(function (sc) {\n            var _sc$card$marketPrice;\n            return {\n              card_name: sc.card.name,\n              card_image_url: sc.card.imageUrl,\n              card_external_id: sc.card.externalId,\n              tcg: sc.card.tcg,\n              card_set: sc.card.setName,\n              card_number: sc.card.number,\n              condition: sc.condition,\n              market_price: (_sc$card$marketPrice = sc.card.marketPrice) != null ? _sc$card$marketPrice : null,\n              quantity: 1\n            };\n          });\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('create_offer_v1', {\n              p_listing_id: listingId,\n              p_offerer_id: user.id,\n              p_cash_amount: cashAmount,\n              p_message: message != null ? message : '',\n              p_items: JSON.stringify(items)\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          return data;\n        });\n        function mutationFn(_x) {\n          return _mutationFn.apply(this, arguments);\n        }\n        return mutationFn;\n      }(),\n      onSuccess: function onSuccess(_, variables) {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.offers(variables.listingId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.detail(variables.listingId)\n        });\n      }\n    });\n  };\n  _s(useCreateOffer, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCreateOffer;\n});","lineCount":91,"map":[[13,2,67,0,"Object"],[13,8,67,0],[13,9,67,0,"defineProperty"],[13,23,67,0],[13,24,67,0,"exports"],[13,31,67,0],[14,4,67,0,"enumerable"],[14,14,67,0],[15,4,67,0,"get"],[15,7,67,0],[15,18,67,0,"get"],[15,19,67,0],[16,6,67,0],[16,13,67,0,"_default"],[16,21,67,0],[17,4,67,0],[18,2,67,0],[19,2,67,30],[19,6,67,30,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,67,30],[19,45,67,30,"require"],[19,52,67,30],[19,53,67,30,"_dependencyMap"],[19,67,67,30],[20,2,67,30],[20,6,67,30,"_asyncToGenerator"],[20,23,67,30],[20,26,67,30,"_interopDefault"],[20,41,67,30],[20,42,67,30,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,67,30],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,17,0],[25,0,18,0],[26,0,19,0],[27,0,20,0],[28,0,21,0],[29,0,22,0],[30,0,23,0],[31,2,24,0],[31,6,24,6,"useCreateOffer"],[31,20,24,20],[31,23,24,23],[31,32,24,6,"useCreateOffer"],[31,46,24,20,"useCreateOffer"],[31,47,24,20],[31,49,24,29],[32,4,24,29,"_s"],[32,6,24,29],[33,4,25,2],[33,8,25,8,"queryClient"],[33,19,25,19],[33,22,25,22],[33,26,25,22,"useQueryClient"],[33,45,25,36],[33,46,25,36,"useQueryClient"],[33,60,25,36],[33,62,25,37],[33,63,25,38],[34,4,27,2],[34,11,27,9],[34,15,27,9,"useMutation"],[34,34,27,20],[34,35,27,20,"useMutation"],[34,46,27,20],[34,48,27,65],[35,6,28,4,"mutationFn"],[35,16,28,14],[36,8,28,14],[36,12,28,14,"_mutationFn"],[36,23,28,14],[36,30,28,14,"_asyncToGenerator"],[36,47,28,14],[36,48,28,14,"default"],[36,55,28,14],[36,57,28,16],[36,68,28,16,"_ref"],[36,72,28,16],[36,74,28,77],[37,10,28,77],[37,14,28,77,"_session$user"],[37,27,28,77],[38,10,28,77],[38,14,28,25,"listingId"],[38,23,28,34],[38,26,28,34,"_ref"],[38,30,28,34],[38,31,28,25,"listingId"],[38,40,28,34],[39,12,28,36,"selectedCards"],[39,25,28,49],[39,28,28,49,"_ref"],[39,32,28,49],[39,33,28,36,"selectedCards"],[39,46,28,49],[40,12,28,51,"cashAmount"],[40,22,28,61],[40,25,28,61,"_ref"],[40,29,28,61],[40,30,28,51,"cashAmount"],[40,40,28,61],[41,12,28,63,"message"],[41,19,28,70],[41,22,28,70,"_ref"],[41,26,28,70],[41,27,28,63,"message"],[41,34,28,70],[42,10,29,6],[42,14,29,6,"_yield$supabase$auth$"],[42,35,29,6],[42,44,31,16,"supabase"],[42,56,31,24],[42,57,31,24,"supabase"],[42,65,31,24],[42,66,31,25,"auth"],[42,70,31,29],[42,71,31,30,"getSession"],[42,81,31,40],[42,82,31,41],[42,83,31,42],[43,12,30,16,"session"],[43,19,30,23],[43,22,30,23,"_yield$supabase$auth$"],[43,43,30,23],[43,44,30,8,"data"],[43,48,30,12],[43,49,30,16,"session"],[43,56,30,23],[44,10,32,6],[44,14,32,12,"user"],[44,18,32,16],[44,22,32,16,"_session$user"],[44,35,32,16],[44,38,32,19,"session"],[44,45,32,26],[44,65,32,19,"session"],[44,72,32,26],[44,73,32,28,"user"],[44,77,32,32],[44,89,32,32,"_session$user"],[44,102,32,32],[44,105,32,36],[44,109,32,40],[45,10,34,6],[45,14,34,10],[45,15,34,11,"user"],[45,19,34,15],[45,21,34,17],[45,27,34,23],[45,31,34,27,"Error"],[45,36,34,32],[45,37,34,33],[45,61,34,57],[45,62,34,58],[46,10,36,6],[46,14,36,12,"items"],[46,19,36,17],[46,22,36,20,"selectedCards"],[46,35,36,33],[46,36,36,34,"map"],[46,39,36,37],[46,40,36,38],[46,50,36,39,"sc"],[46,52,36,41],[47,12,36,41],[47,16,36,41,"_sc$card$marketPrice"],[47,36,36,41],[48,12,36,41],[48,19,36,47],[49,14,37,8,"card_name"],[49,23,37,17],[49,25,37,19,"sc"],[49,27,37,21],[49,28,37,22,"card"],[49,32,37,26],[49,33,37,27,"name"],[49,37,37,31],[50,14,38,8,"card_image_url"],[50,28,38,22],[50,30,38,24,"sc"],[50,32,38,26],[50,33,38,27,"card"],[50,37,38,31],[50,38,38,32,"imageUrl"],[50,46,38,40],[51,14,39,8,"card_external_id"],[51,30,39,24],[51,32,39,26,"sc"],[51,34,39,28],[51,35,39,29,"card"],[51,39,39,33],[51,40,39,34,"externalId"],[51,50,39,44],[52,14,40,8,"tcg"],[52,17,40,11],[52,19,40,13,"sc"],[52,21,40,15],[52,22,40,16,"card"],[52,26,40,20],[52,27,40,21,"tcg"],[52,30,40,24],[53,14,41,8,"card_set"],[53,22,41,16],[53,24,41,18,"sc"],[53,26,41,20],[53,27,41,21,"card"],[53,31,41,25],[53,32,41,26,"setName"],[53,39,41,33],[54,14,42,8,"card_number"],[54,25,42,19],[54,27,42,21,"sc"],[54,29,42,23],[54,30,42,24,"card"],[54,34,42,28],[54,35,42,29,"number"],[54,41,42,35],[55,14,43,8,"condition"],[55,23,43,17],[55,25,43,19,"sc"],[55,27,43,21],[55,28,43,22,"condition"],[55,37,43,31],[56,14,44,8,"market_price"],[56,26,44,20],[56,29,44,20,"_sc$card$marketPrice"],[56,49,44,20],[56,52,44,22,"sc"],[56,54,44,24],[56,55,44,25,"card"],[56,59,44,29],[56,60,44,30,"marketPrice"],[56,71,44,41],[56,83,44,41,"_sc$card$marketPrice"],[56,103,44,41],[56,106,44,45],[56,110,44,49],[57,14,45,8,"quantity"],[57,22,45,16],[57,24,45,18],[58,12,46,6],[58,13,46,7],[59,10,46,7],[59,11,46,8],[59,12,46,9],[60,10,48,6],[60,14,48,6,"_yield$supabase$rpc"],[60,33,48,6],[60,42,48,36,"supabase"],[60,54,48,44],[60,55,48,44,"supabase"],[60,63,48,44],[60,64,48,45,"rpc"],[60,67,48,48],[60,68,48,49],[60,85,48,66],[60,87,48,68],[61,14,49,8,"p_listing_id"],[61,26,49,20],[61,28,49,22,"listingId"],[61,37,49,31],[62,14,50,8,"p_offerer_id"],[62,26,50,20],[62,28,50,22,"user"],[62,32,50,26],[62,33,50,27,"id"],[62,35,50,29],[63,14,51,8,"p_cash_amount"],[63,27,51,21],[63,29,51,23,"cashAmount"],[63,39,51,33],[64,14,52,8,"p_message"],[64,23,52,17],[64,25,52,19,"message"],[64,32,52,26],[64,43,52,19,"message"],[64,50,52,26],[64,53,52,30],[64,55,52,32],[65,14,53,8,"p_items"],[65,21,53,15],[65,23,53,17,"JSON"],[65,27,53,21],[65,28,53,22,"stringify"],[65,37,53,31],[65,38,53,32,"items"],[65,43,53,37],[66,12,54,6],[66,13,54,7],[66,14,54,8],[67,12,48,14,"data"],[67,16,48,18],[67,19,48,18,"_yield$supabase$rpc"],[67,38,48,18],[67,39,48,14,"data"],[67,43,48,18],[68,12,48,20,"error"],[68,17,48,25],[68,20,48,25,"_yield$supabase$rpc"],[68,39,48,25],[68,40,48,20,"error"],[68,45,48,25],[69,10,56,6],[69,14,56,10,"error"],[69,19,56,15],[69,21,56,17],[69,27,56,23,"error"],[69,32,56,28],[70,10,58,6],[70,17,58,13,"data"],[70,21,58,17],[71,8,59,4],[71,9,59,5],[72,8,59,5],[72,17,28,4,"mutationFn"],[72,27,28,14,"mutationFn"],[72,28,28,14,"_x"],[72,30,28,14],[73,10,28,14],[73,17,28,14,"_mutationFn"],[73,28,28,14],[73,29,28,14,"apply"],[73,34,28,14],[73,41,28,14,"arguments"],[73,50,28,14],[74,8,28,14],[75,8,28,14],[75,15,28,4,"mutationFn"],[75,25,28,14],[76,6,28,14],[76,9,59,5],[77,6,60,4,"onSuccess"],[77,15,60,13],[77,17,60,15],[77,26,60,4,"onSuccess"],[77,35,60,13,"onSuccess"],[77,36,60,16,"_"],[77,37,60,17],[77,39,60,19,"variables"],[77,48,60,28],[77,50,60,33],[78,8,61,6,"queryClient"],[78,19,61,17],[78,20,61,18,"invalidateQueries"],[78,37,61,35],[78,38,61,36],[79,10,61,38,"queryKey"],[79,18,61,46],[79,20,61,48,"listingKeys"],[79,30,61,59],[79,31,61,59,"listingKeys"],[79,42,61,59],[79,43,61,60,"offers"],[79,49,61,66],[79,50,61,67,"variables"],[79,59,61,76],[79,60,61,77,"listingId"],[79,69,61,86],[80,8,61,88],[80,9,61,89],[80,10,61,90],[81,8,62,6,"queryClient"],[81,19,62,17],[81,20,62,18,"invalidateQueries"],[81,37,62,35],[81,38,62,36],[82,10,62,38,"queryKey"],[82,18,62,46],[82,20,62,48,"listingKeys"],[82,30,62,59],[82,31,62,59,"listingKeys"],[82,42,62,59],[82,43,62,60,"detail"],[82,49,62,66],[82,50,62,67,"variables"],[82,59,62,76],[82,60,62,77,"listingId"],[82,69,62,86],[83,8,62,88],[83,9,62,89],[83,10,62,90],[84,6,63,4],[85,4,64,2],[85,5,64,3],[85,6,64,4],[86,2,65,0],[86,3,65,1],[87,2,65,2,"_s"],[87,4,65,2],[87,5,24,6,"useCreateOffer"],[87,19,24,20],[88,4,24,20],[88,12,25,22,"useQueryClient"],[88,31,25,36],[88,32,25,36,"useQueryClient"],[88,46,25,36],[88,48,27,9,"useMutation"],[88,67,27,20],[88,68,27,20,"useMutation"],[88,79,27,20],[89,2,27,20],[90,2,67,0],[90,6,67,0,"_default"],[90,14,67,0],[90,17,67,15,"useCreateOffer"],[90,31,67,29],[91,0,67,30],[91,3]],"functionMap":{"names":["<global>","useCreateOffer","useMutation$argument_0.mutationFn","selectedCards.map$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;uBCuB;gBCI;sCCQ;QDU;KDa;eGC;KHG;CDE"},"hasCjsExports":false},"type":"js/module"}]}