{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Mutation hook that creates an offer on a listing.\n   * Inserts an offer row followed by offer_items rows for each selected card.\n   */\n  var useCreateOffer = function useCreateOffer() {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _mutationFn = (0, _asyncToGenerator.default)(function* (_ref) {\n          var _session$user;\n          var listingId = _ref.listingId,\n            selectedCards = _ref.selectedCards,\n            cashAmount = _ref.cashAmount,\n            message = _ref.message;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var user = (_session$user = session == null ? void 0 : session.user) != null ? _session$user : null;\n          if (!user) throw new Error('User not authenticated');\n\n          // Insert offer\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('offers').insert({\n              listing_id: listingId,\n              offerer_id: user.id,\n              cash_amount: cashAmount,\n              message: message\n            }).select().single(),\n            offer = _yield$supabase$from$.data,\n            offerError = _yield$supabase$from$.error;\n          if (offerError) throw offerError;\n\n          // Insert offer items\n          if (selectedCards.length > 0) {\n            var items = selectedCards.map(function (sc) {\n              var _sc$card$marketPrice;\n              return {\n                offer_id: offer.id,\n                card_name: sc.card.name,\n                card_image_url: sc.card.imageUrl,\n                card_external_id: sc.card.externalId,\n                tcg: sc.card.tcg,\n                card_set: sc.card.setName,\n                card_number: sc.card.number,\n                condition: sc.condition,\n                market_price: (_sc$card$marketPrice = sc.card.marketPrice) != null ? _sc$card$marketPrice : null,\n                quantity: 1\n              };\n            });\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('offer_items').insert(items),\n              itemsError = _yield$supabase$from$2.error;\n            if (itemsError) throw itemsError;\n          }\n          return offer;\n        });\n        function mutationFn(_x) {\n          return _mutationFn.apply(this, arguments);\n        }\n        return mutationFn;\n      }(),\n      onSuccess: function onSuccess(_, variables) {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.offers(variables.listingId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.detail(variables.listingId)\n        });\n      }\n    });\n  };\n  _s(useCreateOffer, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCreateOffer;\n});","lineCount":97,"map":[[13,2,75,0,"Object"],[13,8,75,0],[13,9,75,0,"defineProperty"],[13,23,75,0],[13,24,75,0,"exports"],[13,31,75,0],[14,4,75,0,"enumerable"],[14,14,75,0],[15,4,75,0,"get"],[15,7,75,0],[15,18,75,0,"get"],[15,19,75,0],[16,6,75,0],[16,13,75,0,"_default"],[16,21,75,0],[17,4,75,0],[18,2,75,0],[19,2,75,30],[19,6,75,30,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,75,30],[19,45,75,30,"require"],[19,52,75,30],[19,53,75,30,"_dependencyMap"],[19,67,75,30],[20,2,75,30],[20,6,75,30,"_asyncToGenerator"],[20,23,75,30],[20,26,75,30,"_interopDefault"],[20,41,75,30],[20,42,75,30,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,75,30],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,14,0],[25,0,15,0],[26,0,16,0],[27,0,17,0],[28,2,18,0],[28,6,18,6,"useCreateOffer"],[28,20,18,20],[28,23,18,23],[28,32,18,6,"useCreateOffer"],[28,46,18,20,"useCreateOffer"],[28,47,18,20],[28,49,18,29],[29,4,18,29,"_s"],[29,6,18,29],[30,4,19,2],[30,8,19,8,"queryClient"],[30,19,19,19],[30,22,19,22],[30,26,19,22,"useQueryClient"],[30,45,19,36],[30,46,19,36,"useQueryClient"],[30,60,19,36],[30,62,19,37],[30,63,19,38],[31,4,21,2],[31,11,21,9],[31,15,21,9,"useMutation"],[31,34,21,20],[31,35,21,20,"useMutation"],[31,46,21,20],[31,48,21,56],[32,6,22,4,"mutationFn"],[32,16,22,14],[33,8,22,14],[33,12,22,14,"_mutationFn"],[33,23,22,14],[33,30,22,14,"_asyncToGenerator"],[33,47,22,14],[33,48,22,14,"default"],[33,55,22,14],[33,57,22,16],[33,68,22,16,"_ref"],[33,72,22,16],[33,74,22,77],[34,10,22,77],[34,14,22,77,"_session$user"],[34,27,22,77],[35,10,22,77],[35,14,22,25,"listingId"],[35,23,22,34],[35,26,22,34,"_ref"],[35,30,22,34],[35,31,22,25,"listingId"],[35,40,22,34],[36,12,22,36,"selectedCards"],[36,25,22,49],[36,28,22,49,"_ref"],[36,32,22,49],[36,33,22,36,"selectedCards"],[36,46,22,49],[37,12,22,51,"cashAmount"],[37,22,22,61],[37,25,22,61,"_ref"],[37,29,22,61],[37,30,22,51,"cashAmount"],[37,40,22,61],[38,12,22,63,"message"],[38,19,22,70],[38,22,22,70,"_ref"],[38,26,22,70],[38,27,22,63,"message"],[38,34,22,70],[39,10,23,6],[39,14,23,6,"_yield$supabase$auth$"],[39,35,23,6],[39,44,25,16,"supabase"],[39,56,25,24],[39,57,25,24,"supabase"],[39,65,25,24],[39,66,25,25,"auth"],[39,70,25,29],[39,71,25,30,"getSession"],[39,81,25,40],[39,82,25,41],[39,83,25,42],[40,12,24,16,"session"],[40,19,24,23],[40,22,24,23,"_yield$supabase$auth$"],[40,43,24,23],[40,44,24,8,"data"],[40,48,24,12],[40,49,24,16,"session"],[40,56,24,23],[41,10,26,6],[41,14,26,12,"user"],[41,18,26,16],[41,22,26,16,"_session$user"],[41,35,26,16],[41,38,26,19,"session"],[41,45,26,26],[41,65,26,19,"session"],[41,72,26,26],[41,73,26,28,"user"],[41,77,26,32],[41,89,26,32,"_session$user"],[41,102,26,32],[41,105,26,36],[41,109,26,40],[42,10,28,6],[42,14,28,10],[42,15,28,11,"user"],[42,19,28,15],[42,21,28,17],[42,27,28,23],[42,31,28,27,"Error"],[42,36,28,32],[42,37,28,33],[42,61,28,57],[42,62,28,58],[44,10,30,6],[45,10,31,6],[45,14,31,6,"_yield$supabase$from$"],[45,35,31,6],[45,44,31,55,"supabase"],[45,56,31,63],[45,57,31,63,"supabase"],[45,65,31,63],[45,66,32,9,"from"],[45,70,32,13],[45,71,32,14],[45,79,32,22],[45,80,32,23],[45,81,33,9,"insert"],[45,87,33,15],[45,88,33,16],[46,14,34,10,"listing_id"],[46,24,34,20],[46,26,34,22,"listingId"],[46,35,34,31],[47,14,35,10,"offerer_id"],[47,24,35,20],[47,26,35,22,"user"],[47,30,35,26],[47,31,35,27,"id"],[47,33,35,29],[48,14,36,10,"cash_amount"],[48,25,36,21],[48,27,36,23,"cashAmount"],[48,37,36,33],[49,14,37,10,"message"],[49,21,37,17],[49,23,37,10,"message"],[50,12,38,8],[50,13,38,9],[50,14,38,10],[50,15,39,9,"select"],[50,21,39,15],[50,22,39,16],[50,23,39,17],[50,24,40,9,"single"],[50,30,40,15],[50,31,40,16],[50,32,40,17],[51,12,31,20,"offer"],[51,17,31,25],[51,20,31,25,"_yield$supabase$from$"],[51,41,31,25],[51,42,31,14,"data"],[51,46,31,18],[52,12,31,34,"offerError"],[52,22,31,44],[52,25,31,44,"_yield$supabase$from$"],[52,46,31,44],[52,47,31,27,"error"],[52,52,31,32],[53,10,42,6],[53,14,42,10,"offerError"],[53,24,42,20],[53,26,42,22],[53,32,42,28,"offerError"],[53,42,42,38],[55,10,44,6],[56,10,45,6],[56,14,45,10,"selectedCards"],[56,27,45,23],[56,28,45,24,"length"],[56,34,45,30],[56,37,45,33],[56,38,45,34],[56,40,45,36],[57,12,46,8],[57,16,46,14,"items"],[57,21,46,38],[57,24,46,41,"selectedCards"],[57,37,46,54],[57,38,46,55,"map"],[57,41,46,58],[57,42,46,59],[57,52,46,60,"sc"],[57,54,46,62],[58,14,46,62],[58,18,46,62,"_sc$card$marketPrice"],[58,38,46,62],[59,14,46,62],[59,21,46,68],[60,16,47,10,"offer_id"],[60,24,47,18],[60,26,47,20,"offer"],[60,31,47,25],[60,32,47,26,"id"],[60,34,47,28],[61,16,48,10,"card_name"],[61,25,48,19],[61,27,48,21,"sc"],[61,29,48,23],[61,30,48,24,"card"],[61,34,48,28],[61,35,48,29,"name"],[61,39,48,33],[62,16,49,10,"card_image_url"],[62,30,49,24],[62,32,49,26,"sc"],[62,34,49,28],[62,35,49,29,"card"],[62,39,49,33],[62,40,49,34,"imageUrl"],[62,48,49,42],[63,16,50,10,"card_external_id"],[63,32,50,26],[63,34,50,28,"sc"],[63,36,50,30],[63,37,50,31,"card"],[63,41,50,35],[63,42,50,36,"externalId"],[63,52,50,46],[64,16,51,10,"tcg"],[64,19,51,13],[64,21,51,15,"sc"],[64,23,51,17],[64,24,51,18,"card"],[64,28,51,22],[64,29,51,23,"tcg"],[64,32,51,26],[65,16,52,10,"card_set"],[65,24,52,18],[65,26,52,20,"sc"],[65,28,52,22],[65,29,52,23,"card"],[65,33,52,27],[65,34,52,28,"setName"],[65,41,52,35],[66,16,53,10,"card_number"],[66,27,53,21],[66,29,53,23,"sc"],[66,31,53,25],[66,32,53,26,"card"],[66,36,53,30],[66,37,53,31,"number"],[66,43,53,37],[67,16,54,10,"condition"],[67,25,54,19],[67,27,54,21,"sc"],[67,29,54,23],[67,30,54,24,"condition"],[67,39,54,33],[68,16,55,10,"market_price"],[68,28,55,22],[68,31,55,22,"_sc$card$marketPrice"],[68,51,55,22],[68,54,55,24,"sc"],[68,56,55,26],[68,57,55,27,"card"],[68,61,55,31],[68,62,55,32,"marketPrice"],[68,73,55,43],[68,85,55,43,"_sc$card$marketPrice"],[68,105,55,43],[68,108,55,47],[68,112,55,51],[69,16,56,10,"quantity"],[69,24,56,18],[69,26,56,20],[70,14,57,8],[70,15,57,9],[71,12,57,9],[71,13,57,10],[71,14,57,11],[72,12,59,8],[72,16,59,8,"_yield$supabase$from$2"],[72,38,59,8],[72,47,59,44,"supabase"],[72,59,59,52],[72,60,59,52,"supabase"],[72,68,59,52],[72,69,60,11,"from"],[72,73,60,15],[72,74,60,16],[72,87,60,29],[72,88,60,30],[72,89,61,11,"insert"],[72,95,61,17],[72,96,61,18,"items"],[72,101,61,23],[72,102,61,24],[73,14,59,23,"itemsError"],[73,24,59,33],[73,27,59,33,"_yield$supabase$from$2"],[73,49,59,33],[73,50,59,16,"error"],[73,55,59,21],[74,12,63,8],[74,16,63,12,"itemsError"],[74,26,63,22],[74,28,63,24],[74,34,63,30,"itemsError"],[74,44,63,40],[75,10,64,6],[76,10,66,6],[76,17,66,13,"offer"],[76,22,66,18],[77,8,67,4],[77,9,67,5],[78,8,67,5],[78,17,22,4,"mutationFn"],[78,27,22,14,"mutationFn"],[78,28,22,14,"_x"],[78,30,22,14],[79,10,22,14],[79,17,22,14,"_mutationFn"],[79,28,22,14],[79,29,22,14,"apply"],[79,34,22,14],[79,41,22,14,"arguments"],[79,50,22,14],[80,8,22,14],[81,8,22,14],[81,15,22,4,"mutationFn"],[81,25,22,14],[82,6,22,14],[82,9,67,5],[83,6,68,4,"onSuccess"],[83,15,68,13],[83,17,68,15],[83,26,68,4,"onSuccess"],[83,35,68,13,"onSuccess"],[83,36,68,16,"_"],[83,37,68,17],[83,39,68,19,"variables"],[83,48,68,28],[83,50,68,33],[84,8,69,6,"queryClient"],[84,19,69,17],[84,20,69,18,"invalidateQueries"],[84,37,69,35],[84,38,69,36],[85,10,69,38,"queryKey"],[85,18,69,46],[85,20,69,48,"listingKeys"],[85,30,69,59],[85,31,69,59,"listingKeys"],[85,42,69,59],[85,43,69,60,"offers"],[85,49,69,66],[85,50,69,67,"variables"],[85,59,69,76],[85,60,69,77,"listingId"],[85,69,69,86],[86,8,69,88],[86,9,69,89],[86,10,69,90],[87,8,70,6,"queryClient"],[87,19,70,17],[87,20,70,18,"invalidateQueries"],[87,37,70,35],[87,38,70,36],[88,10,70,38,"queryKey"],[88,18,70,46],[88,20,70,48,"listingKeys"],[88,30,70,59],[88,31,70,59,"listingKeys"],[88,42,70,59],[88,43,70,60,"detail"],[88,49,70,66],[88,50,70,67,"variables"],[88,59,70,76],[88,60,70,77,"listingId"],[88,69,70,86],[89,8,70,88],[89,9,70,89],[89,10,70,90],[90,6,71,4],[91,4,72,2],[91,5,72,3],[91,6,72,4],[92,2,73,0],[92,3,73,1],[93,2,73,2,"_s"],[93,4,73,2],[93,5,18,6,"useCreateOffer"],[93,19,18,20],[94,4,18,20],[94,12,19,22,"useQueryClient"],[94,31,19,36],[94,32,19,36,"useQueryClient"],[94,46,19,36],[94,48,21,9,"useMutation"],[94,67,21,20],[94,68,21,20,"useMutation"],[94,79,21,20],[95,2,21,20],[96,2,75,0],[96,6,75,0,"_default"],[96,14,75,0],[96,17,75,15,"useCreateOffer"],[96,31,75,29],[97,0,75,30],[97,3]],"functionMap":{"names":["<global>","useCreateOffer","useMutation$argument_0.mutationFn","selectedCards.map$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;uBCiB;gBCI;2DCwB;UDW;KDU;eGC;KHG;CDE"},"hasCjsExports":false},"type":"js/module"}]}