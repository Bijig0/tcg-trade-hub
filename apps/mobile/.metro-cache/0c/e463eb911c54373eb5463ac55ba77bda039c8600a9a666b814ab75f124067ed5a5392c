{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"../../../feed/queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":159},"end":{"line":4,"column":51,"index":210}}],"key":"fOhRZkI3VX68oiFPDy9rlJOS+w8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  var _feedQueryKeys = require(_dependencyMap[4], \"../../../feed/queryKeys\");\n  /**\n   * Hook that expires a listing via atomic Postgres RPC.\n   *\n   * Atomically transitions the listing to 'expired' and withdraws\n   * all pending offers. Invalidates myListings and feed queries on success.\n   *\n   * @see packages/api/src/pipelines/expireListing/expireListing.ts\n   */\n  var useDeleteListing = function useDeleteListing() {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _mutationFn = (0, _asyncToGenerator.default)(function* (listingId) {\n          var _session$user;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session == null || (_session$user = session.user) == null ? void 0 : _session$user.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('expire_listing_v1', {\n              p_listing_id: listingId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          return data;\n        });\n        function mutationFn(_x) {\n          return _mutationFn.apply(this, arguments);\n        }\n        return mutationFn;\n      }(),\n      onSuccess: function onSuccess() {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.myListings()\n        });\n        queryClient.invalidateQueries({\n          queryKey: _feedQueryKeys.feedKeys.lists()\n        });\n      }\n    });\n  };\n  _s(useDeleteListing, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useDeleteListing;\n});","lineCount":72,"map":[[13,2,47,0,"Object"],[13,8,47,0],[13,9,47,0,"defineProperty"],[13,23,47,0],[13,24,47,0,"exports"],[13,31,47,0],[14,4,47,0,"enumerable"],[14,14,47,0],[15,4,47,0,"get"],[15,7,47,0],[15,18,47,0,"get"],[15,19,47,0],[16,6,47,0],[16,13,47,0,"_default"],[16,21,47,0],[17,4,47,0],[18,2,47,0],[19,2,47,32],[19,6,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,47,32],[19,45,47,32,"require"],[19,52,47,32],[19,53,47,32,"_dependencyMap"],[19,67,47,32],[20,2,47,32],[20,6,47,32,"_asyncToGenerator"],[20,23,47,32],[20,26,47,32,"_interopDefault"],[20,41,47,32],[20,42,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,47,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,4,0],[24,6,4,0,"_feedQueryKeys"],[24,20,4,0],[24,23,4,0,"require"],[24,30,4,0],[24,31,4,0,"_dependencyMap"],[24,45,4,0],[25,2,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[31,0,17,0],[32,0,18,0],[33,2,19,0],[33,6,19,6,"useDeleteListing"],[33,22,19,22],[33,25,19,25],[33,34,19,6,"useDeleteListing"],[33,50,19,22,"useDeleteListing"],[33,51,19,22],[33,53,19,31],[34,4,19,31,"_s"],[34,6,19,31],[35,4,20,2],[35,8,20,8,"queryClient"],[35,19,20,19],[35,22,20,22],[35,26,20,22,"useQueryClient"],[35,45,20,36],[35,46,20,36,"useQueryClient"],[35,60,20,36],[35,62,20,37],[35,63,20,38],[36,4,22,2],[36,11,22,9],[36,15,22,9,"useMutation"],[36,34,22,20],[36,35,22,20,"useMutation"],[36,46,22,20],[36,48,22,50],[37,6,23,4,"mutationFn"],[37,16,23,14],[38,8,23,14],[38,12,23,14,"_mutationFn"],[38,23,23,14],[38,30,23,14,"_asyncToGenerator"],[38,47,23,14],[38,48,23,14,"default"],[38,55,23,14],[38,57,23,16],[38,68,23,23,"listingId"],[38,77,23,32],[38,79,23,37],[39,10,23,37],[39,14,23,37,"_session$user"],[39,27,23,37],[40,10,24,6],[40,14,24,6,"_yield$supabase$auth$"],[40,35,24,6],[40,44,26,16,"supabase"],[40,56,26,24],[40,57,26,24,"supabase"],[40,65,26,24],[40,66,26,25,"auth"],[40,70,26,29],[40,71,26,30,"getSession"],[40,81,26,40],[40,82,26,41],[40,83,26,42],[41,12,25,16,"session"],[41,19,25,23],[41,22,25,23,"_yield$supabase$auth$"],[41,43,25,23],[41,44,25,8,"data"],[41,48,25,12],[41,49,25,16,"session"],[41,56,25,23],[42,10,27,6],[42,14,27,12,"userId"],[42,20,27,18],[42,23,27,21,"session"],[42,30,27,28],[42,43,27,28,"_session$user"],[42,56,27,28],[42,59,27,21,"session"],[42,66,27,28],[42,67,27,30,"user"],[42,71,27,34],[42,92,27,21,"_session$user"],[42,105,27,21],[42,106,27,36,"id"],[42,108,27,38],[43,10,29,6],[43,14,29,10],[43,15,29,11,"userId"],[43,21,29,17],[43,23,29,19],[43,29,29,25],[43,33,29,29,"Error"],[43,38,29,34],[43,39,29,35],[43,58,29,54],[43,59,29,55],[44,10,31,6],[44,14,31,6,"_yield$supabase$rpc"],[44,33,31,6],[44,42,31,36,"supabase"],[44,54,31,44],[44,55,31,44,"supabase"],[44,63,31,44],[44,64,31,45,"rpc"],[44,67,31,48],[44,68,31,49],[44,87,31,68],[44,89,31,70],[45,14,32,8,"p_listing_id"],[45,26,32,20],[45,28,32,22,"listingId"],[45,37,32,31],[46,14,33,8,"p_user_id"],[46,23,33,17],[46,25,33,19,"userId"],[47,12,34,6],[47,13,34,7],[47,14,34,8],[48,12,31,14,"data"],[48,16,31,18],[48,19,31,18,"_yield$supabase$rpc"],[48,38,31,18],[48,39,31,14,"data"],[48,43,31,18],[49,12,31,20,"error"],[49,17,31,25],[49,20,31,25,"_yield$supabase$rpc"],[49,39,31,25],[49,40,31,20,"error"],[49,45,31,25],[50,10,36,6],[50,14,36,10,"error"],[50,19,36,15],[50,21,36,17],[50,27,36,23,"error"],[50,32,36,28],[51,10,38,6],[51,17,38,13,"data"],[51,21,38,17],[52,8,39,4],[52,9,39,5],[53,8,39,5],[53,17,23,4,"mutationFn"],[53,27,23,14,"mutationFn"],[53,28,23,14,"_x"],[53,30,23,14],[54,10,23,14],[54,17,23,14,"_mutationFn"],[54,28,23,14],[54,29,23,14,"apply"],[54,34,23,14],[54,41,23,14,"arguments"],[54,50,23,14],[55,8,23,14],[56,8,23,14],[56,15,23,4,"mutationFn"],[56,25,23,14],[57,6,23,14],[57,9,39,5],[58,6,40,4,"onSuccess"],[58,15,40,13],[58,17,40,15],[58,26,40,4,"onSuccess"],[58,35,40,13,"onSuccess"],[58,36,40,13],[58,38,40,21],[59,8,41,6,"queryClient"],[59,19,41,17],[59,20,41,18,"invalidateQueries"],[59,37,41,35],[59,38,41,36],[60,10,41,38,"queryKey"],[60,18,41,46],[60,20,41,48,"listingKeys"],[60,30,41,59],[60,31,41,59,"listingKeys"],[60,42,41,59],[60,43,41,60,"myListings"],[60,53,41,70],[60,54,41,71],[61,8,41,73],[61,9,41,74],[61,10,41,75],[62,8,42,6,"queryClient"],[62,19,42,17],[62,20,42,18,"invalidateQueries"],[62,37,42,35],[62,38,42,36],[63,10,42,38,"queryKey"],[63,18,42,46],[63,20,42,48,"feedKeys"],[63,34,42,56],[63,35,42,56,"feedKeys"],[63,43,42,56],[63,44,42,57,"lists"],[63,49,42,62],[63,50,42,63],[64,8,42,65],[64,9,42,66],[64,10,42,67],[65,6,43,4],[66,4,44,2],[66,5,44,3],[66,6,44,4],[67,2,45,0],[67,3,45,1],[68,2,45,2,"_s"],[68,4,45,2],[68,5,19,6,"useDeleteListing"],[68,21,19,22],[69,4,19,22],[69,12,20,22,"useQueryClient"],[69,31,20,36],[69,32,20,36,"useQueryClient"],[69,46,20,36],[69,48,22,9,"useMutation"],[69,67,22,20],[69,68,22,20,"useMutation"],[69,79,22,20],[70,2,22,20],[71,2,47,0],[71,6,47,0,"_default"],[71,14,47,0],[71,17,47,15,"useDeleteListing"],[71,33,47,31],[72,0,47,32],[72,3]],"functionMap":{"names":["<global>","useDeleteListing","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCkB;gBCI;KDgB;eEC;KFG;CDE"},"hasCjsExports":false},"type":"js/module"}]}