{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":46,"index":139}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _queryKeys = require(_dependencyMap[3]);\n  /**\n   * Hook that fetches a user's public profile by ID.\n   *\n   * Joins the active listings count and recent ratings with rater names.\n   */\n  var usePublicProfile = userId => {\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.profileKeys.publicProfile(userId),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          // Fetch user profile\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('users').select('id, display_name, avatar_url, preferred_tcgs, rating_score, total_trades, created_at').eq('id', userId).single(),\n            profile = _yield$supabase$from$.data,\n            profileError = _yield$supabase$from$.error;\n          if (profileError) throw profileError;\n          if (!profile) throw new Error('User not found');\n\n          // Count active listings\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listings').select('*', {\n              count: 'exact',\n              head: true\n            }).eq('user_id', userId).eq('status', 'active'),\n            count = _yield$supabase$from$2.count,\n            countError = _yield$supabase$from$2.error;\n          if (countError) throw countError;\n\n          // Fetch recent ratings\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('ratings').select('id, score, comment, created_at, rater_id').eq('ratee_id', userId).order('created_at', {\n              ascending: false\n            }).limit(10),\n            ratings = _yield$supabase$from$3.data,\n            ratingsError = _yield$supabase$from$3.error;\n          if (ratingsError) throw ratingsError;\n\n          // Resolve rater display names\n          var raterIds = [...new Set((ratings ?? []).map(r => r.rater_id))];\n          var ratersMap = new Map();\n          if (raterIds.length > 0) {\n            var _yield$supabase$from$4 = yield _libSupabase.supabase.from('users').select('id, display_name').in('id', raterIds),\n              raters = _yield$supabase$from$4.data;\n            ratersMap = new Map((raters ?? []).map(r => [r.id, r.display_name]));\n          }\n          var recentRatings = (ratings ?? []).map(r => ({\n            id: r.id,\n            score: r.score,\n            comment: r.comment,\n            created_at: r.created_at,\n            rater_display_name: ratersMap.get(r.rater_id) ?? 'Unknown'\n          }));\n          return {\n            ...profile,\n            active_listings_count: count ?? 0,\n            recent_ratings: recentRatings\n          };\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!userId\n    });\n  };\n  var _default = usePublicProfile;\n});","lineCount":86,"map":[[12,2,87,0,"Object"],[12,8,87,0],[12,9,87,0,"defineProperty"],[12,23,87,0],[12,24,87,0,"exports"],[12,31,87,0],[13,4,87,0,"enumerable"],[13,14,87,0],[14,4,87,0,"get"],[14,7,87,0],[14,18,87,0,"get"],[14,19,87,0],[15,6,87,0],[15,13,87,0,"_default"],[15,21,87,0],[16,4,87,0],[17,2,87,0],[18,2,87,32],[18,6,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,87,32],[18,45,87,32,"require"],[18,52,87,32],[18,53,87,32,"_dependencyMap"],[18,67,87,32],[19,2,87,32],[19,6,87,32,"_asyncToGenerator"],[19,23,87,32],[19,26,87,32,"_interopDefault"],[19,41,87,32],[19,42,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,87,32],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_libSupabase"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_queryKeys"],[22,16,3,0],[22,19,3,0,"require"],[22,26,3,0],[22,27,3,0,"_dependencyMap"],[22,41,3,0],[23,2,18,0],[24,0,19,0],[25,0,20,0],[26,0,21,0],[27,0,22,0],[28,2,23,0],[28,6,23,6,"usePublicProfile"],[28,22,23,22],[28,25,23,26,"userId"],[28,31,23,40],[28,35,23,45],[29,4,24,2],[29,11,24,9],[29,15,24,9,"useQuery"],[29,34,24,17],[29,35,24,17,"useQuery"],[29,43,24,17],[29,45,24,40],[30,6,25,4,"queryKey"],[30,14,25,12],[30,16,25,14,"profileKeys"],[30,26,25,25],[30,27,25,25,"profileKeys"],[30,38,25,25],[30,39,25,26,"publicProfile"],[30,52,25,39],[30,53,25,40,"userId"],[30,59,25,46],[30,60,25,47],[31,6,26,4,"queryFn"],[31,13,26,11],[32,8,26,11],[32,12,26,11,"_ref"],[32,16,26,11],[32,23,26,11,"_asyncToGenerator"],[32,40,26,11],[32,41,26,11,"default"],[32,48,26,11],[32,50,26,13],[32,63,26,25],[33,10,27,6],[34,10,28,6],[34,14,28,6,"_yield$supabase$from$"],[34,35,28,6],[34,44,28,59,"supabase"],[34,56,28,67],[34,57,28,67,"supabase"],[34,65,28,67],[34,66,29,9,"from"],[34,70,29,13],[34,71,29,14],[34,78,29,21],[34,79,29,22],[34,80,30,9,"select"],[34,86,30,15],[34,87,30,16],[34,173,30,102],[34,174,30,103],[34,175,31,9,"eq"],[34,177,31,11],[34,178,31,12],[34,182,31,16],[34,184,31,18,"userId"],[34,190,31,24],[34,191,31,25],[34,192,32,9,"single"],[34,198,32,15],[34,199,32,16],[34,200,32,17],[35,12,28,20,"profile"],[35,19,28,27],[35,22,28,27,"_yield$supabase$from$"],[35,43,28,27],[35,44,28,14,"data"],[35,48,28,18],[36,12,28,36,"profileError"],[36,24,28,48],[36,27,28,48,"_yield$supabase$from$"],[36,48,28,48],[36,49,28,29,"error"],[36,54,28,34],[37,10,34,6],[37,14,34,10,"profileError"],[37,26,34,22],[37,28,34,24],[37,34,34,30,"profileError"],[37,46,34,42],[38,10,35,6],[38,14,35,10],[38,15,35,11,"profile"],[38,22,35,18],[38,24,35,20],[38,30,35,26],[38,34,35,30,"Error"],[38,39,35,35],[38,40,35,36],[38,56,35,52],[38,57,35,53],[40,10,37,6],[41,10,38,6],[41,14,38,6,"_yield$supabase$from$2"],[41,36,38,6],[41,45,38,49,"supabase"],[41,57,38,57],[41,58,38,57,"supabase"],[41,66,38,57],[41,67,39,9,"from"],[41,71,39,13],[41,72,39,14],[41,82,39,24],[41,83,39,25],[41,84,40,9,"select"],[41,90,40,15],[41,91,40,16],[41,94,40,19],[41,96,40,21],[42,14,40,23,"count"],[42,19,40,28],[42,21,40,30],[42,28,40,37],[43,14,40,39,"head"],[43,18,40,43],[43,20,40,45],[44,12,40,50],[44,13,40,51],[44,14,40,52],[44,15,41,9,"eq"],[44,17,41,11],[44,18,41,12],[44,27,41,21],[44,29,41,23,"userId"],[44,35,41,29],[44,36,41,30],[44,37,42,9,"eq"],[44,39,42,11],[44,40,42,12],[44,48,42,20],[44,50,42,22],[44,58,42,30],[44,59,42,31],[45,12,38,14,"count"],[45,17,38,19],[45,20,38,19,"_yield$supabase$from$2"],[45,42,38,19],[45,43,38,14,"count"],[45,48,38,19],[46,12,38,28,"countError"],[46,22,38,38],[46,25,38,38,"_yield$supabase$from$2"],[46,47,38,38],[46,48,38,21,"error"],[46,53,38,26],[47,10,44,6],[47,14,44,10,"countError"],[47,24,44,20],[47,26,44,22],[47,32,44,28,"countError"],[47,42,44,38],[49,10,46,6],[50,10,47,6],[50,14,47,6,"_yield$supabase$from$3"],[50,36,47,6],[50,45,47,59,"supabase"],[50,57,47,67],[50,58,47,67,"supabase"],[50,66,47,67],[50,67,48,9,"from"],[50,71,48,13],[50,72,48,14],[50,81,48,23],[50,82,48,24],[50,83,49,9,"select"],[50,89,49,15],[50,90,49,16],[50,132,49,58],[50,133,49,59],[50,134,50,9,"eq"],[50,136,50,11],[50,137,50,12],[50,147,50,22],[50,149,50,24,"userId"],[50,155,50,30],[50,156,50,31],[50,157,51,9,"order"],[50,162,51,14],[50,163,51,15],[50,175,51,27],[50,177,51,29],[51,14,51,31,"ascending"],[51,23,51,40],[51,25,51,42],[52,12,51,48],[52,13,51,49],[52,14,51,50],[52,15,52,9,"limit"],[52,20,52,14],[52,21,52,15],[52,23,52,17],[52,24,52,18],[53,12,47,20,"ratings"],[53,19,47,27],[53,22,47,27,"_yield$supabase$from$3"],[53,44,47,27],[53,45,47,14,"data"],[53,49,47,18],[54,12,47,36,"ratingsError"],[54,24,47,48],[54,27,47,48,"_yield$supabase$from$3"],[54,49,47,48],[54,50,47,29,"error"],[54,55,47,34],[55,10,54,6],[55,14,54,10,"ratingsError"],[55,26,54,22],[55,28,54,24],[55,34,54,30,"ratingsError"],[55,46,54,42],[57,10,56,6],[58,10,57,6],[58,14,57,12,"raterIds"],[58,22,57,20],[58,25,57,23],[58,26,57,24],[58,29,57,27],[58,33,57,31,"Set"],[58,36,57,34],[58,37,57,35],[58,38,57,36,"ratings"],[58,45,57,43],[58,49,57,47],[58,51,57,49],[58,53,57,51,"map"],[58,56,57,54],[58,57,57,56,"r"],[58,58,57,57],[58,62,57,62,"r"],[58,63,57,63],[58,64,57,64,"rater_id"],[58,72,57,72],[58,73,57,73],[58,74,57,74],[58,75,57,75],[59,10,58,6],[59,14,58,10,"ratersMap"],[59,23,58,19],[59,26,58,22],[59,30,58,26,"Map"],[59,33,58,29],[59,34,58,46],[59,35,58,47],[60,10,60,6],[60,14,60,10,"raterIds"],[60,22,60,18],[60,23,60,19,"length"],[60,29,60,25],[60,32,60,28],[60,33,60,29],[60,35,60,31],[61,12,61,8],[61,16,61,8,"_yield$supabase$from$4"],[61,38,61,8],[61,47,61,39,"supabase"],[61,59,61,47],[61,60,61,47,"supabase"],[61,68,61,47],[61,69,62,11,"from"],[61,73,62,15],[61,74,62,16],[61,81,62,23],[61,82,62,24],[61,83,63,11,"select"],[61,89,63,17],[61,90,63,18],[61,108,63,36],[61,109,63,37],[61,110,64,11,"in"],[61,112,64,13],[61,113,64,14],[61,117,64,18],[61,119,64,20,"raterIds"],[61,127,64,28],[61,128,64,29],[62,14,61,22,"raters"],[62,20,61,28],[62,23,61,28,"_yield$supabase$from$4"],[62,45,61,28],[62,46,61,16,"data"],[62,50,61,20],[63,12,66,8,"ratersMap"],[63,21,66,17],[63,24,66,20],[63,28,66,24,"Map"],[63,31,66,27],[63,32,66,28],[63,33,66,29,"raters"],[63,39,66,35],[63,43,66,39],[63,45,66,41],[63,47,66,43,"map"],[63,50,66,46],[63,51,66,48,"r"],[63,52,66,49],[63,56,66,54],[63,57,66,55,"r"],[63,58,66,56],[63,59,66,57,"id"],[63,61,66,59],[63,63,66,61,"r"],[63,64,66,62],[63,65,66,63,"display_name"],[63,77,66,75],[63,78,66,76],[63,79,66,77],[63,80,66,78],[64,10,67,6],[65,10,69,6],[65,14,69,12,"recentRatings"],[65,27,69,25],[65,30,69,28],[65,31,69,29,"ratings"],[65,38,69,36],[65,42,69,40],[65,44,69,42],[65,46,69,44,"map"],[65,49,69,47],[65,50,69,49,"r"],[65,51,69,50],[65,56,69,56],[66,12,70,8,"id"],[66,14,70,10],[66,16,70,12,"r"],[66,17,70,13],[66,18,70,14,"id"],[66,20,70,16],[67,12,71,8,"score"],[67,17,71,13],[67,19,71,15,"r"],[67,20,71,16],[67,21,71,17,"score"],[67,26,71,22],[68,12,72,8,"comment"],[68,19,72,15],[68,21,72,17,"r"],[68,22,72,18],[68,23,72,19,"comment"],[68,30,72,26],[69,12,73,8,"created_at"],[69,22,73,18],[69,24,73,20,"r"],[69,25,73,21],[69,26,73,22,"created_at"],[69,36,73,32],[70,12,74,8,"rater_display_name"],[70,30,74,26],[70,32,74,28,"ratersMap"],[70,41,74,37],[70,42,74,38,"get"],[70,45,74,41],[70,46,74,42,"r"],[70,47,74,43],[70,48,74,44,"rater_id"],[70,56,74,52],[70,57,74,53],[70,61,74,57],[71,10,75,6],[71,11,75,7],[71,12,75,8],[71,13,75,9],[72,10,77,6],[72,17,77,13],[73,12,78,8],[73,15,78,11,"profile"],[73,22,78,18],[74,12,79,8,"active_listings_count"],[74,33,79,29],[74,35,79,31,"count"],[74,40,79,36],[74,44,79,40],[74,45,79,41],[75,12,80,8,"recent_ratings"],[75,26,80,22],[75,28,80,24,"recentRatings"],[76,10,81,6],[76,11,81,7],[77,8,82,4],[77,9,82,5],[78,8,82,5],[78,24,26,4,"queryFn"],[78,31,26,11,"queryFn"],[78,32,26,11],[79,10,26,11],[79,17,26,11,"_ref"],[79,21,26,11],[79,22,26,11,"apply"],[79,27,26,11],[79,34,26,11,"arguments"],[79,43,26,11],[80,8,26,11],[81,6,26,11],[81,9,82,5],[82,6,83,4,"enabled"],[82,13,83,11],[82,15,83,13],[82,16,83,14],[82,17,83,15,"userId"],[83,4,84,2],[83,5,84,3],[83,6,84,4],[84,2,85,0],[84,3,85,1],[85,2,87,0],[85,6,87,0,"_default"],[85,14,87,0],[85,17,87,15,"usePublicProfile"],[85,33,87,31],[86,0,87,32],[86,3]],"functionMap":{"names":["<global>","usePublicProfile","useQuery$argument_0.queryFn","map$argument_0"],"mappings":"AAA;yBCsB;aCG;uDC+B,iBD;+CCS,6BD;gDCG;QDM;KDO;CDG"},"hasCjsExports":false},"type":"js/module"}]}