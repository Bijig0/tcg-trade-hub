{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":55,"index":90}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":91},"end":{"line":3,"column":42,"index":133}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":134},"end":{"line":4,"column":43,"index":177}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0]);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _queryKeys = require(_dependencyMap[3]);\n  /**\n   * Subscribes to Supabase Realtime postgres_changes on the conversations table\n   * for a specific conversation ID. When the negotiation_status changes,\n   * invalidates the trade context query to reflect the new status.\n   */\n  var useNegotiationStatus = conversationId => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    (0, _react.useEffect)(() => {\n      if (!conversationId) return;\n      var channel = _libSupabase.supabase.channel(`conversation-status:${conversationId}`).on('postgres_changes', {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'conversations',\n        filter: `id=eq.${conversationId}`\n      }, () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.tradeContext(conversationId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.conversations()\n        });\n      }).subscribe();\n      return () => {\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [conversationId, queryClient]);\n  };\n  var _default = useNegotiationStatus;\n});","lineCount":45,"map":[[7,2,45,0,"Object"],[7,8,45,0],[7,9,45,0,"defineProperty"],[7,23,45,0],[7,24,45,0,"exports"],[7,31,45,0],[8,4,45,0,"enumerable"],[8,14,45,0],[9,4,45,0,"get"],[9,7,45,0],[9,18,45,0,"get"],[9,19,45,0],[10,6,45,0],[10,13,45,0,"_default"],[10,21,45,0],[11,4,45,0],[12,2,45,0],[13,2,1,0],[13,6,1,0,"_react"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_tanstackReactQuery"],[14,25,2,0],[14,28,2,0,"require"],[14,35,2,0],[14,36,2,0,"_dependencyMap"],[14,50,2,0],[15,2,3,0],[15,6,3,0,"_libSupabase"],[15,18,3,0],[15,21,3,0,"require"],[15,28,3,0],[15,29,3,0,"_dependencyMap"],[15,43,3,0],[16,2,4,0],[16,6,4,0,"_queryKeys"],[16,16,4,0],[16,19,4,0,"require"],[16,26,4,0],[16,27,4,0,"_dependencyMap"],[16,41,4,0],[17,2,7,0],[18,0,8,0],[19,0,9,0],[20,0,10,0],[21,0,11,0],[22,2,12,0],[22,6,12,6,"useNegotiationStatus"],[22,26,12,26],[22,29,12,30,"conversationId"],[22,43,12,52],[22,47,12,57],[23,4,13,2],[23,8,13,8,"queryClient"],[23,19,13,19],[23,22,13,22],[23,26,13,22,"useQueryClient"],[23,45,13,36],[23,46,13,36,"useQueryClient"],[23,60,13,36],[23,62,13,37],[23,63,13,38],[24,4,15,2],[24,8,15,2,"useEffect"],[24,14,15,11],[24,15,15,11,"useEffect"],[24,24,15,11],[24,26,15,12],[24,32,15,18],[25,6,16,4],[25,10,16,8],[25,11,16,9,"conversationId"],[25,25,16,23],[25,27,16,25],[26,6,18,4],[26,10,18,10,"channel"],[26,17,18,17],[26,20,18,20,"supabase"],[26,32,18,28],[26,33,18,28,"supabase"],[26,41,18,28],[26,42,19,7,"channel"],[26,49,19,14],[26,50,19,15],[26,73,19,38,"conversationId"],[26,87,19,52],[26,89,19,54],[26,90,19,55],[26,91,20,7,"on"],[26,93,20,9],[26,94,21,8],[26,112,21,26],[26,114,22,8],[27,8,23,10,"event"],[27,13,23,15],[27,15,23,17],[27,23,23,25],[28,8,24,10,"schema"],[28,14,24,16],[28,16,24,18],[28,24,24,26],[29,8,25,10,"table"],[29,13,25,15],[29,15,25,17],[29,30,25,32],[30,8,26,10,"filter"],[30,14,26,16],[30,16,26,18],[30,25,26,27,"conversationId"],[30,39,26,41],[31,6,27,8],[31,7,27,9],[31,9,28,8],[31,15,28,14],[32,8,29,10,"queryClient"],[32,19,29,21],[32,20,29,22,"invalidateQueries"],[32,37,29,39],[32,38,29,40],[33,10,30,12,"queryKey"],[33,18,30,20],[33,20,30,22,"chatKeys"],[33,30,30,30],[33,31,30,30,"chatKeys"],[33,39,30,30],[33,40,30,31,"tradeContext"],[33,52,30,43],[33,53,30,44,"conversationId"],[33,67,30,58],[34,8,31,10],[34,9,31,11],[34,10,31,12],[35,8,32,10,"queryClient"],[35,19,32,21],[35,20,32,22,"invalidateQueries"],[35,37,32,39],[35,38,32,40],[36,10,33,12,"queryKey"],[36,18,33,20],[36,20,33,22,"chatKeys"],[36,30,33,30],[36,31,33,30,"chatKeys"],[36,39,33,30],[36,40,33,31,"conversations"],[36,53,33,44],[36,54,33,45],[37,8,34,10],[37,9,34,11],[37,10,34,12],[38,6,35,8],[38,7,36,6],[38,8,36,7],[38,9,37,7,"subscribe"],[38,18,37,16],[38,19,37,17],[38,20,37,18],[39,6,39,4],[39,13,39,11],[39,19,39,17],[40,8,40,6,"supabase"],[40,20,40,14],[40,21,40,14,"supabase"],[40,29,40,14],[40,30,40,15,"removeChannel"],[40,43,40,28],[40,44,40,29,"channel"],[40,51,40,36],[40,52,40,37],[41,6,41,4],[41,7,41,5],[42,4,42,2],[42,5,42,3],[42,7,42,5],[42,8,42,6,"conversationId"],[42,22,42,20],[42,24,42,22,"queryClient"],[42,35,42,33],[42,36,42,34],[42,37,42,35],[43,2,43,0],[43,3,43,1],[44,2,45,0],[44,6,45,0,"_default"],[44,14,45,0],[44,17,45,15,"useNegotiationStatus"],[44,37,45,35],[45,0,45,36],[45,3]],"functionMap":{"names":["<global>","useNegotiationStatus","useEffect$argument_0","supabase.channel.on$argument_2","<anonymous>"],"mappings":"AAA;6BCW;YCG;QCa;SDO;WEI;KFE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}