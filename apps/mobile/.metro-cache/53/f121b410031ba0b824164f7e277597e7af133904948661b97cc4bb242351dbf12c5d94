{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":55,"index":90}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":91},"end":{"line":3,"column":42,"index":133}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":134},"end":{"line":4,"column":49,"index":183}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":184},"end":{"line":5,"column":43,"index":227}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[3], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Subscribes to Supabase Realtime postgres_changes on the conversation_reads\n   * table for a given conversation. When the other user updates their read receipt,\n   * invalidates the read receipt query so the UI reflects the latest state.\n   *\n   * Ignores updates from the current user to avoid unnecessary re-fetches.\n   */\n  var useRealtimeReadReceipts = conversationId => {\n    _s();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    (0, _react.useEffect)(() => {\n      if (!conversationId || !user) return;\n      var channel = _libSupabase.supabase.channel(`read-receipts-${conversationId}`).on('postgres_changes', {\n        event: '*',\n        schema: 'public',\n        table: 'conversation_reads',\n        filter: `conversation_id=eq.${conversationId}`\n      }, payload => {\n        // Ignore own read receipt updates\n        var record = payload.new;\n        if (record?.user_id === user.id) return;\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.readReceipt(conversationId)\n        });\n      }).subscribe();\n      return () => {\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [conversationId, user, queryClient]);\n  };\n  _s(useRealtimeReadReceipts, \"Sd/ke2td8CCwZaIXaDGjYa+CO44=\", false, function () {\n    return [_contextAuthProvider.useAuth, _tanstackReactQuery.useQueryClient];\n  });\n  var _default = useRealtimeReadReceipts;\n});","lineCount":55,"map":[[8,2,49,0,"Object"],[8,8,49,0],[8,9,49,0,"defineProperty"],[8,23,49,0],[8,24,49,0,"exports"],[8,31,49,0],[9,4,49,0,"enumerable"],[9,14,49,0],[10,4,49,0,"get"],[10,7,49,0],[10,18,49,0,"get"],[10,19,49,0],[11,6,49,0],[11,13,49,0,"_default"],[11,21,49,0],[12,4,49,0],[13,2,49,0],[14,2,1,0],[14,6,1,0,"_react"],[14,12,1,0],[14,15,1,0,"require"],[14,22,1,0],[14,23,1,0,"_dependencyMap"],[14,37,1,0],[15,2,2,0],[15,6,2,0,"_tanstackReactQuery"],[15,25,2,0],[15,28,2,0,"require"],[15,35,2,0],[15,36,2,0,"_dependencyMap"],[15,50,2,0],[16,2,3,0],[16,6,3,0,"_libSupabase"],[16,18,3,0],[16,21,3,0,"require"],[16,28,3,0],[16,29,3,0,"_dependencyMap"],[16,43,3,0],[17,2,4,0],[17,6,4,0,"_contextAuthProvider"],[17,26,4,0],[17,29,4,0,"require"],[17,36,4,0],[17,37,4,0,"_dependencyMap"],[17,51,4,0],[18,2,5,0],[18,6,5,0,"_queryKeys"],[18,16,5,0],[18,19,5,0,"require"],[18,26,5,0],[18,27,5,0,"_dependencyMap"],[18,41,5,0],[19,2,7,0],[20,0,8,0],[21,0,9,0],[22,0,10,0],[23,0,11,0],[24,0,12,0],[25,0,13,0],[26,2,14,0],[26,6,14,6,"useRealtimeReadReceipts"],[26,29,14,29],[26,32,14,33,"conversationId"],[26,46,14,55],[26,50,14,60],[27,4,14,60,"_s"],[27,6,14,60],[28,4,15,2],[28,8,15,2,"_useAuth"],[28,16,15,2],[28,19,15,19],[28,23,15,19,"useAuth"],[28,43,15,26],[28,44,15,26,"useAuth"],[28,51,15,26],[28,53,15,27],[28,54,15,28],[29,6,15,10,"user"],[29,10,15,14],[29,13,15,14,"_useAuth"],[29,21,15,14],[29,22,15,10,"user"],[29,26,15,14],[30,4,16,2],[30,8,16,8,"queryClient"],[30,19,16,19],[30,22,16,22],[30,26,16,22,"useQueryClient"],[30,45,16,36],[30,46,16,36,"useQueryClient"],[30,60,16,36],[30,62,16,37],[30,63,16,38],[31,4,18,2],[31,8,18,2,"useEffect"],[31,14,18,11],[31,15,18,11,"useEffect"],[31,24,18,11],[31,26,18,12],[31,32,18,18],[32,6,19,4],[32,10,19,8],[32,11,19,9,"conversationId"],[32,25,19,23],[32,29,19,27],[32,30,19,28,"user"],[32,34,19,32],[32,36,19,34],[33,6,21,4],[33,10,21,10,"channel"],[33,17,21,17],[33,20,21,20,"supabase"],[33,32,21,28],[33,33,21,28,"supabase"],[33,41,21,28],[33,42,22,7,"channel"],[33,49,22,14],[33,50,22,15],[33,67,22,32,"conversationId"],[33,81,22,46],[33,83,22,48],[33,84,22,49],[33,85,23,7,"on"],[33,87,23,9],[33,88,24,8],[33,106,24,26],[33,108,25,8],[34,8,26,10,"event"],[34,13,26,15],[34,15,26,17],[34,18,26,20],[35,8,27,10,"schema"],[35,14,27,16],[35,16,27,18],[35,24,27,26],[36,8,28,10,"table"],[36,13,28,15],[36,15,28,17],[36,35,28,37],[37,8,29,10,"filter"],[37,14,29,16],[37,16,29,18],[37,38,29,40,"conversationId"],[37,52,29,54],[38,6,30,8],[38,7,30,9],[38,9,31,9,"payload"],[38,16,31,16],[38,20,31,21],[39,8,32,10],[40,8,33,10],[40,12,33,16,"record"],[40,18,33,22],[40,21,33,25,"payload"],[40,28,33,32],[40,29,33,33,"new"],[40,32,33,72],[41,8,34,10],[41,12,34,14,"record"],[41,18,34,20],[41,20,34,22,"user_id"],[41,27,34,29],[41,32,34,34,"user"],[41,36,34,38],[41,37,34,39,"id"],[41,39,34,41],[41,41,34,43],[42,8,36,10,"queryClient"],[42,19,36,21],[42,20,36,22,"invalidateQueries"],[42,37,36,39],[42,38,36,40],[43,10,37,12,"queryKey"],[43,18,37,20],[43,20,37,22,"chatKeys"],[43,30,37,30],[43,31,37,30,"chatKeys"],[43,39,37,30],[43,40,37,31,"readReceipt"],[43,51,37,42],[43,52,37,43,"conversationId"],[43,66,37,57],[44,8,38,10],[44,9,38,11],[44,10,38,12],[45,6,39,8],[45,7,40,6],[45,8,40,7],[45,9,41,7,"subscribe"],[45,18,41,16],[45,19,41,17],[45,20,41,18],[46,6,43,4],[46,13,43,11],[46,19,43,17],[47,8,44,6,"supabase"],[47,20,44,14],[47,21,44,14,"supabase"],[47,29,44,14],[47,30,44,15,"removeChannel"],[47,43,44,28],[47,44,44,29,"channel"],[47,51,44,36],[47,52,44,37],[48,6,45,4],[48,7,45,5],[49,4,46,2],[49,5,46,3],[49,7,46,5],[49,8,46,6,"conversationId"],[49,22,46,20],[49,24,46,22,"user"],[49,28,46,26],[49,30,46,28,"queryClient"],[49,41,46,39],[49,42,46,40],[49,43,46,41],[50,2,47,0],[50,3,47,1],[51,2,47,2,"_s"],[51,4,47,2],[51,5,14,6,"useRealtimeReadReceipts"],[51,28,14,29],[52,4,14,29],[52,12,15,19,"useAuth"],[52,32,15,26],[52,33,15,26,"useAuth"],[52,40,15,26],[52,42,16,22,"useQueryClient"],[52,61,16,36],[52,62,16,36,"useQueryClient"],[52,76,16,36],[53,2,16,36],[54,2,49,0],[54,6,49,0,"_default"],[54,14,49,0],[54,17,49,15,"useRealtimeReadReceipts"],[54,40,49,38],[55,0,49,39],[55,3]],"functionMap":{"names":["<global>","useRealtimeReadReceipts","useEffect$argument_0","supabase.channel.on$argument_2","<anonymous>"],"mappings":"AAA;gCCa;YCI;QCa;SDQ;WEI;KFE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}