{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":55,"index":90}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":91},"end":{"line":3,"column":42,"index":133}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":134},"end":{"line":4,"column":49,"index":183}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":184},"end":{"line":5,"column":43,"index":227}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0]);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _contextAuthProvider = require(_dependencyMap[3]);\n  var _queryKeys = require(_dependencyMap[4]);\n  /**\n   * Subscribes to Supabase Realtime postgres_changes on the conversation_reads\n   * table for a given conversation. When the other user updates their read receipt,\n   * invalidates the read receipt query so the UI reflects the latest state.\n   *\n   * Ignores updates from the current user to avoid unnecessary re-fetches.\n   */\n  var useRealtimeReadReceipts = conversationId => {\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    (0, _react.useEffect)(() => {\n      if (!conversationId || !user) return;\n      var channel = _libSupabase.supabase.channel(`read-receipts-${conversationId}`).on('postgres_changes', {\n        event: '*',\n        schema: 'public',\n        table: 'conversation_reads',\n        filter: `conversation_id=eq.${conversationId}`\n      }, payload => {\n        // Ignore own read receipt updates\n        var record = payload.new;\n        if (record?.user_id === user.id) return;\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.readReceipt(conversationId)\n        });\n      }).subscribe();\n      return () => {\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [conversationId, user, queryClient]);\n  };\n  var _default = useRealtimeReadReceipts;\n});","lineCount":50,"map":[[7,2,49,0,"Object"],[7,8,49,0],[7,9,49,0,"defineProperty"],[7,23,49,0],[7,24,49,0,"exports"],[7,31,49,0],[8,4,49,0,"enumerable"],[8,14,49,0],[9,4,49,0,"get"],[9,7,49,0],[9,18,49,0,"get"],[9,19,49,0],[10,6,49,0],[10,13,49,0,"_default"],[10,21,49,0],[11,4,49,0],[12,2,49,0],[13,2,1,0],[13,6,1,0,"_react"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_tanstackReactQuery"],[14,25,2,0],[14,28,2,0,"require"],[14,35,2,0],[14,36,2,0,"_dependencyMap"],[14,50,2,0],[15,2,3,0],[15,6,3,0,"_libSupabase"],[15,18,3,0],[15,21,3,0,"require"],[15,28,3,0],[15,29,3,0,"_dependencyMap"],[15,43,3,0],[16,2,4,0],[16,6,4,0,"_contextAuthProvider"],[16,26,4,0],[16,29,4,0,"require"],[16,36,4,0],[16,37,4,0,"_dependencyMap"],[16,51,4,0],[17,2,5,0],[17,6,5,0,"_queryKeys"],[17,16,5,0],[17,19,5,0,"require"],[17,26,5,0],[17,27,5,0,"_dependencyMap"],[17,41,5,0],[18,2,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,0,13,0],[25,2,14,0],[25,6,14,6,"useRealtimeReadReceipts"],[25,29,14,29],[25,32,14,33,"conversationId"],[25,46,14,55],[25,50,14,60],[26,4,15,2],[26,8,15,2,"_useAuth"],[26,16,15,2],[26,19,15,19],[26,23,15,19,"useAuth"],[26,43,15,26],[26,44,15,26,"useAuth"],[26,51,15,26],[26,53,15,27],[26,54,15,28],[27,6,15,10,"user"],[27,10,15,14],[27,13,15,14,"_useAuth"],[27,21,15,14],[27,22,15,10,"user"],[27,26,15,14],[28,4,16,2],[28,8,16,8,"queryClient"],[28,19,16,19],[28,22,16,22],[28,26,16,22,"useQueryClient"],[28,45,16,36],[28,46,16,36,"useQueryClient"],[28,60,16,36],[28,62,16,37],[28,63,16,38],[29,4,18,2],[29,8,18,2,"useEffect"],[29,14,18,11],[29,15,18,11,"useEffect"],[29,24,18,11],[29,26,18,12],[29,32,18,18],[30,6,19,4],[30,10,19,8],[30,11,19,9,"conversationId"],[30,25,19,23],[30,29,19,27],[30,30,19,28,"user"],[30,34,19,32],[30,36,19,34],[31,6,21,4],[31,10,21,10,"channel"],[31,17,21,17],[31,20,21,20,"supabase"],[31,32,21,28],[31,33,21,28,"supabase"],[31,41,21,28],[31,42,22,7,"channel"],[31,49,22,14],[31,50,22,15],[31,67,22,32,"conversationId"],[31,81,22,46],[31,83,22,48],[31,84,22,49],[31,85,23,7,"on"],[31,87,23,9],[31,88,24,8],[31,106,24,26],[31,108,25,8],[32,8,26,10,"event"],[32,13,26,15],[32,15,26,17],[32,18,26,20],[33,8,27,10,"schema"],[33,14,27,16],[33,16,27,18],[33,24,27,26],[34,8,28,10,"table"],[34,13,28,15],[34,15,28,17],[34,35,28,37],[35,8,29,10,"filter"],[35,14,29,16],[35,16,29,18],[35,38,29,40,"conversationId"],[35,52,29,54],[36,6,30,8],[36,7,30,9],[36,9,31,9,"payload"],[36,16,31,16],[36,20,31,21],[37,8,32,10],[38,8,33,10],[38,12,33,16,"record"],[38,18,33,22],[38,21,33,25,"payload"],[38,28,33,32],[38,29,33,33,"new"],[38,32,33,72],[39,8,34,10],[39,12,34,14,"record"],[39,18,34,20],[39,20,34,22,"user_id"],[39,27,34,29],[39,32,34,34,"user"],[39,36,34,38],[39,37,34,39,"id"],[39,39,34,41],[39,41,34,43],[40,8,36,10,"queryClient"],[40,19,36,21],[40,20,36,22,"invalidateQueries"],[40,37,36,39],[40,38,36,40],[41,10,37,12,"queryKey"],[41,18,37,20],[41,20,37,22,"chatKeys"],[41,30,37,30],[41,31,37,30,"chatKeys"],[41,39,37,30],[41,40,37,31,"readReceipt"],[41,51,37,42],[41,52,37,43,"conversationId"],[41,66,37,57],[42,8,38,10],[42,9,38,11],[42,10,38,12],[43,6,39,8],[43,7,40,6],[43,8,40,7],[43,9,41,7,"subscribe"],[43,18,41,16],[43,19,41,17],[43,20,41,18],[44,6,43,4],[44,13,43,11],[44,19,43,17],[45,8,44,6,"supabase"],[45,20,44,14],[45,21,44,14,"supabase"],[45,29,44,14],[45,30,44,15,"removeChannel"],[45,43,44,28],[45,44,44,29,"channel"],[45,51,44,36],[45,52,44,37],[46,6,45,4],[46,7,45,5],[47,4,46,2],[47,5,46,3],[47,7,46,5],[47,8,46,6,"conversationId"],[47,22,46,20],[47,24,46,22,"user"],[47,28,46,26],[47,30,46,28,"queryClient"],[47,41,46,39],[47,42,46,40],[47,43,46,41],[48,2,47,0],[48,3,47,1],[49,2,49,0],[49,6,49,0,"_default"],[49,14,49,0],[49,17,49,15,"useRealtimeReadReceipts"],[49,40,49,38],[50,0,49,39],[50,3]],"functionMap":{"names":["<global>","useRealtimeReadReceipts","useEffect$argument_0","supabase.channel.on$argument_2","<anonymous>"],"mappings":"AAA;gCCa;YCI;QCa;SDQ;WEI;KFE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}