{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":49,"index":142}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":43,"index":186}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[3], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /** Fetches all conversations for the current user, sorted by most recent message */\n  var useConversations = () => {\n    _s();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.chatKeys.conversations(),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          if (!user) return [];\n\n          // Get conversations where the current user is part of the match\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('conversations').select(`\n          id,\n          match_id,\n          matches!inner (\n            id,\n            user_a_id,\n            user_b_id\n          )\n        `).or(`user_a_id.eq.${user.id},user_b_id.eq.${user.id}`, {\n              referencedTable: 'matches'\n            }),\n            conversations = _yield$supabase$from$.data,\n            error = _yield$supabase$from$.error;\n          if (error) throw error;\n          if (!conversations || conversations.length === 0) return [];\n          var results = [];\n          for (var conv of conversations) {\n            var match = conv.matches;\n            var otherUserId = match.user_a_id === user.id ? match.user_b_id : match.user_a_id;\n\n            // Fetch the other user's profile\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('users').select('id, display_name, avatar_url, rating_score').eq('id', otherUserId).single(),\n              otherUserData = _yield$supabase$from$2.data;\n\n            // Fetch the last message\n            var _yield$supabase$from$3 = yield _libSupabase.supabase.from('messages').select('body, type, created_at').eq('conversation_id', conv.id).order('created_at', {\n                ascending: false\n              }).limit(1).single(),\n              lastMessageData = _yield$supabase$from$3.data;\n            results.push({\n              conversationId: conv.id,\n              matchId: match.id,\n              otherUser: {\n                id: otherUserData?.id ?? otherUserId,\n                name: otherUserData?.display_name ?? 'Unknown',\n                avatar: otherUserData?.avatar_url ?? null,\n                rating: otherUserData?.rating_score ?? 0\n              },\n              lastMessage: lastMessageData ? {\n                body: lastMessageData.body,\n                type: lastMessageData.type,\n                createdAt: lastMessageData.created_at\n              } : null,\n              unreadCount: 0 // Placeholder until read receipts are implemented\n            });\n          }\n\n          // Sort by last message date descending (newest first)\n          results.sort((a, b) => {\n            var dateA = a.lastMessage?.createdAt ?? '';\n            var dateB = b.lastMessage?.createdAt ?? '';\n            return dateB.localeCompare(dateA);\n          });\n          return results;\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!user\n    });\n  };\n  _s(useConversations, \"feBfegY2LWvVkHAo3/+H6/HJ9O4=\", false, function () {\n    return [_contextAuthProvider.useAuth, _tanstackReactQuery.useQuery];\n  });\n  var _default = useConversations;\n});","lineCount":103,"map":[[13,2,116,0,"Object"],[13,8,116,0],[13,9,116,0,"defineProperty"],[13,23,116,0],[13,24,116,0,"exports"],[13,31,116,0],[14,4,116,0,"enumerable"],[14,14,116,0],[15,4,116,0,"get"],[15,7,116,0],[15,18,116,0,"get"],[15,19,116,0],[16,6,116,0],[16,13,116,0,"_default"],[16,21,116,0],[17,4,116,0],[18,2,116,0],[19,2,116,32],[19,6,116,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,116,32],[19,45,116,32,"require"],[19,52,116,32],[19,53,116,32,"_dependencyMap"],[19,67,116,32],[20,2,116,32],[20,6,116,32,"_asyncToGenerator"],[20,23,116,32],[20,26,116,32,"_interopDefault"],[20,41,116,32],[20,42,116,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,116,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_contextAuthProvider"],[23,26,3,0],[23,29,3,0,"require"],[23,36,3,0],[23,37,3,0,"_dependencyMap"],[23,51,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,24,0],[26,2,25,0],[26,6,25,6,"useConversations"],[26,22,25,22],[26,25,25,25,"useConversations"],[26,26,25,25],[26,31,25,31],[27,4,25,31,"_s"],[27,6,25,31],[28,4,26,2],[28,8,26,2,"_useAuth"],[28,16,26,2],[28,19,26,19],[28,23,26,19,"useAuth"],[28,43,26,26],[28,44,26,26,"useAuth"],[28,51,26,26],[28,53,26,27],[28,54,26,28],[29,6,26,10,"user"],[29,10,26,14],[29,13,26,14,"_useAuth"],[29,21,26,14],[29,22,26,10,"user"],[29,26,26,14],[30,4,28,2],[30,11,28,9],[30,15,28,9,"useQuery"],[30,34,28,17],[30,35,28,17,"useQuery"],[30,43,28,17],[30,45,28,18],[31,6,29,4,"queryKey"],[31,14,29,12],[31,16,29,14,"chatKeys"],[31,26,29,22],[31,27,29,22,"chatKeys"],[31,35,29,22],[31,36,29,23,"conversations"],[31,49,29,36],[31,50,29,37],[31,51,29,38],[32,6,30,4,"queryFn"],[32,13,30,11],[33,8,30,11],[33,12,30,11,"_ref"],[33,16,30,11],[33,23,30,11,"_asyncToGenerator"],[33,40,30,11],[33,41,30,11,"default"],[33,48,30,11],[33,50,30,13],[33,63,30,57],[34,10,31,6],[34,14,31,10],[34,15,31,11,"user"],[34,19,31,15],[34,21,31,17],[34,28,31,24],[34,30,31,26],[36,10,33,6],[37,10,34,6],[37,14,34,6,"_yield$supabase$from$"],[37,35,34,6],[37,44,34,51,"supabase"],[37,56,34,59],[37,57,34,59,"supabase"],[37,65,34,59],[37,66,35,9,"from"],[37,70,35,13],[37,71,35,14],[37,86,35,29],[37,87,35,30],[37,88,36,9,"select"],[37,94,36,15],[37,95,37,10],[38,0,38,0],[39,0,39,0],[40,0,40,0],[41,0,41,0],[42,0,42,0],[43,0,43,0],[44,0,44,0],[45,0,45,0],[45,9,46,8],[45,10,46,9],[45,11,47,9,"or"],[45,13,47,11],[45,14,48,10],[45,30,48,26,"user"],[45,34,48,30],[45,35,48,31,"id"],[45,37,48,33],[45,54,48,50,"user"],[45,58,48,54],[45,59,48,55,"id"],[45,61,48,57],[45,63,48,59],[45,65,49,10],[46,14,49,12,"referencedTable"],[46,29,49,27],[46,31,49,29],[47,12,49,39],[47,13,50,8],[47,14,50,9],[48,12,34,20,"conversations"],[48,25,34,33],[48,28,34,33,"_yield$supabase$from$"],[48,49,34,33],[48,50,34,14,"data"],[48,54,34,18],[49,12,34,35,"error"],[49,17,34,40],[49,20,34,40,"_yield$supabase$from$"],[49,41,34,40],[49,42,34,35,"error"],[49,47,34,40],[50,10,52,6],[50,14,52,10,"error"],[50,19,52,15],[50,21,52,17],[50,27,52,23,"error"],[50,32,52,28],[51,10,53,6],[51,14,53,10],[51,15,53,11,"conversations"],[51,28,53,24],[51,32,53,28,"conversations"],[51,45,53,41],[51,46,53,42,"length"],[51,52,53,48],[51,57,53,53],[51,58,53,54],[51,60,53,56],[51,67,53,63],[51,69,53,65],[52,10,55,6],[52,14,55,12,"results"],[52,21,55,42],[52,24,55,45],[52,26,55,47],[53,10,57,6],[53,15,57,11],[53,19,57,17,"conv"],[53,23,57,21],[53,27,57,25,"conversations"],[53,40,57,38],[53,42,57,40],[54,12,58,8],[54,16,58,14,"match"],[54,21,58,19],[54,24,58,22,"conv"],[54,28,58,26],[54,29,58,27,"matches"],[54,36,62,9],[55,12,64,8],[55,16,64,14,"otherUserId"],[55,27,64,25],[55,30,65,10,"match"],[55,35,65,15],[55,36,65,16,"user_a_id"],[55,45,65,25],[55,50,65,30,"user"],[55,54,65,34],[55,55,65,35,"id"],[55,57,65,37],[55,60,65,40,"match"],[55,65,65,45],[55,66,65,46,"user_b_id"],[55,75,65,55],[55,78,65,58,"match"],[55,83,65,63],[55,84,65,64,"user_a_id"],[55,93,65,73],[57,12,67,8],[58,12,68,8],[58,16,68,8,"_yield$supabase$from$2"],[58,38,68,8],[58,47,68,46,"supabase"],[58,59,68,54],[58,60,68,54,"supabase"],[58,68,68,54],[58,69,69,11,"from"],[58,73,69,15],[58,74,69,16],[58,81,69,23],[58,82,69,24],[58,83,70,11,"select"],[58,89,70,17],[58,90,70,18],[58,134,70,62],[58,135,70,63],[58,136,71,11,"eq"],[58,138,71,13],[58,139,71,14],[58,143,71,18],[58,145,71,20,"otherUserId"],[58,156,71,31],[58,157,71,32],[58,158,72,11,"single"],[58,164,72,17],[58,165,72,18],[58,166,72,19],[59,14,68,22,"otherUserData"],[59,27,68,35],[59,30,68,35,"_yield$supabase$from$2"],[59,52,68,35],[59,53,68,16,"data"],[59,57,68,20],[61,12,74,8],[62,12,75,8],[62,16,75,8,"_yield$supabase$from$3"],[62,38,75,8],[62,47,75,48,"supabase"],[62,59,75,56],[62,60,75,56,"supabase"],[62,68,75,56],[62,69,76,11,"from"],[62,73,76,15],[62,74,76,16],[62,84,76,26],[62,85,76,27],[62,86,77,11,"select"],[62,92,77,17],[62,93,77,18],[62,117,77,42],[62,118,77,43],[62,119,78,11,"eq"],[62,121,78,13],[62,122,78,14],[62,139,78,31],[62,141,78,33,"conv"],[62,145,78,37],[62,146,78,38,"id"],[62,148,78,40],[62,149,78,41],[62,150,79,11,"order"],[62,155,79,16],[62,156,79,17],[62,168,79,29],[62,170,79,31],[63,16,79,33,"ascending"],[63,25,79,42],[63,27,79,44],[64,14,79,50],[64,15,79,51],[64,16,79,52],[64,17,80,11,"limit"],[64,22,80,16],[64,23,80,17],[64,24,80,18],[64,25,80,19],[64,26,81,11,"single"],[64,32,81,17],[64,33,81,18],[64,34,81,19],[65,14,75,22,"lastMessageData"],[65,29,75,37],[65,32,75,37,"_yield$supabase$from$3"],[65,54,75,37],[65,55,75,16,"data"],[65,59,75,20],[66,12,83,8,"results"],[66,19,83,15],[66,20,83,16,"push"],[66,24,83,20],[66,25,83,21],[67,14,84,10,"conversationId"],[67,28,84,24],[67,30,84,26,"conv"],[67,34,84,30],[67,35,84,31,"id"],[67,37,84,33],[68,14,85,10,"matchId"],[68,21,85,17],[68,23,85,19,"match"],[68,28,85,24],[68,29,85,25,"id"],[68,31,85,27],[69,14,86,10,"otherUser"],[69,23,86,19],[69,25,86,21],[70,16,87,12,"id"],[70,18,87,14],[70,20,87,16,"otherUserData"],[70,33,87,29],[70,35,87,31,"id"],[70,37,87,33],[70,41,87,37,"otherUserId"],[70,52,87,48],[71,16,88,12,"name"],[71,20,88,16],[71,22,88,18,"otherUserData"],[71,35,88,31],[71,37,88,33,"display_name"],[71,49,88,45],[71,53,88,49],[71,62,88,58],[72,16,89,12,"avatar"],[72,22,89,18],[72,24,89,20,"otherUserData"],[72,37,89,33],[72,39,89,35,"avatar_url"],[72,49,89,45],[72,53,89,49],[72,57,89,53],[73,16,90,12,"rating"],[73,22,90,18],[73,24,90,20,"otherUserData"],[73,37,90,33],[73,39,90,35,"rating_score"],[73,51,90,47],[73,55,90,51],[74,14,91,10],[74,15,91,11],[75,14,92,10,"lastMessage"],[75,25,92,21],[75,27,92,23,"lastMessageData"],[75,42,92,38],[75,45,93,14],[76,16,94,16,"body"],[76,20,94,20],[76,22,94,22,"lastMessageData"],[76,37,94,37],[76,38,94,38,"body"],[76,42,94,42],[77,16,95,16,"type"],[77,20,95,20],[77,22,95,22,"lastMessageData"],[77,37,95,37],[77,38,95,38,"type"],[77,42,95,42],[78,16,96,16,"createdAt"],[78,25,96,25],[78,27,96,27,"lastMessageData"],[78,42,96,42],[78,43,96,43,"created_at"],[79,14,97,14],[79,15,97,15],[79,18,98,14],[79,22,98,18],[80,14,99,10,"unreadCount"],[80,25,99,21],[80,27,99,23],[80,28,99,24],[80,29,99,26],[81,12,100,8],[81,13,100,9],[81,14,100,10],[82,10,101,6],[84,10,103,6],[85,10,104,6,"results"],[85,17,104,13],[85,18,104,14,"sort"],[85,22,104,18],[85,23,104,19],[85,24,104,20,"a"],[85,25,104,21],[85,27,104,23,"b"],[85,28,104,24],[85,33,104,29],[86,12,105,8],[86,16,105,14,"dateA"],[86,21,105,19],[86,24,105,22,"a"],[86,25,105,23],[86,26,105,24,"lastMessage"],[86,37,105,35],[86,39,105,37,"createdAt"],[86,48,105,46],[86,52,105,50],[86,54,105,52],[87,12,106,8],[87,16,106,14,"dateB"],[87,21,106,19],[87,24,106,22,"b"],[87,25,106,23],[87,26,106,24,"lastMessage"],[87,37,106,35],[87,39,106,37,"createdAt"],[87,48,106,46],[87,52,106,50],[87,54,106,52],[88,12,107,8],[88,19,107,15,"dateB"],[88,24,107,20],[88,25,107,21,"localeCompare"],[88,38,107,34],[88,39,107,35,"dateA"],[88,44,107,40],[88,45,107,41],[89,10,108,6],[89,11,108,7],[89,12,108,8],[90,10,110,6],[90,17,110,13,"results"],[90,24,110,20],[91,8,111,4],[91,9,111,5],[92,8,111,5],[92,24,30,4,"queryFn"],[92,31,30,11,"queryFn"],[92,32,30,11],[93,10,30,11],[93,17,30,11,"_ref"],[93,21,30,11],[93,22,30,11,"apply"],[93,27,30,11],[93,34,30,11,"arguments"],[93,43,30,11],[94,8,30,11],[95,6,30,11],[95,9,111,5],[96,6,112,4,"enabled"],[96,13,112,11],[96,15,112,13],[96,16,112,14],[96,17,112,15,"user"],[97,4,113,2],[97,5,113,3],[97,6,113,4],[98,2,114,0],[98,3,114,1],[99,2,114,2,"_s"],[99,4,114,2],[99,5,25,6,"useConversations"],[99,21,25,22],[100,4,25,22],[100,12,26,19,"useAuth"],[100,32,26,26],[100,33,26,26,"useAuth"],[100,40,26,26],[100,42,28,9,"useQuery"],[100,61,28,17],[100,62,28,17,"useQuery"],[100,70,28,17],[101,2,28,17],[102,2,116,0],[102,6,116,0,"_default"],[102,14,116,0],[102,17,116,15,"useConversations"],[102,33,116,31],[103,0,116,32],[103,3]],"functionMap":{"names":["<global>","useConversations","useQuery$argument_0.queryFn","results.sort$argument_0"],"mappings":"AAA;yBCwB;aCK;mBC0E;ODI;KDG;CDG"},"hasCjsExports":false},"type":"js/module"}]}