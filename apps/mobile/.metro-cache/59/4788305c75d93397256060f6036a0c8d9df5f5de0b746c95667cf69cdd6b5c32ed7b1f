{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/services/cardData","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":54,"index":166}}],"key":"aDLIuqe8ZoUac1cvYkmTdLzn7po=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":167},"end":{"line":4,"column":49,"index":216}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _servicesCardData = require(_dependencyMap[3]);\n  var _queryKeys = require(_dependencyMap[4]);\n  /**\n   * Batch-refreshes market_price for all collection items by\n   * fetching current prices from the card data service adapter.\n   */\n  var useRefreshPrices = () => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (items) {\n          var nonSealed = items.filter(item => !item.is_sealed);\n          var updated = 0;\n          for (var item of nonSealed) {\n            var detail = yield _servicesCardData.cardDataService.getCardDetail(item.external_id);\n            if (detail?.marketPrice != null && detail.marketPrice !== item.market_price) {\n              var _yield$supabase$from$ = yield _libSupabase.supabase.from('collection_items').update({\n                  market_price: detail.marketPrice\n                }).eq('id', item.id),\n                error = _yield$supabase$from$.error;\n              if (!error) updated++;\n            }\n          }\n          return {\n            updated,\n            total: nonSealed.length\n          };\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.collectionKeys.all\n        });\n      }\n    });\n  };\n  var _default = useRefreshPrices;\n});","lineCount":62,"map":[[12,2,39,0,"Object"],[12,8,39,0],[12,9,39,0,"defineProperty"],[12,23,39,0],[12,24,39,0,"exports"],[12,31,39,0],[13,4,39,0,"enumerable"],[13,14,39,0],[14,4,39,0,"get"],[14,7,39,0],[14,18,39,0,"get"],[14,19,39,0],[15,6,39,0],[15,13,39,0,"_default"],[15,21,39,0],[16,4,39,0],[17,2,39,0],[18,2,39,32],[18,6,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,39,32],[18,45,39,32,"require"],[18,52,39,32],[18,53,39,32,"_dependencyMap"],[18,67,39,32],[19,2,39,32],[19,6,39,32,"_asyncToGenerator"],[19,23,39,32],[19,26,39,32,"_interopDefault"],[19,41,39,32],[19,42,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,39,32],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_libSupabase"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_servicesCardData"],[22,23,3,0],[22,26,3,0,"require"],[22,33,3,0],[22,34,3,0,"_dependencyMap"],[22,48,3,0],[23,2,4,0],[23,6,4,0,"_queryKeys"],[23,16,4,0],[23,19,4,0,"require"],[23,26,4,0],[23,27,4,0,"_dependencyMap"],[23,41,4,0],[24,2,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,2,11,0],[28,6,11,6,"useRefreshPrices"],[28,22,11,22],[28,25,11,25,"useRefreshPrices"],[28,26,11,25],[28,31,11,31],[29,4,12,2],[29,8,12,8,"queryClient"],[29,19,12,19],[29,22,12,22],[29,26,12,22,"useQueryClient"],[29,45,12,36],[29,46,12,36,"useQueryClient"],[29,60,12,36],[29,62,12,37],[29,63,12,38],[30,4,14,2],[30,11,14,9],[30,15,14,9,"useMutation"],[30,34,14,20],[30,35,14,20,"useMutation"],[30,46,14,20],[30,48,14,21],[31,6,15,4,"mutationFn"],[31,16,15,14],[32,8,15,14],[32,12,15,14,"_ref"],[32,16,15,14],[32,23,15,14,"_asyncToGenerator"],[32,40,15,14],[32,41,15,14,"default"],[32,48,15,14],[32,50,15,16],[32,61,15,23,"items"],[32,66,15,49],[32,68,15,54],[33,10,16,6],[33,14,16,12,"nonSealed"],[33,23,16,21],[33,26,16,24,"items"],[33,31,16,29],[33,32,16,30,"filter"],[33,38,16,36],[33,39,16,38,"item"],[33,43,16,42],[33,47,16,47],[33,48,16,48,"item"],[33,52,16,52],[33,53,16,53,"is_sealed"],[33,62,16,62],[33,63,16,63],[34,10,17,6],[34,14,17,10,"updated"],[34,21,17,17],[34,24,17,20],[34,25,17,21],[35,10,19,6],[35,15,19,11],[35,19,19,17,"item"],[35,23,19,21],[35,27,19,25,"nonSealed"],[35,36,19,34],[35,38,19,36],[36,12,20,8],[36,16,20,14,"detail"],[36,22,20,20],[36,31,20,29,"cardDataService"],[36,48,20,44],[36,49,20,44,"cardDataService"],[36,64,20,44],[36,65,20,45,"getCardDetail"],[36,78,20,58],[36,79,20,59,"item"],[36,83,20,63],[36,84,20,64,"external_id"],[36,95,20,75],[36,96,20,76],[37,12,21,8],[37,16,21,12,"detail"],[37,22,21,18],[37,24,21,20,"marketPrice"],[37,35,21,31],[37,39,21,35],[37,43,21,39],[37,47,21,43,"detail"],[37,53,21,49],[37,54,21,50,"marketPrice"],[37,65,21,61],[37,70,21,66,"item"],[37,74,21,70],[37,75,21,71,"market_price"],[37,87,21,83],[37,89,21,85],[38,14,22,10],[38,18,22,10,"_yield$supabase$from$"],[38,39,22,10],[38,48,22,34,"supabase"],[38,60,22,42],[38,61,22,42,"supabase"],[38,69,22,42],[38,70,23,13,"from"],[38,74,23,17],[38,75,23,18],[38,93,23,36],[38,94,23,37],[38,95,24,13,"update"],[38,101,24,19],[38,102,24,20],[39,18,24,22,"market_price"],[39,30,24,34],[39,32,24,36,"detail"],[39,38,24,42],[39,39,24,43,"marketPrice"],[40,16,24,55],[40,17,24,56],[40,18,24,57],[40,19,25,13,"eq"],[40,21,25,15],[40,22,25,16],[40,26,25,20],[40,28,25,22,"item"],[40,32,25,26],[40,33,25,27,"id"],[40,35,25,29],[40,36,25,30],[41,16,22,18,"error"],[41,21,22,23],[41,24,22,23,"_yield$supabase$from$"],[41,45,22,23],[41,46,22,18,"error"],[41,51,22,23],[42,14,27,10],[42,18,27,14],[42,19,27,15,"error"],[42,24,27,20],[42,26,27,22,"updated"],[42,33,27,29],[42,35,27,31],[43,12,28,8],[44,10,29,6],[45,10,31,6],[45,17,31,13],[46,12,31,15,"updated"],[46,19,31,22],[47,12,31,24,"total"],[47,17,31,29],[47,19,31,31,"nonSealed"],[47,28,31,40],[47,29,31,41,"length"],[48,10,31,48],[48,11,31,49],[49,8,32,4],[49,9,32,5],[50,8,32,5],[50,24,15,4,"mutationFn"],[50,34,15,14,"mutationFn"],[50,35,15,14,"_x"],[50,37,15,14],[51,10,15,14],[51,17,15,14,"_ref"],[51,21,15,14],[51,22,15,14,"apply"],[51,27,15,14],[51,34,15,14,"arguments"],[51,43,15,14],[52,8,15,14],[53,6,15,14],[53,9,32,5],[54,6,33,4,"onSuccess"],[54,15,33,13],[54,17,33,15,"onSuccess"],[54,18,33,15],[54,23,33,21],[55,8,34,6,"queryClient"],[55,19,34,17],[55,20,34,18,"invalidateQueries"],[55,37,34,35],[55,38,34,36],[56,10,34,38,"queryKey"],[56,18,34,46],[56,20,34,48,"collectionKeys"],[56,30,34,62],[56,31,34,62,"collectionKeys"],[56,45,34,62],[56,46,34,63,"all"],[57,8,34,67],[57,9,34,68],[57,10,34,69],[58,6,35,4],[59,4,36,2],[59,5,36,3],[59,6,36,4],[60,2,37,0],[60,3,37,1],[61,2,39,0],[61,6,39,0,"_default"],[61,14,39,0],[61,17,39,15,"useRefreshPrices"],[61,33,39,31],[62,0,39,32],[62,3]],"functionMap":{"names":["<global>","useRefreshPrices","useMutation$argument_0.mutationFn","items.filter$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCU;gBCI;qCCC,yBD;KDgB;eGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}