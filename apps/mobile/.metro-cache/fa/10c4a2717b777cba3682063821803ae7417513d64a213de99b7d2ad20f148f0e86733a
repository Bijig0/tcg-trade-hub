{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":32,"index":32}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":33},"end":{"line":2,"column":49,"index":82}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/services/cardData/cardDataService","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":83},"end":{"line":3,"column":70,"index":153}}],"key":"nywe4wRFGi03uMHWkFCW5l9Ir6I=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0]);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _servicesCardDataCardDataService = require(_dependencyMap[2]);\n  var PERIOD_DAYS = {\n    '1M': 30,\n    '3M': 90,\n    '6M': 180,\n    '12M': 365,\n    MAX: Infinity\n  };\n\n  /**\n   * Returns price history for a card, filtered by the selected time period.\n   */\n  var usePriceHistory = (externalId, period) => {\n    var _useQuery = (0, _tanstackReactQuery.useQuery)({\n        queryKey: ['card-detail', externalId],\n        queryFn: () => _servicesCardDataCardDataService.cardDataService.getCardDetail(externalId),\n        staleTime: 1800000,\n        enabled: externalId.length > 0\n      }),\n      detail = _useQuery.data,\n      isLoading = _useQuery.isLoading;\n    var filtered = (0, _react.useMemo)(() => {\n      var history = detail?.priceHistory;\n      if (!history || history.points.length === 0) return null;\n      var days = PERIOD_DAYS[period] ?? Infinity;\n      if (days === Infinity) return history;\n      var cutoff = new Date();\n      cutoff.setDate(cutoff.getDate() - days);\n      var cutoffStr = cutoff.toISOString().split('T')[0];\n      var pts = history.points.filter(p => p.date >= cutoffStr);\n      if (pts.length < 2) return history; // fallback to full if too few points\n\n      var high = -(1 / 0);\n      var low = Infinity;\n      for (var p of pts) {\n        if (p.price > high) high = p.price;\n        if (p.price < low) low = p.price;\n      }\n      var first = pts[0].price;\n      var last = pts[pts.length - 1].price;\n      var changePercent = first > 0 ? Math.round((last - first) / first * 10000) / 100 : 0;\n      return {\n        points: pts,\n        high: Math.round(high * 100) / 100,\n        low: Math.round(low * 100) / 100,\n        changePercent\n      };\n    }, [detail, period]);\n    return {\n      data: filtered,\n      isLoading\n    };\n  };\n  var _default = usePriceHistory;\n});","lineCount":69,"map":[[7,2,64,0,"Object"],[7,8,64,0],[7,9,64,0,"defineProperty"],[7,23,64,0],[7,24,64,0,"exports"],[7,31,64,0],[8,4,64,0,"enumerable"],[8,14,64,0],[9,4,64,0,"get"],[9,7,64,0],[9,18,64,0,"get"],[9,19,64,0],[10,6,64,0],[10,13,64,0,"_default"],[10,21,64,0],[11,4,64,0],[12,2,64,0],[13,2,1,0],[13,6,1,0,"_react"],[13,12,1,0],[13,15,1,0,"require"],[13,22,1,0],[13,23,1,0,"_dependencyMap"],[13,37,1,0],[14,2,2,0],[14,6,2,0,"_tanstackReactQuery"],[14,25,2,0],[14,28,2,0,"require"],[14,35,2,0],[14,36,2,0,"_dependencyMap"],[14,50,2,0],[15,2,3,0],[15,6,3,0,"_servicesCardDataCardDataService"],[15,38,3,0],[15,41,3,0,"require"],[15,48,3,0],[15,49,3,0,"_dependencyMap"],[15,63,3,0],[16,2,6,0],[16,6,6,6,"PERIOD_DAYS"],[16,17,6,41],[16,20,6,44],[17,4,7,2],[17,8,7,6],[17,10,7,8],[17,12,7,10],[18,4,8,2],[18,8,8,6],[18,10,8,8],[18,12,8,10],[19,4,9,2],[19,8,9,6],[19,10,9,8],[19,13,9,11],[20,4,10,2],[20,9,10,7],[20,11,10,9],[20,14,10,12],[21,4,11,2,"MAX"],[21,7,11,5],[21,9,11,7,"Infinity"],[22,2,12,0],[22,3,12,1],[24,2,14,0],[25,0,15,0],[26,0,16,0],[27,2,17,0],[27,6,17,6,"usePriceHistory"],[27,21,17,21],[27,24,17,24,"usePriceHistory"],[27,25,17,25,"externalId"],[27,35,17,43],[27,37,17,45,"period"],[27,43,17,59],[27,48,17,64],[28,4,18,2],[28,8,18,2,"_useQuery"],[28,17,18,2],[28,20,18,38],[28,24,18,38,"useQuery"],[28,43,18,46],[28,44,18,46,"useQuery"],[28,52,18,46],[28,54,18,47],[29,8,19,4,"queryKey"],[29,16,19,12],[29,18,19,14],[29,19,19,15],[29,32,19,28],[29,34,19,30,"externalId"],[29,44,19,40],[29,45,19,50],[30,8,20,4,"queryFn"],[30,15,20,11],[30,17,20,13,"queryFn"],[30,18,20,13],[30,23,20,19,"cardDataService"],[30,55,20,34],[30,56,20,34,"cardDataService"],[30,71,20,34],[30,72,20,35,"getCardDetail"],[30,85,20,48],[30,86,20,49,"externalId"],[30,96,20,59],[30,97,20,60],[31,8,21,4,"staleTime"],[31,17,21,13],[31,26,21,29],[32,8,22,4,"enabled"],[32,15,22,11],[32,17,22,13,"externalId"],[32,27,22,23],[32,28,22,24,"length"],[32,34,22,30],[32,37,22,33],[33,6,23,2],[33,7,23,3],[33,8,23,4],[34,6,18,16,"detail"],[34,12,18,22],[34,15,18,22,"_useQuery"],[34,24,18,22],[34,25,18,10,"data"],[34,29,18,14],[35,6,18,24,"isLoading"],[35,15,18,33],[35,18,18,33,"_useQuery"],[35,27,18,33],[35,28,18,24,"isLoading"],[35,37,18,33],[36,4,25,2],[36,8,25,8,"filtered"],[36,16,25,16],[36,19,25,19],[36,23,25,19,"useMemo"],[36,29,25,26],[36,30,25,26,"useMemo"],[36,37,25,26],[36,39,25,27],[36,45,25,54],[37,6,26,4],[37,10,26,10,"history"],[37,17,26,17],[37,20,26,20,"detail"],[37,26,26,26],[37,28,26,28,"priceHistory"],[37,40,26,40],[38,6,27,4],[38,10,27,8],[38,11,27,9,"history"],[38,18,27,16],[38,22,27,20,"history"],[38,29,27,27],[38,30,27,28,"points"],[38,36,27,34],[38,37,27,35,"length"],[38,43,27,41],[38,48,27,46],[38,49,27,47],[38,51,27,49],[38,58,27,56],[38,62,27,60],[39,6,29,4],[39,10,29,10,"days"],[39,14,29,14],[39,17,29,17,"PERIOD_DAYS"],[39,28,29,28],[39,29,29,29,"period"],[39,35,29,35],[39,36,29,36],[39,40,29,40,"Infinity"],[39,48,29,48],[40,6,30,4],[40,10,30,8,"days"],[40,14,30,12],[40,19,30,17,"Infinity"],[40,27,30,25],[40,29,30,27],[40,36,30,34,"history"],[40,43,30,41],[41,6,32,4],[41,10,32,10,"cutoff"],[41,16,32,16],[41,19,32,19],[41,23,32,23,"Date"],[41,27,32,27],[41,28,32,28],[41,29,32,29],[42,6,33,4,"cutoff"],[42,12,33,10],[42,13,33,11,"setDate"],[42,20,33,18],[42,21,33,19,"cutoff"],[42,27,33,25],[42,28,33,26,"getDate"],[42,35,33,33],[42,36,33,34],[42,37,33,35],[42,40,33,38,"days"],[42,44,33,42],[42,45,33,43],[43,6,34,4],[43,10,34,10,"cutoffStr"],[43,19,34,19],[43,22,34,22,"cutoff"],[43,28,34,28],[43,29,34,29,"toISOString"],[43,40,34,40],[43,41,34,41],[43,42,34,42],[43,43,34,43,"split"],[43,48,34,48],[43,49,34,49],[43,52,34,52],[43,53,34,53],[43,54,34,54],[43,55,34,55],[43,56,34,57],[44,6,36,4],[44,10,36,10,"pts"],[44,13,36,13],[44,16,36,16,"history"],[44,23,36,23],[44,24,36,24,"points"],[44,30,36,30],[44,31,36,31,"filter"],[44,37,36,37],[44,38,36,39,"p"],[44,39,36,40],[44,43,36,45,"p"],[44,44,36,46],[44,45,36,47,"date"],[44,49,36,51],[44,53,36,55,"cutoffStr"],[44,62,36,64],[44,63,36,65],[45,6,37,4],[45,10,37,8,"pts"],[45,13,37,11],[45,14,37,12,"length"],[45,20,37,18],[45,23,37,21],[45,24,37,22],[45,26,37,24],[45,33,37,31,"history"],[45,40,37,38],[45,41,37,39],[45,42,37,40],[47,6,39,4],[47,10,39,8,"high"],[47,14,39,12],[47,25,39,24],[48,6,40,4],[48,10,40,8,"low"],[48,13,40,11],[48,16,40,14,"Infinity"],[48,24,40,22],[49,6,41,4],[49,11,41,9],[49,15,41,15,"p"],[49,16,41,16],[49,20,41,20,"pts"],[49,23,41,23],[49,25,41,25],[50,8,42,6],[50,12,42,10,"p"],[50,13,42,11],[50,14,42,12,"price"],[50,19,42,17],[50,22,42,20,"high"],[50,26,42,24],[50,28,42,26,"high"],[50,32,42,30],[50,35,42,33,"p"],[50,36,42,34],[50,37,42,35,"price"],[50,42,42,40],[51,8,43,6],[51,12,43,10,"p"],[51,13,43,11],[51,14,43,12,"price"],[51,19,43,17],[51,22,43,20,"low"],[51,25,43,23],[51,27,43,25,"low"],[51,30,43,28],[51,33,43,31,"p"],[51,34,43,32],[51,35,43,33,"price"],[51,40,43,38],[52,6,44,4],[53,6,46,4],[53,10,46,10,"first"],[53,15,46,15],[53,18,46,18,"pts"],[53,21,46,21],[53,22,46,22],[53,23,46,23],[53,24,46,24],[53,25,46,26,"price"],[53,30,46,31],[54,6,47,4],[54,10,47,10,"last"],[54,14,47,14],[54,17,47,17,"pts"],[54,20,47,20],[54,21,47,21,"pts"],[54,24,47,24],[54,25,47,25,"length"],[54,31,47,31],[54,34,47,34],[54,35,47,35],[54,36,47,36],[54,37,47,38,"price"],[54,42,47,43],[55,6,48,4],[55,10,48,10,"changePercent"],[55,23,48,23],[55,26,49,6,"first"],[55,31,49,11],[55,34,49,14],[55,35,49,15],[55,38,50,10,"Math"],[55,42,50,14],[55,43,50,15,"round"],[55,48,50,20],[55,49,50,22],[55,50,50,23,"last"],[55,54,50,27],[55,57,50,30,"first"],[55,62,50,35],[55,66,50,39,"first"],[55,71,50,44],[55,74,50,48],[55,79,50,53],[55,80,50,54],[55,83,50,57],[55,86,50,60],[55,89,51,10],[55,90,51,11],[56,6,53,4],[56,13,53,11],[57,8,54,6,"points"],[57,14,54,12],[57,16,54,14,"pts"],[57,19,54,17],[58,8,55,6,"high"],[58,12,55,10],[58,14,55,12,"Math"],[58,18,55,16],[58,19,55,17,"round"],[58,24,55,22],[58,25,55,23,"high"],[58,29,55,27],[58,32,55,30],[58,35,55,33],[58,36,55,34],[58,39,55,37],[58,42,55,40],[59,8,56,6,"low"],[59,11,56,9],[59,13,56,11,"Math"],[59,17,56,15],[59,18,56,16,"round"],[59,23,56,21],[59,24,56,22,"low"],[59,27,56,25],[59,30,56,28],[59,33,56,31],[59,34,56,32],[59,37,56,35],[59,40,56,38],[60,8,57,6,"changePercent"],[61,6,58,4],[61,7,58,5],[62,4,59,2],[62,5,59,3],[62,7,59,5],[62,8,59,6,"detail"],[62,14,59,12],[62,16,59,14,"period"],[62,22,59,20],[62,23,59,21],[62,24,59,22],[63,4,61,2],[63,11,61,9],[64,6,61,11,"data"],[64,10,61,15],[64,12,61,17,"filtered"],[64,20,61,25],[65,6,61,27,"isLoading"],[66,4,61,37],[66,5,61,38],[67,2,62,0],[67,3,62,1],[68,2,64,0],[68,6,64,0,"_default"],[68,14,64,0],[68,17,64,15,"usePriceHistory"],[68,32,64,30],[69,0,64,31],[69,3]],"functionMap":{"names":["<global>","usePriceHistory","useQuery$argument_0.queryFn","useMemo$argument_0","history.points.filter$argument_0"],"mappings":"AAA;wBCgB;aCG,+CD;2BEK;sCCW,0BD;GFuB;CDG"},"hasCjsExports":false},"type":"js/module"}]}