{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":43,"index":136}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"../../utils/normalizeOfferNotes/normalizeOfferNotes","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":137},"end":{"line":4,"column":86,"index":223}}],"key":"i1eXRxjKohYoHxkMvLegV8XaHRc=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  var _utilsNormalizeOfferNotesNormalizeOfferNotes = require(_dependencyMap[4], \"../../utils/normalizeOfferNotes/normalizeOfferNotes\");\n  var normalizeOfferNotes = _interopDefault(_utilsNormalizeOfferNotesNormalizeOfferNotes);\n  /**\n   * Fetches notes from the most recent card_offer message in a conversation.\n   * Handles both new multi-author format and legacy single-string format.\n   */\n  var useOfferNotes = conversationId => {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.chatKeys.offerNotes(conversationId),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('messages').select(`\n          id,\n          payload,\n          sender:users!messages_sender_id_fkey (\n            id,\n            display_name,\n            avatar_url\n          )\n        `).eq('conversation_id', conversationId).eq('type', 'card_offer').order('created_at', {\n              ascending: false\n            }).limit(1),\n            data = _yield$supabase$from$.data,\n            error = _yield$supabase$from$.error;\n          if (error) throw error;\n          if (!data || data.length === 0) {\n            return {\n              offeringNotes: [],\n              requestingNotes: []\n            };\n          }\n          var msg = data[0];\n          var payload = msg.payload;\n          var sender = msg.sender;\n          return (0, normalizeOfferNotes.default)(payload, {\n            id: sender.id,\n            name: sender.display_name,\n            avatarUrl: sender.avatar_url\n          });\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!conversationId,\n      staleTime: 5 * 60 * 1000\n    });\n  };\n  _s(useOfferNotes, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = useOfferNotes;\n});","lineCount":77,"map":[[13,2,62,0,"Object"],[13,8,62,0],[13,9,62,0,"defineProperty"],[13,23,62,0],[13,24,62,0,"exports"],[13,31,62,0],[14,4,62,0,"enumerable"],[14,14,62,0],[15,4,62,0,"get"],[15,7,62,0],[15,18,62,0,"get"],[15,19,62,0],[16,6,62,0],[16,13,62,0,"_default"],[16,21,62,0],[17,4,62,0],[18,2,62,0],[19,2,62,29],[19,6,62,29,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,62,29],[19,45,62,29,"require"],[19,52,62,29],[19,53,62,29,"_dependencyMap"],[19,67,62,29],[20,2,62,29],[20,6,62,29,"_asyncToGenerator"],[20,23,62,29],[20,26,62,29,"_interopDefault"],[20,41,62,29],[20,42,62,29,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,62,29],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,4,0],[24,6,4,0,"_utilsNormalizeOfferNotesNormalizeOfferNotes"],[24,50,4,0],[24,53,4,0,"require"],[24,60,4,0],[24,61,4,0,"_dependencyMap"],[24,75,4,0],[25,2,4,0],[25,6,4,0,"normalizeOfferNotes"],[25,25,4,0],[25,28,4,0,"_interopDefault"],[25,43,4,0],[25,44,4,0,"_utilsNormalizeOfferNotesNormalizeOfferNotes"],[25,88,4,0],[26,2,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,2,16,0],[30,6,16,6,"useOfferNotes"],[30,19,16,19],[30,22,16,23,"conversationId"],[30,36,16,45],[30,40,16,50],[31,4,16,50,"_s"],[31,6,16,50],[32,4,17,2],[32,11,17,9],[32,15,17,9,"useQuery"],[32,34,17,17],[32,35,17,17,"useQuery"],[32,43,17,17],[32,45,17,18],[33,6,18,4,"queryKey"],[33,14,18,12],[33,16,18,14,"chatKeys"],[33,26,18,22],[33,27,18,22,"chatKeys"],[33,35,18,22],[33,36,18,23,"offerNotes"],[33,46,18,33],[33,47,18,34,"conversationId"],[33,61,18,48],[33,62,18,49],[34,6,19,4,"queryFn"],[34,13,19,11],[35,8,19,11],[35,12,19,11,"_ref"],[35,16,19,11],[35,23,19,11,"_asyncToGenerator"],[35,40,19,11],[35,41,19,11,"default"],[35,48,19,11],[35,50,19,13],[35,63,19,46],[36,10,20,6],[36,14,20,6,"_yield$supabase$from$"],[36,35,20,6],[36,44,20,36,"supabase"],[36,56,20,44],[36,57,20,44,"supabase"],[36,65,20,44],[36,66,21,9,"from"],[36,70,21,13],[36,71,21,14],[36,81,21,24],[36,82,21,25],[36,83,22,9,"select"],[36,89,22,15],[36,90,23,10],[37,0,24,0],[38,0,25,0],[39,0,26,0],[40,0,27,0],[41,0,28,0],[42,0,29,0],[43,0,30,0],[44,0,31,0],[44,9,32,8],[44,10,32,9],[44,11,33,9,"eq"],[44,13,33,11],[44,14,33,12],[44,31,33,29],[44,33,33,31,"conversationId"],[44,47,33,45],[44,48,33,46],[44,49,34,9,"eq"],[44,51,34,11],[44,52,34,12],[44,58,34,18],[44,60,34,20],[44,72,34,32],[44,73,34,33],[44,74,35,9,"order"],[44,79,35,14],[44,80,35,15],[44,92,35,27],[44,94,35,29],[45,14,35,31,"ascending"],[45,23,35,40],[45,25,35,42],[46,12,35,48],[46,13,35,49],[46,14,35,50],[46,15,36,9,"limit"],[46,20,36,14],[46,21,36,15],[46,22,36,16],[46,23,36,17],[47,12,20,14,"data"],[47,16,20,18],[47,19,20,18,"_yield$supabase$from$"],[47,40,20,18],[47,41,20,14,"data"],[47,45,20,18],[48,12,20,20,"error"],[48,17,20,25],[48,20,20,25,"_yield$supabase$from$"],[48,41,20,25],[48,42,20,20,"error"],[48,47,20,25],[49,10,38,6],[49,14,38,10,"error"],[49,19,38,15],[49,21,38,17],[49,27,38,23,"error"],[49,32,38,28],[50,10,39,6],[50,14,39,10],[50,15,39,11,"data"],[50,19,39,15],[50,23,39,19,"data"],[50,27,39,23],[50,28,39,24,"length"],[50,34,39,30],[50,39,39,35],[50,40,39,36],[50,42,39,38],[51,12,40,8],[51,19,40,15],[52,14,40,17,"offeringNotes"],[52,27,40,30],[52,29,40,32],[52,31,40,34],[53,14,40,36,"requestingNotes"],[53,29,40,51],[53,31,40,53],[54,12,40,56],[54,13,40,57],[55,10,41,6],[56,10,43,6],[56,14,43,12,"msg"],[56,17,43,15],[56,20,43,18,"data"],[56,24,43,22],[56,25,43,23],[56,26,43,24],[56,27,43,26],[57,10,44,6],[57,14,44,12,"payload"],[57,21,44,19],[57,24,44,22,"msg"],[57,27,44,25],[57,28,44,26,"payload"],[57,35,44,53],[58,10,45,6],[58,14,45,12,"sender"],[58,20,45,18],[58,23,45,21,"msg"],[58,26,45,24],[58,27,45,25,"sender"],[58,33,49,7],[59,10,51,6],[59,17,51,13],[59,21,51,13,"normalizeOfferNotes"],[59,40,51,32],[59,41,51,32,"default"],[59,48,51,32],[59,50,51,33,"payload"],[59,57,51,40],[59,59,51,42],[60,12,52,8,"id"],[60,14,52,10],[60,16,52,12,"sender"],[60,22,52,18],[60,23,52,19,"id"],[60,25,52,21],[61,12,53,8,"name"],[61,16,53,12],[61,18,53,14,"sender"],[61,24,53,20],[61,25,53,21,"display_name"],[61,37,53,33],[62,12,54,8,"avatarUrl"],[62,21,54,17],[62,23,54,19,"sender"],[62,29,54,25],[62,30,54,26,"avatar_url"],[63,10,55,6],[63,11,55,7],[63,12,55,8],[64,8,56,4],[64,9,56,5],[65,8,56,5],[65,24,19,4,"queryFn"],[65,31,19,11,"queryFn"],[65,32,19,11],[66,10,19,11],[66,17,19,11,"_ref"],[66,21,19,11],[66,22,19,11,"apply"],[66,27,19,11],[66,34,19,11,"arguments"],[66,43,19,11],[67,8,19,11],[68,6,19,11],[68,9,56,5],[69,6,57,4,"enabled"],[69,13,57,11],[69,15,57,13],[69,16,57,14],[69,17,57,15,"conversationId"],[69,31,57,29],[70,6,58,4,"staleTime"],[70,15,58,13],[70,17,58,15],[70,18,58,16],[70,21,58,19],[70,23,58,21],[70,26,58,24],[71,4,59,2],[71,5,59,3],[71,6,59,4],[72,2,60,0],[72,3,60,1],[73,2,60,2,"_s"],[73,4,60,2],[73,5,16,6,"useOfferNotes"],[73,18,16,19],[74,4,16,19],[74,12,17,9,"useQuery"],[74,31,17,17],[74,32,17,17,"useQuery"],[74,40,17,17],[75,2,17,17],[76,2,62,0],[76,6,62,0,"_default"],[76,14,62,0],[76,17,62,15,"useOfferNotes"],[76,30,62,28],[77,0,62,29],[77,3]],"functionMap":{"names":["<global>","useOfferNotes","useQuery$argument_0.queryFn"],"mappings":"AAA;sBCe;aCG;KDqC;CDI"},"hasCjsExports":false},"type":"js/module"}]}