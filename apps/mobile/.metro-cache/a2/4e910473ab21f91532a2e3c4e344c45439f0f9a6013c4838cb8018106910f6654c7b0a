{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":42,"index":121}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":49,"index":171}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":172},"end":{"line":4,"column":43,"index":215}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[3], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Manages per-user conversation nicknames.\n   *\n   * Returns the display name (custom nickname or default), plus rename/reset mutations.\n   * No row is auto-inserted â€” returns the default until the user explicitly renames.\n   */\n  var useConversationNickname = _ref => {\n    _s();\n    var conversationId = _ref.conversationId,\n      defaultNickname = _ref.defaultNickname;\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useQuery = (0, _tanstackReactQuery.useQuery)({\n        queryKey: _queryKeys.chatKeys.nickname(conversationId),\n        queryFn: function () {\n          var _ref2 = (0, _asyncToGenerator.default)(function* () {\n            if (!user) return null;\n            var _yield$supabase$from$ = yield _libSupabase.supabase.from('conversation_nicknames').select('nickname').eq('conversation_id', conversationId).eq('user_id', user.id).maybeSingle(),\n              data = _yield$supabase$from$.data,\n              error = _yield$supabase$from$.error;\n            if (error) throw error;\n            return data?.nickname ?? null;\n          });\n          return function queryFn() {\n            return _ref2.apply(this, arguments);\n          };\n        }(),\n        enabled: !!user && !!conversationId\n      }),\n      nickname = _useQuery.data,\n      isLoading = _useQuery.isLoading;\n    var renameMutation = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref3 = (0, _asyncToGenerator.default)(function* (newNickname) {\n          if (!user) throw new Error('Not authenticated');\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('conversation_nicknames').upsert({\n              conversation_id: conversationId,\n              user_id: user.id,\n              nickname: newNickname\n            }, {\n              onConflict: 'conversation_id,user_id'\n            }),\n            error = _yield$supabase$from$2.error;\n          if (error) throw error;\n        });\n        return function mutationFn(_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.nickname(conversationId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.conversations()\n        });\n      }\n    });\n    var resetMutation = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref4 = (0, _asyncToGenerator.default)(function* () {\n          if (!user) throw new Error('Not authenticated');\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('conversation_nicknames').delete().eq('conversation_id', conversationId).eq('user_id', user.id),\n            error = _yield$supabase$from$3.error;\n          if (error) throw error;\n        });\n        return function mutationFn() {\n          return _ref4.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.nickname(conversationId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.conversations()\n        });\n      }\n    });\n    var isCustom = nickname !== null;\n    var displayName = nickname ?? defaultNickname;\n    return {\n      displayName,\n      isCustom,\n      isLoading,\n      rename: renameMutation.mutate,\n      resetToDefault: resetMutation.mutate,\n      isRenaming: renameMutation.isPending || resetMutation.isPending\n    };\n  };\n  _s(useConversationNickname, \"b4ExxgWnOU33xub+GaMh1UfQiRA=\", false, function () {\n    return [_contextAuthProvider.useAuth, _tanstackReactQuery.useQueryClient, _tanstackReactQuery.useQuery, _tanstackReactQuery.useMutation, _tanstackReactQuery.useMutation];\n  });\n  var _default = useConversationNickname;\n});","lineCount":120,"map":[[13,2,104,0,"Object"],[13,8,104,0],[13,9,104,0,"defineProperty"],[13,23,104,0],[13,24,104,0,"exports"],[13,31,104,0],[14,4,104,0,"enumerable"],[14,14,104,0],[15,4,104,0,"get"],[15,7,104,0],[15,18,104,0,"get"],[15,19,104,0],[16,6,104,0],[16,13,104,0,"_default"],[16,21,104,0],[17,4,104,0],[18,2,104,0],[19,2,104,39],[19,6,104,39,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,104,39],[19,45,104,39,"require"],[19,52,104,39],[19,53,104,39,"_dependencyMap"],[19,67,104,39],[20,2,104,39],[20,6,104,39,"_asyncToGenerator"],[20,23,104,39],[20,26,104,39,"_interopDefault"],[20,41,104,39],[20,42,104,39,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,104,39],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_contextAuthProvider"],[23,26,3,0],[23,29,3,0,"require"],[23,36,3,0],[23,37,3,0,"_dependencyMap"],[23,51,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[31,2,17,0],[31,6,17,6,"useConversationNickname"],[31,29,17,29],[31,32,17,32,"_ref"],[31,36,17,32],[31,40,20,38],[32,4,20,38,"_s"],[32,6,20,38],[33,4,20,38],[33,8,18,2,"conversationId"],[33,22,18,16],[33,25,18,16,"_ref"],[33,29,18,16],[33,30,18,2,"conversationId"],[33,44,18,16],[34,6,19,2,"defaultNickname"],[34,21,19,17],[34,24,19,17,"_ref"],[34,28,19,17],[34,29,19,2,"defaultNickname"],[34,44,19,17],[35,4,21,2],[35,8,21,2,"_useAuth"],[35,16,21,2],[35,19,21,19],[35,23,21,19,"useAuth"],[35,43,21,26],[35,44,21,26,"useAuth"],[35,51,21,26],[35,53,21,27],[35,54,21,28],[36,6,21,10,"user"],[36,10,21,14],[36,13,21,14,"_useAuth"],[36,21,21,14],[36,22,21,10,"user"],[36,26,21,14],[37,4,22,2],[37,8,22,8,"queryClient"],[37,19,22,19],[37,22,22,22],[37,26,22,22,"useQueryClient"],[37,45,22,36],[37,46,22,36,"useQueryClient"],[37,60,22,36],[37,62,22,37],[37,63,22,38],[38,4,24,2],[38,8,24,2,"_useQuery"],[38,17,24,2],[38,20,24,40],[38,24,24,40,"useQuery"],[38,43,24,48],[38,44,24,48,"useQuery"],[38,52,24,48],[38,54,24,49],[39,8,25,4,"queryKey"],[39,16,25,12],[39,18,25,14,"chatKeys"],[39,28,25,22],[39,29,25,22,"chatKeys"],[39,37,25,22],[39,38,25,23,"nickname"],[39,46,25,31],[39,47,25,32,"conversationId"],[39,61,25,46],[39,62,25,47],[40,8,26,4,"queryFn"],[40,15,26,11],[41,10,26,11],[41,14,26,11,"_ref2"],[41,19,26,11],[41,26,26,11,"_asyncToGenerator"],[41,43,26,11],[41,44,26,11,"default"],[41,51,26,11],[41,53,26,13],[41,66,26,49],[42,12,27,6],[42,16,27,10],[42,17,27,11,"user"],[42,21,27,15],[42,23,27,17],[42,30,27,24],[42,34,27,28],[43,12,29,6],[43,16,29,6,"_yield$supabase$from$"],[43,37,29,6],[43,46,29,36,"supabase"],[43,58,29,44],[43,59,29,44,"supabase"],[43,67,29,44],[43,68,30,9,"from"],[43,72,30,13],[43,73,30,14],[43,97,30,38],[43,98,30,39],[43,99,31,9,"select"],[43,105,31,15],[43,106,31,16],[43,116,31,26],[43,117,31,27],[43,118,32,9,"eq"],[43,120,32,11],[43,121,32,12],[43,138,32,29],[43,140,32,31,"conversationId"],[43,154,32,45],[43,155,32,46],[43,156,33,9,"eq"],[43,158,33,11],[43,159,33,12],[43,168,33,21],[43,170,33,23,"user"],[43,174,33,27],[43,175,33,28,"id"],[43,177,33,30],[43,178,33,31],[43,179,34,9,"maybeSingle"],[43,190,34,20],[43,191,34,21],[43,192,34,22],[44,14,29,14,"data"],[44,18,29,18],[44,21,29,18,"_yield$supabase$from$"],[44,42,29,18],[44,43,29,14,"data"],[44,47,29,18],[45,14,29,20,"error"],[45,19,29,25],[45,22,29,25,"_yield$supabase$from$"],[45,43,29,25],[45,44,29,20,"error"],[45,49,29,25],[46,12,36,6],[46,16,36,10,"error"],[46,21,36,15],[46,23,36,17],[46,29,36,23,"error"],[46,34,36,28],[47,12,37,6],[47,19,37,13,"data"],[47,23,37,17],[47,25,37,19,"nickname"],[47,33,37,27],[47,37,37,31],[47,41,37,35],[48,10,38,4],[48,11,38,5],[49,10,38,5],[49,26,26,4,"queryFn"],[49,33,26,11,"queryFn"],[49,34,26,11],[50,12,26,11],[50,19,26,11,"_ref2"],[50,24,26,11],[50,25,26,11,"apply"],[50,30,26,11],[50,37,26,11,"arguments"],[50,46,26,11],[51,10,26,11],[52,8,26,11],[52,11,38,5],[53,8,39,4,"enabled"],[53,15,39,11],[53,17,39,13],[53,18,39,14],[53,19,39,15,"user"],[53,23,39,19],[53,27,39,23],[53,28,39,24],[53,29,39,25,"conversationId"],[54,6,40,2],[54,7,40,3],[54,8,40,4],[55,6,24,16,"nickname"],[55,14,24,24],[55,17,24,24,"_useQuery"],[55,26,24,24],[55,27,24,10,"data"],[55,31,24,14],[56,6,24,26,"isLoading"],[56,15,24,35],[56,18,24,35,"_useQuery"],[56,27,24,35],[56,28,24,26,"isLoading"],[56,37,24,35],[57,4,42,2],[57,8,42,8,"renameMutation"],[57,22,42,22],[57,25,42,25],[57,29,42,25,"useMutation"],[57,48,42,36],[57,49,42,36,"useMutation"],[57,60,42,36],[57,62,42,37],[58,6,43,4,"mutationFn"],[58,16,43,14],[59,8,43,14],[59,12,43,14,"_ref3"],[59,17,43,14],[59,24,43,14,"_asyncToGenerator"],[59,41,43,14],[59,42,43,14,"default"],[59,49,43,14],[59,51,43,16],[59,62,43,23,"newNickname"],[59,73,43,42],[59,75,43,47],[60,10,44,6],[60,14,44,10],[60,15,44,11,"user"],[60,19,44,15],[60,21,44,17],[60,27,44,23],[60,31,44,27,"Error"],[60,36,44,32],[60,37,44,33],[60,56,44,52],[60,57,44,53],[61,10,46,6],[61,14,46,6,"_yield$supabase$from$2"],[61,36,46,6],[61,45,46,30,"supabase"],[61,57,46,38],[61,58,46,38,"supabase"],[61,66,46,38],[61,67,47,9,"from"],[61,71,47,13],[61,72,47,14],[61,96,47,38],[61,97,47,39],[61,98,48,9,"upsert"],[61,104,48,15],[61,105,49,10],[62,14,50,12,"conversation_id"],[62,29,50,27],[62,31,50,29,"conversationId"],[62,45,50,43],[63,14,51,12,"user_id"],[63,21,51,19],[63,23,51,21,"user"],[63,27,51,25],[63,28,51,26,"id"],[63,30,51,28],[64,14,52,12,"nickname"],[64,22,52,20],[64,24,52,22,"newNickname"],[65,12,53,10],[65,13,53,11],[65,15,54,10],[66,14,54,12,"onConflict"],[66,24,54,22],[66,26,54,24],[67,12,54,50],[67,13,55,8],[67,14,55,9],[68,12,46,14,"error"],[68,17,46,19],[68,20,46,19,"_yield$supabase$from$2"],[68,42,46,19],[68,43,46,14,"error"],[68,48,46,19],[69,10,57,6],[69,14,57,10,"error"],[69,19,57,15],[69,21,57,17],[69,27,57,23,"error"],[69,32,57,28],[70,8,58,4],[70,9,58,5],[71,8,58,5],[71,24,43,4,"mutationFn"],[71,34,43,14,"mutationFn"],[71,35,43,14,"_x"],[71,37,43,14],[72,10,43,14],[72,17,43,14,"_ref3"],[72,22,43,14],[72,23,43,14,"apply"],[72,28,43,14],[72,35,43,14,"arguments"],[72,44,43,14],[73,8,43,14],[74,6,43,14],[74,9,58,5],[75,6,59,4,"onSuccess"],[75,15,59,13],[75,17,59,15,"onSuccess"],[75,18,59,15],[75,23,59,21],[76,8,60,6,"queryClient"],[76,19,60,17],[76,20,60,18,"invalidateQueries"],[76,37,60,35],[76,38,60,36],[77,10,61,8,"queryKey"],[77,18,61,16],[77,20,61,18,"chatKeys"],[77,30,61,26],[77,31,61,26,"chatKeys"],[77,39,61,26],[77,40,61,27,"nickname"],[77,48,61,35],[77,49,61,36,"conversationId"],[77,63,61,50],[78,8,62,6],[78,9,62,7],[78,10,62,8],[79,8,63,6,"queryClient"],[79,19,63,17],[79,20,63,18,"invalidateQueries"],[79,37,63,35],[79,38,63,36],[80,10,64,8,"queryKey"],[80,18,64,16],[80,20,64,18,"chatKeys"],[80,30,64,26],[80,31,64,26,"chatKeys"],[80,39,64,26],[80,40,64,27,"conversations"],[80,53,64,40],[80,54,64,41],[81,8,65,6],[81,9,65,7],[81,10,65,8],[82,6,66,4],[83,4,67,2],[83,5,67,3],[83,6,67,4],[84,4,69,2],[84,8,69,8,"resetMutation"],[84,21,69,21],[84,24,69,24],[84,28,69,24,"useMutation"],[84,47,69,35],[84,48,69,35,"useMutation"],[84,59,69,35],[84,61,69,36],[85,6,70,4,"mutationFn"],[85,16,70,14],[86,8,70,14],[86,12,70,14,"_ref4"],[86,17,70,14],[86,24,70,14,"_asyncToGenerator"],[86,41,70,14],[86,42,70,14,"default"],[86,49,70,14],[86,51,70,16],[86,64,70,28],[87,10,71,6],[87,14,71,10],[87,15,71,11,"user"],[87,19,71,15],[87,21,71,17],[87,27,71,23],[87,31,71,27,"Error"],[87,36,71,32],[87,37,71,33],[87,56,71,52],[87,57,71,53],[88,10,73,6],[88,14,73,6,"_yield$supabase$from$3"],[88,36,73,6],[88,45,73,30,"supabase"],[88,57,73,38],[88,58,73,38,"supabase"],[88,66,73,38],[88,67,74,9,"from"],[88,71,74,13],[88,72,74,14],[88,96,74,38],[88,97,74,39],[88,98,75,9,"delete"],[88,104,75,15],[88,105,75,16],[88,106,75,17],[88,107,76,9,"eq"],[88,109,76,11],[88,110,76,12],[88,127,76,29],[88,129,76,31,"conversationId"],[88,143,76,45],[88,144,76,46],[88,145,77,9,"eq"],[88,147,77,11],[88,148,77,12],[88,157,77,21],[88,159,77,23,"user"],[88,163,77,27],[88,164,77,28,"id"],[88,166,77,30],[88,167,77,31],[89,12,73,14,"error"],[89,17,73,19],[89,20,73,19,"_yield$supabase$from$3"],[89,42,73,19],[89,43,73,14,"error"],[89,48,73,19],[90,10,79,6],[90,14,79,10,"error"],[90,19,79,15],[90,21,79,17],[90,27,79,23,"error"],[90,32,79,28],[91,8,80,4],[91,9,80,5],[92,8,80,5],[92,24,70,4,"mutationFn"],[92,34,70,14,"mutationFn"],[92,35,70,14],[93,10,70,14],[93,17,70,14,"_ref4"],[93,22,70,14],[93,23,70,14,"apply"],[93,28,70,14],[93,35,70,14,"arguments"],[93,44,70,14],[94,8,70,14],[95,6,70,14],[95,9,80,5],[96,6,81,4,"onSuccess"],[96,15,81,13],[96,17,81,15,"onSuccess"],[96,18,81,15],[96,23,81,21],[97,8,82,6,"queryClient"],[97,19,82,17],[97,20,82,18,"invalidateQueries"],[97,37,82,35],[97,38,82,36],[98,10,83,8,"queryKey"],[98,18,83,16],[98,20,83,18,"chatKeys"],[98,30,83,26],[98,31,83,26,"chatKeys"],[98,39,83,26],[98,40,83,27,"nickname"],[98,48,83,35],[98,49,83,36,"conversationId"],[98,63,83,50],[99,8,84,6],[99,9,84,7],[99,10,84,8],[100,8,85,6,"queryClient"],[100,19,85,17],[100,20,85,18,"invalidateQueries"],[100,37,85,35],[100,38,85,36],[101,10,86,8,"queryKey"],[101,18,86,16],[101,20,86,18,"chatKeys"],[101,30,86,26],[101,31,86,26,"chatKeys"],[101,39,86,26],[101,40,86,27,"conversations"],[101,53,86,40],[101,54,86,41],[102,8,87,6],[102,9,87,7],[102,10,87,8],[103,6,88,4],[104,4,89,2],[104,5,89,3],[104,6,89,4],[105,4,91,2],[105,8,91,8,"isCustom"],[105,16,91,16],[105,19,91,19,"nickname"],[105,27,91,27],[105,32,91,32],[105,36,91,36],[106,4,92,2],[106,8,92,8,"displayName"],[106,19,92,19],[106,22,92,22,"nickname"],[106,30,92,30],[106,34,92,34,"defaultNickname"],[106,49,92,49],[107,4,94,2],[107,11,94,9],[108,6,95,4,"displayName"],[108,17,95,15],[109,6,96,4,"isCustom"],[109,14,96,12],[110,6,97,4,"isLoading"],[110,15,97,13],[111,6,98,4,"rename"],[111,12,98,10],[111,14,98,12,"renameMutation"],[111,28,98,26],[111,29,98,27,"mutate"],[111,35,98,33],[112,6,99,4,"resetToDefault"],[112,20,99,18],[112,22,99,20,"resetMutation"],[112,35,99,33],[112,36,99,34,"mutate"],[112,42,99,40],[113,6,100,4,"isRenaming"],[113,16,100,14],[113,18,100,16,"renameMutation"],[113,32,100,30],[113,33,100,31,"isPending"],[113,42,100,40],[113,46,100,44,"resetMutation"],[113,59,100,57],[113,60,100,58,"isPending"],[114,4,101,2],[114,5,101,3],[115,2,102,0],[115,3,102,1],[116,2,102,2,"_s"],[116,4,102,2],[116,5,17,6,"useConversationNickname"],[116,28,17,29],[117,4,17,29],[117,12,21,19,"useAuth"],[117,32,21,26],[117,33,21,26,"useAuth"],[117,40,21,26],[117,42,22,22,"useQueryClient"],[117,61,22,36],[117,62,22,36,"useQueryClient"],[117,76,22,36],[117,78,24,40,"useQuery"],[117,97,24,48],[117,98,24,48,"useQuery"],[117,106,24,48],[117,108,42,25,"useMutation"],[117,127,42,36],[117,128,42,36,"useMutation"],[117,139,42,36],[117,141,69,24,"useMutation"],[117,160,69,35],[117,161,69,35,"useMutation"],[117,172,69,35],[118,2,69,35],[119,2,104,0],[119,6,104,0,"_default"],[119,14,104,0],[119,17,104,15,"useConversationNickname"],[119,40,104,38],[120,0,104,39],[120,3]],"functionMap":{"names":["<global>","useConversationNickname","useQuery$argument_0.queryFn","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess"],"mappings":"AAA;gCCgB;aCS;KDY;gBEK;KFe;eGC;KHO;gBEI;KFU;eGC;KHO;CDc"},"hasCjsExports":false},"type":"js/module"}]}