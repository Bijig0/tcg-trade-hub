{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":34,"index":34}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":35},"end":{"line":2,"column":55,"index":90}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":91},"end":{"line":3,"column":42,"index":133}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":134},"end":{"line":4,"column":46,"index":180}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Subscribes to Supabase Realtime for offer changes on a specific listing.\n   * - UPDATE on offers: invalidates the offers list, and on acceptance also\n   *   invalidates the listing detail and myListings queries.\n   * - INSERT on offers: new offer arrived, invalidates offers list.\n   */\n  var useRealtimeOfferUpdates = function useRealtimeOfferUpdates(listingId) {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    (0, _react.useEffect)(function () {\n      if (!listingId) return;\n      var channel = _libSupabase.supabase.channel(`offers:listing:${listingId}`).on('postgres_changes', {\n        event: 'UPDATE',\n        schema: 'public',\n        table: 'offers',\n        filter: `listing_id=eq.${listingId}`\n      }, function (payload) {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.offers(listingId)\n        });\n\n        // If an offer was accepted, the listing status also changed\n        if (payload.new.status === 'accepted') {\n          queryClient.invalidateQueries({\n            queryKey: _queryKeys.listingKeys.detail(listingId)\n          });\n          queryClient.invalidateQueries({\n            queryKey: _queryKeys.listingKeys.myListings()\n          });\n        }\n      }).on('postgres_changes', {\n        event: 'INSERT',\n        schema: 'public',\n        table: 'offers',\n        filter: `listing_id=eq.${listingId}`\n      }, function () {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.offers(listingId)\n        });\n      }).subscribe();\n      return function () {\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [listingId, queryClient]);\n  };\n  _s(useRealtimeOfferUpdates, \"aixO0mo1bdM1nWLRolCdKzppx/I=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient];\n  });\n  var _default = useRealtimeOfferUpdates;\n});","lineCount":67,"map":[[8,2,67,0,"Object"],[8,8,67,0],[8,9,67,0,"defineProperty"],[8,23,67,0],[8,24,67,0,"exports"],[8,31,67,0],[9,4,67,0,"enumerable"],[9,14,67,0],[10,4,67,0,"get"],[10,7,67,0],[10,18,67,0,"get"],[10,19,67,0],[11,6,67,0],[11,13,67,0,"_default"],[11,21,67,0],[12,4,67,0],[13,2,67,0],[14,2,1,0],[14,6,1,0,"_react"],[14,12,1,0],[14,15,1,0,"require"],[14,22,1,0],[14,23,1,0,"_dependencyMap"],[14,37,1,0],[15,2,2,0],[15,6,2,0,"_tanstackReactQuery"],[15,25,2,0],[15,28,2,0,"require"],[15,35,2,0],[15,36,2,0,"_dependencyMap"],[15,50,2,0],[16,2,3,0],[16,6,3,0,"_libSupabase"],[16,18,3,0],[16,21,3,0,"require"],[16,28,3,0],[16,29,3,0,"_dependencyMap"],[16,43,3,0],[17,2,4,0],[17,6,4,0,"_queryKeys"],[17,16,4,0],[17,19,4,0,"require"],[17,26,4,0],[17,27,4,0,"_dependencyMap"],[17,41,4,0],[18,2,7,0],[19,0,8,0],[20,0,9,0],[21,0,10,0],[22,0,11,0],[23,0,12,0],[24,2,13,0],[24,6,13,6,"useRealtimeOfferUpdates"],[24,29,13,29],[24,32,13,32],[24,41,13,6,"useRealtimeOfferUpdates"],[24,64,13,29,"useRealtimeOfferUpdates"],[24,65,13,33,"listingId"],[24,74,13,50],[24,76,13,55],[25,4,13,55,"_s"],[25,6,13,55],[26,4,14,2],[26,8,14,8,"queryClient"],[26,19,14,19],[26,22,14,22],[26,26,14,22,"useQueryClient"],[26,45,14,36],[26,46,14,36,"useQueryClient"],[26,60,14,36],[26,62,14,37],[26,63,14,38],[27,4,16,2],[27,8,16,2,"useEffect"],[27,14,16,11],[27,15,16,11,"useEffect"],[27,24,16,11],[27,26,16,12],[27,38,16,18],[28,6,17,4],[28,10,17,8],[28,11,17,9,"listingId"],[28,20,17,18],[28,22,17,20],[29,6,19,4],[29,10,19,10,"channel"],[29,17,19,17],[29,20,19,20,"supabase"],[29,32,19,28],[29,33,19,28,"supabase"],[29,41,19,28],[29,42,20,7,"channel"],[29,49,20,14],[29,50,20,15],[29,68,20,33,"listingId"],[29,77,20,42],[29,79,20,44],[29,80,20,45],[29,81,21,7,"on"],[29,83,21,9],[29,84,22,8],[29,102,22,26],[29,104,23,8],[30,8,24,10,"event"],[30,13,24,15],[30,15,24,17],[30,23,24,25],[31,8,25,10,"schema"],[31,14,25,16],[31,16,25,18],[31,24,25,26],[32,8,26,10,"table"],[32,13,26,15],[32,15,26,17],[32,23,26,25],[33,8,27,10,"filter"],[33,14,27,16],[33,16,27,18],[33,33,27,35,"listingId"],[33,42,27,44],[34,6,28,8],[34,7,28,9],[34,9,29,8],[34,19,29,9,"payload"],[34,26,29,16],[34,28,29,21],[35,8,30,10,"queryClient"],[35,19,30,21],[35,20,30,22,"invalidateQueries"],[35,37,30,39],[35,38,30,40],[36,10,31,12,"queryKey"],[36,18,31,20],[36,20,31,22,"listingKeys"],[36,30,31,33],[36,31,31,33,"listingKeys"],[36,42,31,33],[36,43,31,34,"offers"],[36,49,31,40],[36,50,31,41,"listingId"],[36,59,31,50],[37,8,32,10],[37,9,32,11],[37,10,32,12],[39,8,34,10],[40,8,35,10],[40,12,35,14,"payload"],[40,19,35,21],[40,20,35,22,"new"],[40,23,35,25],[40,24,35,26,"status"],[40,30,35,32],[40,35,35,37],[40,45,35,47],[40,47,35,49],[41,10,36,12,"queryClient"],[41,21,36,23],[41,22,36,24,"invalidateQueries"],[41,39,36,41],[41,40,36,42],[42,12,37,14,"queryKey"],[42,20,37,22],[42,22,37,24,"listingKeys"],[42,32,37,35],[42,33,37,35,"listingKeys"],[42,44,37,35],[42,45,37,36,"detail"],[42,51,37,42],[42,52,37,43,"listingId"],[42,61,37,52],[43,10,38,12],[43,11,38,13],[43,12,38,14],[44,10,39,12,"queryClient"],[44,21,39,23],[44,22,39,24,"invalidateQueries"],[44,39,39,41],[44,40,39,42],[45,12,40,14,"queryKey"],[45,20,40,22],[45,22,40,24,"listingKeys"],[45,32,40,35],[45,33,40,35,"listingKeys"],[45,44,40,35],[45,45,40,36,"myListings"],[45,55,40,46],[45,56,40,47],[46,10,41,12],[46,11,41,13],[46,12,41,14],[47,8,42,10],[48,6,43,8],[48,7,44,6],[48,8,44,7],[48,9,45,7,"on"],[48,11,45,9],[48,12,46,8],[48,30,46,26],[48,32,47,8],[49,8,48,10,"event"],[49,13,48,15],[49,15,48,17],[49,23,48,25],[50,8,49,10,"schema"],[50,14,49,16],[50,16,49,18],[50,24,49,26],[51,8,50,10,"table"],[51,13,50,15],[51,15,50,17],[51,23,50,25],[52,8,51,10,"filter"],[52,14,51,16],[52,16,51,18],[52,33,51,35,"listingId"],[52,42,51,44],[53,6,52,8],[53,7,52,9],[53,9,53,8],[53,21,53,14],[54,8,54,10,"queryClient"],[54,19,54,21],[54,20,54,22,"invalidateQueries"],[54,37,54,39],[54,38,54,40],[55,10,55,12,"queryKey"],[55,18,55,20],[55,20,55,22,"listingKeys"],[55,30,55,33],[55,31,55,33,"listingKeys"],[55,42,55,33],[55,43,55,34,"offers"],[55,49,55,40],[55,50,55,41,"listingId"],[55,59,55,50],[56,8,56,10],[56,9,56,11],[56,10,56,12],[57,6,57,8],[57,7,58,6],[57,8,58,7],[57,9,59,7,"subscribe"],[57,18,59,16],[57,19,59,17],[57,20,59,18],[58,6,61,4],[58,13,61,11],[58,25,61,17],[59,8,62,6,"supabase"],[59,20,62,14],[59,21,62,14,"supabase"],[59,29,62,14],[59,30,62,15,"removeChannel"],[59,43,62,28],[59,44,62,29,"channel"],[59,51,62,36],[59,52,62,37],[60,6,63,4],[60,7,63,5],[61,4,64,2],[61,5,64,3],[61,7,64,5],[61,8,64,6,"listingId"],[61,17,64,15],[61,19,64,17,"queryClient"],[61,30,64,28],[61,31,64,29],[61,32,64,30],[62,2,65,0],[62,3,65,1],[63,2,65,2,"_s"],[63,4,65,2],[63,5,13,6,"useRealtimeOfferUpdates"],[63,28,13,29],[64,4,13,29],[64,12,14,22,"useQueryClient"],[64,31,14,36],[64,32,14,36,"useQueryClient"],[64,46,14,36],[65,2,14,36],[66,2,67,0],[66,6,67,0,"_default"],[66,14,67,0],[66,17,67,15,"useRealtimeOfferUpdates"],[66,40,67,38],[67,0,67,39],[67,3]],"functionMap":{"names":["<global>","useRealtimeOfferUpdates","useEffect$argument_0","supabase.channel.on$argument_2","supabase.channel.on.on$argument_2","<anonymous>"],"mappings":"AAA;gCCY;YCG;QCa;SDc;QEU;SFI;WGI;KHE;GDC;CDC"},"hasCjsExports":false},"type":"js/module"}]}