{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":78,"index":78}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":79},"end":{"line":2,"column":42,"index":121}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":122},"end":{"line":3,"column":49,"index":171}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":172},"end":{"line":4,"column":43,"index":215}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _libSupabase = require(_dependencyMap[2]);\n  var _contextAuthProvider = require(_dependencyMap[3]);\n  var _queryKeys = require(_dependencyMap[4]);\n  /**\n   * Manages per-user conversation nicknames.\n   *\n   * Returns the display name (custom nickname or default), plus rename/reset mutations.\n   * No row is auto-inserted â€” returns the default until the user explicitly renames.\n   */\n  var useConversationNickname = _ref => {\n    var conversationId = _ref.conversationId,\n      defaultNickname = _ref.defaultNickname;\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useQuery = (0, _tanstackReactQuery.useQuery)({\n        queryKey: _queryKeys.chatKeys.nickname(conversationId),\n        queryFn: function () {\n          var _ref2 = (0, _asyncToGenerator.default)(function* () {\n            if (!user) return null;\n            var _yield$supabase$from$ = yield _libSupabase.supabase.from('conversation_nicknames').select('nickname').eq('conversation_id', conversationId).eq('user_id', user.id).maybeSingle(),\n              data = _yield$supabase$from$.data,\n              error = _yield$supabase$from$.error;\n            if (error) throw error;\n            return data?.nickname ?? null;\n          });\n          return function queryFn() {\n            return _ref2.apply(this, arguments);\n          };\n        }(),\n        enabled: !!user && !!conversationId\n      }),\n      nickname = _useQuery.data,\n      isLoading = _useQuery.isLoading;\n    var renameMutation = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref3 = (0, _asyncToGenerator.default)(function* (newNickname) {\n          if (!user) throw new Error('Not authenticated');\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('conversation_nicknames').upsert({\n              conversation_id: conversationId,\n              user_id: user.id,\n              nickname: newNickname\n            }, {\n              onConflict: 'conversation_id,user_id'\n            }),\n            error = _yield$supabase$from$2.error;\n          if (error) throw error;\n        });\n        return function mutationFn(_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.nickname(conversationId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.conversations()\n        });\n      }\n    });\n    var resetMutation = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref4 = (0, _asyncToGenerator.default)(function* () {\n          if (!user) throw new Error('Not authenticated');\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('conversation_nicknames').delete().eq('conversation_id', conversationId).eq('user_id', user.id),\n            error = _yield$supabase$from$3.error;\n          if (error) throw error;\n        });\n        return function mutationFn() {\n          return _ref4.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.nickname(conversationId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.chatKeys.conversations()\n        });\n      }\n    });\n    var isCustom = nickname !== null;\n    var displayName = nickname ?? defaultNickname;\n    return {\n      displayName,\n      isCustom,\n      isLoading,\n      rename: renameMutation.mutate,\n      resetToDefault: resetMutation.mutate,\n      isRenaming: renameMutation.isPending || resetMutation.isPending\n    };\n  };\n  var _default = useConversationNickname;\n});","lineCount":115,"map":[[12,2,104,0,"Object"],[12,8,104,0],[12,9,104,0,"defineProperty"],[12,23,104,0],[12,24,104,0,"exports"],[12,31,104,0],[13,4,104,0,"enumerable"],[13,14,104,0],[14,4,104,0,"get"],[14,7,104,0],[14,18,104,0,"get"],[14,19,104,0],[15,6,104,0],[15,13,104,0,"_default"],[15,21,104,0],[16,4,104,0],[17,2,104,0],[18,2,104,39],[18,6,104,39,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,104,39],[18,45,104,39,"require"],[18,52,104,39],[18,53,104,39,"_dependencyMap"],[18,67,104,39],[19,2,104,39],[19,6,104,39,"_asyncToGenerator"],[19,23,104,39],[19,26,104,39,"_interopDefault"],[19,41,104,39],[19,42,104,39,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,104,39],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_libSupabase"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_contextAuthProvider"],[22,26,3,0],[22,29,3,0,"require"],[22,36,3,0],[22,37,3,0,"_dependencyMap"],[22,51,3,0],[23,2,4,0],[23,6,4,0,"_queryKeys"],[23,16,4,0],[23,19,4,0,"require"],[23,26,4,0],[23,27,4,0,"_dependencyMap"],[23,41,4,0],[24,2,11,0],[25,0,12,0],[26,0,13,0],[27,0,14,0],[28,0,15,0],[29,0,16,0],[30,2,17,0],[30,6,17,6,"useConversationNickname"],[30,29,17,29],[30,32,17,32,"_ref"],[30,36,17,32],[30,40,20,38],[31,4,20,38],[31,8,18,2,"conversationId"],[31,22,18,16],[31,25,18,16,"_ref"],[31,29,18,16],[31,30,18,2,"conversationId"],[31,44,18,16],[32,6,19,2,"defaultNickname"],[32,21,19,17],[32,24,19,17,"_ref"],[32,28,19,17],[32,29,19,2,"defaultNickname"],[32,44,19,17],[33,4,21,2],[33,8,21,2,"_useAuth"],[33,16,21,2],[33,19,21,19],[33,23,21,19,"useAuth"],[33,43,21,26],[33,44,21,26,"useAuth"],[33,51,21,26],[33,53,21,27],[33,54,21,28],[34,6,21,10,"user"],[34,10,21,14],[34,13,21,14,"_useAuth"],[34,21,21,14],[34,22,21,10,"user"],[34,26,21,14],[35,4,22,2],[35,8,22,8,"queryClient"],[35,19,22,19],[35,22,22,22],[35,26,22,22,"useQueryClient"],[35,45,22,36],[35,46,22,36,"useQueryClient"],[35,60,22,36],[35,62,22,37],[35,63,22,38],[36,4,24,2],[36,8,24,2,"_useQuery"],[36,17,24,2],[36,20,24,40],[36,24,24,40,"useQuery"],[36,43,24,48],[36,44,24,48,"useQuery"],[36,52,24,48],[36,54,24,49],[37,8,25,4,"queryKey"],[37,16,25,12],[37,18,25,14,"chatKeys"],[37,28,25,22],[37,29,25,22,"chatKeys"],[37,37,25,22],[37,38,25,23,"nickname"],[37,46,25,31],[37,47,25,32,"conversationId"],[37,61,25,46],[37,62,25,47],[38,8,26,4,"queryFn"],[38,15,26,11],[39,10,26,11],[39,14,26,11,"_ref2"],[39,19,26,11],[39,26,26,11,"_asyncToGenerator"],[39,43,26,11],[39,44,26,11,"default"],[39,51,26,11],[39,53,26,13],[39,66,26,49],[40,12,27,6],[40,16,27,10],[40,17,27,11,"user"],[40,21,27,15],[40,23,27,17],[40,30,27,24],[40,34,27,28],[41,12,29,6],[41,16,29,6,"_yield$supabase$from$"],[41,37,29,6],[41,46,29,36,"supabase"],[41,58,29,44],[41,59,29,44,"supabase"],[41,67,29,44],[41,68,30,9,"from"],[41,72,30,13],[41,73,30,14],[41,97,30,38],[41,98,30,39],[41,99,31,9,"select"],[41,105,31,15],[41,106,31,16],[41,116,31,26],[41,117,31,27],[41,118,32,9,"eq"],[41,120,32,11],[41,121,32,12],[41,138,32,29],[41,140,32,31,"conversationId"],[41,154,32,45],[41,155,32,46],[41,156,33,9,"eq"],[41,158,33,11],[41,159,33,12],[41,168,33,21],[41,170,33,23,"user"],[41,174,33,27],[41,175,33,28,"id"],[41,177,33,30],[41,178,33,31],[41,179,34,9,"maybeSingle"],[41,190,34,20],[41,191,34,21],[41,192,34,22],[42,14,29,14,"data"],[42,18,29,18],[42,21,29,18,"_yield$supabase$from$"],[42,42,29,18],[42,43,29,14,"data"],[42,47,29,18],[43,14,29,20,"error"],[43,19,29,25],[43,22,29,25,"_yield$supabase$from$"],[43,43,29,25],[43,44,29,20,"error"],[43,49,29,25],[44,12,36,6],[44,16,36,10,"error"],[44,21,36,15],[44,23,36,17],[44,29,36,23,"error"],[44,34,36,28],[45,12,37,6],[45,19,37,13,"data"],[45,23,37,17],[45,25,37,19,"nickname"],[45,33,37,27],[45,37,37,31],[45,41,37,35],[46,10,38,4],[46,11,38,5],[47,10,38,5],[47,26,26,4,"queryFn"],[47,33,26,11,"queryFn"],[47,34,26,11],[48,12,26,11],[48,19,26,11,"_ref2"],[48,24,26,11],[48,25,26,11,"apply"],[48,30,26,11],[48,37,26,11,"arguments"],[48,46,26,11],[49,10,26,11],[50,8,26,11],[50,11,38,5],[51,8,39,4,"enabled"],[51,15,39,11],[51,17,39,13],[51,18,39,14],[51,19,39,15,"user"],[51,23,39,19],[51,27,39,23],[51,28,39,24],[51,29,39,25,"conversationId"],[52,6,40,2],[52,7,40,3],[52,8,40,4],[53,6,24,16,"nickname"],[53,14,24,24],[53,17,24,24,"_useQuery"],[53,26,24,24],[53,27,24,10,"data"],[53,31,24,14],[54,6,24,26,"isLoading"],[54,15,24,35],[54,18,24,35,"_useQuery"],[54,27,24,35],[54,28,24,26,"isLoading"],[54,37,24,35],[55,4,42,2],[55,8,42,8,"renameMutation"],[55,22,42,22],[55,25,42,25],[55,29,42,25,"useMutation"],[55,48,42,36],[55,49,42,36,"useMutation"],[55,60,42,36],[55,62,42,37],[56,6,43,4,"mutationFn"],[56,16,43,14],[57,8,43,14],[57,12,43,14,"_ref3"],[57,17,43,14],[57,24,43,14,"_asyncToGenerator"],[57,41,43,14],[57,42,43,14,"default"],[57,49,43,14],[57,51,43,16],[57,62,43,23,"newNickname"],[57,73,43,42],[57,75,43,47],[58,10,44,6],[58,14,44,10],[58,15,44,11,"user"],[58,19,44,15],[58,21,44,17],[58,27,44,23],[58,31,44,27,"Error"],[58,36,44,32],[58,37,44,33],[58,56,44,52],[58,57,44,53],[59,10,46,6],[59,14,46,6,"_yield$supabase$from$2"],[59,36,46,6],[59,45,46,30,"supabase"],[59,57,46,38],[59,58,46,38,"supabase"],[59,66,46,38],[59,67,47,9,"from"],[59,71,47,13],[59,72,47,14],[59,96,47,38],[59,97,47,39],[59,98,48,9,"upsert"],[59,104,48,15],[59,105,49,10],[60,14,50,12,"conversation_id"],[60,29,50,27],[60,31,50,29,"conversationId"],[60,45,50,43],[61,14,51,12,"user_id"],[61,21,51,19],[61,23,51,21,"user"],[61,27,51,25],[61,28,51,26,"id"],[61,30,51,28],[62,14,52,12,"nickname"],[62,22,52,20],[62,24,52,22,"newNickname"],[63,12,53,10],[63,13,53,11],[63,15,54,10],[64,14,54,12,"onConflict"],[64,24,54,22],[64,26,54,24],[65,12,54,50],[65,13,55,8],[65,14,55,9],[66,12,46,14,"error"],[66,17,46,19],[66,20,46,19,"_yield$supabase$from$2"],[66,42,46,19],[66,43,46,14,"error"],[66,48,46,19],[67,10,57,6],[67,14,57,10,"error"],[67,19,57,15],[67,21,57,17],[67,27,57,23,"error"],[67,32,57,28],[68,8,58,4],[68,9,58,5],[69,8,58,5],[69,24,43,4,"mutationFn"],[69,34,43,14,"mutationFn"],[69,35,43,14,"_x"],[69,37,43,14],[70,10,43,14],[70,17,43,14,"_ref3"],[70,22,43,14],[70,23,43,14,"apply"],[70,28,43,14],[70,35,43,14,"arguments"],[70,44,43,14],[71,8,43,14],[72,6,43,14],[72,9,58,5],[73,6,59,4,"onSuccess"],[73,15,59,13],[73,17,59,15,"onSuccess"],[73,18,59,15],[73,23,59,21],[74,8,60,6,"queryClient"],[74,19,60,17],[74,20,60,18,"invalidateQueries"],[74,37,60,35],[74,38,60,36],[75,10,61,8,"queryKey"],[75,18,61,16],[75,20,61,18,"chatKeys"],[75,30,61,26],[75,31,61,26,"chatKeys"],[75,39,61,26],[75,40,61,27,"nickname"],[75,48,61,35],[75,49,61,36,"conversationId"],[75,63,61,50],[76,8,62,6],[76,9,62,7],[76,10,62,8],[77,8,63,6,"queryClient"],[77,19,63,17],[77,20,63,18,"invalidateQueries"],[77,37,63,35],[77,38,63,36],[78,10,64,8,"queryKey"],[78,18,64,16],[78,20,64,18,"chatKeys"],[78,30,64,26],[78,31,64,26,"chatKeys"],[78,39,64,26],[78,40,64,27,"conversations"],[78,53,64,40],[78,54,64,41],[79,8,65,6],[79,9,65,7],[79,10,65,8],[80,6,66,4],[81,4,67,2],[81,5,67,3],[81,6,67,4],[82,4,69,2],[82,8,69,8,"resetMutation"],[82,21,69,21],[82,24,69,24],[82,28,69,24,"useMutation"],[82,47,69,35],[82,48,69,35,"useMutation"],[82,59,69,35],[82,61,69,36],[83,6,70,4,"mutationFn"],[83,16,70,14],[84,8,70,14],[84,12,70,14,"_ref4"],[84,17,70,14],[84,24,70,14,"_asyncToGenerator"],[84,41,70,14],[84,42,70,14,"default"],[84,49,70,14],[84,51,70,16],[84,64,70,28],[85,10,71,6],[85,14,71,10],[85,15,71,11,"user"],[85,19,71,15],[85,21,71,17],[85,27,71,23],[85,31,71,27,"Error"],[85,36,71,32],[85,37,71,33],[85,56,71,52],[85,57,71,53],[86,10,73,6],[86,14,73,6,"_yield$supabase$from$3"],[86,36,73,6],[86,45,73,30,"supabase"],[86,57,73,38],[86,58,73,38,"supabase"],[86,66,73,38],[86,67,74,9,"from"],[86,71,74,13],[86,72,74,14],[86,96,74,38],[86,97,74,39],[86,98,75,9,"delete"],[86,104,75,15],[86,105,75,16],[86,106,75,17],[86,107,76,9,"eq"],[86,109,76,11],[86,110,76,12],[86,127,76,29],[86,129,76,31,"conversationId"],[86,143,76,45],[86,144,76,46],[86,145,77,9,"eq"],[86,147,77,11],[86,148,77,12],[86,157,77,21],[86,159,77,23,"user"],[86,163,77,27],[86,164,77,28,"id"],[86,166,77,30],[86,167,77,31],[87,12,73,14,"error"],[87,17,73,19],[87,20,73,19,"_yield$supabase$from$3"],[87,42,73,19],[87,43,73,14,"error"],[87,48,73,19],[88,10,79,6],[88,14,79,10,"error"],[88,19,79,15],[88,21,79,17],[88,27,79,23,"error"],[88,32,79,28],[89,8,80,4],[89,9,80,5],[90,8,80,5],[90,24,70,4,"mutationFn"],[90,34,70,14,"mutationFn"],[90,35,70,14],[91,10,70,14],[91,17,70,14,"_ref4"],[91,22,70,14],[91,23,70,14,"apply"],[91,28,70,14],[91,35,70,14,"arguments"],[91,44,70,14],[92,8,70,14],[93,6,70,14],[93,9,80,5],[94,6,81,4,"onSuccess"],[94,15,81,13],[94,17,81,15,"onSuccess"],[94,18,81,15],[94,23,81,21],[95,8,82,6,"queryClient"],[95,19,82,17],[95,20,82,18,"invalidateQueries"],[95,37,82,35],[95,38,82,36],[96,10,83,8,"queryKey"],[96,18,83,16],[96,20,83,18,"chatKeys"],[96,30,83,26],[96,31,83,26,"chatKeys"],[96,39,83,26],[96,40,83,27,"nickname"],[96,48,83,35],[96,49,83,36,"conversationId"],[96,63,83,50],[97,8,84,6],[97,9,84,7],[97,10,84,8],[98,8,85,6,"queryClient"],[98,19,85,17],[98,20,85,18,"invalidateQueries"],[98,37,85,35],[98,38,85,36],[99,10,86,8,"queryKey"],[99,18,86,16],[99,20,86,18,"chatKeys"],[99,30,86,26],[99,31,86,26,"chatKeys"],[99,39,86,26],[99,40,86,27,"conversations"],[99,53,86,40],[99,54,86,41],[100,8,87,6],[100,9,87,7],[100,10,87,8],[101,6,88,4],[102,4,89,2],[102,5,89,3],[102,6,89,4],[103,4,91,2],[103,8,91,8,"isCustom"],[103,16,91,16],[103,19,91,19,"nickname"],[103,27,91,27],[103,32,91,32],[103,36,91,36],[104,4,92,2],[104,8,92,8,"displayName"],[104,19,92,19],[104,22,92,22,"nickname"],[104,30,92,30],[104,34,92,34,"defaultNickname"],[104,49,92,49],[105,4,94,2],[105,11,94,9],[106,6,95,4,"displayName"],[106,17,95,15],[107,6,96,4,"isCustom"],[107,14,96,12],[108,6,97,4,"isLoading"],[108,15,97,13],[109,6,98,4,"rename"],[109,12,98,10],[109,14,98,12,"renameMutation"],[109,28,98,26],[109,29,98,27,"mutate"],[109,35,98,33],[110,6,99,4,"resetToDefault"],[110,20,99,18],[110,22,99,20,"resetMutation"],[110,35,99,33],[110,36,99,34,"mutate"],[110,42,99,40],[111,6,100,4,"isRenaming"],[111,16,100,14],[111,18,100,16,"renameMutation"],[111,32,100,30],[111,33,100,31,"isPending"],[111,42,100,40],[111,46,100,44,"resetMutation"],[111,59,100,57],[111,60,100,58,"isPending"],[112,4,101,2],[112,5,101,3],[113,2,102,0],[113,3,102,1],[114,2,104,0],[114,6,104,0,"_default"],[114,14,104,0],[114,17,104,15,"useConversationNickname"],[114,40,104,38],[115,0,104,39],[115,3]],"functionMap":{"names":["<global>","useConversationNickname","useQuery$argument_0.queryFn","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess"],"mappings":"AAA;gCCgB;aCS;KDY;gBEK;KFe;eGC;KHO;gBEI;KFU;eGC;KHO;CDc"},"hasCjsExports":false},"type":"js/module"}]}