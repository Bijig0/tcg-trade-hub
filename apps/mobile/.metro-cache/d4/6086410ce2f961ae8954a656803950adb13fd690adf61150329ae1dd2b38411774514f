{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":43,"index":136}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Hook that fetches a single listing by ID with its items and owner information.\n   *\n   * Joins the `users` table to include owner display_name, avatar_url,\n   * rating_score, and total_trades alongside all listing fields.\n   * Also fetches listing_items and counts pending offers.\n   */\n  var useListingDetail = listingId => {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.feedKeys.detail(listingId),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          // Fetch listing with owner\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('listings').select(`\n          *,\n          owner:users!user_id (\n            display_name,\n            avatar_url,\n            rating_score,\n            total_trades\n          )\n        `).eq('id', listingId).single(),\n            data = _yield$supabase$from$.data,\n            error = _yield$supabase$from$.error;\n          if (error) throw error;\n\n          // Fetch listing items\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listing_items').select('*').eq('listing_id', listingId).order('created_at', {\n              ascending: true\n            }),\n            items = _yield$supabase$from$2.data,\n            itemsError = _yield$supabase$from$2.error;\n          if (itemsError) throw itemsError;\n\n          // Count pending offers\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('offers').select('id', {\n              count: 'exact',\n              head: true\n            }).eq('listing_id', listingId).eq('status', 'pending'),\n            count = _yield$supabase$from$3.count,\n            countError = _yield$supabase$from$3.error;\n          if (countError) throw countError;\n\n          // Supabase returns the joined user as an object under the alias `owner`\n          var listing = data;\n\n          // distance_km is not available from a direct query; default to 0\n          // The feed edge function normally provides this value\n          if (listing.distance_km === undefined) {\n            listing.distance_km = 0;\n          }\n          listing.items = items ?? [];\n          listing.offer_count = count ?? 0;\n          return listing;\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!listingId\n    });\n  };\n  _s(useListingDetail, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = useListingDetail;\n});","lineCount":91,"map":[[13,2,73,0,"Object"],[13,8,73,0],[13,9,73,0,"defineProperty"],[13,23,73,0],[13,24,73,0,"exports"],[13,31,73,0],[14,4,73,0,"enumerable"],[14,14,73,0],[15,4,73,0,"get"],[15,7,73,0],[15,18,73,0,"get"],[15,19,73,0],[16,6,73,0],[16,13,73,0,"_default"],[16,21,73,0],[17,4,73,0],[18,2,73,0],[19,2,73,32],[19,6,73,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,73,32],[19,45,73,32,"require"],[19,52,73,32],[19,53,73,32,"_dependencyMap"],[19,67,73,32],[20,2,73,32],[20,6,73,32,"_asyncToGenerator"],[20,23,73,32],[20,26,73,32,"_interopDefault"],[20,41,73,32],[20,42,73,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,73,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,7,0],[25,0,8,0],[26,0,9,0],[27,0,10,0],[28,0,11,0],[29,0,12,0],[30,0,13,0],[31,2,14,0],[31,6,14,6,"useListingDetail"],[31,22,14,22],[31,25,14,26,"listingId"],[31,34,14,43],[31,38,14,48],[32,4,14,48,"_s"],[32,6,14,48],[33,4,15,2],[33,11,15,9],[33,15,15,9,"useQuery"],[33,34,15,17],[33,35,15,17,"useQuery"],[33,43,15,17],[33,45,15,46],[34,6,16,4,"queryKey"],[34,14,16,12],[34,16,16,14,"feedKeys"],[34,26,16,22],[34,27,16,22,"feedKeys"],[34,35,16,22],[34,36,16,23,"detail"],[34,42,16,29],[34,43,16,30,"listingId"],[34,52,16,39],[34,53,16,40],[35,6,17,4,"queryFn"],[35,13,17,11],[36,8,17,11],[36,12,17,11,"_ref"],[36,16,17,11],[36,23,17,11,"_asyncToGenerator"],[36,40,17,11],[36,41,17,11,"default"],[36,48,17,11],[36,50,17,13],[36,63,17,25],[37,10,18,6],[38,10,19,6],[38,14,19,6,"_yield$supabase$from$"],[38,35,19,6],[38,44,19,36,"supabase"],[38,56,19,44],[38,57,19,44,"supabase"],[38,65,19,44],[38,66,20,9,"from"],[38,70,20,13],[38,71,20,14],[38,81,20,24],[38,82,20,25],[38,83,21,9,"select"],[38,89,21,15],[38,90,22,10],[39,0,23,0],[40,0,24,0],[41,0,25,0],[42,0,26,0],[43,0,27,0],[44,0,28,0],[45,0,29,0],[46,0,30,0],[46,9,31,8],[46,10,31,9],[46,11,32,9,"eq"],[46,13,32,11],[46,14,32,12],[46,18,32,16],[46,20,32,18,"listingId"],[46,29,32,27],[46,30,32,28],[46,31,33,9,"single"],[46,37,33,15],[46,38,33,16],[46,39,33,17],[47,12,19,14,"data"],[47,16,19,18],[47,19,19,18,"_yield$supabase$from$"],[47,40,19,18],[47,41,19,14,"data"],[47,45,19,18],[48,12,19,20,"error"],[48,17,19,25],[48,20,19,25,"_yield$supabase$from$"],[48,41,19,25],[48,42,19,20,"error"],[48,47,19,25],[49,10,35,6],[49,14,35,10,"error"],[49,19,35,15],[49,21,35,17],[49,27,35,23,"error"],[49,32,35,28],[51,10,37,6],[52,10,38,6],[52,14,38,6,"_yield$supabase$from$2"],[52,36,38,6],[52,45,38,55,"supabase"],[52,57,38,63],[52,58,38,63,"supabase"],[52,66,38,63],[52,67,39,9,"from"],[52,71,39,13],[52,72,39,14],[52,87,39,29],[52,88,39,30],[52,89,40,9,"select"],[52,95,40,15],[52,96,40,16],[52,99,40,19],[52,100,40,20],[52,101,41,9,"eq"],[52,103,41,11],[52,104,41,12],[52,116,41,24],[52,118,41,26,"listingId"],[52,127,41,35],[52,128,41,36],[52,129,42,9,"order"],[52,134,42,14],[52,135,42,15],[52,147,42,27],[52,149,42,29],[53,14,42,31,"ascending"],[53,23,42,40],[53,25,42,42],[54,12,42,47],[54,13,42,48],[54,14,42,49],[55,12,38,20,"items"],[55,17,38,25],[55,20,38,25,"_yield$supabase$from$2"],[55,42,38,25],[55,43,38,14,"data"],[55,47,38,18],[56,12,38,34,"itemsError"],[56,22,38,44],[56,25,38,44,"_yield$supabase$from$2"],[56,47,38,44],[56,48,38,27,"error"],[56,53,38,32],[57,10,44,6],[57,14,44,10,"itemsError"],[57,24,44,20],[57,26,44,22],[57,32,44,28,"itemsError"],[57,42,44,38],[59,10,46,6],[60,10,47,6],[60,14,47,6,"_yield$supabase$from$3"],[60,36,47,6],[60,45,47,49,"supabase"],[60,57,47,57],[60,58,47,57,"supabase"],[60,66,47,57],[60,67,48,9,"from"],[60,71,48,13],[60,72,48,14],[60,80,48,22],[60,81,48,23],[60,82,49,9,"select"],[60,88,49,15],[60,89,49,16],[60,93,49,20],[60,95,49,22],[61,14,49,24,"count"],[61,19,49,29],[61,21,49,31],[61,28,49,38],[62,14,49,40,"head"],[62,18,49,44],[62,20,49,46],[63,12,49,51],[63,13,49,52],[63,14,49,53],[63,15,50,9,"eq"],[63,17,50,11],[63,18,50,12],[63,30,50,24],[63,32,50,26,"listingId"],[63,41,50,35],[63,42,50,36],[63,43,51,9,"eq"],[63,45,51,11],[63,46,51,12],[63,54,51,20],[63,56,51,22],[63,65,51,31],[63,66,51,32],[64,12,47,14,"count"],[64,17,47,19],[64,20,47,19,"_yield$supabase$from$3"],[64,42,47,19],[64,43,47,14,"count"],[64,48,47,19],[65,12,47,28,"countError"],[65,22,47,38],[65,25,47,38,"_yield$supabase$from$3"],[65,47,47,38],[65,48,47,21,"error"],[65,53,47,26],[66,10,53,6],[66,14,53,10,"countError"],[66,24,53,20],[66,26,53,22],[66,32,53,28,"countError"],[66,42,53,38],[68,10,55,6],[69,10,56,6],[69,14,56,12,"listing"],[69,21,56,19],[69,24,56,22,"data"],[69,28,56,60],[71,10,58,6],[72,10,59,6],[73,10,60,6],[73,14,60,10,"listing"],[73,21,60,17],[73,22,60,18,"distance_km"],[73,33,60,29],[73,38,60,34,"undefined"],[73,47,60,43],[73,49,60,45],[74,12,61,9,"listing"],[74,19,61,16],[74,20,61,45,"distance_km"],[74,31,61,56],[74,34,61,59],[74,35,61,60],[75,10,62,6],[76,10,64,7,"listing"],[76,17,64,14],[76,18,64,43,"items"],[76,23,64,48],[76,26,64,52,"items"],[76,31,64,57],[76,35,64,61],[76,37,64,84],[77,10,65,7,"listing"],[77,17,65,14],[77,18,65,43,"offer_count"],[77,29,65,54],[77,32,65,57,"count"],[77,37,65,62],[77,41,65,66],[77,42,65,67],[78,10,67,6],[78,17,67,13,"listing"],[78,24,67,20],[79,8,68,4],[79,9,68,5],[80,8,68,5],[80,24,17,4,"queryFn"],[80,31,17,11,"queryFn"],[80,32,17,11],[81,10,17,11],[81,17,17,11,"_ref"],[81,21,17,11],[81,22,17,11,"apply"],[81,27,17,11],[81,34,17,11,"arguments"],[81,43,17,11],[82,8,17,11],[83,6,17,11],[83,9,68,5],[84,6,69,4,"enabled"],[84,13,69,11],[84,15,69,13],[84,16,69,14],[84,17,69,15,"listingId"],[85,4,70,2],[85,5,70,3],[85,6,70,4],[86,2,71,0],[86,3,71,1],[87,2,71,2,"_s"],[87,4,71,2],[87,5,14,6,"useListingDetail"],[87,21,14,22],[88,4,14,22],[88,12,15,9,"useQuery"],[88,31,15,17],[88,32,15,17,"useQuery"],[88,40,15,17],[89,2,15,17],[90,2,73,0],[90,6,73,0,"_default"],[90,14,73,0],[90,17,73,15,"useListingDetail"],[90,33,73,31],[91,0,73,32],[91,3]],"functionMap":{"names":["<global>","useListingDetail","useQuery$argument_0.queryFn"],"mappings":"AAA;yBCa;aCG;KDmD;CDG"},"hasCjsExports":false},"type":"js/module"}]}