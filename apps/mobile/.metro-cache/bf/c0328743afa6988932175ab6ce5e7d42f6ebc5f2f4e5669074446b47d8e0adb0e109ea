{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var CONDITION_RANK = {\n    nm: 5,\n    lp: 4,\n    mp: 3,\n    hp: 2,\n    dmg: 1\n  };\n\n  /**\n   * Finds cards from a user's collection that satisfy the other party's trade wants.\n   * Used by MatchConfirmSheet to auto-select cards for a quick match.\n   *\n   * @param theirTradeWants - What the other person is looking for\n   * @param myCollection - Current user's tradeable collection items\n   * @returns Collection items that satisfy at least one trade want\n   */\n  var findMatchingCollectionCards = function findMatchingCollectionCards(theirTradeWants, myCollection) {\n    if (theirTradeWants.length === 0 || myCollection.length === 0) return [];\n    var matchedIds = new Set();\n    var matched = [];\n    for (var want of theirTradeWants) {\n      for (var item of myCollection) {\n        if (matchedIds.has(item.id)) continue;\n        var isMatch = false;\n        switch (want.type) {\n          case 'specific_card':\n            isMatch = item.external_id === want.card_external_id;\n            break;\n          case 'sealed':\n            if (!item.is_sealed) break;\n            if (want.product_type == null) {\n              isMatch = true;\n            } else {\n              isMatch = item.product_type === want.product_type;\n            }\n            break;\n          case 'slab':\n            if (item.grading_company == null) break;\n            if (want.grading_company != null && item.grading_company !== want.grading_company) break;\n            if (want.min_grade != null) {\n              var _item$grading_score;\n              var score = parseFloat((_item$grading_score = item.grading_score) != null ? _item$grading_score : '0');\n              isMatch = score >= want.min_grade;\n            } else {\n              isMatch = true;\n            }\n            break;\n          case 'raw_cards':\n            if (item.is_sealed || item.grading_company != null) break;\n            if (want.min_condition == null) {\n              isMatch = true;\n            } else {\n              var _CONDITION_RANK$item$, _CONDITION_RANK$want$;\n              var itemRank = (_CONDITION_RANK$item$ = CONDITION_RANK[item.condition]) != null ? _CONDITION_RANK$item$ : 0;\n              var minRank = (_CONDITION_RANK$want$ = CONDITION_RANK[want.min_condition]) != null ? _CONDITION_RANK$want$ : 0;\n              isMatch = itemRank >= minRank;\n            }\n            break;\n          case 'open_to_offers':\n            isMatch = true;\n            break;\n          case 'cash':\n          case 'custom':\n            // Not matchable against collection items\n            break;\n        }\n        if (isMatch) {\n          matchedIds.add(item.id);\n          matched.push(item);\n        }\n      }\n    }\n    return matched;\n  };\n  var _default = findMatchingCollectionCards;\n});","lineCount":88,"map":[[7,2,90,0,"Object"],[7,8,90,0],[7,9,90,0,"defineProperty"],[7,23,90,0],[7,24,90,0,"exports"],[7,31,90,0],[8,4,90,0,"enumerable"],[8,14,90,0],[9,4,90,0,"get"],[9,7,90,0],[9,18,90,0,"get"],[9,19,90,0],[10,6,90,0],[10,13,90,0,"_default"],[10,21,90,0],[11,4,90,0],[12,2,90,0],[13,2,3,0],[13,6,3,6,"CONDITION_RANK"],[13,20,3,44],[13,23,3,47],[14,4,4,2,"nm"],[14,6,4,4],[14,8,4,6],[14,9,4,7],[15,4,5,2,"lp"],[15,6,5,4],[15,8,5,6],[15,9,5,7],[16,4,6,2,"mp"],[16,6,6,4],[16,8,6,6],[16,9,6,7],[17,4,7,2,"hp"],[17,6,7,4],[17,8,7,6],[17,9,7,7],[18,4,8,2,"dmg"],[18,7,8,5],[18,9,8,7],[19,2,9,0],[19,3,9,1],[21,2,11,0],[22,0,12,0],[23,0,13,0],[24,0,14,0],[25,0,15,0],[26,0,16,0],[27,0,17,0],[28,0,18,0],[29,2,19,0],[29,6,19,6,"findMatchingCollectionCards"],[29,33,19,33],[29,36,19,36],[29,45,19,6,"findMatchingCollectionCards"],[29,72,19,33,"findMatchingCollectionCards"],[29,73,20,2,"theirTradeWants"],[29,88,20,30],[29,90,21,2,"myCollection"],[29,102,21,35],[29,104,22,26],[30,4,23,2],[30,8,23,6,"theirTradeWants"],[30,23,23,21],[30,24,23,22,"length"],[30,30,23,28],[30,35,23,33],[30,36,23,34],[30,40,23,38,"myCollection"],[30,52,23,50],[30,53,23,51,"length"],[30,59,23,57],[30,64,23,62],[30,65,23,63],[30,67,23,65],[30,74,23,72],[30,76,23,74],[31,4,25,2],[31,8,25,8,"matchedIds"],[31,18,25,18],[31,21,25,21],[31,25,25,25,"Set"],[31,28,25,28],[31,29,25,37],[31,30,25,38],[32,4,26,2],[32,8,26,8,"matched"],[32,15,26,36],[32,18,26,39],[32,20,26,41],[33,4,28,2],[33,9,28,7],[33,13,28,13,"want"],[33,17,28,17],[33,21,28,21,"theirTradeWants"],[33,36,28,36],[33,38,28,38],[34,6,29,4],[34,11,29,9],[34,15,29,15,"item"],[34,19,29,19],[34,23,29,23,"myCollection"],[34,35,29,35],[34,37,29,37],[35,8,30,6],[35,12,30,10,"matchedIds"],[35,22,30,20],[35,23,30,21,"has"],[35,26,30,24],[35,27,30,25,"item"],[35,31,30,29],[35,32,30,30,"id"],[35,34,30,32],[35,35,30,33],[35,37,30,35],[36,8,32,6],[36,12,32,10,"isMatch"],[36,19,32,17],[36,22,32,20],[36,27,32,25],[37,8,34,6],[37,16,34,14,"want"],[37,20,34,18],[37,21,34,19,"type"],[37,25,34,23],[38,10,35,8],[38,15,35,13],[38,30,35,28],[39,12,36,10,"isMatch"],[39,19,36,17],[39,22,36,20,"item"],[39,26,36,24],[39,27,36,25,"external_id"],[39,38,36,36],[39,43,36,41,"want"],[39,47,36,45],[39,48,36,46,"card_external_id"],[39,64,36,62],[40,12,37,10],[41,10,39,8],[41,15,39,13],[41,23,39,21],[42,12,40,10],[42,16,40,14],[42,17,40,15,"item"],[42,21,40,19],[42,22,40,20,"is_sealed"],[42,31,40,29],[42,33,40,31],[43,12,41,10],[43,16,41,14,"want"],[43,20,41,18],[43,21,41,19,"product_type"],[43,33,41,31],[43,37,41,35],[43,41,41,39],[43,43,41,41],[44,14,42,12,"isMatch"],[44,21,42,19],[44,24,42,22],[44,28,42,26],[45,12,43,10],[45,13,43,11],[45,19,43,17],[46,14,44,12,"isMatch"],[46,21,44,19],[46,24,44,22,"item"],[46,28,44,26],[46,29,44,27,"product_type"],[46,41,44,39],[46,46,44,44,"want"],[46,50,44,48],[46,51,44,49,"product_type"],[46,63,44,61],[47,12,45,10],[48,12,46,10],[49,10,48,8],[49,15,48,13],[49,21,48,19],[50,12,49,10],[50,16,49,14,"item"],[50,20,49,18],[50,21,49,19,"grading_company"],[50,36,49,34],[50,40,49,38],[50,44,49,42],[50,46,49,44],[51,12,50,10],[51,16,50,14,"want"],[51,20,50,18],[51,21,50,19,"grading_company"],[51,36,50,34],[51,40,50,38],[51,44,50,42],[51,48,50,46,"item"],[51,52,50,50],[51,53,50,51,"grading_company"],[51,68,50,66],[51,73,50,71,"want"],[51,77,50,75],[51,78,50,76,"grading_company"],[51,93,50,91],[51,95,50,93],[52,12,51,10],[52,16,51,14,"want"],[52,20,51,18],[52,21,51,19,"min_grade"],[52,30,51,28],[52,34,51,32],[52,38,51,36],[52,40,51,38],[53,14,51,38],[53,18,51,38,"_item$grading_score"],[53,37,51,38],[54,14,52,12],[54,18,52,18,"score"],[54,23,52,23],[54,26,52,26,"parseFloat"],[54,36,52,36],[54,38,52,36,"_item$grading_score"],[54,57,52,36],[54,60,52,37,"item"],[54,64,52,41],[54,65,52,42,"grading_score"],[54,78,52,55],[54,90,52,55,"_item$grading_score"],[54,109,52,55],[54,112,52,59],[54,115,52,62],[54,116,52,63],[55,14,53,12,"isMatch"],[55,21,53,19],[55,24,53,22,"score"],[55,29,53,27],[55,33,53,31,"want"],[55,37,53,35],[55,38,53,36,"min_grade"],[55,47,53,45],[56,12,54,10],[56,13,54,11],[56,19,54,17],[57,14,55,12,"isMatch"],[57,21,55,19],[57,24,55,22],[57,28,55,26],[58,12,56,10],[59,12,57,10],[60,10,59,8],[60,15,59,13],[60,26,59,24],[61,12,60,10],[61,16,60,14,"item"],[61,20,60,18],[61,21,60,19,"is_sealed"],[61,30,60,28],[61,34,60,32,"item"],[61,38,60,36],[61,39,60,37,"grading_company"],[61,54,60,52],[61,58,60,56],[61,62,60,60],[61,64,60,62],[62,12,61,10],[62,16,61,14,"want"],[62,20,61,18],[62,21,61,19,"min_condition"],[62,34,61,32],[62,38,61,36],[62,42,61,40],[62,44,61,42],[63,14,62,12,"isMatch"],[63,21,62,19],[63,24,62,22],[63,28,62,26],[64,12,63,10],[64,13,63,11],[64,19,63,17],[65,14,63,17],[65,18,63,17,"_CONDITION_RANK$item$"],[65,39,63,17],[65,41,63,17,"_CONDITION_RANK$want$"],[65,62,63,17],[66,14,64,12],[66,18,64,18,"itemRank"],[66,26,64,26],[66,30,64,26,"_CONDITION_RANK$item$"],[66,51,64,26],[66,54,64,29,"CONDITION_RANK"],[66,68,64,43],[66,69,64,44,"item"],[66,73,64,48],[66,74,64,49,"condition"],[66,83,64,58],[66,84,64,59],[66,96,64,59,"_CONDITION_RANK$item$"],[66,117,64,59],[66,120,64,63],[66,121,64,64],[67,14,65,12],[67,18,65,18,"minRank"],[67,25,65,25],[67,29,65,25,"_CONDITION_RANK$want$"],[67,50,65,25],[67,53,65,28,"CONDITION_RANK"],[67,67,65,42],[67,68,65,43,"want"],[67,72,65,47],[67,73,65,48,"min_condition"],[67,86,65,61],[67,87,65,62],[67,99,65,62,"_CONDITION_RANK$want$"],[67,120,65,62],[67,123,65,66],[67,124,65,67],[68,14,66,12,"isMatch"],[68,21,66,19],[68,24,66,22,"itemRank"],[68,32,66,30],[68,36,66,34,"minRank"],[68,43,66,41],[69,12,67,10],[70,12,68,10],[71,10,70,8],[71,15,70,13],[71,31,70,29],[72,12,71,10,"isMatch"],[72,19,71,17],[72,22,71,20],[72,26,71,24],[73,12,72,10],[74,10,74,8],[74,15,74,13],[74,21,74,19],[75,10,75,8],[75,15,75,13],[75,23,75,21],[76,12,76,10],[77,12,77,10],[78,8,78,6],[79,8,80,6],[79,12,80,10,"isMatch"],[79,19,80,17],[79,21,80,19],[80,10,81,8,"matchedIds"],[80,20,81,18],[80,21,81,19,"add"],[80,24,81,22],[80,25,81,23,"item"],[80,29,81,27],[80,30,81,28,"id"],[80,32,81,30],[80,33,81,31],[81,10,82,8,"matched"],[81,17,82,15],[81,18,82,16,"push"],[81,22,82,20],[81,23,82,21,"item"],[81,27,82,25],[81,28,82,26],[82,8,83,6],[83,6,84,4],[84,4,85,2],[85,4,87,2],[85,11,87,9,"matched"],[85,18,87,16],[86,2,88,0],[86,3,88,1],[87,2,90,0],[87,6,90,0,"_default"],[87,14,90,0],[87,17,90,15,"findMatchingCollectionCards"],[87,44,90,42],[88,0,90,43],[88,3]],"functionMap":{"names":["<global>","findMatchingCollectionCards"],"mappings":"AAA;oCCkB;CDqE"},"hasCjsExports":false},"type":"js/module"}]}