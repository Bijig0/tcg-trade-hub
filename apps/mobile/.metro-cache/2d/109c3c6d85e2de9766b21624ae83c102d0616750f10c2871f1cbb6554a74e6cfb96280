{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":49,"index":142}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":143},"end":{"line":4,"column":43,"index":186}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _contextAuthProvider = require(_dependencyMap[3], \"@/context/AuthProvider\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /** Fetches all conversations for the current user, sorted by most recent message */\n  var useConversations = function useConversations() {\n    _s();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.chatKeys.conversations(),\n      queryFn: function () {\n        var _queryFn = (0, _asyncToGenerator.default)(function* () {\n          if (!user) return [];\n\n          // Get conversations where the current user is part of the match\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('conversations').select(`\n          id,\n          match_id,\n          matches!inner (\n            id,\n            user_a_id,\n            user_b_id\n          )\n        `).or(`user_a_id.eq.${user.id},user_b_id.eq.${user.id}`, {\n              referencedTable: 'matches'\n            }),\n            conversations = _yield$supabase$from$.data,\n            error = _yield$supabase$from$.error;\n          if (error) throw error;\n          if (!conversations || conversations.length === 0) return [];\n          var results = [];\n          for (var conv of conversations) {\n            var _otherUserData$id, _otherUserData$displa, _otherUserData$avatar, _otherUserData$rating;\n            var match = conv.matches;\n            var otherUserId = match.user_a_id === user.id ? match.user_b_id : match.user_a_id;\n\n            // Fetch the other user's profile\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('users').select('id, display_name, avatar_url, rating_score').eq('id', otherUserId).single(),\n              otherUserData = _yield$supabase$from$2.data;\n\n            // Fetch the last message\n            var _yield$supabase$from$3 = yield _libSupabase.supabase.from('messages').select('body, type, created_at').eq('conversation_id', conv.id).order('created_at', {\n                ascending: false\n              }).limit(1).single(),\n              lastMessageData = _yield$supabase$from$3.data;\n            results.push({\n              conversationId: conv.id,\n              matchId: match.id,\n              otherUser: {\n                id: (_otherUserData$id = otherUserData == null ? void 0 : otherUserData.id) != null ? _otherUserData$id : otherUserId,\n                name: (_otherUserData$displa = otherUserData == null ? void 0 : otherUserData.display_name) != null ? _otherUserData$displa : 'Unknown',\n                avatar: (_otherUserData$avatar = otherUserData == null ? void 0 : otherUserData.avatar_url) != null ? _otherUserData$avatar : null,\n                rating: (_otherUserData$rating = otherUserData == null ? void 0 : otherUserData.rating_score) != null ? _otherUserData$rating : 0\n              },\n              lastMessage: lastMessageData ? {\n                body: lastMessageData.body,\n                type: lastMessageData.type,\n                createdAt: lastMessageData.created_at\n              } : null,\n              unreadCount: 0 // Placeholder until read receipts are implemented\n            });\n          }\n\n          // Sort by last message date descending (newest first)\n          results.sort(function (a, b) {\n            var _a$lastMessage$create, _a$lastMessage, _b$lastMessage$create, _b$lastMessage;\n            var dateA = (_a$lastMessage$create = (_a$lastMessage = a.lastMessage) == null ? void 0 : _a$lastMessage.createdAt) != null ? _a$lastMessage$create : '';\n            var dateB = (_b$lastMessage$create = (_b$lastMessage = b.lastMessage) == null ? void 0 : _b$lastMessage.createdAt) != null ? _b$lastMessage$create : '';\n            return dateB.localeCompare(dateA);\n          });\n          return results;\n        });\n        function queryFn() {\n          return _queryFn.apply(this, arguments);\n        }\n        return queryFn;\n      }(),\n      enabled: !!user\n    });\n  };\n  _s(useConversations, \"feBfegY2LWvVkHAo3/+H6/HJ9O4=\", false, function () {\n    return [_contextAuthProvider.useAuth, _tanstackReactQuery.useQuery];\n  });\n  var _default = useConversations;\n});","lineCount":106,"map":[[13,2,116,0,"Object"],[13,8,116,0],[13,9,116,0,"defineProperty"],[13,23,116,0],[13,24,116,0,"exports"],[13,31,116,0],[14,4,116,0,"enumerable"],[14,14,116,0],[15,4,116,0,"get"],[15,7,116,0],[15,18,116,0,"get"],[15,19,116,0],[16,6,116,0],[16,13,116,0,"_default"],[16,21,116,0],[17,4,116,0],[18,2,116,0],[19,2,116,32],[19,6,116,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,116,32],[19,45,116,32,"require"],[19,52,116,32],[19,53,116,32,"_dependencyMap"],[19,67,116,32],[20,2,116,32],[20,6,116,32,"_asyncToGenerator"],[20,23,116,32],[20,26,116,32,"_interopDefault"],[20,41,116,32],[20,42,116,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,116,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_contextAuthProvider"],[23,26,3,0],[23,29,3,0,"require"],[23,36,3,0],[23,37,3,0,"_dependencyMap"],[23,51,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,24,0],[26,2,25,0],[26,6,25,6,"useConversations"],[26,22,25,22],[26,25,25,25],[26,34,25,6,"useConversations"],[26,50,25,22,"useConversations"],[26,51,25,22],[26,53,25,31],[27,4,25,31,"_s"],[27,6,25,31],[28,4,26,2],[28,8,26,2,"_useAuth"],[28,16,26,2],[28,19,26,19],[28,23,26,19,"useAuth"],[28,43,26,26],[28,44,26,26,"useAuth"],[28,51,26,26],[28,53,26,27],[28,54,26,28],[29,6,26,10,"user"],[29,10,26,14],[29,13,26,14,"_useAuth"],[29,21,26,14],[29,22,26,10,"user"],[29,26,26,14],[30,4,28,2],[30,11,28,9],[30,15,28,9,"useQuery"],[30,34,28,17],[30,35,28,17,"useQuery"],[30,43,28,17],[30,45,28,18],[31,6,29,4,"queryKey"],[31,14,29,12],[31,16,29,14,"chatKeys"],[31,26,29,22],[31,27,29,22,"chatKeys"],[31,35,29,22],[31,36,29,23,"conversations"],[31,49,29,36],[31,50,29,37],[31,51,29,38],[32,6,30,4,"queryFn"],[32,13,30,11],[33,8,30,11],[33,12,30,11,"_queryFn"],[33,20,30,11],[33,27,30,11,"_asyncToGenerator"],[33,44,30,11],[33,45,30,11,"default"],[33,52,30,11],[33,54,30,13],[33,67,30,57],[34,10,31,6],[34,14,31,10],[34,15,31,11,"user"],[34,19,31,15],[34,21,31,17],[34,28,31,24],[34,30,31,26],[36,10,33,6],[37,10,34,6],[37,14,34,6,"_yield$supabase$from$"],[37,35,34,6],[37,44,34,51,"supabase"],[37,56,34,59],[37,57,34,59,"supabase"],[37,65,34,59],[37,66,35,9,"from"],[37,70,35,13],[37,71,35,14],[37,86,35,29],[37,87,35,30],[37,88,36,9,"select"],[37,94,36,15],[37,95,37,10],[38,0,38,0],[39,0,39,0],[40,0,40,0],[41,0,41,0],[42,0,42,0],[43,0,43,0],[44,0,44,0],[45,0,45,0],[45,9,46,8],[45,10,46,9],[45,11,47,9,"or"],[45,13,47,11],[45,14,48,10],[45,30,48,26,"user"],[45,34,48,30],[45,35,48,31,"id"],[45,37,48,33],[45,54,48,50,"user"],[45,58,48,54],[45,59,48,55,"id"],[45,61,48,57],[45,63,48,59],[45,65,49,10],[46,14,49,12,"referencedTable"],[46,29,49,27],[46,31,49,29],[47,12,49,39],[47,13,50,8],[47,14,50,9],[48,12,34,20,"conversations"],[48,25,34,33],[48,28,34,33,"_yield$supabase$from$"],[48,49,34,33],[48,50,34,14,"data"],[48,54,34,18],[49,12,34,35,"error"],[49,17,34,40],[49,20,34,40,"_yield$supabase$from$"],[49,41,34,40],[49,42,34,35,"error"],[49,47,34,40],[50,10,52,6],[50,14,52,10,"error"],[50,19,52,15],[50,21,52,17],[50,27,52,23,"error"],[50,32,52,28],[51,10,53,6],[51,14,53,10],[51,15,53,11,"conversations"],[51,28,53,24],[51,32,53,28,"conversations"],[51,45,53,41],[51,46,53,42,"length"],[51,52,53,48],[51,57,53,53],[51,58,53,54],[51,60,53,56],[51,67,53,63],[51,69,53,65],[52,10,55,6],[52,14,55,12,"results"],[52,21,55,42],[52,24,55,45],[52,26,55,47],[53,10,57,6],[53,15,57,11],[53,19,57,17,"conv"],[53,23,57,21],[53,27,57,25,"conversations"],[53,40,57,38],[53,42,57,40],[54,12,57,40],[54,16,57,40,"_otherUserData$id"],[54,33,57,40],[54,35,57,40,"_otherUserData$displa"],[54,56,57,40],[54,58,57,40,"_otherUserData$avatar"],[54,79,57,40],[54,81,57,40,"_otherUserData$rating"],[54,102,57,40],[55,12,58,8],[55,16,58,14,"match"],[55,21,58,19],[55,24,58,22,"conv"],[55,28,58,26],[55,29,58,27,"matches"],[55,36,62,9],[56,12,64,8],[56,16,64,14,"otherUserId"],[56,27,64,25],[56,30,65,10,"match"],[56,35,65,15],[56,36,65,16,"user_a_id"],[56,45,65,25],[56,50,65,30,"user"],[56,54,65,34],[56,55,65,35,"id"],[56,57,65,37],[56,60,65,40,"match"],[56,65,65,45],[56,66,65,46,"user_b_id"],[56,75,65,55],[56,78,65,58,"match"],[56,83,65,63],[56,84,65,64,"user_a_id"],[56,93,65,73],[58,12,67,8],[59,12,68,8],[59,16,68,8,"_yield$supabase$from$2"],[59,38,68,8],[59,47,68,46,"supabase"],[59,59,68,54],[59,60,68,54,"supabase"],[59,68,68,54],[59,69,69,11,"from"],[59,73,69,15],[59,74,69,16],[59,81,69,23],[59,82,69,24],[59,83,70,11,"select"],[59,89,70,17],[59,90,70,18],[59,134,70,62],[59,135,70,63],[59,136,71,11,"eq"],[59,138,71,13],[59,139,71,14],[59,143,71,18],[59,145,71,20,"otherUserId"],[59,156,71,31],[59,157,71,32],[59,158,72,11,"single"],[59,164,72,17],[59,165,72,18],[59,166,72,19],[60,14,68,22,"otherUserData"],[60,27,68,35],[60,30,68,35,"_yield$supabase$from$2"],[60,52,68,35],[60,53,68,16,"data"],[60,57,68,20],[62,12,74,8],[63,12,75,8],[63,16,75,8,"_yield$supabase$from$3"],[63,38,75,8],[63,47,75,48,"supabase"],[63,59,75,56],[63,60,75,56,"supabase"],[63,68,75,56],[63,69,76,11,"from"],[63,73,76,15],[63,74,76,16],[63,84,76,26],[63,85,76,27],[63,86,77,11,"select"],[63,92,77,17],[63,93,77,18],[63,117,77,42],[63,118,77,43],[63,119,78,11,"eq"],[63,121,78,13],[63,122,78,14],[63,139,78,31],[63,141,78,33,"conv"],[63,145,78,37],[63,146,78,38,"id"],[63,148,78,40],[63,149,78,41],[63,150,79,11,"order"],[63,155,79,16],[63,156,79,17],[63,168,79,29],[63,170,79,31],[64,16,79,33,"ascending"],[64,25,79,42],[64,27,79,44],[65,14,79,50],[65,15,79,51],[65,16,79,52],[65,17,80,11,"limit"],[65,22,80,16],[65,23,80,17],[65,24,80,18],[65,25,80,19],[65,26,81,11,"single"],[65,32,81,17],[65,33,81,18],[65,34,81,19],[66,14,75,22,"lastMessageData"],[66,29,75,37],[66,32,75,37,"_yield$supabase$from$3"],[66,54,75,37],[66,55,75,16,"data"],[66,59,75,20],[67,12,83,8,"results"],[67,19,83,15],[67,20,83,16,"push"],[67,24,83,20],[67,25,83,21],[68,14,84,10,"conversationId"],[68,28,84,24],[68,30,84,26,"conv"],[68,34,84,30],[68,35,84,31,"id"],[68,37,84,33],[69,14,85,10,"matchId"],[69,21,85,17],[69,23,85,19,"match"],[69,28,85,24],[69,29,85,25,"id"],[69,31,85,27],[70,14,86,10,"otherUser"],[70,23,86,19],[70,25,86,21],[71,16,87,12,"id"],[71,18,87,14],[71,21,87,14,"_otherUserData$id"],[71,38,87,14],[71,41,87,16,"otherUserData"],[71,54,87,29],[71,74,87,16,"otherUserData"],[71,87,87,29],[71,88,87,31,"id"],[71,90,87,33],[71,102,87,33,"_otherUserData$id"],[71,119,87,33],[71,122,87,37,"otherUserId"],[71,133,87,48],[72,16,88,12,"name"],[72,20,88,16],[72,23,88,16,"_otherUserData$displa"],[72,44,88,16],[72,47,88,18,"otherUserData"],[72,60,88,31],[72,80,88,18,"otherUserData"],[72,93,88,31],[72,94,88,33,"display_name"],[72,106,88,45],[72,118,88,45,"_otherUserData$displa"],[72,139,88,45],[72,142,88,49],[72,151,88,58],[73,16,89,12,"avatar"],[73,22,89,18],[73,25,89,18,"_otherUserData$avatar"],[73,46,89,18],[73,49,89,20,"otherUserData"],[73,62,89,33],[73,82,89,20,"otherUserData"],[73,95,89,33],[73,96,89,35,"avatar_url"],[73,106,89,45],[73,118,89,45,"_otherUserData$avatar"],[73,139,89,45],[73,142,89,49],[73,146,89,53],[74,16,90,12,"rating"],[74,22,90,18],[74,25,90,18,"_otherUserData$rating"],[74,46,90,18],[74,49,90,20,"otherUserData"],[74,62,90,33],[74,82,90,20,"otherUserData"],[74,95,90,33],[74,96,90,35,"rating_score"],[74,108,90,47],[74,120,90,47,"_otherUserData$rating"],[74,141,90,47],[74,144,90,51],[75,14,91,10],[75,15,91,11],[76,14,92,10,"lastMessage"],[76,25,92,21],[76,27,92,23,"lastMessageData"],[76,42,92,38],[76,45,93,14],[77,16,94,16,"body"],[77,20,94,20],[77,22,94,22,"lastMessageData"],[77,37,94,37],[77,38,94,38,"body"],[77,42,94,42],[78,16,95,16,"type"],[78,20,95,20],[78,22,95,22,"lastMessageData"],[78,37,95,37],[78,38,95,38,"type"],[78,42,95,42],[79,16,96,16,"createdAt"],[79,25,96,25],[79,27,96,27,"lastMessageData"],[79,42,96,42],[79,43,96,43,"created_at"],[80,14,97,14],[80,15,97,15],[80,18,98,14],[80,22,98,18],[81,14,99,10,"unreadCount"],[81,25,99,21],[81,27,99,23],[81,28,99,24],[81,29,99,26],[82,12,100,8],[82,13,100,9],[82,14,100,10],[83,10,101,6],[85,10,103,6],[86,10,104,6,"results"],[86,17,104,13],[86,18,104,14,"sort"],[86,22,104,18],[86,23,104,19],[86,33,104,20,"a"],[86,34,104,21],[86,36,104,23,"b"],[86,37,104,24],[86,39,104,29],[87,12,104,29],[87,16,104,29,"_a$lastMessage$create"],[87,37,104,29],[87,39,104,29,"_a$lastMessage"],[87,53,104,29],[87,55,104,29,"_b$lastMessage$create"],[87,76,104,29],[87,78,104,29,"_b$lastMessage"],[87,92,104,29],[88,12,105,8],[88,16,105,14,"dateA"],[88,21,105,19],[88,25,105,19,"_a$lastMessage$create"],[88,46,105,19],[88,50,105,19,"_a$lastMessage"],[88,64,105,19],[88,67,105,22,"a"],[88,68,105,23],[88,69,105,24,"lastMessage"],[88,80,105,35],[88,101,105,22,"_a$lastMessage"],[88,115,105,22],[88,116,105,37,"createdAt"],[88,125,105,46],[88,137,105,46,"_a$lastMessage$create"],[88,158,105,46],[88,161,105,50],[88,163,105,52],[89,12,106,8],[89,16,106,14,"dateB"],[89,21,106,19],[89,25,106,19,"_b$lastMessage$create"],[89,46,106,19],[89,50,106,19,"_b$lastMessage"],[89,64,106,19],[89,67,106,22,"b"],[89,68,106,23],[89,69,106,24,"lastMessage"],[89,80,106,35],[89,101,106,22,"_b$lastMessage"],[89,115,106,22],[89,116,106,37,"createdAt"],[89,125,106,46],[89,137,106,46,"_b$lastMessage$create"],[89,158,106,46],[89,161,106,50],[89,163,106,52],[90,12,107,8],[90,19,107,15,"dateB"],[90,24,107,20],[90,25,107,21,"localeCompare"],[90,38,107,34],[90,39,107,35,"dateA"],[90,44,107,40],[90,45,107,41],[91,10,108,6],[91,11,108,7],[91,12,108,8],[92,10,110,6],[92,17,110,13,"results"],[92,24,110,20],[93,8,111,4],[93,9,111,5],[94,8,111,5],[94,17,30,4,"queryFn"],[94,24,30,11,"queryFn"],[94,25,30,11],[95,10,30,11],[95,17,30,11,"_queryFn"],[95,25,30,11],[95,26,30,11,"apply"],[95,31,30,11],[95,38,30,11,"arguments"],[95,47,30,11],[96,8,30,11],[97,8,30,11],[97,15,30,4,"queryFn"],[97,22,30,11],[98,6,30,11],[98,9,111,5],[99,6,112,4,"enabled"],[99,13,112,11],[99,15,112,13],[99,16,112,14],[99,17,112,15,"user"],[100,4,113,2],[100,5,113,3],[100,6,113,4],[101,2,114,0],[101,3,114,1],[102,2,114,2,"_s"],[102,4,114,2],[102,5,25,6,"useConversations"],[102,21,25,22],[103,4,25,22],[103,12,26,19,"useAuth"],[103,32,26,26],[103,33,26,26,"useAuth"],[103,40,26,26],[103,42,28,9,"useQuery"],[103,61,28,17],[103,62,28,17,"useQuery"],[103,70,28,17],[104,2,28,17],[105,2,116,0],[105,6,116,0,"_default"],[105,14,116,0],[105,17,116,15,"useConversations"],[105,33,116,31],[106,0,116,32],[106,3]],"functionMap":{"names":["<global>","useConversations","useQuery$argument_0.queryFn","results.sort$argument_0"],"mappings":"AAA;yBCwB;aCK;mBC0E;ODI;KDG;CDG"},"hasCjsExports":false},"type":"js/module"}]}