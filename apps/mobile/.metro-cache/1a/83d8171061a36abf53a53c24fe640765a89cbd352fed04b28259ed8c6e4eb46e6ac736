{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":46,"index":139}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Hook that fetches a user's public profile by ID.\n   *\n   * Joins the active listings count and recent ratings with rater names.\n   */\n  var usePublicProfile = userId => {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.profileKeys.publicProfile(userId),\n      queryFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* () {\n          // Fetch user profile\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('users').select('id, display_name, avatar_url, preferred_tcgs, rating_score, total_trades, created_at').eq('id', userId).single(),\n            profile = _yield$supabase$from$.data,\n            profileError = _yield$supabase$from$.error;\n          if (profileError) throw profileError;\n          if (!profile) throw new Error('User not found');\n\n          // Count active listings\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listings').select('*', {\n              count: 'exact',\n              head: true\n            }).eq('user_id', userId).eq('status', 'active'),\n            count = _yield$supabase$from$2.count,\n            countError = _yield$supabase$from$2.error;\n          if (countError) throw countError;\n\n          // Fetch recent ratings\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('ratings').select('id, score, comment, created_at, rater_id').eq('ratee_id', userId).order('created_at', {\n              ascending: false\n            }).limit(10),\n            ratings = _yield$supabase$from$3.data,\n            ratingsError = _yield$supabase$from$3.error;\n          if (ratingsError) throw ratingsError;\n\n          // Resolve rater display names\n          var raterIds = [...new Set((ratings ?? []).map(r => r.rater_id))];\n          var ratersMap = new Map();\n          if (raterIds.length > 0) {\n            var _yield$supabase$from$4 = yield _libSupabase.supabase.from('users').select('id, display_name').in('id', raterIds),\n              raters = _yield$supabase$from$4.data;\n            ratersMap = new Map((raters ?? []).map(r => [r.id, r.display_name]));\n          }\n          var recentRatings = (ratings ?? []).map(r => ({\n            id: r.id,\n            score: r.score,\n            comment: r.comment,\n            created_at: r.created_at,\n            rater_display_name: ratersMap.get(r.rater_id) ?? 'Unknown'\n          }));\n          return {\n            ...profile,\n            active_listings_count: count ?? 0,\n            recent_ratings: recentRatings\n          };\n        });\n        return function queryFn() {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      enabled: !!userId\n    });\n  };\n  _s(usePublicProfile, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = usePublicProfile;\n});","lineCount":91,"map":[[13,2,87,0,"Object"],[13,8,87,0],[13,9,87,0,"defineProperty"],[13,23,87,0],[13,24,87,0,"exports"],[13,31,87,0],[14,4,87,0,"enumerable"],[14,14,87,0],[15,4,87,0,"get"],[15,7,87,0],[15,18,87,0,"get"],[15,19,87,0],[16,6,87,0],[16,13,87,0,"_default"],[16,21,87,0],[17,4,87,0],[18,2,87,0],[19,2,87,32],[19,6,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,87,32],[19,45,87,32,"require"],[19,52,87,32],[19,53,87,32,"_dependencyMap"],[19,67,87,32],[20,2,87,32],[20,6,87,32,"_asyncToGenerator"],[20,23,87,32],[20,26,87,32,"_interopDefault"],[20,41,87,32],[20,42,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,87,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,18,0],[25,0,19,0],[26,0,20,0],[27,0,21,0],[28,0,22,0],[29,2,23,0],[29,6,23,6,"usePublicProfile"],[29,22,23,22],[29,25,23,26,"userId"],[29,31,23,40],[29,35,23,45],[30,4,23,45,"_s"],[30,6,23,45],[31,4,24,2],[31,11,24,9],[31,15,24,9,"useQuery"],[31,34,24,17],[31,35,24,17,"useQuery"],[31,43,24,17],[31,45,24,40],[32,6,25,4,"queryKey"],[32,14,25,12],[32,16,25,14,"profileKeys"],[32,26,25,25],[32,27,25,25,"profileKeys"],[32,38,25,25],[32,39,25,26,"publicProfile"],[32,52,25,39],[32,53,25,40,"userId"],[32,59,25,46],[32,60,25,47],[33,6,26,4,"queryFn"],[33,13,26,11],[34,8,26,11],[34,12,26,11,"_ref"],[34,16,26,11],[34,23,26,11,"_asyncToGenerator"],[34,40,26,11],[34,41,26,11,"default"],[34,48,26,11],[34,50,26,13],[34,63,26,25],[35,10,27,6],[36,10,28,6],[36,14,28,6,"_yield$supabase$from$"],[36,35,28,6],[36,44,28,59,"supabase"],[36,56,28,67],[36,57,28,67,"supabase"],[36,65,28,67],[36,66,29,9,"from"],[36,70,29,13],[36,71,29,14],[36,78,29,21],[36,79,29,22],[36,80,30,9,"select"],[36,86,30,15],[36,87,30,16],[36,173,30,102],[36,174,30,103],[36,175,31,9,"eq"],[36,177,31,11],[36,178,31,12],[36,182,31,16],[36,184,31,18,"userId"],[36,190,31,24],[36,191,31,25],[36,192,32,9,"single"],[36,198,32,15],[36,199,32,16],[36,200,32,17],[37,12,28,20,"profile"],[37,19,28,27],[37,22,28,27,"_yield$supabase$from$"],[37,43,28,27],[37,44,28,14,"data"],[37,48,28,18],[38,12,28,36,"profileError"],[38,24,28,48],[38,27,28,48,"_yield$supabase$from$"],[38,48,28,48],[38,49,28,29,"error"],[38,54,28,34],[39,10,34,6],[39,14,34,10,"profileError"],[39,26,34,22],[39,28,34,24],[39,34,34,30,"profileError"],[39,46,34,42],[40,10,35,6],[40,14,35,10],[40,15,35,11,"profile"],[40,22,35,18],[40,24,35,20],[40,30,35,26],[40,34,35,30,"Error"],[40,39,35,35],[40,40,35,36],[40,56,35,52],[40,57,35,53],[42,10,37,6],[43,10,38,6],[43,14,38,6,"_yield$supabase$from$2"],[43,36,38,6],[43,45,38,49,"supabase"],[43,57,38,57],[43,58,38,57,"supabase"],[43,66,38,57],[43,67,39,9,"from"],[43,71,39,13],[43,72,39,14],[43,82,39,24],[43,83,39,25],[43,84,40,9,"select"],[43,90,40,15],[43,91,40,16],[43,94,40,19],[43,96,40,21],[44,14,40,23,"count"],[44,19,40,28],[44,21,40,30],[44,28,40,37],[45,14,40,39,"head"],[45,18,40,43],[45,20,40,45],[46,12,40,50],[46,13,40,51],[46,14,40,52],[46,15,41,9,"eq"],[46,17,41,11],[46,18,41,12],[46,27,41,21],[46,29,41,23,"userId"],[46,35,41,29],[46,36,41,30],[46,37,42,9,"eq"],[46,39,42,11],[46,40,42,12],[46,48,42,20],[46,50,42,22],[46,58,42,30],[46,59,42,31],[47,12,38,14,"count"],[47,17,38,19],[47,20,38,19,"_yield$supabase$from$2"],[47,42,38,19],[47,43,38,14,"count"],[47,48,38,19],[48,12,38,28,"countError"],[48,22,38,38],[48,25,38,38,"_yield$supabase$from$2"],[48,47,38,38],[48,48,38,21,"error"],[48,53,38,26],[49,10,44,6],[49,14,44,10,"countError"],[49,24,44,20],[49,26,44,22],[49,32,44,28,"countError"],[49,42,44,38],[51,10,46,6],[52,10,47,6],[52,14,47,6,"_yield$supabase$from$3"],[52,36,47,6],[52,45,47,59,"supabase"],[52,57,47,67],[52,58,47,67,"supabase"],[52,66,47,67],[52,67,48,9,"from"],[52,71,48,13],[52,72,48,14],[52,81,48,23],[52,82,48,24],[52,83,49,9,"select"],[52,89,49,15],[52,90,49,16],[52,132,49,58],[52,133,49,59],[52,134,50,9,"eq"],[52,136,50,11],[52,137,50,12],[52,147,50,22],[52,149,50,24,"userId"],[52,155,50,30],[52,156,50,31],[52,157,51,9,"order"],[52,162,51,14],[52,163,51,15],[52,175,51,27],[52,177,51,29],[53,14,51,31,"ascending"],[53,23,51,40],[53,25,51,42],[54,12,51,48],[54,13,51,49],[54,14,51,50],[54,15,52,9,"limit"],[54,20,52,14],[54,21,52,15],[54,23,52,17],[54,24,52,18],[55,12,47,20,"ratings"],[55,19,47,27],[55,22,47,27,"_yield$supabase$from$3"],[55,44,47,27],[55,45,47,14,"data"],[55,49,47,18],[56,12,47,36,"ratingsError"],[56,24,47,48],[56,27,47,48,"_yield$supabase$from$3"],[56,49,47,48],[56,50,47,29,"error"],[56,55,47,34],[57,10,54,6],[57,14,54,10,"ratingsError"],[57,26,54,22],[57,28,54,24],[57,34,54,30,"ratingsError"],[57,46,54,42],[59,10,56,6],[60,10,57,6],[60,14,57,12,"raterIds"],[60,22,57,20],[60,25,57,23],[60,26,57,24],[60,29,57,27],[60,33,57,31,"Set"],[60,36,57,34],[60,37,57,35],[60,38,57,36,"ratings"],[60,45,57,43],[60,49,57,47],[60,51,57,49],[60,53,57,51,"map"],[60,56,57,54],[60,57,57,56,"r"],[60,58,57,57],[60,62,57,62,"r"],[60,63,57,63],[60,64,57,64,"rater_id"],[60,72,57,72],[60,73,57,73],[60,74,57,74],[60,75,57,75],[61,10,58,6],[61,14,58,10,"ratersMap"],[61,23,58,19],[61,26,58,22],[61,30,58,26,"Map"],[61,33,58,29],[61,34,58,46],[61,35,58,47],[62,10,60,6],[62,14,60,10,"raterIds"],[62,22,60,18],[62,23,60,19,"length"],[62,29,60,25],[62,32,60,28],[62,33,60,29],[62,35,60,31],[63,12,61,8],[63,16,61,8,"_yield$supabase$from$4"],[63,38,61,8],[63,47,61,39,"supabase"],[63,59,61,47],[63,60,61,47,"supabase"],[63,68,61,47],[63,69,62,11,"from"],[63,73,62,15],[63,74,62,16],[63,81,62,23],[63,82,62,24],[63,83,63,11,"select"],[63,89,63,17],[63,90,63,18],[63,108,63,36],[63,109,63,37],[63,110,64,11,"in"],[63,112,64,13],[63,113,64,14],[63,117,64,18],[63,119,64,20,"raterIds"],[63,127,64,28],[63,128,64,29],[64,14,61,22,"raters"],[64,20,61,28],[64,23,61,28,"_yield$supabase$from$4"],[64,45,61,28],[64,46,61,16,"data"],[64,50,61,20],[65,12,66,8,"ratersMap"],[65,21,66,17],[65,24,66,20],[65,28,66,24,"Map"],[65,31,66,27],[65,32,66,28],[65,33,66,29,"raters"],[65,39,66,35],[65,43,66,39],[65,45,66,41],[65,47,66,43,"map"],[65,50,66,46],[65,51,66,48,"r"],[65,52,66,49],[65,56,66,54],[65,57,66,55,"r"],[65,58,66,56],[65,59,66,57,"id"],[65,61,66,59],[65,63,66,61,"r"],[65,64,66,62],[65,65,66,63,"display_name"],[65,77,66,75],[65,78,66,76],[65,79,66,77],[65,80,66,78],[66,10,67,6],[67,10,69,6],[67,14,69,12,"recentRatings"],[67,27,69,25],[67,30,69,28],[67,31,69,29,"ratings"],[67,38,69,36],[67,42,69,40],[67,44,69,42],[67,46,69,44,"map"],[67,49,69,47],[67,50,69,49,"r"],[67,51,69,50],[67,56,69,56],[68,12,70,8,"id"],[68,14,70,10],[68,16,70,12,"r"],[68,17,70,13],[68,18,70,14,"id"],[68,20,70,16],[69,12,71,8,"score"],[69,17,71,13],[69,19,71,15,"r"],[69,20,71,16],[69,21,71,17,"score"],[69,26,71,22],[70,12,72,8,"comment"],[70,19,72,15],[70,21,72,17,"r"],[70,22,72,18],[70,23,72,19,"comment"],[70,30,72,26],[71,12,73,8,"created_at"],[71,22,73,18],[71,24,73,20,"r"],[71,25,73,21],[71,26,73,22,"created_at"],[71,36,73,32],[72,12,74,8,"rater_display_name"],[72,30,74,26],[72,32,74,28,"ratersMap"],[72,41,74,37],[72,42,74,38,"get"],[72,45,74,41],[72,46,74,42,"r"],[72,47,74,43],[72,48,74,44,"rater_id"],[72,56,74,52],[72,57,74,53],[72,61,74,57],[73,10,75,6],[73,11,75,7],[73,12,75,8],[73,13,75,9],[74,10,77,6],[74,17,77,13],[75,12,78,8],[75,15,78,11,"profile"],[75,22,78,18],[76,12,79,8,"active_listings_count"],[76,33,79,29],[76,35,79,31,"count"],[76,40,79,36],[76,44,79,40],[76,45,79,41],[77,12,80,8,"recent_ratings"],[77,26,80,22],[77,28,80,24,"recentRatings"],[78,10,81,6],[78,11,81,7],[79,8,82,4],[79,9,82,5],[80,8,82,5],[80,24,26,4,"queryFn"],[80,31,26,11,"queryFn"],[80,32,26,11],[81,10,26,11],[81,17,26,11,"_ref"],[81,21,26,11],[81,22,26,11,"apply"],[81,27,26,11],[81,34,26,11,"arguments"],[81,43,26,11],[82,8,26,11],[83,6,26,11],[83,9,82,5],[84,6,83,4,"enabled"],[84,13,83,11],[84,15,83,13],[84,16,83,14],[84,17,83,15,"userId"],[85,4,84,2],[85,5,84,3],[85,6,84,4],[86,2,85,0],[86,3,85,1],[87,2,85,2,"_s"],[87,4,85,2],[87,5,23,6,"usePublicProfile"],[87,21,23,22],[88,4,23,22],[88,12,24,9,"useQuery"],[88,31,24,17],[88,32,24,17,"useQuery"],[88,40,24,17],[89,2,24,17],[90,2,87,0],[90,6,87,0,"_default"],[90,14,87,0],[90,17,87,15,"usePublicProfile"],[90,33,87,31],[91,0,87,32],[91,3]],"functionMap":{"names":["<global>","usePublicProfile","useQuery$argument_0.queryFn","map$argument_0"],"mappings":"AAA;yBCsB;aCG;uDC+B,iBD;+CCS,6BD;gDCG;QDM;KDO;CDG"},"hasCjsExports":false},"type":"js/module"}]}