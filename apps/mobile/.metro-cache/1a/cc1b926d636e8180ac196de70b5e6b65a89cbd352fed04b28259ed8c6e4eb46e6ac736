{"dependencies":[{"name":"@babel/runtime/helpers/toConsumableArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kiCFfIx1MWoD4noR0gEoyrFAUKE=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":42,"index":92}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":93},"end":{"line":3,"column":46,"index":139}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersToConsumableArray = require(_dependencyMap[0], \"@babel/runtime/helpers/toConsumableArray\");\n  var _toConsumableArray = _interopDefault(_babelRuntimeHelpersToConsumableArray);\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[1], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[2], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[3], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Hook that fetches a user's public profile by ID.\n   *\n   * Joins the active listings count and recent ratings with rater names.\n   */\n  var usePublicProfile = function usePublicProfile(userId) {\n    _s();\n    return (0, _tanstackReactQuery.useQuery)({\n      queryKey: _queryKeys.profileKeys.publicProfile(userId),\n      queryFn: function () {\n        var _queryFn = (0, _asyncToGenerator.default)(function* () {\n          // Fetch user profile\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('users').select('id, display_name, avatar_url, preferred_tcgs, rating_score, total_trades, created_at').eq('id', userId).single(),\n            profile = _yield$supabase$from$.data,\n            profileError = _yield$supabase$from$.error;\n          if (profileError) throw profileError;\n          if (!profile) throw new Error('User not found');\n\n          // Count active listings\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('listings').select('*', {\n              count: 'exact',\n              head: true\n            }).eq('user_id', userId).eq('status', 'active'),\n            count = _yield$supabase$from$2.count,\n            countError = _yield$supabase$from$2.error;\n          if (countError) throw countError;\n\n          // Fetch recent ratings\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('ratings').select('id, score, comment, created_at, rater_id').eq('ratee_id', userId).order('created_at', {\n              ascending: false\n            }).limit(10),\n            ratings = _yield$supabase$from$3.data,\n            ratingsError = _yield$supabase$from$3.error;\n          if (ratingsError) throw ratingsError;\n\n          // Resolve rater display names\n          var raterIds = (0, _toConsumableArray.default)(new Set((ratings != null ? ratings : []).map(function (r) {\n            return r.rater_id;\n          })));\n          var ratersMap = new Map();\n          if (raterIds.length > 0) {\n            var _yield$supabase$from$4 = yield _libSupabase.supabase.from('users').select('id, display_name').in('id', raterIds),\n              raters = _yield$supabase$from$4.data;\n            ratersMap = new Map((raters != null ? raters : []).map(function (r) {\n              return [r.id, r.display_name];\n            }));\n          }\n          var recentRatings = (ratings != null ? ratings : []).map(function (r) {\n            var _ratersMap$get;\n            return {\n              id: r.id,\n              score: r.score,\n              comment: r.comment,\n              created_at: r.created_at,\n              rater_display_name: (_ratersMap$get = ratersMap.get(r.rater_id)) != null ? _ratersMap$get : 'Unknown'\n            };\n          });\n          return Object.assign({}, profile, {\n            active_listings_count: count != null ? count : 0,\n            recent_ratings: recentRatings\n          });\n        });\n        function queryFn() {\n          return _queryFn.apply(this, arguments);\n        }\n        return queryFn;\n      }(),\n      enabled: !!userId\n    });\n  };\n  _s(usePublicProfile, \"4ZpngI1uv+Uo3WQHEZmTQ5FNM+k=\", false, function () {\n    return [_tanstackReactQuery.useQuery];\n  });\n  var _default = usePublicProfile;\n});","lineCount":100,"map":[[13,2,87,0,"Object"],[13,8,87,0],[13,9,87,0,"defineProperty"],[13,23,87,0],[13,24,87,0,"exports"],[13,31,87,0],[14,4,87,0,"enumerable"],[14,14,87,0],[15,4,87,0,"get"],[15,7,87,0],[15,18,87,0,"get"],[15,19,87,0],[16,6,87,0],[16,13,87,0,"_default"],[16,21,87,0],[17,4,87,0],[18,2,87,0],[19,2,87,32],[19,6,87,32,"_babelRuntimeHelpersToConsumableArray"],[19,43,87,32],[19,46,87,32,"require"],[19,53,87,32],[19,54,87,32,"_dependencyMap"],[19,68,87,32],[20,2,87,32],[20,6,87,32,"_toConsumableArray"],[20,24,87,32],[20,27,87,32,"_interopDefault"],[20,42,87,32],[20,43,87,32,"_babelRuntimeHelpersToConsumableArray"],[20,80,87,32],[21,2,87,32],[21,6,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[21,42,87,32],[21,45,87,32,"require"],[21,52,87,32],[21,53,87,32,"_dependencyMap"],[21,67,87,32],[22,2,87,32],[22,6,87,32,"_asyncToGenerator"],[22,23,87,32],[22,26,87,32,"_interopDefault"],[22,41,87,32],[22,42,87,32,"_babelRuntimeHelpersAsyncToGenerator"],[22,78,87,32],[23,2,1,0],[23,6,1,0,"_tanstackReactQuery"],[23,25,1,0],[23,28,1,0,"require"],[23,35,1,0],[23,36,1,0,"_dependencyMap"],[23,50,1,0],[24,2,2,0],[24,6,2,0,"_libSupabase"],[24,18,2,0],[24,21,2,0,"require"],[24,28,2,0],[24,29,2,0,"_dependencyMap"],[24,43,2,0],[25,2,3,0],[25,6,3,0,"_queryKeys"],[25,16,3,0],[25,19,3,0,"require"],[25,26,3,0],[25,27,3,0,"_dependencyMap"],[25,41,3,0],[26,2,18,0],[27,0,19,0],[28,0,20,0],[29,0,21,0],[30,0,22,0],[31,2,23,0],[31,6,23,6,"usePublicProfile"],[31,22,23,22],[31,25,23,25],[31,34,23,6,"usePublicProfile"],[31,50,23,22,"usePublicProfile"],[31,51,23,26,"userId"],[31,57,23,40],[31,59,23,45],[32,4,23,45,"_s"],[32,6,23,45],[33,4,24,2],[33,11,24,9],[33,15,24,9,"useQuery"],[33,34,24,17],[33,35,24,17,"useQuery"],[33,43,24,17],[33,45,24,40],[34,6,25,4,"queryKey"],[34,14,25,12],[34,16,25,14,"profileKeys"],[34,26,25,25],[34,27,25,25,"profileKeys"],[34,38,25,25],[34,39,25,26,"publicProfile"],[34,52,25,39],[34,53,25,40,"userId"],[34,59,25,46],[34,60,25,47],[35,6,26,4,"queryFn"],[35,13,26,11],[36,8,26,11],[36,12,26,11,"_queryFn"],[36,20,26,11],[36,27,26,11,"_asyncToGenerator"],[36,44,26,11],[36,45,26,11,"default"],[36,52,26,11],[36,54,26,13],[36,67,26,25],[37,10,27,6],[38,10,28,6],[38,14,28,6,"_yield$supabase$from$"],[38,35,28,6],[38,44,28,59,"supabase"],[38,56,28,67],[38,57,28,67,"supabase"],[38,65,28,67],[38,66,29,9,"from"],[38,70,29,13],[38,71,29,14],[38,78,29,21],[38,79,29,22],[38,80,30,9,"select"],[38,86,30,15],[38,87,30,16],[38,173,30,102],[38,174,30,103],[38,175,31,9,"eq"],[38,177,31,11],[38,178,31,12],[38,182,31,16],[38,184,31,18,"userId"],[38,190,31,24],[38,191,31,25],[38,192,32,9,"single"],[38,198,32,15],[38,199,32,16],[38,200,32,17],[39,12,28,20,"profile"],[39,19,28,27],[39,22,28,27,"_yield$supabase$from$"],[39,43,28,27],[39,44,28,14,"data"],[39,48,28,18],[40,12,28,36,"profileError"],[40,24,28,48],[40,27,28,48,"_yield$supabase$from$"],[40,48,28,48],[40,49,28,29,"error"],[40,54,28,34],[41,10,34,6],[41,14,34,10,"profileError"],[41,26,34,22],[41,28,34,24],[41,34,34,30,"profileError"],[41,46,34,42],[42,10,35,6],[42,14,35,10],[42,15,35,11,"profile"],[42,22,35,18],[42,24,35,20],[42,30,35,26],[42,34,35,30,"Error"],[42,39,35,35],[42,40,35,36],[42,56,35,52],[42,57,35,53],[44,10,37,6],[45,10,38,6],[45,14,38,6,"_yield$supabase$from$2"],[45,36,38,6],[45,45,38,49,"supabase"],[45,57,38,57],[45,58,38,57,"supabase"],[45,66,38,57],[45,67,39,9,"from"],[45,71,39,13],[45,72,39,14],[45,82,39,24],[45,83,39,25],[45,84,40,9,"select"],[45,90,40,15],[45,91,40,16],[45,94,40,19],[45,96,40,21],[46,14,40,23,"count"],[46,19,40,28],[46,21,40,30],[46,28,40,37],[47,14,40,39,"head"],[47,18,40,43],[47,20,40,45],[48,12,40,50],[48,13,40,51],[48,14,40,52],[48,15,41,9,"eq"],[48,17,41,11],[48,18,41,12],[48,27,41,21],[48,29,41,23,"userId"],[48,35,41,29],[48,36,41,30],[48,37,42,9,"eq"],[48,39,42,11],[48,40,42,12],[48,48,42,20],[48,50,42,22],[48,58,42,30],[48,59,42,31],[49,12,38,14,"count"],[49,17,38,19],[49,20,38,19,"_yield$supabase$from$2"],[49,42,38,19],[49,43,38,14,"count"],[49,48,38,19],[50,12,38,28,"countError"],[50,22,38,38],[50,25,38,38,"_yield$supabase$from$2"],[50,47,38,38],[50,48,38,21,"error"],[50,53,38,26],[51,10,44,6],[51,14,44,10,"countError"],[51,24,44,20],[51,26,44,22],[51,32,44,28,"countError"],[51,42,44,38],[53,10,46,6],[54,10,47,6],[54,14,47,6,"_yield$supabase$from$3"],[54,36,47,6],[54,45,47,59,"supabase"],[54,57,47,67],[54,58,47,67,"supabase"],[54,66,47,67],[54,67,48,9,"from"],[54,71,48,13],[54,72,48,14],[54,81,48,23],[54,82,48,24],[54,83,49,9,"select"],[54,89,49,15],[54,90,49,16],[54,132,49,58],[54,133,49,59],[54,134,50,9,"eq"],[54,136,50,11],[54,137,50,12],[54,147,50,22],[54,149,50,24,"userId"],[54,155,50,30],[54,156,50,31],[54,157,51,9,"order"],[54,162,51,14],[54,163,51,15],[54,175,51,27],[54,177,51,29],[55,14,51,31,"ascending"],[55,23,51,40],[55,25,51,42],[56,12,51,48],[56,13,51,49],[56,14,51,50],[56,15,52,9,"limit"],[56,20,52,14],[56,21,52,15],[56,23,52,17],[56,24,52,18],[57,12,47,20,"ratings"],[57,19,47,27],[57,22,47,27,"_yield$supabase$from$3"],[57,44,47,27],[57,45,47,14,"data"],[57,49,47,18],[58,12,47,36,"ratingsError"],[58,24,47,48],[58,27,47,48,"_yield$supabase$from$3"],[58,49,47,48],[58,50,47,29,"error"],[58,55,47,34],[59,10,54,6],[59,14,54,10,"ratingsError"],[59,26,54,22],[59,28,54,24],[59,34,54,30,"ratingsError"],[59,46,54,42],[61,10,56,6],[62,10,57,6],[62,14,57,12,"raterIds"],[62,22,57,20],[62,29,57,20,"_toConsumableArray"],[62,47,57,20],[62,48,57,20,"default"],[62,55,57,20],[62,57,57,27],[62,61,57,31,"Set"],[62,64,57,34],[62,65,57,35],[62,66,57,36,"ratings"],[62,73,57,43],[62,84,57,36,"ratings"],[62,91,57,43],[62,94,57,47],[62,96,57,49],[62,98,57,51,"map"],[62,101,57,54],[62,102,57,55],[62,112,57,56,"r"],[62,113,57,57],[63,12,57,57],[63,19,57,62,"r"],[63,20,57,63],[63,21,57,64,"rater_id"],[63,29,57,72],[64,10,57,72],[64,12,57,73],[64,13,57,74],[64,14,57,75],[65,10,58,6],[65,14,58,10,"ratersMap"],[65,23,58,19],[65,26,58,22],[65,30,58,26,"Map"],[65,33,58,29],[65,34,58,46],[65,35,58,47],[66,10,60,6],[66,14,60,10,"raterIds"],[66,22,60,18],[66,23,60,19,"length"],[66,29,60,25],[66,32,60,28],[66,33,60,29],[66,35,60,31],[67,12,61,8],[67,16,61,8,"_yield$supabase$from$4"],[67,38,61,8],[67,47,61,39,"supabase"],[67,59,61,47],[67,60,61,47,"supabase"],[67,68,61,47],[67,69,62,11,"from"],[67,73,62,15],[67,74,62,16],[67,81,62,23],[67,82,62,24],[67,83,63,11,"select"],[67,89,63,17],[67,90,63,18],[67,108,63,36],[67,109,63,37],[67,110,64,11,"in"],[67,112,64,13],[67,113,64,14],[67,117,64,18],[67,119,64,20,"raterIds"],[67,127,64,28],[67,128,64,29],[68,14,61,22,"raters"],[68,20,61,28],[68,23,61,28,"_yield$supabase$from$4"],[68,45,61,28],[68,46,61,16,"data"],[68,50,61,20],[69,12,66,8,"ratersMap"],[69,21,66,17],[69,24,66,20],[69,28,66,24,"Map"],[69,31,66,27],[69,32,66,28],[69,33,66,29,"raters"],[69,39,66,35],[69,50,66,29,"raters"],[69,56,66,35],[69,59,66,39],[69,61,66,41],[69,63,66,43,"map"],[69,66,66,46],[69,67,66,47],[69,77,66,48,"r"],[69,78,66,49],[70,14,66,49],[70,21,66,54],[70,22,66,55,"r"],[70,23,66,56],[70,24,66,57,"id"],[70,26,66,59],[70,28,66,61,"r"],[70,29,66,62],[70,30,66,63,"display_name"],[70,42,66,75],[70,43,66,76],[71,12,66,76],[71,14,66,77],[71,15,66,78],[72,10,67,6],[73,10,69,6],[73,14,69,12,"recentRatings"],[73,27,69,25],[73,30,69,28],[73,31,69,29,"ratings"],[73,38,69,36],[73,49,69,29,"ratings"],[73,56,69,36],[73,59,69,40],[73,61,69,42],[73,63,69,44,"map"],[73,66,69,47],[73,67,69,48],[73,77,69,49,"r"],[73,78,69,50],[74,12,69,50],[74,16,69,50,"_ratersMap$get"],[74,30,69,50],[75,12,69,50],[75,19,69,56],[76,14,70,8,"id"],[76,16,70,10],[76,18,70,12,"r"],[76,19,70,13],[76,20,70,14,"id"],[76,22,70,16],[77,14,71,8,"score"],[77,19,71,13],[77,21,71,15,"r"],[77,22,71,16],[77,23,71,17,"score"],[77,28,71,22],[78,14,72,8,"comment"],[78,21,72,15],[78,23,72,17,"r"],[78,24,72,18],[78,25,72,19,"comment"],[78,32,72,26],[79,14,73,8,"created_at"],[79,24,73,18],[79,26,73,20,"r"],[79,27,73,21],[79,28,73,22,"created_at"],[79,38,73,32],[80,14,74,8,"rater_display_name"],[80,32,74,26],[80,35,74,26,"_ratersMap$get"],[80,49,74,26],[80,52,74,28,"ratersMap"],[80,61,74,37],[80,62,74,38,"get"],[80,65,74,41],[80,66,74,42,"r"],[80,67,74,43],[80,68,74,44,"rater_id"],[80,76,74,52],[80,77,74,53],[80,89,74,53,"_ratersMap$get"],[80,103,74,53],[80,106,74,57],[81,12,75,6],[81,13,75,7],[82,10,75,7],[82,11,75,8],[82,12,75,9],[83,10,77,6],[83,17,77,6,"Object"],[83,23,77,6],[83,24,77,6,"assign"],[83,30,77,6],[83,35,78,11,"profile"],[83,42,78,18],[84,12,79,8,"active_listings_count"],[84,33,79,29],[84,35,79,31,"count"],[84,40,79,36],[84,51,79,31,"count"],[84,56,79,36],[84,59,79,40],[84,60,79,41],[85,12,80,8,"recent_ratings"],[85,26,80,22],[85,28,80,24,"recentRatings"],[86,10,80,37],[87,8,82,4],[87,9,82,5],[88,8,82,5],[88,17,26,4,"queryFn"],[88,24,26,11,"queryFn"],[88,25,26,11],[89,10,26,11],[89,17,26,11,"_queryFn"],[89,25,26,11],[89,26,26,11,"apply"],[89,31,26,11],[89,38,26,11,"arguments"],[89,47,26,11],[90,8,26,11],[91,8,26,11],[91,15,26,4,"queryFn"],[91,22,26,11],[92,6,26,11],[92,9,82,5],[93,6,83,4,"enabled"],[93,13,83,11],[93,15,83,13],[93,16,83,14],[93,17,83,15,"userId"],[94,4,84,2],[94,5,84,3],[94,6,84,4],[95,2,85,0],[95,3,85,1],[96,2,85,2,"_s"],[96,4,85,2],[96,5,23,6,"usePublicProfile"],[96,21,23,22],[97,4,23,22],[97,12,24,9,"useQuery"],[97,31,24,17],[97,32,24,17,"useQuery"],[97,40,24,17],[98,2,24,17],[99,2,87,0],[99,6,87,0,"_default"],[99,14,87,0],[99,17,87,15,"usePublicProfile"],[99,33,87,31],[100,0,87,32],[100,3]],"functionMap":{"names":["<global>","usePublicProfile","useQuery$argument_0.queryFn","map$argument_0"],"mappings":"AAA;yBCsB;aCG;uDC+B,iBD;+CCS,6BD;gDCG;QDM;KDO;CDG"},"hasCjsExports":false},"type":"js/module"}]}