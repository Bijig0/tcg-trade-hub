{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":45,"index":195}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _libSupabase = require(_dependencyMap[3], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Hook that completes a meetup via atomic Postgres RPC.\n   *\n   * Marks the current user's side as completed. When both users have\n   * completed, the RPC atomically finalizes the meetup, match, and\n   * increments both users' total_trades. The response indicates\n   * `both_completed: true` which triggers the rating prompt via\n   * the onBothCompleted callback.\n   *\n   * @see packages/api/src/pipelines/completeMeetup/completeMeetup.ts\n   */\n  var useCompleteMeetup = onBothCompleted => {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var meetupId = _ref.meetupId;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session?.user?.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('complete_meetup_v1', {\n              p_meetup_id: meetupId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          if (!data) throw new Error('No response from complete_meetup_v1');\n          return data;\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: data => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(data.meetup_id)\n        });\n        if (data.both_completed && onBothCompleted) {\n          onBothCompleted(data.meetup_id);\n        }\n      },\n      onError: error => {\n        _reactNative.Alert.alert('Error', error.message ?? 'Failed to complete meetup');\n      }\n    });\n  };\n  _s(useCompleteMeetup, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCompleteMeetup;\n});","lineCount":81,"map":[[13,2,62,0,"Object"],[13,8,62,0],[13,9,62,0,"defineProperty"],[13,23,62,0],[13,24,62,0,"exports"],[13,31,62,0],[14,4,62,0,"enumerable"],[14,14,62,0],[15,4,62,0,"get"],[15,7,62,0],[15,18,62,0,"get"],[15,19,62,0],[16,6,62,0],[16,13,62,0,"_default"],[16,21,62,0],[17,4,62,0],[18,2,62,0],[19,2,62,33],[19,6,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,62,33],[19,45,62,33,"require"],[19,52,62,33],[19,53,62,33,"_dependencyMap"],[19,67,62,33],[20,2,62,33],[20,6,62,33,"_asyncToGenerator"],[20,23,62,33],[20,26,62,33,"_interopDefault"],[20,41,62,33],[20,42,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,62,33],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_reactNative"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_libSupabase"],[23,18,3,0],[23,21,3,0,"require"],[23,28,3,0],[23,29,3,0,"_dependencyMap"],[23,43,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,15,0],[26,0,16,0],[27,0,17,0],[28,0,18,0],[29,0,19,0],[30,0,20,0],[31,0,21,0],[32,0,22,0],[33,0,23,0],[34,0,24,0],[35,0,25,0],[36,2,26,0],[36,6,26,6,"useCompleteMeetup"],[36,23,26,23],[36,26,26,27,"onBothCompleted"],[36,41,26,71],[36,45,26,76],[37,4,26,76,"_s"],[37,6,26,76],[38,4,27,2],[38,8,27,8,"queryClient"],[38,19,27,19],[38,22,27,22],[38,26,27,22,"useQueryClient"],[38,45,27,36],[38,46,27,36,"useQueryClient"],[38,60,27,36],[38,62,27,37],[38,63,27,38],[39,4,29,2],[39,11,29,9],[39,15,29,9,"useMutation"],[39,34,29,20],[39,35,29,20,"useMutation"],[39,46,29,20],[39,48,29,21],[40,6,30,4,"mutationFn"],[40,16,30,14],[41,8,30,14],[41,12,30,14,"_ref2"],[41,17,30,14],[41,24,30,14,"_asyncToGenerator"],[41,41,30,14],[41,42,30,14,"default"],[41,49,30,14],[41,51,30,16],[41,62,30,16,"_ref"],[41,66,30,16],[41,68,30,62],[42,10,30,62],[42,14,30,25,"meetupId"],[42,22,30,33],[42,25,30,33,"_ref"],[42,29,30,33],[42,30,30,25,"meetupId"],[42,38,30,33],[43,10,31,6],[43,14,31,6,"_yield$supabase$auth$"],[43,35,31,6],[43,44,33,16,"supabase"],[43,56,33,24],[43,57,33,24,"supabase"],[43,65,33,24],[43,66,33,25,"auth"],[43,70,33,29],[43,71,33,30,"getSession"],[43,81,33,40],[43,82,33,41],[43,83,33,42],[44,12,32,16,"session"],[44,19,32,23],[44,22,32,23,"_yield$supabase$auth$"],[44,43,32,23],[44,44,32,8,"data"],[44,48,32,12],[44,49,32,16,"session"],[44,56,32,23],[45,10,34,6],[45,14,34,12,"userId"],[45,20,34,18],[45,23,34,21,"session"],[45,30,34,28],[45,32,34,30,"user"],[45,36,34,34],[45,38,34,36,"id"],[45,40,34,38],[46,10,36,6],[46,14,36,10],[46,15,36,11,"userId"],[46,21,36,17],[46,23,36,19],[46,29,36,25],[46,33,36,29,"Error"],[46,38,36,34],[46,39,36,35],[46,58,36,54],[46,59,36,55],[47,10,38,6],[47,14,38,6,"_yield$supabase$rpc"],[47,33,38,6],[47,42,38,36,"supabase"],[47,54,38,44],[47,55,38,44,"supabase"],[47,63,38,44],[47,64,38,45,"rpc"],[47,67,38,48],[47,68,38,49],[47,88,38,69],[47,90,38,80],[48,14,39,8,"p_meetup_id"],[48,25,39,19],[48,27,39,21,"meetupId"],[48,35,39,29],[49,14,40,8,"p_user_id"],[49,23,40,17],[49,25,40,19,"userId"],[50,12,41,6],[50,13,41,16],[50,14,41,17],[51,12,38,14,"data"],[51,16,38,18],[51,19,38,18,"_yield$supabase$rpc"],[51,38,38,18],[51,39,38,14,"data"],[51,43,38,18],[52,12,38,20,"error"],[52,17,38,25],[52,20,38,25,"_yield$supabase$rpc"],[52,39,38,25],[52,40,38,20,"error"],[52,45,38,25],[53,10,43,6],[53,14,43,10,"error"],[53,19,43,15],[53,21,43,17],[53,27,43,23,"error"],[53,32,43,28],[54,10,44,6],[54,14,44,10],[54,15,44,11,"data"],[54,19,44,15],[54,21,44,17],[54,27,44,23],[54,31,44,27,"Error"],[54,36,44,32],[54,37,44,33],[54,74,44,70],[54,75,44,71],[55,10,46,6],[55,17,46,13,"data"],[55,21,46,17],[56,8,47,4],[56,9,47,5],[57,8,47,5],[57,24,30,4,"mutationFn"],[57,34,30,14,"mutationFn"],[57,35,30,14,"_x"],[57,37,30,14],[58,10,30,14],[58,17,30,14,"_ref2"],[58,22,30,14],[58,23,30,14,"apply"],[58,28,30,14],[58,35,30,14,"arguments"],[58,44,30,14],[59,8,30,14],[60,6,30,14],[60,9,47,5],[61,6,48,4,"onSuccess"],[61,15,48,13],[61,17,48,16,"data"],[61,21,48,20],[61,25,48,25],[62,8,49,6,"queryClient"],[62,19,49,17],[62,20,49,18,"invalidateQueries"],[62,37,49,35],[62,38,49,36],[63,10,49,38,"queryKey"],[63,18,49,46],[63,20,49,48,"meetupKeys"],[63,30,49,58],[63,31,49,58,"meetupKeys"],[63,41,49,58],[63,42,49,59,"all"],[64,8,49,63],[64,9,49,64],[64,10,49,65],[65,8,50,6,"queryClient"],[65,19,50,17],[65,20,50,18,"invalidateQueries"],[65,37,50,35],[65,38,50,36],[66,10,50,38,"queryKey"],[66,18,50,46],[66,20,50,48,"meetupKeys"],[66,30,50,58],[66,31,50,58,"meetupKeys"],[66,41,50,58],[66,42,50,59,"detail"],[66,48,50,65],[66,49,50,66,"data"],[66,53,50,70],[66,54,50,71,"meetup_id"],[66,63,50,80],[67,8,50,82],[67,9,50,83],[67,10,50,84],[68,8,52,6],[68,12,52,10,"data"],[68,16,52,14],[68,17,52,15,"both_completed"],[68,31,52,29],[68,35,52,33,"onBothCompleted"],[68,50,52,48],[68,52,52,50],[69,10,53,8,"onBothCompleted"],[69,25,53,23],[69,26,53,24,"data"],[69,30,53,28],[69,31,53,29,"meetup_id"],[69,40,53,38],[69,41,53,39],[70,8,54,6],[71,6,55,4],[71,7,55,5],[72,6,56,4,"onError"],[72,13,56,11],[72,15,56,14,"error"],[72,20,56,26],[72,24,56,31],[73,8,57,6,"Alert"],[73,20,57,11],[73,21,57,11,"Alert"],[73,26,57,11],[73,27,57,12,"alert"],[73,32,57,17],[73,33,57,18],[73,40,57,25],[73,42,57,27,"error"],[73,47,57,32],[73,48,57,33,"message"],[73,55,57,40],[73,59,57,44],[73,86,57,71],[73,87,57,72],[74,6,58,4],[75,4,59,2],[75,5,59,3],[75,6,59,4],[76,2,60,0],[76,3,60,1],[77,2,60,2,"_s"],[77,4,60,2],[77,5,26,6,"useCompleteMeetup"],[77,22,26,23],[78,4,26,23],[78,12,27,22,"useQueryClient"],[78,31,27,36],[78,32,27,36,"useQueryClient"],[78,46,27,36],[78,48,29,9,"useMutation"],[78,67,29,20],[78,68,29,20,"useMutation"],[78,79,29,20],[79,2,29,20],[80,2,62,0],[80,6,62,0,"_default"],[80,14,62,0],[80,17,62,15,"useCompleteMeetup"],[80,34,62,32],[81,0,62,33],[81,3]],"functionMap":{"names":["<global>","useCompleteMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;0BCyB;gBCI;KDiB;eEC;KFO;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}