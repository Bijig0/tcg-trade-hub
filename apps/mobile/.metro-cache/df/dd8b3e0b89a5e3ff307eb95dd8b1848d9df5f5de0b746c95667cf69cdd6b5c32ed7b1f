{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/services/cardData","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":54,"index":166}}],"key":"aDLIuqe8ZoUac1cvYkmTdLzn7po=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":167},"end":{"line":4,"column":49,"index":216}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _servicesCardData = require(_dependencyMap[3], \"@/services/cardData\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Batch-refreshes market_price for all collection items by\n   * fetching current prices from the card data service adapter.\n   */\n  var useRefreshPrices = function useRefreshPrices() {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _mutationFn = (0, _asyncToGenerator.default)(function* (items) {\n          var nonSealed = items.filter(function (item) {\n            return !item.is_sealed;\n          });\n          var updated = 0;\n          for (var item of nonSealed) {\n            var detail = yield _servicesCardData.cardDataService.getCardDetail(item.external_id);\n            if ((detail == null ? void 0 : detail.marketPrice) != null && detail.marketPrice !== item.market_price) {\n              var _yield$supabase$from$ = yield _libSupabase.supabase.from('collection_items').update({\n                  market_price: detail.marketPrice\n                }).eq('id', item.id),\n                error = _yield$supabase$from$.error;\n              if (!error) updated++;\n            }\n          }\n          return {\n            updated: updated,\n            total: nonSealed.length\n          };\n        });\n        function mutationFn(_x) {\n          return _mutationFn.apply(this, arguments);\n        }\n        return mutationFn;\n      }(),\n      onSuccess: function onSuccess() {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.collectionKeys.all\n        });\n      }\n    });\n  };\n  _s(useRefreshPrices, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useRefreshPrices;\n});","lineCount":70,"map":[[13,2,39,0,"Object"],[13,8,39,0],[13,9,39,0,"defineProperty"],[13,23,39,0],[13,24,39,0,"exports"],[13,31,39,0],[14,4,39,0,"enumerable"],[14,14,39,0],[15,4,39,0,"get"],[15,7,39,0],[15,18,39,0,"get"],[15,19,39,0],[16,6,39,0],[16,13,39,0,"_default"],[16,21,39,0],[17,4,39,0],[18,2,39,0],[19,2,39,32],[19,6,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,39,32],[19,45,39,32,"require"],[19,52,39,32],[19,53,39,32,"_dependencyMap"],[19,67,39,32],[20,2,39,32],[20,6,39,32,"_asyncToGenerator"],[20,23,39,32],[20,26,39,32,"_interopDefault"],[20,41,39,32],[20,42,39,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,39,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_servicesCardData"],[23,23,3,0],[23,26,3,0,"require"],[23,33,3,0],[23,34,3,0,"_dependencyMap"],[23,48,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,7,0],[26,0,8,0],[27,0,9,0],[28,0,10,0],[29,2,11,0],[29,6,11,6,"useRefreshPrices"],[29,22,11,22],[29,25,11,25],[29,34,11,6,"useRefreshPrices"],[29,50,11,22,"useRefreshPrices"],[29,51,11,22],[29,53,11,31],[30,4,11,31,"_s"],[30,6,11,31],[31,4,12,2],[31,8,12,8,"queryClient"],[31,19,12,19],[31,22,12,22],[31,26,12,22,"useQueryClient"],[31,45,12,36],[31,46,12,36,"useQueryClient"],[31,60,12,36],[31,62,12,37],[31,63,12,38],[32,4,14,2],[32,11,14,9],[32,15,14,9,"useMutation"],[32,34,14,20],[32,35,14,20,"useMutation"],[32,46,14,20],[32,48,14,21],[33,6,15,4,"mutationFn"],[33,16,15,14],[34,8,15,14],[34,12,15,14,"_mutationFn"],[34,23,15,14],[34,30,15,14,"_asyncToGenerator"],[34,47,15,14],[34,48,15,14,"default"],[34,55,15,14],[34,57,15,16],[34,68,15,23,"items"],[34,73,15,49],[34,75,15,54],[35,10,16,6],[35,14,16,12,"nonSealed"],[35,23,16,21],[35,26,16,24,"items"],[35,31,16,29],[35,32,16,30,"filter"],[35,38,16,36],[35,39,16,37],[35,49,16,38,"item"],[35,53,16,42],[36,12,16,42],[36,19,16,47],[36,20,16,48,"item"],[36,24,16,52],[36,25,16,53,"is_sealed"],[36,34,16,62],[37,10,16,62],[37,12,16,63],[38,10,17,6],[38,14,17,10,"updated"],[38,21,17,17],[38,24,17,20],[38,25,17,21],[39,10,19,6],[39,15,19,11],[39,19,19,17,"item"],[39,23,19,21],[39,27,19,25,"nonSealed"],[39,36,19,34],[39,38,19,36],[40,12,20,8],[40,16,20,14,"detail"],[40,22,20,20],[40,31,20,29,"cardDataService"],[40,48,20,44],[40,49,20,44,"cardDataService"],[40,64,20,44],[40,65,20,45,"getCardDetail"],[40,78,20,58],[40,79,20,59,"item"],[40,83,20,63],[40,84,20,64,"external_id"],[40,95,20,75],[40,96,20,76],[41,12,21,8],[41,16,21,12],[41,17,21,12,"detail"],[41,23,21,18],[41,43,21,12,"detail"],[41,49,21,18],[41,50,21,20,"marketPrice"],[41,61,21,31],[41,66,21,35],[41,70,21,39],[41,74,21,43,"detail"],[41,80,21,49],[41,81,21,50,"marketPrice"],[41,92,21,61],[41,97,21,66,"item"],[41,101,21,70],[41,102,21,71,"market_price"],[41,114,21,83],[41,116,21,85],[42,14,22,10],[42,18,22,10,"_yield$supabase$from$"],[42,39,22,10],[42,48,22,34,"supabase"],[42,60,22,42],[42,61,22,42,"supabase"],[42,69,22,42],[42,70,23,13,"from"],[42,74,23,17],[42,75,23,18],[42,93,23,36],[42,94,23,37],[42,95,24,13,"update"],[42,101,24,19],[42,102,24,20],[43,18,24,22,"market_price"],[43,30,24,34],[43,32,24,36,"detail"],[43,38,24,42],[43,39,24,43,"marketPrice"],[44,16,24,55],[44,17,24,56],[44,18,24,57],[44,19,25,13,"eq"],[44,21,25,15],[44,22,25,16],[44,26,25,20],[44,28,25,22,"item"],[44,32,25,26],[44,33,25,27,"id"],[44,35,25,29],[44,36,25,30],[45,16,22,18,"error"],[45,21,22,23],[45,24,22,23,"_yield$supabase$from$"],[45,45,22,23],[45,46,22,18,"error"],[45,51,22,23],[46,14,27,10],[46,18,27,14],[46,19,27,15,"error"],[46,24,27,20],[46,26,27,22,"updated"],[46,33,27,29],[46,35,27,31],[47,12,28,8],[48,10,29,6],[49,10,31,6],[49,17,31,13],[50,12,31,15,"updated"],[50,19,31,22],[50,21,31,15,"updated"],[50,28,31,22],[51,12,31,24,"total"],[51,17,31,29],[51,19,31,31,"nonSealed"],[51,28,31,40],[51,29,31,41,"length"],[52,10,31,48],[52,11,31,49],[53,8,32,4],[53,9,32,5],[54,8,32,5],[54,17,15,4,"mutationFn"],[54,27,15,14,"mutationFn"],[54,28,15,14,"_x"],[54,30,15,14],[55,10,15,14],[55,17,15,14,"_mutationFn"],[55,28,15,14],[55,29,15,14,"apply"],[55,34,15,14],[55,41,15,14,"arguments"],[55,50,15,14],[56,8,15,14],[57,8,15,14],[57,15,15,4,"mutationFn"],[57,25,15,14],[58,6,15,14],[58,9,32,5],[59,6,33,4,"onSuccess"],[59,15,33,13],[59,17,33,15],[59,26,33,4,"onSuccess"],[59,35,33,13,"onSuccess"],[59,36,33,13],[59,38,33,21],[60,8,34,6,"queryClient"],[60,19,34,17],[60,20,34,18,"invalidateQueries"],[60,37,34,35],[60,38,34,36],[61,10,34,38,"queryKey"],[61,18,34,46],[61,20,34,48,"collectionKeys"],[61,30,34,62],[61,31,34,62,"collectionKeys"],[61,45,34,62],[61,46,34,63,"all"],[62,8,34,67],[62,9,34,68],[62,10,34,69],[63,6,35,4],[64,4,36,2],[64,5,36,3],[64,6,36,4],[65,2,37,0],[65,3,37,1],[66,2,37,2,"_s"],[66,4,37,2],[66,5,11,6,"useRefreshPrices"],[66,21,11,22],[67,4,11,22],[67,12,12,22,"useQueryClient"],[67,31,12,36],[67,32,12,36,"useQueryClient"],[67,46,12,36],[67,48,14,9,"useMutation"],[67,67,14,20],[67,68,14,20,"useMutation"],[67,79,14,20],[68,2,14,20],[69,2,39,0],[69,6,39,0,"_default"],[69,14,39,0],[69,17,39,15,"useRefreshPrices"],[69,33,39,31],[70,0,39,32],[70,3]],"functionMap":{"names":["<global>","useRefreshPrices","useMutation$argument_0.mutationFn","items.filter$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCU;gBCI;qCCC,yBD;KDgB;eGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}