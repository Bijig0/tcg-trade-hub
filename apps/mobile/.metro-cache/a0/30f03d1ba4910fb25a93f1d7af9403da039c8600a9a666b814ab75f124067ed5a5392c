{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"../../../feed/queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":159},"end":{"line":4,"column":51,"index":210}}],"key":"fOhRZkI3VX68oiFPDy9rlJOS+w8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  var _feedQueryKeys = require(_dependencyMap[4], \"../../../feed/queryKeys\");\n  /**\n   * Hook that expires a listing via atomic Postgres RPC.\n   *\n   * Atomically transitions the listing to 'expired' and withdraws\n   * all pending offers. Invalidates myListings and feed queries on success.\n   *\n   * @see packages/api/src/pipelines/expireListing/expireListing.ts\n   */\n  var useDeleteListing = () => {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (listingId) {\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session?.user?.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('expire_listing_v1', {\n              p_listing_id: listingId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          return data;\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }(),\n      onSuccess: () => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.myListings()\n        });\n        queryClient.invalidateQueries({\n          queryKey: _feedQueryKeys.feedKeys.lists()\n        });\n      }\n    });\n  };\n  _s(useDeleteListing, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useDeleteListing;\n});","lineCount":70,"map":[[13,2,47,0,"Object"],[13,8,47,0],[13,9,47,0,"defineProperty"],[13,23,47,0],[13,24,47,0,"exports"],[13,31,47,0],[14,4,47,0,"enumerable"],[14,14,47,0],[15,4,47,0,"get"],[15,7,47,0],[15,18,47,0,"get"],[15,19,47,0],[16,6,47,0],[16,13,47,0,"_default"],[16,21,47,0],[17,4,47,0],[18,2,47,0],[19,2,47,32],[19,6,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,47,32],[19,45,47,32,"require"],[19,52,47,32],[19,53,47,32,"_dependencyMap"],[19,67,47,32],[20,2,47,32],[20,6,47,32,"_asyncToGenerator"],[20,23,47,32],[20,26,47,32,"_interopDefault"],[20,41,47,32],[20,42,47,32,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,47,32],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,4,0],[24,6,4,0,"_feedQueryKeys"],[24,20,4,0],[24,23,4,0,"require"],[24,30,4,0],[24,31,4,0,"_dependencyMap"],[24,45,4,0],[25,2,11,0],[26,0,12,0],[27,0,13,0],[28,0,14,0],[29,0,15,0],[30,0,16,0],[31,0,17,0],[32,0,18,0],[33,2,19,0],[33,6,19,6,"useDeleteListing"],[33,22,19,22],[33,25,19,25,"useDeleteListing"],[33,26,19,25],[33,31,19,31],[34,4,19,31,"_s"],[34,6,19,31],[35,4,20,2],[35,8,20,8,"queryClient"],[35,19,20,19],[35,22,20,22],[35,26,20,22,"useQueryClient"],[35,45,20,36],[35,46,20,36,"useQueryClient"],[35,60,20,36],[35,62,20,37],[35,63,20,38],[36,4,22,2],[36,11,22,9],[36,15,22,9,"useMutation"],[36,34,22,20],[36,35,22,20,"useMutation"],[36,46,22,20],[36,48,22,50],[37,6,23,4,"mutationFn"],[37,16,23,14],[38,8,23,14],[38,12,23,14,"_ref"],[38,16,23,14],[38,23,23,14,"_asyncToGenerator"],[38,40,23,14],[38,41,23,14,"default"],[38,48,23,14],[38,50,23,16],[38,61,23,23,"listingId"],[38,70,23,32],[38,72,23,37],[39,10,24,6],[39,14,24,6,"_yield$supabase$auth$"],[39,35,24,6],[39,44,26,16,"supabase"],[39,56,26,24],[39,57,26,24,"supabase"],[39,65,26,24],[39,66,26,25,"auth"],[39,70,26,29],[39,71,26,30,"getSession"],[39,81,26,40],[39,82,26,41],[39,83,26,42],[40,12,25,16,"session"],[40,19,25,23],[40,22,25,23,"_yield$supabase$auth$"],[40,43,25,23],[40,44,25,8,"data"],[40,48,25,12],[40,49,25,16,"session"],[40,56,25,23],[41,10,27,6],[41,14,27,12,"userId"],[41,20,27,18],[41,23,27,21,"session"],[41,30,27,28],[41,32,27,30,"user"],[41,36,27,34],[41,38,27,36,"id"],[41,40,27,38],[42,10,29,6],[42,14,29,10],[42,15,29,11,"userId"],[42,21,29,17],[42,23,29,19],[42,29,29,25],[42,33,29,29,"Error"],[42,38,29,34],[42,39,29,35],[42,58,29,54],[42,59,29,55],[43,10,31,6],[43,14,31,6,"_yield$supabase$rpc"],[43,33,31,6],[43,42,31,36,"supabase"],[43,54,31,44],[43,55,31,44,"supabase"],[43,63,31,44],[43,64,31,45,"rpc"],[43,67,31,48],[43,68,31,49],[43,87,31,68],[43,89,31,70],[44,14,32,8,"p_listing_id"],[44,26,32,20],[44,28,32,22,"listingId"],[44,37,32,31],[45,14,33,8,"p_user_id"],[45,23,33,17],[45,25,33,19,"userId"],[46,12,34,6],[46,13,34,7],[46,14,34,8],[47,12,31,14,"data"],[47,16,31,18],[47,19,31,18,"_yield$supabase$rpc"],[47,38,31,18],[47,39,31,14,"data"],[47,43,31,18],[48,12,31,20,"error"],[48,17,31,25],[48,20,31,25,"_yield$supabase$rpc"],[48,39,31,25],[48,40,31,20,"error"],[48,45,31,25],[49,10,36,6],[49,14,36,10,"error"],[49,19,36,15],[49,21,36,17],[49,27,36,23,"error"],[49,32,36,28],[50,10,38,6],[50,17,38,13,"data"],[50,21,38,17],[51,8,39,4],[51,9,39,5],[52,8,39,5],[52,24,23,4,"mutationFn"],[52,34,23,14,"mutationFn"],[52,35,23,14,"_x"],[52,37,23,14],[53,10,23,14],[53,17,23,14,"_ref"],[53,21,23,14],[53,22,23,14,"apply"],[53,27,23,14],[53,34,23,14,"arguments"],[53,43,23,14],[54,8,23,14],[55,6,23,14],[55,9,39,5],[56,6,40,4,"onSuccess"],[56,15,40,13],[56,17,40,15,"onSuccess"],[56,18,40,15],[56,23,40,21],[57,8,41,6,"queryClient"],[57,19,41,17],[57,20,41,18,"invalidateQueries"],[57,37,41,35],[57,38,41,36],[58,10,41,38,"queryKey"],[58,18,41,46],[58,20,41,48,"listingKeys"],[58,30,41,59],[58,31,41,59,"listingKeys"],[58,42,41,59],[58,43,41,60,"myListings"],[58,53,41,70],[58,54,41,71],[59,8,41,73],[59,9,41,74],[59,10,41,75],[60,8,42,6,"queryClient"],[60,19,42,17],[60,20,42,18,"invalidateQueries"],[60,37,42,35],[60,38,42,36],[61,10,42,38,"queryKey"],[61,18,42,46],[61,20,42,48,"feedKeys"],[61,34,42,56],[61,35,42,56,"feedKeys"],[61,43,42,56],[61,44,42,57,"lists"],[61,49,42,62],[61,50,42,63],[62,8,42,65],[62,9,42,66],[62,10,42,67],[63,6,43,4],[64,4,44,2],[64,5,44,3],[64,6,44,4],[65,2,45,0],[65,3,45,1],[66,2,45,2,"_s"],[66,4,45,2],[66,5,19,6,"useDeleteListing"],[66,21,19,22],[67,4,19,22],[67,12,20,22,"useQueryClient"],[67,31,20,36],[67,32,20,36,"useQueryClient"],[67,46,20,36],[67,48,22,9,"useMutation"],[67,67,22,20],[67,68,22,20,"useMutation"],[67,79,22,20],[68,2,22,20],[69,2,47,0],[69,6,47,0,"_default"],[69,14,47,0],[69,17,47,15,"useDeleteListing"],[69,33,47,31],[70,0,47,32],[70,3]],"functionMap":{"names":["<global>","useDeleteListing","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess"],"mappings":"AAA;yBCkB;gBCI;KDgB;eEC;KFG;CDE"},"hasCjsExports":false},"type":"js/module"}]}