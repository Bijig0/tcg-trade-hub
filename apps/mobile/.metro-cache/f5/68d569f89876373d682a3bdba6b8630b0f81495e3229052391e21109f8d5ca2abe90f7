{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":49,"index":199}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":200},"end":{"line":5,"column":45,"index":245}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}},{"name":"@tcg-trade-hub/database","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":246},"end":{"line":6,"column":59,"index":305}}],"key":"5m5x3CfVnTLecgF7rw3ym/c0mII=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _reactNative = require(_dependencyMap[2]);\n  var _libSupabase = require(_dependencyMap[3]);\n  var _contextAuthProvider = require(_dependencyMap[4]);\n  var _queryKeys = require(_dependencyMap[5]);\n  var _tcgTradeHubDatabase = require(_dependencyMap[6]);\n  /**\n   * Hook that cancels a meetup by updating its status and sending\n   * a system message in the related chat conversation.\n   */\n  var useCancelMeetup = () => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var meetupId = _ref.meetupId,\n            conversationId = _ref.conversationId;\n          if (!user) throw new Error('Not authenticated');\n\n          // Fetch current meetup to validate transition\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('meetups').select('status').eq('id', meetupId).single(),\n            currentMeetup = _yield$supabase$from$.data,\n            fetchError = _yield$supabase$from$.error;\n          if (fetchError) throw fetchError;\n          (0, _tcgTradeHubDatabase.assertTransition)('meetup', currentMeetup.status, 'cancelled');\n\n          // Update meetup status to cancelled\n          var _yield$supabase$from$2 = yield _libSupabase.supabase.from('meetups').update({\n              status: 'cancelled'\n            }).eq('id', meetupId),\n            meetupError = _yield$supabase$from$2.error;\n          if (meetupError) throw meetupError;\n\n          // Send system message in the conversation\n          var _yield$supabase$from$3 = yield _libSupabase.supabase.from('messages').insert({\n              conversation_id: conversationId,\n              sender_id: user.id,\n              type: 'system',\n              body: 'Meetup was cancelled.',\n              payload: {\n                event: 'meetup_cancelled'\n              }\n            }),\n            messageError = _yield$supabase$from$3.error;\n          if (messageError) throw messageError;\n          return {\n            meetupId\n          };\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: _ref3 => {\n        var meetupId = _ref3.meetupId;\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(meetupId)\n        });\n      },\n      onError: error => {\n        _reactNative.Alert.alert('Error', error.message ?? 'Failed to cancel meetup');\n      }\n    });\n  };\n  var _default = useCancelMeetup;\n});","lineCount":90,"map":[[12,2,68,0,"Object"],[12,8,68,0],[12,9,68,0,"defineProperty"],[12,23,68,0],[12,24,68,0,"exports"],[12,31,68,0],[13,4,68,0,"enumerable"],[13,14,68,0],[14,4,68,0,"get"],[14,7,68,0],[14,18,68,0,"get"],[14,19,68,0],[15,6,68,0],[15,13,68,0,"_default"],[15,21,68,0],[16,4,68,0],[17,2,68,0],[18,2,68,31],[18,6,68,31,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,68,31],[18,45,68,31,"require"],[18,52,68,31],[18,53,68,31,"_dependencyMap"],[18,67,68,31],[19,2,68,31],[19,6,68,31,"_asyncToGenerator"],[19,23,68,31],[19,26,68,31,"_interopDefault"],[19,41,68,31],[19,42,68,31,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,68,31],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_reactNative"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_libSupabase"],[22,18,3,0],[22,21,3,0,"require"],[22,28,3,0],[22,29,3,0,"_dependencyMap"],[22,43,3,0],[23,2,4,0],[23,6,4,0,"_contextAuthProvider"],[23,26,4,0],[23,29,4,0,"require"],[23,36,4,0],[23,37,4,0,"_dependencyMap"],[23,51,4,0],[24,2,5,0],[24,6,5,0,"_queryKeys"],[24,16,5,0],[24,19,5,0,"require"],[24,26,5,0],[24,27,5,0,"_dependencyMap"],[24,41,5,0],[25,2,6,0],[25,6,6,0,"_tcgTradeHubDatabase"],[25,26,6,0],[25,29,6,0,"require"],[25,36,6,0],[25,37,6,0,"_dependencyMap"],[25,51,6,0],[26,2,14,0],[27,0,15,0],[28,0,16,0],[29,0,17,0],[30,2,18,0],[30,6,18,6,"useCancelMeetup"],[30,21,18,21],[30,24,18,24,"useCancelMeetup"],[30,25,18,24],[30,30,18,30],[31,4,19,2],[31,8,19,8,"queryClient"],[31,19,19,19],[31,22,19,22],[31,26,19,22,"useQueryClient"],[31,45,19,36],[31,46,19,36,"useQueryClient"],[31,60,19,36],[31,62,19,37],[31,63,19,38],[32,4,20,2],[32,8,20,2,"_useAuth"],[32,16,20,2],[32,19,20,19],[32,23,20,19,"useAuth"],[32,43,20,26],[32,44,20,26,"useAuth"],[32,51,20,26],[32,53,20,27],[32,54,20,28],[33,6,20,10,"user"],[33,10,20,14],[33,13,20,14,"_useAuth"],[33,21,20,14],[33,22,20,10,"user"],[33,26,20,14],[34,4,22,2],[34,11,22,9],[34,15,22,9,"useMutation"],[34,34,22,20],[34,35,22,20,"useMutation"],[34,46,22,20],[34,48,22,21],[35,6,23,4,"mutationFn"],[35,16,23,14],[36,8,23,14],[36,12,23,14,"_ref2"],[36,17,23,14],[36,24,23,14,"_asyncToGenerator"],[36,41,23,14],[36,42,23,14,"default"],[36,49,23,14],[36,51,23,16],[36,62,23,16,"_ref"],[36,66,23,16],[36,68,23,76],[37,10,23,76],[37,14,23,25,"meetupId"],[37,22,23,33],[37,25,23,33,"_ref"],[37,29,23,33],[37,30,23,25,"meetupId"],[37,38,23,33],[38,12,23,35,"conversationId"],[38,26,23,49],[38,29,23,49,"_ref"],[38,33,23,49],[38,34,23,35,"conversationId"],[38,48,23,49],[39,10,24,6],[39,14,24,10],[39,15,24,11,"user"],[39,19,24,15],[39,21,24,17],[39,27,24,23],[39,31,24,27,"Error"],[39,36,24,32],[39,37,24,33],[39,56,24,52],[39,57,24,53],[41,10,26,6],[42,10,27,6],[42,14,27,6,"_yield$supabase$from$"],[42,35,27,6],[42,44,27,63,"supabase"],[42,56,27,71],[42,57,27,71,"supabase"],[42,65,27,71],[42,66,28,9,"from"],[42,70,28,13],[42,71,28,14],[42,80,28,23],[42,81,28,24],[42,82,29,9,"select"],[42,88,29,15],[42,89,29,16],[42,97,29,24],[42,98,29,25],[42,99,30,9,"eq"],[42,101,30,11],[42,102,30,12],[42,106,30,16],[42,108,30,18,"meetupId"],[42,116,30,26],[42,117,30,27],[42,118,31,9,"single"],[42,124,31,15],[42,125,31,16],[42,126,31,17],[43,12,27,20,"currentMeetup"],[43,25,27,33],[43,28,27,33,"_yield$supabase$from$"],[43,49,27,33],[43,50,27,14,"data"],[43,54,27,18],[44,12,27,42,"fetchError"],[44,22,27,52],[44,25,27,52,"_yield$supabase$from$"],[44,46,27,52],[44,47,27,35,"error"],[44,52,27,40],[45,10,33,6],[45,14,33,10,"fetchError"],[45,24,33,20],[45,26,33,22],[45,32,33,28,"fetchError"],[45,42,33,38],[46,10,35,6],[46,14,35,6,"assertTransition"],[46,34,35,22],[46,35,35,22,"assertTransition"],[46,51,35,22],[46,53,35,23],[46,61,35,31],[46,63,35,33,"currentMeetup"],[46,76,35,46],[46,77,35,47,"status"],[46,83,35,53],[46,85,35,71],[46,96,35,82],[46,97,35,83],[48,10,37,6],[49,10,38,6],[49,14,38,6,"_yield$supabase$from$2"],[49,36,38,6],[49,45,38,43,"supabase"],[49,57,38,51],[49,58,38,51,"supabase"],[49,66,38,51],[49,67,39,9,"from"],[49,71,39,13],[49,72,39,14],[49,81,39,23],[49,82,39,24],[49,83,40,9,"update"],[49,89,40,15],[49,90,40,16],[50,14,40,18,"status"],[50,20,40,24],[50,22,40,26],[51,12,40,38],[51,13,40,39],[51,14,40,40],[51,15,41,9,"eq"],[51,17,41,11],[51,18,41,12],[51,22,41,16],[51,24,41,18,"meetupId"],[51,32,41,26],[51,33,41,27],[52,12,38,21,"meetupError"],[52,23,38,32],[52,26,38,32,"_yield$supabase$from$2"],[52,48,38,32],[52,49,38,14,"error"],[52,54,38,19],[53,10,43,6],[53,14,43,10,"meetupError"],[53,25,43,21],[53,27,43,23],[53,33,43,29,"meetupError"],[53,44,43,40],[55,10,45,6],[56,10,46,6],[56,14,46,6,"_yield$supabase$from$3"],[56,36,46,6],[56,45,46,44,"supabase"],[56,57,46,52],[56,58,46,52,"supabase"],[56,66,46,52],[56,67,46,53,"from"],[56,71,46,57],[56,72,46,58],[56,82,46,68],[56,83,46,69],[56,84,46,70,"insert"],[56,90,46,76],[56,91,46,77],[57,14,47,8,"conversation_id"],[57,29,47,23],[57,31,47,25,"conversationId"],[57,45,47,39],[58,14,48,8,"sender_id"],[58,23,48,17],[58,25,48,19,"user"],[58,29,48,23],[58,30,48,24,"id"],[58,32,48,26],[59,14,49,8,"type"],[59,18,49,12],[59,20,49,14],[59,28,49,22],[60,14,50,8,"body"],[60,18,50,12],[60,20,50,14],[60,43,50,37],[61,14,51,8,"payload"],[61,21,51,15],[61,23,51,17],[62,16,51,19,"event"],[62,21,51,24],[62,23,51,26],[63,14,51,45],[64,12,52,6],[64,13,52,7],[64,14,52,8],[65,12,46,21,"messageError"],[65,24,46,33],[65,27,46,33,"_yield$supabase$from$3"],[65,49,46,33],[65,50,46,14,"error"],[65,55,46,19],[66,10,54,6],[66,14,54,10,"messageError"],[66,26,54,22],[66,28,54,24],[66,34,54,30,"messageError"],[66,46,54,42],[67,10,56,6],[67,17,56,13],[68,12,56,15,"meetupId"],[69,10,56,24],[69,11,56,25],[70,8,57,4],[70,9,57,5],[71,8,57,5],[71,24,23,4,"mutationFn"],[71,34,23,14,"mutationFn"],[71,35,23,14,"_x"],[71,37,23,14],[72,10,23,14],[72,17,23,14,"_ref2"],[72,22,23,14],[72,23,23,14,"apply"],[72,28,23,14],[72,35,23,14,"arguments"],[72,44,23,14],[73,8,23,14],[74,6,23,14],[74,9,57,5],[75,6,58,4,"onSuccess"],[75,15,58,13],[75,17,58,15,"_ref3"],[75,22,58,15],[75,26,58,33],[76,8,58,33],[76,12,58,18,"meetupId"],[76,20,58,26],[76,23,58,26,"_ref3"],[76,28,58,26],[76,29,58,18,"meetupId"],[76,37,58,26],[77,8,59,6,"queryClient"],[77,19,59,17],[77,20,59,18,"invalidateQueries"],[77,37,59,35],[77,38,59,36],[78,10,59,38,"queryKey"],[78,18,59,46],[78,20,59,48,"meetupKeys"],[78,30,59,58],[78,31,59,58,"meetupKeys"],[78,41,59,58],[78,42,59,59,"all"],[79,8,59,63],[79,9,59,64],[79,10,59,65],[80,8,60,6,"queryClient"],[80,19,60,17],[80,20,60,18,"invalidateQueries"],[80,37,60,35],[80,38,60,36],[81,10,60,38,"queryKey"],[81,18,60,46],[81,20,60,48,"meetupKeys"],[81,30,60,58],[81,31,60,58,"meetupKeys"],[81,41,60,58],[81,42,60,59,"detail"],[81,48,60,65],[81,49,60,66,"meetupId"],[81,57,60,74],[82,8,60,76],[82,9,60,77],[82,10,60,78],[83,6,61,4],[83,7,61,5],[84,6,62,4,"onError"],[84,13,62,11],[84,15,62,14,"error"],[84,20,62,26],[84,24,62,31],[85,8,63,6,"Alert"],[85,20,63,11],[85,21,63,11,"Alert"],[85,26,63,11],[85,27,63,12,"alert"],[85,32,63,17],[85,33,63,18],[85,40,63,25],[85,42,63,27,"error"],[85,47,63,32],[85,48,63,33,"message"],[85,55,63,40],[85,59,63,44],[85,84,63,69],[85,85,63,70],[86,6,64,4],[87,4,65,2],[87,5,65,3],[87,6,65,4],[88,2,66,0],[88,3,66,1],[89,2,68,0],[89,6,68,0,"_default"],[89,14,68,0],[89,17,68,15,"useCancelMeetup"],[89,32,68,30],[90,0,68,31],[90,3]],"functionMap":{"names":["<global>","useCancelMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;wBCiB;gBCK;KDkC;eEC;KFG;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}