{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@babel/runtime/helpers/slicedToArray","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"5y7e5+zC7teYEEC6niD9f5zII1M=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":57,"index":57}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":58},"end":{"line":2,"column":40,"index":98}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":42,"index":141}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"@/context/AuthProvider","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":142},"end":{"line":4,"column":49,"index":191}}],"key":"hnDMt1RwOyVwgo481TGNr6ITBm4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _babelRuntimeHelpersSlicedToArray = require(_dependencyMap[1]);\n  var _slicedToArray = _interopDefault(_babelRuntimeHelpersSlicedToArray);\n  var _react = require(_dependencyMap[2]);\n  var _reactNative = require(_dependencyMap[3]);\n  var _libSupabase = require(_dependencyMap[4]);\n  var _contextAuthProvider = require(_dependencyMap[5]);\n  /**\n   * Tracks online presence using Supabase Realtime Presence.\n   * Automatically tracks/untracks when the app goes to background/foreground.\n   *\n   * Returns the set of online user IDs and a convenience `isOnline` checker.\n   */\n  var useOnlinePresence = () => {\n    var _useAuth = (0, _contextAuthProvider.useAuth)(),\n      user = _useAuth.user;\n    var _useState = (0, _react.useState)(new Set()),\n      _useState2 = (0, _slicedToArray.default)(_useState, 2),\n      onlineUserIds = _useState2[0],\n      setOnlineUserIds = _useState2[1];\n    var isOnline = (0, _react.useCallback)(userId => onlineUserIds.has(userId), [onlineUserIds]);\n    (0, _react.useEffect)(() => {\n      if (!user) return;\n      var channel = _libSupabase.supabase.channel('presence:global', {\n        config: {\n          presence: {\n            key: user.id\n          }\n        }\n      });\n      channel.on('presence', {\n        event: 'sync'\n      }, () => {\n        var state = channel.presenceState();\n        var ids = new Set(Object.keys(state));\n        setOnlineUserIds(ids);\n      }).subscribe(/*#__PURE__*/function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (status) {\n          if (status === 'SUBSCRIBED') {\n            yield channel.track({\n              online_at: new Date().toISOString()\n            });\n          }\n        });\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n\n      // Track/untrack based on app state\n      var subscription = _reactNative.AppState.addEventListener('change', /*#__PURE__*/function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (nextState) {\n          if (nextState === 'active') {\n            yield channel.track({\n              online_at: new Date().toISOString()\n            });\n          } else {\n            yield channel.untrack();\n          }\n        });\n        return function (_x2) {\n          return _ref2.apply(this, arguments);\n        };\n      }());\n      return () => {\n        subscription.remove();\n        _libSupabase.supabase.removeChannel(channel);\n      };\n    }, [user]);\n    return {\n      onlineUserIds,\n      isOnline\n    };\n  };\n  var _default = useOnlinePresence;\n});","lineCount":94,"map":[[12,2,58,0,"Object"],[12,8,58,0],[12,9,58,0,"defineProperty"],[12,23,58,0],[12,24,58,0,"exports"],[12,31,58,0],[13,4,58,0,"enumerable"],[13,14,58,0],[14,4,58,0,"get"],[14,7,58,0],[14,18,58,0,"get"],[14,19,58,0],[15,6,58,0],[15,13,58,0,"_default"],[15,21,58,0],[16,4,58,0],[17,2,58,0],[18,2,58,33],[18,6,58,33,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,58,33],[18,45,58,33,"require"],[18,52,58,33],[18,53,58,33,"_dependencyMap"],[18,67,58,33],[19,2,58,33],[19,6,58,33,"_asyncToGenerator"],[19,23,58,33],[19,26,58,33,"_interopDefault"],[19,41,58,33],[19,42,58,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,58,33],[20,2,58,33],[20,6,58,33,"_babelRuntimeHelpersSlicedToArray"],[20,39,58,33],[20,42,58,33,"require"],[20,49,58,33],[20,50,58,33,"_dependencyMap"],[20,64,58,33],[21,2,58,33],[21,6,58,33,"_slicedToArray"],[21,20,58,33],[21,23,58,33,"_interopDefault"],[21,38,58,33],[21,39,58,33,"_babelRuntimeHelpersSlicedToArray"],[21,72,58,33],[22,2,1,0],[22,6,1,0,"_react"],[22,12,1,0],[22,15,1,0,"require"],[22,22,1,0],[22,23,1,0,"_dependencyMap"],[22,37,1,0],[23,2,2,0],[23,6,2,0,"_reactNative"],[23,18,2,0],[23,21,2,0,"require"],[23,28,2,0],[23,29,2,0,"_dependencyMap"],[23,43,2,0],[24,2,3,0],[24,6,3,0,"_libSupabase"],[24,18,3,0],[24,21,3,0,"require"],[24,28,3,0],[24,29,3,0,"_dependencyMap"],[24,43,3,0],[25,2,4,0],[25,6,4,0,"_contextAuthProvider"],[25,26,4,0],[25,29,4,0,"require"],[25,36,4,0],[25,37,4,0,"_dependencyMap"],[25,51,4,0],[26,2,6,0],[27,0,7,0],[28,0,8,0],[29,0,9,0],[30,0,10,0],[31,0,11,0],[32,2,12,0],[32,6,12,6,"useOnlinePresence"],[32,23,12,23],[32,26,12,26,"useOnlinePresence"],[32,27,12,26],[32,32,12,32],[33,4,13,2],[33,8,13,2,"_useAuth"],[33,16,13,2],[33,19,13,19],[33,23,13,19,"useAuth"],[33,43,13,26],[33,44,13,26,"useAuth"],[33,51,13,26],[33,53,13,27],[33,54,13,28],[34,6,13,10,"user"],[34,10,13,14],[34,13,13,14,"_useAuth"],[34,21,13,14],[34,22,13,10,"user"],[34,26,13,14],[35,4,14,2],[35,8,14,2,"_useState"],[35,17,14,2],[35,20,14,44],[35,24,14,44,"useState"],[35,30,14,52],[35,31,14,52,"useState"],[35,39,14,52],[35,41,14,66],[35,45,14,70,"Set"],[35,48,14,73],[35,49,14,74],[35,50,14,75],[35,51,14,76],[36,6,14,76,"_useState2"],[36,16,14,76],[36,23,14,76,"_slicedToArray"],[36,37,14,76],[36,38,14,76,"default"],[36,45,14,76],[36,47,14,76,"_useState"],[36,56,14,76],[37,6,14,9,"onlineUserIds"],[37,19,14,22],[37,22,14,22,"_useState2"],[37,32,14,22],[38,6,14,24,"setOnlineUserIds"],[38,22,14,40],[38,25,14,40,"_useState2"],[38,35,14,40],[39,4,16,2],[39,8,16,8,"isOnline"],[39,16,16,16],[39,19,16,19],[39,23,16,19,"useCallback"],[39,29,16,30],[39,30,16,30,"useCallback"],[39,41,16,30],[39,43,17,5,"userId"],[39,49,17,19],[39,53,17,24,"onlineUserIds"],[39,66,17,37],[39,67,17,38,"has"],[39,70,17,41],[39,71,17,42,"userId"],[39,77,17,48],[39,78,17,49],[39,80,18,4],[39,81,18,5,"onlineUserIds"],[39,94,18,18],[39,95,19,2],[39,96,19,3],[40,4,21,2],[40,8,21,2,"useEffect"],[40,14,21,11],[40,15,21,11,"useEffect"],[40,24,21,11],[40,26,21,12],[40,32,21,18],[41,6,22,4],[41,10,22,8],[41,11,22,9,"user"],[41,15,22,13],[41,17,22,15],[42,6,24,4],[42,10,24,10,"channel"],[42,17,24,17],[42,20,24,20,"supabase"],[42,32,24,28],[42,33,24,28,"supabase"],[42,41,24,28],[42,42,24,29,"channel"],[42,49,24,36],[42,50,24,37],[42,67,24,54],[42,69,24,56],[43,8,25,6,"config"],[43,14,25,12],[43,16,25,14],[44,10,25,16,"presence"],[44,18,25,24],[44,20,25,26],[45,12,25,28,"key"],[45,15,25,31],[45,17,25,33,"user"],[45,21,25,37],[45,22,25,38,"id"],[46,10,25,41],[47,8,25,43],[48,6,26,4],[48,7,26,5],[48,8,26,6],[49,6,28,4,"channel"],[49,13,28,11],[49,14,29,7,"on"],[49,16,29,9],[49,17,29,10],[49,27,29,20],[49,29,29,22],[50,8,29,24,"event"],[50,13,29,29],[50,15,29,31],[51,6,29,38],[51,7,29,39],[51,9,29,41],[51,15,29,47],[52,8,30,8],[52,12,30,14,"state"],[52,17,30,19],[52,20,30,22,"channel"],[52,27,30,29],[52,28,30,30,"presenceState"],[52,41,30,43],[52,42,30,44],[52,43,30,45],[53,8,31,8],[53,12,31,14,"ids"],[53,15,31,17],[53,18,31,20],[53,22,31,24,"Set"],[53,25,31,27],[53,26,31,28,"Object"],[53,32,31,34],[53,33,31,35,"keys"],[53,37,31,39],[53,38,31,40,"state"],[53,43,31,45],[53,44,31,46],[53,45,31,47],[54,8,32,8,"setOnlineUserIds"],[54,24,32,24],[54,25,32,25,"ids"],[54,28,32,28],[54,29,32,29],[55,6,33,6],[55,7,33,7],[55,8,33,8],[55,9,34,7,"subscribe"],[55,18,34,16],[56,8,34,16],[56,12,34,16,"_ref"],[56,16,34,16],[56,23,34,16,"_asyncToGenerator"],[56,40,34,16],[56,41,34,16,"default"],[56,48,34,16],[56,50,34,17],[56,61,34,24,"status"],[56,67,34,30],[56,69,34,35],[57,10,35,8],[57,14,35,12,"status"],[57,20,35,18],[57,25,35,23],[57,37,35,35],[57,39,35,37],[58,12,36,10],[58,18,36,16,"channel"],[58,25,36,23],[58,26,36,24,"track"],[58,31,36,29],[58,32,36,30],[59,14,36,32,"online_at"],[59,23,36,41],[59,25,36,43],[59,29,36,47,"Date"],[59,33,36,51],[59,34,36,52],[59,35,36,53],[59,36,36,54,"toISOString"],[59,47,36,65],[59,48,36,66],[60,12,36,68],[60,13,36,69],[60,14,36,70],[61,10,37,8],[62,8,38,6],[62,9,38,7],[63,8,38,7],[63,25,38,7,"_x"],[63,27,38,7],[64,10,38,7],[64,17,38,7,"_ref"],[64,21,38,7],[64,22,38,7,"apply"],[64,27,38,7],[64,34,38,7,"arguments"],[64,43,38,7],[65,8,38,7],[66,6,38,7],[66,10,38,8],[68,6,40,4],[69,6,41,4],[69,10,41,10,"subscription"],[69,22,41,22],[69,25,41,25,"AppState"],[69,37,41,33],[69,38,41,33,"AppState"],[69,46,41,33],[69,47,41,34,"addEventListener"],[69,63,41,50],[69,64,41,51],[69,72,41,59],[70,8,41,59],[70,12,41,59,"_ref2"],[70,17,41,59],[70,24,41,59,"_asyncToGenerator"],[70,41,41,59],[70,42,41,59,"default"],[70,49,41,59],[70,51,41,61],[70,62,41,68,"nextState"],[70,71,41,77],[70,73,41,82],[71,10,42,6],[71,14,42,10,"nextState"],[71,23,42,19],[71,28,42,24],[71,36,42,32],[71,38,42,34],[72,12,43,8],[72,18,43,14,"channel"],[72,25,43,21],[72,26,43,22,"track"],[72,31,43,27],[72,32,43,28],[73,14,43,30,"online_at"],[73,23,43,39],[73,25,43,41],[73,29,43,45,"Date"],[73,33,43,49],[73,34,43,50],[73,35,43,51],[73,36,43,52,"toISOString"],[73,47,43,63],[73,48,43,64],[74,12,43,66],[74,13,43,67],[74,14,43,68],[75,10,44,6],[75,11,44,7],[75,17,44,13],[76,12,45,8],[76,18,45,14,"channel"],[76,25,45,21],[76,26,45,22,"untrack"],[76,33,45,29],[76,34,45,30],[76,35,45,31],[77,10,46,6],[78,8,47,4],[78,9,47,5],[79,8,47,5],[79,25,47,5,"_x2"],[79,28,47,5],[80,10,47,5],[80,17,47,5,"_ref2"],[80,22,47,5],[80,23,47,5,"apply"],[80,28,47,5],[80,35,47,5,"arguments"],[80,44,47,5],[81,8,47,5],[82,6,47,5],[82,10,47,6],[83,6,49,4],[83,13,49,11],[83,19,49,17],[84,8,50,6,"subscription"],[84,20,50,18],[84,21,50,19,"remove"],[84,27,50,25],[84,28,50,26],[84,29,50,27],[85,8,51,6,"supabase"],[85,20,51,14],[85,21,51,14,"supabase"],[85,29,51,14],[85,30,51,15,"removeChannel"],[85,43,51,28],[85,44,51,29,"channel"],[85,51,51,36],[85,52,51,37],[86,6,52,4],[86,7,52,5],[87,4,53,2],[87,5,53,3],[87,7,53,5],[87,8,53,6,"user"],[87,12,53,10],[87,13,53,11],[87,14,53,12],[88,4,55,2],[88,11,55,9],[89,6,55,11,"onlineUserIds"],[89,19,55,24],[90,6,55,26,"isOnline"],[91,4,55,35],[91,5,55,36],[92,2,56,0],[92,3,56,1],[93,2,58,0],[93,6,58,0,"_default"],[93,14,58,0],[93,17,58,15,"useOnlinePresence"],[93,34,58,32],[94,0,58,33],[94,3]],"functionMap":{"names":["<global>","useOnlinePresence","isOnline","useEffect$argument_0","channel.on$argument_2","channel.on.subscribe$argument_0","AppState.addEventListener$argument_1","<anonymous>"],"mappings":"AAA;0BCW;ICK,6CD;YEI;yCCQ;ODI;iBEC;OFI;6DGG;KHM;WIE;KJG;GFC;CDG"},"hasCjsExports":false},"type":"js/module"}]}