{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":42,"index":111}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":112},"end":{"line":3,"column":46,"index":158}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _libSupabase = require(_dependencyMap[2], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[3], \"../../queryKeys\");\n  /**\n   * Mutation hook that creates an offer on a listing.\n   * Inserts an offer row followed by offer_items rows for each selected card.\n   */\n  var useCreateOffer = () => {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var listingId = _ref.listingId,\n            selectedCards = _ref.selectedCards,\n            cashAmount = _ref.cashAmount,\n            message = _ref.message;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var user = session?.user ?? null;\n          if (!user) throw new Error('User not authenticated');\n\n          // Insert offer\n          var _yield$supabase$from$ = yield _libSupabase.supabase.from('offers').insert({\n              listing_id: listingId,\n              offerer_id: user.id,\n              cash_amount: cashAmount,\n              message\n            }).select().single(),\n            offer = _yield$supabase$from$.data,\n            offerError = _yield$supabase$from$.error;\n          if (offerError) throw offerError;\n\n          // Insert offer items\n          if (selectedCards.length > 0) {\n            var items = selectedCards.map(sc => ({\n              offer_id: offer.id,\n              card_name: sc.card.name,\n              card_image_url: sc.card.imageUrl,\n              card_external_id: sc.card.externalId,\n              tcg: sc.card.tcg,\n              card_set: sc.card.setName,\n              card_number: sc.card.number,\n              condition: sc.condition,\n              market_price: sc.card.marketPrice ?? null,\n              quantity: 1\n            }));\n            var _yield$supabase$from$2 = yield _libSupabase.supabase.from('offer_items').insert(items),\n              itemsError = _yield$supabase$from$2.error;\n            if (itemsError) throw itemsError;\n          }\n          return offer;\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: (_, variables) => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.offers(variables.listingId)\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.listingKeys.detail(variables.listingId)\n        });\n      }\n    });\n  };\n  _s(useCreateOffer, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCreateOffer;\n});","lineCount":92,"map":[[13,2,75,0,"Object"],[13,8,75,0],[13,9,75,0,"defineProperty"],[13,23,75,0],[13,24,75,0,"exports"],[13,31,75,0],[14,4,75,0,"enumerable"],[14,14,75,0],[15,4,75,0,"get"],[15,7,75,0],[15,18,75,0,"get"],[15,19,75,0],[16,6,75,0],[16,13,75,0,"_default"],[16,21,75,0],[17,4,75,0],[18,2,75,0],[19,2,75,30],[19,6,75,30,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,75,30],[19,45,75,30,"require"],[19,52,75,30],[19,53,75,30,"_dependencyMap"],[19,67,75,30],[20,2,75,30],[20,6,75,30,"_asyncToGenerator"],[20,23,75,30],[20,26,75,30,"_interopDefault"],[20,41,75,30],[20,42,75,30,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,75,30],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_libSupabase"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_queryKeys"],[23,16,3,0],[23,19,3,0,"require"],[23,26,3,0],[23,27,3,0,"_dependencyMap"],[23,41,3,0],[24,2,14,0],[25,0,15,0],[26,0,16,0],[27,0,17,0],[28,2,18,0],[28,6,18,6,"useCreateOffer"],[28,20,18,20],[28,23,18,23,"useCreateOffer"],[28,24,18,23],[28,29,18,29],[29,4,18,29,"_s"],[29,6,18,29],[30,4,19,2],[30,8,19,8,"queryClient"],[30,19,19,19],[30,22,19,22],[30,26,19,22,"useQueryClient"],[30,45,19,36],[30,46,19,36,"useQueryClient"],[30,60,19,36],[30,62,19,37],[30,63,19,38],[31,4,21,2],[31,11,21,9],[31,15,21,9,"useMutation"],[31,34,21,20],[31,35,21,20,"useMutation"],[31,46,21,20],[31,48,21,56],[32,6,22,4,"mutationFn"],[32,16,22,14],[33,8,22,14],[33,12,22,14,"_ref2"],[33,17,22,14],[33,24,22,14,"_asyncToGenerator"],[33,41,22,14],[33,42,22,14,"default"],[33,49,22,14],[33,51,22,16],[33,62,22,16,"_ref"],[33,66,22,16],[33,68,22,77],[34,10,22,77],[34,14,22,25,"listingId"],[34,23,22,34],[34,26,22,34,"_ref"],[34,30,22,34],[34,31,22,25,"listingId"],[34,40,22,34],[35,12,22,36,"selectedCards"],[35,25,22,49],[35,28,22,49,"_ref"],[35,32,22,49],[35,33,22,36,"selectedCards"],[35,46,22,49],[36,12,22,51,"cashAmount"],[36,22,22,61],[36,25,22,61,"_ref"],[36,29,22,61],[36,30,22,51,"cashAmount"],[36,40,22,61],[37,12,22,63,"message"],[37,19,22,70],[37,22,22,70,"_ref"],[37,26,22,70],[37,27,22,63,"message"],[37,34,22,70],[38,10,23,6],[38,14,23,6,"_yield$supabase$auth$"],[38,35,23,6],[38,44,25,16,"supabase"],[38,56,25,24],[38,57,25,24,"supabase"],[38,65,25,24],[38,66,25,25,"auth"],[38,70,25,29],[38,71,25,30,"getSession"],[38,81,25,40],[38,82,25,41],[38,83,25,42],[39,12,24,16,"session"],[39,19,24,23],[39,22,24,23,"_yield$supabase$auth$"],[39,43,24,23],[39,44,24,8,"data"],[39,48,24,12],[39,49,24,16,"session"],[39,56,24,23],[40,10,26,6],[40,14,26,12,"user"],[40,18,26,16],[40,21,26,19,"session"],[40,28,26,26],[40,30,26,28,"user"],[40,34,26,32],[40,38,26,36],[40,42,26,40],[41,10,28,6],[41,14,28,10],[41,15,28,11,"user"],[41,19,28,15],[41,21,28,17],[41,27,28,23],[41,31,28,27,"Error"],[41,36,28,32],[41,37,28,33],[41,61,28,57],[41,62,28,58],[43,10,30,6],[44,10,31,6],[44,14,31,6,"_yield$supabase$from$"],[44,35,31,6],[44,44,31,55,"supabase"],[44,56,31,63],[44,57,31,63,"supabase"],[44,65,31,63],[44,66,32,9,"from"],[44,70,32,13],[44,71,32,14],[44,79,32,22],[44,80,32,23],[44,81,33,9,"insert"],[44,87,33,15],[44,88,33,16],[45,14,34,10,"listing_id"],[45,24,34,20],[45,26,34,22,"listingId"],[45,35,34,31],[46,14,35,10,"offerer_id"],[46,24,35,20],[46,26,35,22,"user"],[46,30,35,26],[46,31,35,27,"id"],[46,33,35,29],[47,14,36,10,"cash_amount"],[47,25,36,21],[47,27,36,23,"cashAmount"],[47,37,36,33],[48,14,37,10,"message"],[49,12,38,8],[49,13,38,9],[49,14,38,10],[49,15,39,9,"select"],[49,21,39,15],[49,22,39,16],[49,23,39,17],[49,24,40,9,"single"],[49,30,40,15],[49,31,40,16],[49,32,40,17],[50,12,31,20,"offer"],[50,17,31,25],[50,20,31,25,"_yield$supabase$from$"],[50,41,31,25],[50,42,31,14,"data"],[50,46,31,18],[51,12,31,34,"offerError"],[51,22,31,44],[51,25,31,44,"_yield$supabase$from$"],[51,46,31,44],[51,47,31,27,"error"],[51,52,31,32],[52,10,42,6],[52,14,42,10,"offerError"],[52,24,42,20],[52,26,42,22],[52,32,42,28,"offerError"],[52,42,42,38],[54,10,44,6],[55,10,45,6],[55,14,45,10,"selectedCards"],[55,27,45,23],[55,28,45,24,"length"],[55,34,45,30],[55,37,45,33],[55,38,45,34],[55,40,45,36],[56,12,46,8],[56,16,46,14,"items"],[56,21,46,38],[56,24,46,41,"selectedCards"],[56,37,46,54],[56,38,46,55,"map"],[56,41,46,58],[56,42,46,60,"sc"],[56,44,46,62],[56,49,46,68],[57,14,47,10,"offer_id"],[57,22,47,18],[57,24,47,20,"offer"],[57,29,47,25],[57,30,47,26,"id"],[57,32,47,28],[58,14,48,10,"card_name"],[58,23,48,19],[58,25,48,21,"sc"],[58,27,48,23],[58,28,48,24,"card"],[58,32,48,28],[58,33,48,29,"name"],[58,37,48,33],[59,14,49,10,"card_image_url"],[59,28,49,24],[59,30,49,26,"sc"],[59,32,49,28],[59,33,49,29,"card"],[59,37,49,33],[59,38,49,34,"imageUrl"],[59,46,49,42],[60,14,50,10,"card_external_id"],[60,30,50,26],[60,32,50,28,"sc"],[60,34,50,30],[60,35,50,31,"card"],[60,39,50,35],[60,40,50,36,"externalId"],[60,50,50,46],[61,14,51,10,"tcg"],[61,17,51,13],[61,19,51,15,"sc"],[61,21,51,17],[61,22,51,18,"card"],[61,26,51,22],[61,27,51,23,"tcg"],[61,30,51,26],[62,14,52,10,"card_set"],[62,22,52,18],[62,24,52,20,"sc"],[62,26,52,22],[62,27,52,23,"card"],[62,31,52,27],[62,32,52,28,"setName"],[62,39,52,35],[63,14,53,10,"card_number"],[63,25,53,21],[63,27,53,23,"sc"],[63,29,53,25],[63,30,53,26,"card"],[63,34,53,30],[63,35,53,31,"number"],[63,41,53,37],[64,14,54,10,"condition"],[64,23,54,19],[64,25,54,21,"sc"],[64,27,54,23],[64,28,54,24,"condition"],[64,37,54,33],[65,14,55,10,"market_price"],[65,26,55,22],[65,28,55,24,"sc"],[65,30,55,26],[65,31,55,27,"card"],[65,35,55,31],[65,36,55,32,"marketPrice"],[65,47,55,43],[65,51,55,47],[65,55,55,51],[66,14,56,10,"quantity"],[66,22,56,18],[66,24,56,20],[67,12,57,8],[67,13,57,9],[67,14,57,10],[67,15,57,11],[68,12,59,8],[68,16,59,8,"_yield$supabase$from$2"],[68,38,59,8],[68,47,59,44,"supabase"],[68,59,59,52],[68,60,59,52,"supabase"],[68,68,59,52],[68,69,60,11,"from"],[68,73,60,15],[68,74,60,16],[68,87,60,29],[68,88,60,30],[68,89,61,11,"insert"],[68,95,61,17],[68,96,61,18,"items"],[68,101,61,23],[68,102,61,24],[69,14,59,23,"itemsError"],[69,24,59,33],[69,27,59,33,"_yield$supabase$from$2"],[69,49,59,33],[69,50,59,16,"error"],[69,55,59,21],[70,12,63,8],[70,16,63,12,"itemsError"],[70,26,63,22],[70,28,63,24],[70,34,63,30,"itemsError"],[70,44,63,40],[71,10,64,6],[72,10,66,6],[72,17,66,13,"offer"],[72,22,66,18],[73,8,67,4],[73,9,67,5],[74,8,67,5],[74,24,22,4,"mutationFn"],[74,34,22,14,"mutationFn"],[74,35,22,14,"_x"],[74,37,22,14],[75,10,22,14],[75,17,22,14,"_ref2"],[75,22,22,14],[75,23,22,14,"apply"],[75,28,22,14],[75,35,22,14,"arguments"],[75,44,22,14],[76,8,22,14],[77,6,22,14],[77,9,67,5],[78,6,68,4,"onSuccess"],[78,15,68,13],[78,17,68,15,"onSuccess"],[78,18,68,16,"_"],[78,19,68,17],[78,21,68,19,"variables"],[78,30,68,28],[78,35,68,33],[79,8,69,6,"queryClient"],[79,19,69,17],[79,20,69,18,"invalidateQueries"],[79,37,69,35],[79,38,69,36],[80,10,69,38,"queryKey"],[80,18,69,46],[80,20,69,48,"listingKeys"],[80,30,69,59],[80,31,69,59,"listingKeys"],[80,42,69,59],[80,43,69,60,"offers"],[80,49,69,66],[80,50,69,67,"variables"],[80,59,69,76],[80,60,69,77,"listingId"],[80,69,69,86],[81,8,69,88],[81,9,69,89],[81,10,69,90],[82,8,70,6,"queryClient"],[82,19,70,17],[82,20,70,18,"invalidateQueries"],[82,37,70,35],[82,38,70,36],[83,10,70,38,"queryKey"],[83,18,70,46],[83,20,70,48,"listingKeys"],[83,30,70,59],[83,31,70,59,"listingKeys"],[83,42,70,59],[83,43,70,60,"detail"],[83,49,70,66],[83,50,70,67,"variables"],[83,59,70,76],[83,60,70,77,"listingId"],[83,69,70,86],[84,8,70,88],[84,9,70,89],[84,10,70,90],[85,6,71,4],[86,4,72,2],[86,5,72,3],[86,6,72,4],[87,2,73,0],[87,3,73,1],[88,2,73,2,"_s"],[88,4,73,2],[88,5,18,6,"useCreateOffer"],[88,19,18,20],[89,4,18,20],[89,12,19,22,"useQueryClient"],[89,31,19,36],[89,32,19,36,"useQueryClient"],[89,46,19,36],[89,48,21,9,"useMutation"],[89,67,21,20],[89,68,21,20,"useMutation"],[89,79,21,20],[90,2,21,20],[91,2,75,0],[91,6,75,0,"_default"],[91,14,75,0],[91,17,75,15,"useCreateOffer"],[91,31,75,29],[92,0,75,30],[92,3]],"functionMap":{"names":["<global>","useCreateOffer","useMutation$argument_0.mutationFn","selectedCards.map$argument_0","useMutation$argument_0.onSuccess"],"mappings":"AAA;uBCiB;gBCI;2DCwB;UDW;KDU;eGC;KHG;CDE"},"hasCjsExports":false},"type":"js/module"}]}