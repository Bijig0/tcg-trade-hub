{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":45,"index":195}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _reactNative = require(_dependencyMap[2]);\n  var _libSupabase = require(_dependencyMap[3]);\n  var _queryKeys = require(_dependencyMap[4]);\n  /**\n   * Hook that completes a meetup via atomic Postgres RPC.\n   *\n   * Marks the current user's side as completed. When both users have\n   * completed, the RPC atomically finalizes the meetup, match, and\n   * increments both users' total_trades. The response indicates\n   * `both_completed: true` which triggers the rating prompt via\n   * the onBothCompleted callback.\n   *\n   * @see packages/api/src/pipelines/completeMeetup/completeMeetup.ts\n   */\n  var useCompleteMeetup = onBothCompleted => {\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref2 = (0, _asyncToGenerator.default)(function* (_ref) {\n          var meetupId = _ref.meetupId;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session?.user?.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('complete_meetup_v1', {\n              p_meetup_id: meetupId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          if (!data) throw new Error('No response from complete_meetup_v1');\n          return data;\n        });\n        return function mutationFn(_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }(),\n      onSuccess: data => {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(data.meetup_id)\n        });\n        if (data.both_completed && onBothCompleted) {\n          onBothCompleted(data.meetup_id);\n        }\n      },\n      onError: error => {\n        _reactNative.Alert.alert('Error', error.message ?? 'Failed to complete meetup');\n      }\n    });\n  };\n  var _default = useCompleteMeetup;\n});","lineCount":76,"map":[[12,2,62,0,"Object"],[12,8,62,0],[12,9,62,0,"defineProperty"],[12,23,62,0],[12,24,62,0,"exports"],[12,31,62,0],[13,4,62,0,"enumerable"],[13,14,62,0],[14,4,62,0,"get"],[14,7,62,0],[14,18,62,0,"get"],[14,19,62,0],[15,6,62,0],[15,13,62,0,"_default"],[15,21,62,0],[16,4,62,0],[17,2,62,0],[18,2,62,33],[18,6,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,62,33],[18,45,62,33,"require"],[18,52,62,33],[18,53,62,33,"_dependencyMap"],[18,67,62,33],[19,2,62,33],[19,6,62,33,"_asyncToGenerator"],[19,23,62,33],[19,26,62,33,"_interopDefault"],[19,41,62,33],[19,42,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,62,33],[20,2,1,0],[20,6,1,0,"_tanstackReactQuery"],[20,25,1,0],[20,28,1,0,"require"],[20,35,1,0],[20,36,1,0,"_dependencyMap"],[20,50,1,0],[21,2,2,0],[21,6,2,0,"_reactNative"],[21,18,2,0],[21,21,2,0,"require"],[21,28,2,0],[21,29,2,0,"_dependencyMap"],[21,43,2,0],[22,2,3,0],[22,6,3,0,"_libSupabase"],[22,18,3,0],[22,21,3,0,"require"],[22,28,3,0],[22,29,3,0,"_dependencyMap"],[22,43,3,0],[23,2,4,0],[23,6,4,0,"_queryKeys"],[23,16,4,0],[23,19,4,0,"require"],[23,26,4,0],[23,27,4,0,"_dependencyMap"],[23,41,4,0],[24,2,15,0],[25,0,16,0],[26,0,17,0],[27,0,18,0],[28,0,19,0],[29,0,20,0],[30,0,21,0],[31,0,22,0],[32,0,23,0],[33,0,24,0],[34,0,25,0],[35,2,26,0],[35,6,26,6,"useCompleteMeetup"],[35,23,26,23],[35,26,26,27,"onBothCompleted"],[35,41,26,71],[35,45,26,76],[36,4,27,2],[36,8,27,8,"queryClient"],[36,19,27,19],[36,22,27,22],[36,26,27,22,"useQueryClient"],[36,45,27,36],[36,46,27,36,"useQueryClient"],[36,60,27,36],[36,62,27,37],[36,63,27,38],[37,4,29,2],[37,11,29,9],[37,15,29,9,"useMutation"],[37,34,29,20],[37,35,29,20,"useMutation"],[37,46,29,20],[37,48,29,21],[38,6,30,4,"mutationFn"],[38,16,30,14],[39,8,30,14],[39,12,30,14,"_ref2"],[39,17,30,14],[39,24,30,14,"_asyncToGenerator"],[39,41,30,14],[39,42,30,14,"default"],[39,49,30,14],[39,51,30,16],[39,62,30,16,"_ref"],[39,66,30,16],[39,68,30,62],[40,10,30,62],[40,14,30,25,"meetupId"],[40,22,30,33],[40,25,30,33,"_ref"],[40,29,30,33],[40,30,30,25,"meetupId"],[40,38,30,33],[41,10,31,6],[41,14,31,6,"_yield$supabase$auth$"],[41,35,31,6],[41,44,33,16,"supabase"],[41,56,33,24],[41,57,33,24,"supabase"],[41,65,33,24],[41,66,33,25,"auth"],[41,70,33,29],[41,71,33,30,"getSession"],[41,81,33,40],[41,82,33,41],[41,83,33,42],[42,12,32,16,"session"],[42,19,32,23],[42,22,32,23,"_yield$supabase$auth$"],[42,43,32,23],[42,44,32,8,"data"],[42,48,32,12],[42,49,32,16,"session"],[42,56,32,23],[43,10,34,6],[43,14,34,12,"userId"],[43,20,34,18],[43,23,34,21,"session"],[43,30,34,28],[43,32,34,30,"user"],[43,36,34,34],[43,38,34,36,"id"],[43,40,34,38],[44,10,36,6],[44,14,36,10],[44,15,36,11,"userId"],[44,21,36,17],[44,23,36,19],[44,29,36,25],[44,33,36,29,"Error"],[44,38,36,34],[44,39,36,35],[44,58,36,54],[44,59,36,55],[45,10,38,6],[45,14,38,6,"_yield$supabase$rpc"],[45,33,38,6],[45,42,38,36,"supabase"],[45,54,38,44],[45,55,38,44,"supabase"],[45,63,38,44],[45,64,38,45,"rpc"],[45,67,38,48],[45,68,38,49],[45,88,38,69],[45,90,38,71],[46,14,39,8,"p_meetup_id"],[46,25,39,19],[46,27,39,21,"meetupId"],[46,35,39,29],[47,14,40,8,"p_user_id"],[47,23,40,17],[47,25,40,19,"userId"],[48,12,41,6],[48,13,41,7],[48,14,41,8],[49,12,38,14,"data"],[49,16,38,18],[49,19,38,18,"_yield$supabase$rpc"],[49,38,38,18],[49,39,38,14,"data"],[49,43,38,18],[50,12,38,20,"error"],[50,17,38,25],[50,20,38,25,"_yield$supabase$rpc"],[50,39,38,25],[50,40,38,20,"error"],[50,45,38,25],[51,10,43,6],[51,14,43,10,"error"],[51,19,43,15],[51,21,43,17],[51,27,43,23,"error"],[51,32,43,28],[52,10,44,6],[52,14,44,10],[52,15,44,11,"data"],[52,19,44,15],[52,21,44,17],[52,27,44,23],[52,31,44,27,"Error"],[52,36,44,32],[52,37,44,33],[52,74,44,70],[52,75,44,71],[53,10,46,6],[53,17,46,13,"data"],[53,21,46,17],[54,8,47,4],[54,9,47,5],[55,8,47,5],[55,24,30,4,"mutationFn"],[55,34,30,14,"mutationFn"],[55,35,30,14,"_x"],[55,37,30,14],[56,10,30,14],[56,17,30,14,"_ref2"],[56,22,30,14],[56,23,30,14,"apply"],[56,28,30,14],[56,35,30,14,"arguments"],[56,44,30,14],[57,8,30,14],[58,6,30,14],[58,9,47,5],[59,6,48,4,"onSuccess"],[59,15,48,13],[59,17,48,16,"data"],[59,21,48,20],[59,25,48,25],[60,8,49,6,"queryClient"],[60,19,49,17],[60,20,49,18,"invalidateQueries"],[60,37,49,35],[60,38,49,36],[61,10,49,38,"queryKey"],[61,18,49,46],[61,20,49,48,"meetupKeys"],[61,30,49,58],[61,31,49,58,"meetupKeys"],[61,41,49,58],[61,42,49,59,"all"],[62,8,49,63],[62,9,49,64],[62,10,49,65],[63,8,50,6,"queryClient"],[63,19,50,17],[63,20,50,18,"invalidateQueries"],[63,37,50,35],[63,38,50,36],[64,10,50,38,"queryKey"],[64,18,50,46],[64,20,50,48,"meetupKeys"],[64,30,50,58],[64,31,50,58,"meetupKeys"],[64,41,50,58],[64,42,50,59,"detail"],[64,48,50,65],[64,49,50,66,"data"],[64,53,50,70],[64,54,50,71,"meetup_id"],[64,63,50,80],[65,8,50,82],[65,9,50,83],[65,10,50,84],[66,8,52,6],[66,12,52,10,"data"],[66,16,52,14],[66,17,52,15,"both_completed"],[66,31,52,29],[66,35,52,33,"onBothCompleted"],[66,50,52,48],[66,52,52,50],[67,10,53,8,"onBothCompleted"],[67,25,53,23],[67,26,53,24,"data"],[67,30,53,28],[67,31,53,29,"meetup_id"],[67,40,53,38],[67,41,53,39],[68,8,54,6],[69,6,55,4],[69,7,55,5],[70,6,56,4,"onError"],[70,13,56,11],[70,15,56,14,"error"],[70,20,56,26],[70,24,56,31],[71,8,57,6,"Alert"],[71,20,57,11],[71,21,57,11,"Alert"],[71,26,57,11],[71,27,57,12,"alert"],[71,32,57,17],[71,33,57,18],[71,40,57,25],[71,42,57,27,"error"],[71,47,57,32],[71,48,57,33,"message"],[71,55,57,40],[71,59,57,44],[71,86,57,71],[71,87,57,72],[72,6,58,4],[73,4,59,2],[73,5,59,3],[73,6,59,4],[74,2,60,0],[74,3,60,1],[75,2,62,0],[75,6,62,0,"_default"],[75,14,62,0],[75,17,62,15,"useCompleteMeetup"],[75,34,62,32],[76,0,62,33],[76,3]],"functionMap":{"names":["<global>","useCompleteMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;0BCyB;gBCI;KDiB;eEC;KFO;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}