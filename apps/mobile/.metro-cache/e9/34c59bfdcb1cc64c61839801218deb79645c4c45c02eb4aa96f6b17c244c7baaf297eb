{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":68,"index":68}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"react-native","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":69},"end":{"line":2,"column":37,"index":106}}],"key":"KyzuX10g6ixS9UfynhmjlvCIG3g=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":107},"end":{"line":3,"column":42,"index":149}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}},{"name":"../../queryKeys","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":150},"end":{"line":4,"column":45,"index":195}}],"key":"9dB6801Llb9DiWHOk43CNQJdoj8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1], \"@tanstack/react-query\");\n  var _reactNative = require(_dependencyMap[2], \"react-native\");\n  var _libSupabase = require(_dependencyMap[3], \"@/lib/supabase\");\n  var _queryKeys = require(_dependencyMap[4], \"../../queryKeys\");\n  /**\n   * Hook that completes a meetup via atomic Postgres RPC.\n   *\n   * Marks the current user's side as completed. When both users have\n   * completed, the RPC atomically finalizes the meetup, match, and\n   * increments both users' total_trades. The response indicates\n   * `both_completed: true` which triggers the rating prompt via\n   * the onBothCompleted callback.\n   *\n   * @see packages/api/src/pipelines/completeMeetup/completeMeetup.ts\n   */\n  var useCompleteMeetup = function useCompleteMeetup(onBothCompleted) {\n    _s();\n    var queryClient = (0, _tanstackReactQuery.useQueryClient)();\n    return (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _mutationFn = (0, _asyncToGenerator.default)(function* (_ref) {\n          var _session$user;\n          var meetupId = _ref.meetupId;\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.getSession(),\n            session = _yield$supabase$auth$.data.session;\n          var userId = session == null || (_session$user = session.user) == null ? void 0 : _session$user.id;\n          if (!userId) throw new Error('Not authenticated');\n          var _yield$supabase$rpc = yield _libSupabase.supabase.rpc('complete_meetup_v1', {\n              p_meetup_id: meetupId,\n              p_user_id: userId\n            }),\n            data = _yield$supabase$rpc.data,\n            error = _yield$supabase$rpc.error;\n          if (error) throw error;\n          if (!data) throw new Error('No response from complete_meetup_v1');\n          return data;\n        });\n        function mutationFn(_x) {\n          return _mutationFn.apply(this, arguments);\n        }\n        return mutationFn;\n      }(),\n      onSuccess: function onSuccess(data) {\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.all\n        });\n        queryClient.invalidateQueries({\n          queryKey: _queryKeys.meetupKeys.detail(data.meetup_id)\n        });\n        if (data.both_completed && onBothCompleted) {\n          onBothCompleted(data.meetup_id);\n        }\n      },\n      onError: function onError(error) {\n        var _error$message;\n        _reactNative.Alert.alert('Error', (_error$message = error.message) != null ? _error$message : 'Failed to complete meetup');\n      }\n    });\n  };\n  _s(useCompleteMeetup, \"YK0wzM21ECnncaq5SECwU+/SVdQ=\", false, function () {\n    return [_tanstackReactQuery.useQueryClient, _tanstackReactQuery.useMutation];\n  });\n  var _default = useCompleteMeetup;\n});","lineCount":84,"map":[[13,2,62,0,"Object"],[13,8,62,0],[13,9,62,0,"defineProperty"],[13,23,62,0],[13,24,62,0,"exports"],[13,31,62,0],[14,4,62,0,"enumerable"],[14,14,62,0],[15,4,62,0,"get"],[15,7,62,0],[15,18,62,0,"get"],[15,19,62,0],[16,6,62,0],[16,13,62,0,"_default"],[16,21,62,0],[17,4,62,0],[18,2,62,0],[19,2,62,33],[19,6,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[19,42,62,33],[19,45,62,33,"require"],[19,52,62,33],[19,53,62,33,"_dependencyMap"],[19,67,62,33],[20,2,62,33],[20,6,62,33,"_asyncToGenerator"],[20,23,62,33],[20,26,62,33,"_interopDefault"],[20,41,62,33],[20,42,62,33,"_babelRuntimeHelpersAsyncToGenerator"],[20,78,62,33],[21,2,1,0],[21,6,1,0,"_tanstackReactQuery"],[21,25,1,0],[21,28,1,0,"require"],[21,35,1,0],[21,36,1,0,"_dependencyMap"],[21,50,1,0],[22,2,2,0],[22,6,2,0,"_reactNative"],[22,18,2,0],[22,21,2,0,"require"],[22,28,2,0],[22,29,2,0,"_dependencyMap"],[22,43,2,0],[23,2,3,0],[23,6,3,0,"_libSupabase"],[23,18,3,0],[23,21,3,0,"require"],[23,28,3,0],[23,29,3,0,"_dependencyMap"],[23,43,3,0],[24,2,4,0],[24,6,4,0,"_queryKeys"],[24,16,4,0],[24,19,4,0,"require"],[24,26,4,0],[24,27,4,0,"_dependencyMap"],[24,41,4,0],[25,2,15,0],[26,0,16,0],[27,0,17,0],[28,0,18,0],[29,0,19,0],[30,0,20,0],[31,0,21,0],[32,0,22,0],[33,0,23,0],[34,0,24,0],[35,0,25,0],[36,2,26,0],[36,6,26,6,"useCompleteMeetup"],[36,23,26,23],[36,26,26,26],[36,35,26,6,"useCompleteMeetup"],[36,52,26,23,"useCompleteMeetup"],[36,53,26,27,"onBothCompleted"],[36,68,26,71],[36,70,26,76],[37,4,26,76,"_s"],[37,6,26,76],[38,4,27,2],[38,8,27,8,"queryClient"],[38,19,27,19],[38,22,27,22],[38,26,27,22,"useQueryClient"],[38,45,27,36],[38,46,27,36,"useQueryClient"],[38,60,27,36],[38,62,27,37],[38,63,27,38],[39,4,29,2],[39,11,29,9],[39,15,29,9,"useMutation"],[39,34,29,20],[39,35,29,20,"useMutation"],[39,46,29,20],[39,48,29,21],[40,6,30,4,"mutationFn"],[40,16,30,14],[41,8,30,14],[41,12,30,14,"_mutationFn"],[41,23,30,14],[41,30,30,14,"_asyncToGenerator"],[41,47,30,14],[41,48,30,14,"default"],[41,55,30,14],[41,57,30,16],[41,68,30,16,"_ref"],[41,72,30,16],[41,74,30,62],[42,10,30,62],[42,14,30,62,"_session$user"],[42,27,30,62],[43,10,30,62],[43,14,30,25,"meetupId"],[43,22,30,33],[43,25,30,33,"_ref"],[43,29,30,33],[43,30,30,25,"meetupId"],[43,38,30,33],[44,10,31,6],[44,14,31,6,"_yield$supabase$auth$"],[44,35,31,6],[44,44,33,16,"supabase"],[44,56,33,24],[44,57,33,24,"supabase"],[44,65,33,24],[44,66,33,25,"auth"],[44,70,33,29],[44,71,33,30,"getSession"],[44,81,33,40],[44,82,33,41],[44,83,33,42],[45,12,32,16,"session"],[45,19,32,23],[45,22,32,23,"_yield$supabase$auth$"],[45,43,32,23],[45,44,32,8,"data"],[45,48,32,12],[45,49,32,16,"session"],[45,56,32,23],[46,10,34,6],[46,14,34,12,"userId"],[46,20,34,18],[46,23,34,21,"session"],[46,30,34,28],[46,43,34,28,"_session$user"],[46,56,34,28],[46,59,34,21,"session"],[46,66,34,28],[46,67,34,30,"user"],[46,71,34,34],[46,92,34,21,"_session$user"],[46,105,34,21],[46,106,34,36,"id"],[46,108,34,38],[47,10,36,6],[47,14,36,10],[47,15,36,11,"userId"],[47,21,36,17],[47,23,36,19],[47,29,36,25],[47,33,36,29,"Error"],[47,38,36,34],[47,39,36,35],[47,58,36,54],[47,59,36,55],[48,10,38,6],[48,14,38,6,"_yield$supabase$rpc"],[48,33,38,6],[48,42,38,36,"supabase"],[48,54,38,44],[48,55,38,44,"supabase"],[48,63,38,44],[48,64,38,45,"rpc"],[48,67,38,48],[48,68,38,49],[48,88,38,69],[48,90,38,71],[49,14,39,8,"p_meetup_id"],[49,25,39,19],[49,27,39,21,"meetupId"],[49,35,39,29],[50,14,40,8,"p_user_id"],[50,23,40,17],[50,25,40,19,"userId"],[51,12,41,6],[51,13,41,7],[51,14,41,8],[52,12,38,14,"data"],[52,16,38,18],[52,19,38,18,"_yield$supabase$rpc"],[52,38,38,18],[52,39,38,14,"data"],[52,43,38,18],[53,12,38,20,"error"],[53,17,38,25],[53,20,38,25,"_yield$supabase$rpc"],[53,39,38,25],[53,40,38,20,"error"],[53,45,38,25],[54,10,43,6],[54,14,43,10,"error"],[54,19,43,15],[54,21,43,17],[54,27,43,23,"error"],[54,32,43,28],[55,10,44,6],[55,14,44,10],[55,15,44,11,"data"],[55,19,44,15],[55,21,44,17],[55,27,44,23],[55,31,44,27,"Error"],[55,36,44,32],[55,37,44,33],[55,74,44,70],[55,75,44,71],[56,10,46,6],[56,17,46,13,"data"],[56,21,46,17],[57,8,47,4],[57,9,47,5],[58,8,47,5],[58,17,30,4,"mutationFn"],[58,27,30,14,"mutationFn"],[58,28,30,14,"_x"],[58,30,30,14],[59,10,30,14],[59,17,30,14,"_mutationFn"],[59,28,30,14],[59,29,30,14,"apply"],[59,34,30,14],[59,41,30,14,"arguments"],[59,50,30,14],[60,8,30,14],[61,8,30,14],[61,15,30,4,"mutationFn"],[61,25,30,14],[62,6,30,14],[62,9,47,5],[63,6,48,4,"onSuccess"],[63,15,48,13],[63,17,48,15],[63,26,48,4,"onSuccess"],[63,35,48,13,"onSuccess"],[63,36,48,16,"data"],[63,40,48,20],[63,42,48,25],[64,8,49,6,"queryClient"],[64,19,49,17],[64,20,49,18,"invalidateQueries"],[64,37,49,35],[64,38,49,36],[65,10,49,38,"queryKey"],[65,18,49,46],[65,20,49,48,"meetupKeys"],[65,30,49,58],[65,31,49,58,"meetupKeys"],[65,41,49,58],[65,42,49,59,"all"],[66,8,49,63],[66,9,49,64],[66,10,49,65],[67,8,50,6,"queryClient"],[67,19,50,17],[67,20,50,18,"invalidateQueries"],[67,37,50,35],[67,38,50,36],[68,10,50,38,"queryKey"],[68,18,50,46],[68,20,50,48,"meetupKeys"],[68,30,50,58],[68,31,50,58,"meetupKeys"],[68,41,50,58],[68,42,50,59,"detail"],[68,48,50,65],[68,49,50,66,"data"],[68,53,50,70],[68,54,50,71,"meetup_id"],[68,63,50,80],[69,8,50,82],[69,9,50,83],[69,10,50,84],[70,8,52,6],[70,12,52,10,"data"],[70,16,52,14],[70,17,52,15,"both_completed"],[70,31,52,29],[70,35,52,33,"onBothCompleted"],[70,50,52,48],[70,52,52,50],[71,10,53,8,"onBothCompleted"],[71,25,53,23],[71,26,53,24,"data"],[71,30,53,28],[71,31,53,29,"meetup_id"],[71,40,53,38],[71,41,53,39],[72,8,54,6],[73,6,55,4],[73,7,55,5],[74,6,56,4,"onError"],[74,13,56,11],[74,15,56,13],[74,24,56,4,"onError"],[74,31,56,11,"onError"],[74,32,56,14,"error"],[74,37,56,26],[74,39,56,31],[75,8,56,31],[75,12,56,31,"_error$message"],[75,26,56,31],[76,8,57,6,"Alert"],[76,20,57,11],[76,21,57,11,"Alert"],[76,26,57,11],[76,27,57,12,"alert"],[76,32,57,17],[76,33,57,18],[76,40,57,25],[76,43,57,25,"_error$message"],[76,57,57,25],[76,60,57,27,"error"],[76,65,57,32],[76,66,57,33,"message"],[76,73,57,40],[76,85,57,40,"_error$message"],[76,99,57,40],[76,102,57,44],[76,129,57,71],[76,130,57,72],[77,6,58,4],[78,4,59,2],[78,5,59,3],[78,6,59,4],[79,2,60,0],[79,3,60,1],[80,2,60,2,"_s"],[80,4,60,2],[80,5,26,6,"useCompleteMeetup"],[80,22,26,23],[81,4,26,23],[81,12,27,22,"useQueryClient"],[81,31,27,36],[81,32,27,36,"useQueryClient"],[81,46,27,36],[81,48,29,9,"useMutation"],[81,67,29,20],[81,68,29,20,"useMutation"],[81,79,29,20],[82,2,29,20],[83,2,62,0],[83,6,62,0,"_default"],[83,14,62,0],[83,17,62,15,"useCompleteMeetup"],[83,34,62,32],[84,0,62,33],[84,3]],"functionMap":{"names":["<global>","useCompleteMeetup","useMutation$argument_0.mutationFn","useMutation$argument_0.onSuccess","useMutation$argument_0.onError"],"mappings":"AAA;0BCyB;gBCI;KDiB;eEC;KFO;aGC;KHE;CDE"},"hasCjsExports":false},"type":"js/module"}]}