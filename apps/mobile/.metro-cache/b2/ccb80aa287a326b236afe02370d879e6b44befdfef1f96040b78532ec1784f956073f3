{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@tanstack/react-query","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":52,"index":52}}],"key":"Pzwu/0TIyhnZOrC9PAkpZx92hFo=","exportNames":["*"],"imports":1}},{"name":"expo-auth-session","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":53},"end":{"line":2,"column":52,"index":105}}],"key":"s3shNvVlaQeRdxbAJkHAKmToFDc=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":106},"end":{"line":3,"column":47,"index":153}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"@/lib/supabase","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":154},"end":{"line":4,"column":42,"index":196}}],"key":"KSAjB91cgWz7DQuLWke0G0l9TgA=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0]);\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _tanstackReactQuery = require(_dependencyMap[1]);\n  var _expoAuthSession = require(_dependencyMap[2]);\n  var _expoWebBrowser = require(_dependencyMap[3]);\n  var WebBrowser = _interopNamespace(_expoWebBrowser);\n  var _libSupabase = require(_dependencyMap[4]);\n  WebBrowser.maybeCompleteAuthSession();\n  /** Hook for OAuth sign-in with Google or Apple via Supabase */\n  var useOAuth = () => {\n    var signIn = (0, _tanstackReactQuery.useMutation)({\n      mutationFn: function () {\n        var _ref = (0, _asyncToGenerator.default)(function* (provider) {\n          var redirectTo = (0, _expoAuthSession.makeRedirectUri)({\n            scheme: 'tcg-trade-hub'\n          });\n          var _yield$supabase$auth$ = yield _libSupabase.supabase.auth.signInWithOAuth({\n              provider,\n              options: {\n                redirectTo,\n                skipBrowserRedirect: true\n              }\n            }),\n            data = _yield$supabase$auth$.data,\n            error = _yield$supabase$auth$.error;\n          if (error) throw error;\n          if (!data.url) throw new Error('No OAuth URL returned');\n          var result = yield WebBrowser.openAuthSessionAsync(data.url, redirectTo);\n          if (result.type === 'success') {\n            var url = new URL(result.url);\n            var params = new URLSearchParams(url.hash.substring(1));\n            var accessToken = params.get('access_token');\n            var refreshToken = params.get('refresh_token');\n            if (accessToken && refreshToken) {\n              var _yield$supabase$auth$2 = yield _libSupabase.supabase.auth.setSession({\n                  access_token: accessToken,\n                  refresh_token: refreshToken\n                }),\n                sessionData = _yield$supabase$auth$2.data,\n                sessionError = _yield$supabase$auth$2.error;\n              if (sessionError) throw sessionError;\n\n              // Create profile if first sign-in\n              if (sessionData.user) {\n                var _yield$supabase$from$ = yield _libSupabase.supabase.from('users').select('id').eq('id', sessionData.user.id).single(),\n                  existingProfile = _yield$supabase$from$.data;\n                if (!existingProfile) {\n                  yield _libSupabase.supabase.from('users').insert({\n                    id: sessionData.user.id,\n                    email: sessionData.user.email ?? '',\n                    display_name: sessionData.user.user_metadata?.['full_name'] ?? sessionData.user.user_metadata?.['name'] ?? sessionData.user.email?.split('@')[0] ?? 'Trader',\n                    avatar_url: sessionData.user.user_metadata?.['avatar_url'] ?? null\n                  });\n                }\n              }\n              return sessionData;\n            }\n          }\n          throw new Error('OAuth sign-in was cancelled or failed');\n        });\n        return function mutationFn(_x) {\n          return _ref.apply(this, arguments);\n        };\n      }()\n    });\n    return {\n      signIn\n    };\n  };\n  var _default = useOAuth;\n});","lineCount":103,"map":[[27,2,73,0,"Object"],[27,8,73,0],[27,9,73,0,"defineProperty"],[27,23,73,0],[27,24,73,0,"exports"],[27,31,73,0],[28,4,73,0,"enumerable"],[28,14,73,0],[29,4,73,0,"get"],[29,7,73,0],[29,18,73,0,"get"],[29,19,73,0],[30,6,73,0],[30,13,73,0,"_default"],[30,21,73,0],[31,4,73,0],[32,2,73,0],[33,2,73,24],[33,6,73,24,"_babelRuntimeHelpersAsyncToGenerator"],[33,42,73,24],[33,45,73,24,"require"],[33,52,73,24],[33,53,73,24,"_dependencyMap"],[33,67,73,24],[34,2,73,24],[34,6,73,24,"_asyncToGenerator"],[34,23,73,24],[34,26,73,24,"_interopDefault"],[34,41,73,24],[34,42,73,24,"_babelRuntimeHelpersAsyncToGenerator"],[34,78,73,24],[35,2,1,0],[35,6,1,0,"_tanstackReactQuery"],[35,25,1,0],[35,28,1,0,"require"],[35,35,1,0],[35,36,1,0,"_dependencyMap"],[35,50,1,0],[36,2,2,0],[36,6,2,0,"_expoAuthSession"],[36,22,2,0],[36,25,2,0,"require"],[36,32,2,0],[36,33,2,0,"_dependencyMap"],[36,47,2,0],[37,2,3,0],[37,6,3,0,"_expoWebBrowser"],[37,21,3,0],[37,24,3,0,"require"],[37,31,3,0],[37,32,3,0,"_dependencyMap"],[37,46,3,0],[38,2,3,0],[38,6,3,0,"WebBrowser"],[38,16,3,0],[38,19,3,0,"_interopNamespace"],[38,36,3,0],[38,37,3,0,"_expoWebBrowser"],[38,52,3,0],[39,2,4,0],[39,6,4,0,"_libSupabase"],[39,18,4,0],[39,21,4,0,"require"],[39,28,4,0],[39,29,4,0,"_dependencyMap"],[39,43,4,0],[40,2,6,0,"WebBrowser"],[40,12,6,10],[40,13,6,11,"maybeCompleteAuthSession"],[40,37,6,35],[40,38,6,36],[40,39,6,37],[41,2,10,0],[42,2,11,0],[42,6,11,6,"useOAuth"],[42,14,11,14],[42,17,11,17,"useOAuth"],[42,18,11,17],[42,23,11,23],[43,4,12,2],[43,8,12,8,"signIn"],[43,14,12,14],[43,17,12,17],[43,21,12,17,"useMutation"],[43,40,12,28],[43,41,12,28,"useMutation"],[43,52,12,28],[43,54,12,29],[44,6,13,4,"mutationFn"],[44,16,13,14],[45,8,13,14],[45,12,13,14,"_ref"],[45,16,13,14],[45,23,13,14,"_asyncToGenerator"],[45,40,13,14],[45,41,13,14,"default"],[45,48,13,14],[45,50,13,16],[45,61,13,23,"provider"],[45,69,13,46],[45,71,13,51],[46,10,14,6],[46,14,14,12,"redirectTo"],[46,24,14,22],[46,27,14,25],[46,31,14,25,"makeRedirectUri"],[46,47,14,40],[46,48,14,40,"makeRedirectUri"],[46,63,14,40],[46,65,14,41],[47,12,14,43,"scheme"],[47,18,14,49],[47,20,14,51],[48,10,14,67],[48,11,14,68],[48,12,14,69],[49,10,16,6],[49,14,16,6,"_yield$supabase$auth$"],[49,35,16,6],[49,44,16,36,"supabase"],[49,56,16,44],[49,57,16,44,"supabase"],[49,65,16,44],[49,66,16,45,"auth"],[49,70,16,49],[49,71,16,50,"signInWithOAuth"],[49,86,16,65],[49,87,16,66],[50,14,17,8,"provider"],[50,22,17,16],[51,14,18,8,"options"],[51,21,18,15],[51,23,18,17],[52,16,19,10,"redirectTo"],[52,26,19,20],[53,16,20,10,"skipBrowserRedirect"],[53,35,20,29],[53,37,20,31],[54,14,21,8],[55,12,22,6],[55,13,22,7],[55,14,22,8],[56,12,16,14,"data"],[56,16,16,18],[56,19,16,18,"_yield$supabase$auth$"],[56,40,16,18],[56,41,16,14,"data"],[56,45,16,18],[57,12,16,20,"error"],[57,17,16,25],[57,20,16,25,"_yield$supabase$auth$"],[57,41,16,25],[57,42,16,20,"error"],[57,47,16,25],[58,10,24,6],[58,14,24,10,"error"],[58,19,24,15],[58,21,24,17],[58,27,24,23,"error"],[58,32,24,28],[59,10,25,6],[59,14,25,10],[59,15,25,11,"data"],[59,19,25,15],[59,20,25,16,"url"],[59,23,25,19],[59,25,25,21],[59,31,25,27],[59,35,25,31,"Error"],[59,40,25,36],[59,41,25,37],[59,64,25,60],[59,65,25,61],[60,10,27,6],[60,14,27,12,"result"],[60,20,27,18],[60,29,27,27,"WebBrowser"],[60,39,27,37],[60,40,27,38,"openAuthSessionAsync"],[60,60,27,58],[60,61,27,59,"data"],[60,65,27,63],[60,66,27,64,"url"],[60,69,27,67],[60,71,27,69,"redirectTo"],[60,81,27,79],[60,82,27,80],[61,10,29,6],[61,14,29,10,"result"],[61,20,29,16],[61,21,29,17,"type"],[61,25,29,21],[61,30,29,26],[61,39,29,35],[61,41,29,37],[62,12,30,8],[62,16,30,14,"url"],[62,19,30,17],[62,22,30,20],[62,26,30,24,"URL"],[62,29,30,27],[62,30,30,28,"result"],[62,36,30,34],[62,37,30,35,"url"],[62,40,30,38],[62,41,30,39],[63,12,31,8],[63,16,31,14,"params"],[63,22,31,20],[63,25,31,23],[63,29,31,27,"URLSearchParams"],[63,44,31,42],[63,45,31,43,"url"],[63,48,31,46],[63,49,31,47,"hash"],[63,53,31,51],[63,54,31,52,"substring"],[63,63,31,61],[63,64,31,62],[63,65,31,63],[63,66,31,64],[63,67,31,65],[64,12,32,8],[64,16,32,14,"accessToken"],[64,27,32,25],[64,30,32,28,"params"],[64,36,32,34],[64,37,32,35,"get"],[64,40,32,38],[64,41,32,39],[64,55,32,53],[64,56,32,54],[65,12,33,8],[65,16,33,14,"refreshToken"],[65,28,33,26],[65,31,33,29,"params"],[65,37,33,35],[65,38,33,36,"get"],[65,41,33,39],[65,42,33,40],[65,57,33,55],[65,58,33,56],[66,12,35,8],[66,16,35,12,"accessToken"],[66,27,35,23],[66,31,35,27,"refreshToken"],[66,43,35,39],[66,45,35,41],[67,14,36,10],[67,18,36,10,"_yield$supabase$auth$2"],[67,40,36,10],[67,49,37,18,"supabase"],[67,61,37,26],[67,62,37,26,"supabase"],[67,70,37,26],[67,71,37,27,"auth"],[67,75,37,31],[67,76,37,32,"setSession"],[67,86,37,42],[67,87,37,43],[68,18,37,45,"access_token"],[68,30,37,57],[68,32,37,59,"accessToken"],[68,43,37,70],[69,18,37,72,"refresh_token"],[69,31,37,85],[69,33,37,87,"refreshToken"],[70,16,37,100],[70,17,37,101],[70,18,37,102],[71,16,36,24,"sessionData"],[71,27,36,35],[71,30,36,35,"_yield$supabase$auth$2"],[71,52,36,35],[71,53,36,18,"data"],[71,57,36,22],[72,16,36,44,"sessionError"],[72,28,36,56],[72,31,36,56,"_yield$supabase$auth$2"],[72,53,36,56],[72,54,36,37,"error"],[72,59,36,42],[73,14,38,10],[73,18,38,14,"sessionError"],[73,30,38,26],[73,32,38,28],[73,38,38,34,"sessionError"],[73,50,38,46],[75,14,40,10],[76,14,41,10],[76,18,41,14,"sessionData"],[76,29,41,25],[76,30,41,26,"user"],[76,34,41,30],[76,36,41,32],[77,16,42,12],[77,20,42,12,"_yield$supabase$from$"],[77,41,42,12],[77,50,42,52,"supabase"],[77,62,42,60],[77,63,42,60,"supabase"],[77,71,42,60],[77,72,43,15,"from"],[77,76,43,19],[77,77,43,20],[77,84,43,27],[77,85,43,28],[77,86,44,15,"select"],[77,92,44,21],[77,93,44,22],[77,97,44,26],[77,98,44,27],[77,99,45,15,"eq"],[77,101,45,17],[77,102,45,18],[77,106,45,22],[77,108,45,24,"sessionData"],[77,119,45,35],[77,120,45,36,"user"],[77,124,45,40],[77,125,45,41,"id"],[77,127,45,43],[77,128,45,44],[77,129,46,15,"single"],[77,135,46,21],[77,136,46,22],[77,137,46,23],[78,18,42,26,"existingProfile"],[78,33,42,41],[78,36,42,41,"_yield$supabase$from$"],[78,57,42,41],[78,58,42,20,"data"],[78,62,42,24],[79,16,48,12],[79,20,48,16],[79,21,48,17,"existingProfile"],[79,36,48,32],[79,38,48,34],[80,18,49,14],[80,24,49,20,"supabase"],[80,36,49,28],[80,37,49,28,"supabase"],[80,45,49,28],[80,46,49,29,"from"],[80,50,49,33],[80,51,49,34],[80,58,49,41],[80,59,49,42],[80,60,49,43,"insert"],[80,66,49,49],[80,67,49,50],[81,20,50,16,"id"],[81,22,50,18],[81,24,50,20,"sessionData"],[81,35,50,31],[81,36,50,32,"user"],[81,40,50,36],[81,41,50,37,"id"],[81,43,50,39],[82,20,51,16,"email"],[82,25,51,21],[82,27,51,23,"sessionData"],[82,38,51,34],[82,39,51,35,"user"],[82,43,51,39],[82,44,51,40,"email"],[82,49,51,45],[82,53,51,49],[82,55,51,51],[83,20,52,16,"display_name"],[83,32,52,28],[83,34,53,18,"sessionData"],[83,45,53,29],[83,46,53,30,"user"],[83,50,53,34],[83,51,53,35,"user_metadata"],[83,64,53,48],[83,67,53,51],[83,78,53,62],[83,79,53,63],[83,83,54,18,"sessionData"],[83,94,54,29],[83,95,54,30,"user"],[83,99,54,34],[83,100,54,35,"user_metadata"],[83,113,54,48],[83,116,54,51],[83,122,54,57],[83,123,54,58],[83,127,55,18,"sessionData"],[83,138,55,29],[83,139,55,30,"user"],[83,143,55,34],[83,144,55,35,"email"],[83,149,55,40],[83,151,55,42,"split"],[83,156,55,47],[83,157,55,48],[83,160,55,51],[83,161,55,52],[83,162,55,53],[83,163,55,54],[83,164,55,55],[83,168,56,18],[83,176,56,26],[84,20,57,16,"avatar_url"],[84,30,57,26],[84,32,57,28,"sessionData"],[84,43,57,39],[84,44,57,40,"user"],[84,48,57,44],[84,49,57,45,"user_metadata"],[84,62,57,58],[84,65,57,61],[84,77,57,73],[84,78,57,74],[84,82,57,78],[85,18,58,14],[85,19,58,15],[85,20,58,16],[86,16,59,12],[87,14,60,10],[88,14,62,10],[88,21,62,17,"sessionData"],[88,32,62,28],[89,12,63,8],[90,10,64,6],[91,10,66,6],[91,16,66,12],[91,20,66,16,"Error"],[91,25,66,21],[91,26,66,22],[91,65,66,61],[91,66,66,62],[92,8,67,4],[92,9,67,5],[93,8,67,5],[93,24,13,4,"mutationFn"],[93,34,13,14,"mutationFn"],[93,35,13,14,"_x"],[93,37,13,14],[94,10,13,14],[94,17,13,14,"_ref"],[94,21,13,14],[94,22,13,14,"apply"],[94,27,13,14],[94,34,13,14,"arguments"],[94,43,13,14],[95,8,13,14],[96,6,13,14],[97,4,68,2],[97,5,68,3],[97,6,68,4],[98,4,70,2],[98,11,70,9],[99,6,70,11,"signIn"],[100,4,70,18],[100,5,70,19],[101,2,71,0],[101,3,71,1],[102,2,73,0],[102,6,73,0,"_default"],[102,14,73,0],[102,17,73,15,"useOAuth"],[102,25,73,23],[103,0,73,24],[103,3]],"functionMap":{"names":["<global>","useOAuth","useMutation$argument_0.mutationFn"],"mappings":"AAA;iBCU;gBCE;KDsD;CDI"},"hasCjsExports":false},"type":"js/module"}]}